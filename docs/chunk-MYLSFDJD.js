import{e as p}from"./chunk-LKCMDNQU.js";import{U as f}from"./chunk-ZKPT3BQF.js";import{a as l,b as g}from"./chunk-2WH2EVR6.js";var S=class a{constructor(){}read(e){try{let t=JSON.parse(localStorage.getItem(e+"_top")||"{}"),r=JSON.parse(localStorage.getItem(e+"_recent")||"{}");return{top:t,recent:r}}catch(t){return console.error("Error reading from localStorage:",t),{top:{},recent:{}}}}count(e,t){if(!t)return;let r=e+"_history",i=e+"_recent",d=e+"_top",o=JSON.parse(localStorage.getItem(r)||"{}"),n=Date.now(),c=n-30*24*60*60*1e3;o[t]={count:(o[t]?.count||0)+1,updatedAt:n};let u=Object.entries(o).filter(([m,s])=>s.updatedAt>=c),D=u.sort((m,s)=>s[1].updatedAt-m[1].updatedAt).slice(0,5),F=u.sort((m,s)=>s[1].count-m[1].count||s[1].updatedAt-m[1].updatedAt).slice(0,5);localStorage.setItem(r,JSON.stringify(Object.fromEntries(u))),localStorage.setItem(i,JSON.stringify(Object.fromEntries(D))),localStorage.setItem(d,JSON.stringify(Object.fromEntries(F)))}static \u0275fac=function(t){return new(t||a)};static \u0275prov=f({token:a,factory:a.\u0275fac,providedIn:"root"})};var y=class a{constructor(){}getDraftForms=e=>{let t=localStorage.getItem(e);return t?JSON.parse(t):null};setDraftForm=(e,t,r,i={})=>{let d=this.getDraftForms(e),o=Date.now(),n=p(),c={uuid:n,createdAt:o,data:t,mode:r,meta:i},u=g(l({},d),{[n]:c});return localStorage.setItem(e,JSON.stringify(u)),c};updateDraftForm=(e,t,r,i,d={})=>{let o=this.getDraftForms(e),n={},c=o;o?.[r]&&(n=g(l({},o?.[r]),{updatedAt:Date.now(),data:l(l({},o?.[r].data),t),mode:i,meta:d}),c[r]=n),localStorage.setItem(e,JSON.stringify(c))};removeDraftForm=(e,t)=>{let r=this.getDraftForms(e);if(r){if(t)delete r[t];else{localStorage.removeItem(e);return}localStorage.setItem(e,JSON.stringify(r))}};static \u0275fac=function(t){return new(t||a)};static \u0275prov=f({token:a,factory:a.\u0275fac,providedIn:"root"})};export{S as a,y as b};
