import{a as Ee,b as Pe}from"./chunk-CJZ3Y6QD.js";import{a as w}from"./chunk-AWZZLHFR.js";import{a as I}from"./chunk-NJUXFY6Z.js";import{a as xe}from"./chunk-YS7XTPR6.js";import{c as Se}from"./chunk-43HPM6FF.js";import"./chunk-IAXPE3GV.js";import{a as L}from"./chunk-HONVEYMY.js";import{b as ke}from"./chunk-YNJQ2EOU.js";import{d as G}from"./chunk-X7YFISNV.js";import{$a as T,$b as we,Ab as me,C as y,Ca as te,Cb as fe,Da as oe,Ga as re,H as E,Ha as ne,Ia as f,Ja as g,Ka as h,M as V,O as $,Oa as ie,P as H,Pa as se,Q as a,Qa as ae,R as q,Rb as ge,Tb as he,U as Y,V as J,Vb as ve,W as X,Wb as ye,Ya as pe,Yb as Ce,Z as K,Za as ce,_b as be,a as Q,ac as Re,bb as le,ea as ee,f as u,gb as de,hb as k,i as A,ia as C,j as M,na as b,r as S,rb as ue,ta as O,ua as z,w as v,wa as P,x as U}from"./chunk-LOAPDVIX.js";var D=(e,o)=>e.reduce((t,n)=>{let r=n[o]||"unknown";return t[r]||(t[r]=[]),t[r].push(n),t},{});var _e=(e,o)=>u(void 0,null,function*(){let t=a(w),n=a(I),s=(yield t.getRecipes()).toSorted((p,m)=>p.name.localeCompare(m.name)),i=D(s,"category_id"),c=[];for(let p in i){let m=i[p],B=yield n.getOne(p);c.push({category:B?.name,recipes:m})}if(!c.length)return[];let[l,...d]=c.toSorted((p,m)=>p.category>m.category?1:-1);return l?.category?[l].concat(d):d.concat([l])});var Ae=(e,o)=>u(void 0,null,function*(){let t=e.paramMap.get("uuid");return a(w)?.getOne(t)});var Me=(e,o)=>u(void 0,null,function*(){let t=e.paramMap.get("uuid");return a(Ee)?.calculateRecipe(t)});var Oe=(e,o)=>u(void 0,null,function*(){let t=e.paramMap.get("uuid"),n=a(w),r=a(Pe),i=(yield n.getOne(t))?.taxTemplateName;return i?r.getTemplateByName("tax",i):null});var Te=(e,o)=>u(void 0,null,function*(){let t=a(Se),n=a(L),s=(yield t.getProducts()).toSorted((p,m)=>p.name.localeCompare(m.name)),i=D(s,"category_id"),c=[];for(let p in i){let m=i[p],B=yield n.getOne(p);c.push({category:B?.name,products:m})}if(!c.length)return[];let[l,...d]=c.toSorted((p,m)=>p.category>m.category?1:-1);return l?.category?[l].concat(d):d.concat([l])});var Ie=[{path:"",children:[{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",loadComponent:()=>import("./chunk-43Y6KPOI.js").then(e=>e.ApplicationComponent)},{path:"add-recipe",loadComponent:()=>import("./chunk-EF77YSMZ.js").then(e=>e.AddRecipeComponent)},{path:"edit-recipe/:uuid",loadComponent:()=>import("./chunk-EF77YSMZ.js").then(e=>e.AddRecipeComponent),resolve:{recipe:Ae}},{path:"calc-recipe/:uuid",loadComponent:()=>import("./chunk-7G6GJHF7.js").then(e=>e.CalculateRecipeComponent),resolve:{result:Me,template:Oe}},{path:"recipes",loadComponent:()=>import("./chunk-6XVIHBJC.js").then(e=>e.RecipesListComponent),resolve:{list:_e}},{path:"add-product",loadComponent:()=>import("./chunk-U2MNQJNG.js").then(e=>e.AddProductComponent)},{path:"edit-product/:uuid",loadComponent:()=>import("./chunk-U2MNQJNG.js").then(e=>e.AddProductComponent)},{path:"products",loadComponent:()=>import("./chunk-4Y67DNVT.js").then(e=>e.ProductListComponent),resolve:{list:Te}},{path:"add-product-category",loadComponent:()=>import("./chunk-V3ZSS7BJ.js").then(e=>e.AddCategoryComponent)},{path:"edit-product-category/:uuid",loadComponent:()=>import("./chunk-V3ZSS7BJ.js").then(e=>e.AddCategoryComponent)},{path:"products-categories",loadComponent:()=>import("./chunk-IVX4E3OR.js").then(e=>e.CategoryListComponent)},{path:"add-recipe-category",loadComponent:()=>import("./chunk-72QI2TKW.js").then(e=>e.AddCategoryRecipeComponent)},{path:"edit-recipe-category/:uuid",loadComponent:()=>import("./chunk-72QI2TKW.js").then(e=>e.AddCategoryRecipeComponent)},{path:"recipes-categories",loadComponent:()=>import("./chunk-DXT6X5OE.js").then(e=>e.CategoryRecipeListComponent)},{path:"widgets",loadComponent:()=>import("./chunk-7UXOYH72.js").then(e=>e.WidgetsPageComponent)},{path:"settings",loadComponent:()=>import("./chunk-QG5OQW3M.js").then(e=>e.SettingsComponent)}]}];var x="Service workers are disabled or not supported by this browser",R=class{serviceWorker;worker;registration;events;constructor(o,t){if(this.serviceWorker=o,!o)this.worker=this.events=this.registration=new A(n=>n.error(new Error(x)));else{let n=null,r=new M;this.worker=new A(d=>(n!==null&&d.next(n),r.subscribe(p=>d.next(p))));let s=()=>{let{controller:d}=o;d!==null&&(n=d,r.next(n))};o.addEventListener("controllerchange",s),s(),this.registration=this.worker.pipe(E(()=>o.getRegistration()));let i=new M;this.events=i.asObservable();let c=d=>{let{data:p}=d;p?.type&&i.next(p)};o.addEventListener("message",c),t?.get(z,null,{optional:!0})?.onDestroy(()=>{o.removeEventListener("controllerchange",s),o.removeEventListener("message",c)})}}postMessage(o,t){return new Promise(n=>{this.worker.pipe(y(1)).subscribe(r=>{r.postMessage(Q({action:o},t)),n()})})}postMessageWithOperation(o,t,n){let r=this.waitForOperationCompleted(n),s=this.postMessage(o,t);return Promise.all([s,r]).then(([,i])=>i)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(o){let t;return typeof o=="string"?t=n=>n.type===o:t=n=>o.includes(n.type),this.events.pipe(U(t))}nextEventOfType(o){return this.eventsOfType(o).pipe(y(1))}waitForOperationCompleted(o){return new Promise((t,n)=>{this.eventsOfType("OPERATION_COMPLETED").pipe(U(r=>r.nonce===o),y(1),S(r=>{if(r.result!==void 0)return r.result;throw new Error(r.error)})).subscribe({next:t,error:n})})}get isEnabled(){return!!this.serviceWorker}},We=(()=>{class e{sw;messages;notificationClicks;subscription;get isEnabled(){return this.sw.isEnabled}pushManager=null;subscriptionChanges=new M;constructor(t){if(this.sw=t,!t.isEnabled){this.messages=v,this.notificationClicks=v,this.subscription=v;return}this.messages=this.sw.eventsOfType("PUSH").pipe(S(r=>r.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(S(r=>r.data)),this.pushManager=this.sw.registration.pipe(S(r=>r.pushManager));let n=this.pushManager.pipe(E(r=>r.getSubscription()));this.subscription=new A(r=>{let s=n.subscribe(r),i=this.subscriptionChanges.subscribe(r);return()=>{s.unsubscribe(),i.unsubscribe()}})}requestSubscription(t){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(x));let n={userVisibleOnly:!0},r=this.decodeBase64(t.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),s=new Uint8Array(new ArrayBuffer(r.length));for(let i=0;i<r.length;i++)s[i]=r.charCodeAt(i);return n.applicationServerKey=s,new Promise((i,c)=>{this.pushManager.pipe(E(l=>l.subscribe(n)),y(1)).subscribe({next:l=>{this.subscriptionChanges.next(l),i(l)},error:c})})}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(x));let t=n=>{if(n===null)throw new Error("Not subscribed to push notifications.");return n.unsubscribe().then(r=>{if(!r)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})};return new Promise((n,r)=>{this.subscription.pipe(y(1),E(t)).subscribe({next:n,error:r})})}decodeBase64(t){return atob(t)}static \u0275fac=function(n){return new(n||e)(H(R))};static \u0275prov=V({token:e,factory:e.\u0275fac})}return e})(),Be=(()=>{class e{sw;versionUpdates;unrecoverable;get isEnabled(){return this.sw.isEnabled}constructor(t){if(this.sw=t,!t.isEnabled){this.versionUpdates=v,this.unrecoverable=v;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(x));let t=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:t},t)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(x));let t=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:t},t)}static \u0275fac=function(n){return new(n||e)(H(R))};static \u0275prov=V({token:e,factory:e.\u0275fac})}return e})();var De=new $("");function Ue(){let e=a(_);if(!("serviceWorker"in navigator&&e.enabled!==!1))return;let o=a(De),t=a(ee),n=a(z);t.runOutsideAngular(()=>{let r=navigator.serviceWorker,s=()=>r.controller?.postMessage({action:"INITIALIZE"});r.addEventListener("controllerchange",s),n.onDestroy(()=>{r.removeEventListener("controllerchange",s)})}),t.runOutsideAngular(()=>{let r,{registrationStrategy:s}=e;if(typeof s=="function")r=new Promise(i=>s().subscribe(()=>i()));else{let[i,...c]=(s||"registerWhenStable:30000").split(":");switch(i){case"registerImmediately":r=Promise.resolve();break;case"registerWithDelay":r=Le(+c[0]||0);break;case"registerWhenStable":r=Promise.race([n.whenStable(),Le(+c[0])]);break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${e.registrationStrategy}`)}}r.then(()=>navigator.serviceWorker.register(o,{scope:e.scope}).catch(i=>console.error("Service worker registration failed with:",i)))})}function Le(e){return new Promise(o=>setTimeout(o,e))}function Ve(e,o){return new R(e.enabled!==!1?navigator.serviceWorker:void 0,o)}var _=class{enabled;scope;registrationStrategy};function Fe(e,o={}){return q([We,Be,{provide:De,useValue:e},{provide:_,useValue:o},{provide:R,useFactory:Ve,deps:[_,X]},O(Ue)])}var Ne={providers:[ue({eventCoalescing:!0}),Re(Ie),ye(ve()),ke(),he(),O(()=>{let e=a(L),o=a(I);return Promise.all([e.preloadCategories(),o.preloadCategories()])}),Fe("ngsw-worker.js",{enabled:!fe(),registrationStrategy:"registerWhenStable:30000"})]};function He(e,o){if(e&1){let t=ie();f(0,"button",0),se("click",function(){Y(t);let r=ae();return J(r.installPWA())}),T(1,"\u0423\u0441\u0442\u0430\u043D\u043E\u0432\u0438\u0442\u044C PWA"),g()}}var F=class e{deferredPrompt=null;showButton=!1;ngOnInit(){window.addEventListener("beforeinstallprompt",o=>{o.preventDefault(),this.deferredPrompt=o,this.showButton=!0})}installPWA(){return u(this,null,function*(){if(!this.deferredPrompt)return;this.deferredPrompt.prompt();let{outcome:o}=yield this.deferredPrompt.userChoice;o==="accepted"?(this.showButton=!1,console.log("PWA \u0443\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D\u0430!")):console.log("\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C \u043E\u0442\u043A\u0430\u0437\u0430\u043B\u0441\u044F \u043E\u0442 \u0443\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0438"),this.deferredPrompt=null,this.showButton=!1})}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=b({type:e,selectors:[["lg-pwa-install"]],decls:1,vars:1,consts:[[3,"click"]],template:function(t,n){t&1&&te(0,He,2,0,"button"),t&2&&oe(n.showButton?0:-1)},styles:["lg-pwa-install[_ngcontent-%COMP%]{display:flex}button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;padding:10px 20px;cursor:pointer;width:100%}button[_ngcontent-%COMP%]:hover{background-color:#0056b3}"]})};var N=()=>["route-active"],Ke=(e,o)=>o.label;function ze(e,o){if(e&1&&(f(0,"a",4),T(1),g()),e&2){let t=o.$implicit;P("routerLink",t.link)("routerLinkActive",k(3,N)),C(),le(" ",t.label," ")}}var j=class e{constructor(){}items=K([{label:"Recipes",link:"/recipes"},{label:"Products",link:"/products"}]);activeIndex=K(0);links=me(G);setActive(o){this.activeIndex.set(o)}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=b({type:e,selectors:[["lg-header"]],viewQuery:function(t,n){t&1&&pe(n.links,G,5),t&2&&ce()},decls:10,vars:9,consts:[[1,"lg-header"],[1,"lg-header__icon",3,"routerLinkActive","routerLink"],["aria-hidden","false","fontIcon","home"],[1,"lg-header__inner"],[1,"lg-header__link",3,"routerLink","routerLinkActive"],["aria-hidden","false","fontIcon","settings"],["aria-hidden","false","fontIcon","widgets"]],template:function(t,n){t&1&&(f(0,"header",0)(1,"a",1),h(2,"mat-icon",2),g(),f(3,"div",3),re(4,ze,2,4,"a",4,Ke),g(),f(6,"a",1),h(7,"mat-icon",5),g(),f(8,"a",1),h(9,"mat-icon",6),g()()),t&2&&(C(),P("routerLinkActive",k(6,N))("routerLink","/home"),C(3),ne(n.items()),C(2),P("routerLinkActive",k(7,N))("routerLink","/settings"),C(2),P("routerLinkActive",k(8,N))("routerLink","/widgets"))},dependencies:[be,we,xe],styles:[".lg-header[_ngcontent-%COMP%]{position:fixed;height:var(--header-height);left:0;right:0;top:12px;display:flex;align-items:center;justify-content:center;gap:16px;overflow-x:auto;white-space:nowrap;padding:0 16px}@media (max-width: 768px){.lg-header[_ngcontent-%COMP%]{justify-content:normal;scroll-snap-type:both mandatory;overscroll-behavior-x:contain;scrollbar-width:none}}.lg-header__inner[_ngcontent-%COMP%]{display:flex;border-radius:35px;padding:8px;-webkit-backdrop-filter:blur(3px);backdrop-filter:blur(3px);background-color:#ffffffb3}.lg-header__link[_ngcontent-%COMP%]{font-size:1rem;font-family:inherit;text-decoration:none;padding:8px 24px;border-radius:32px;cursor:pointer;display:flex;align-items:center;justify-content:center;scroll-snap-align:center}.lg-header__link.route-active[_ngcontent-%COMP%]{background-color:#a26dc7;color:#fff}.lg-header__icon[_ngcontent-%COMP%]{border-radius:50%;display:flex;align-items:center;justify-content:center;padding:8px;cursor:pointer;scroll-snap-align:center;-webkit-backdrop-filter:blur(3px);backdrop-filter:blur(3px);background-color:#ffffffb3}.lg-header__icon.route-active[_ngcontent-%COMP%]{background-color:#a26dc7;color:#fff}"]})};var W=class e{title="lasagna";static \u0275fac=function(t){return new(t||e)};static \u0275cmp=b({type:e,selectors:[["app-root"]],features:[de([])],decls:5,vars:0,consts:[[1,"app"],[1,"app-content"]],template:function(t,n){t&1&&(h(0,"lg-pwa-install"),f(1,"main",0),h(2,"lg-header"),f(3,"div",1),h(4,"router-outlet"),g()())},dependencies:[Ce,F,j],styles:[".app-content[_ngcontent-%COMP%]{padding-top:calc(var(--header-height) + 44px)}"]})};ge(W,Ne).catch(e=>console.error(e));
