import{a as v}from"./chunk-CH6IPXKI.js";import{a as $}from"./chunk-OGV7MEY2.js";import{a as X,c as Y,d as ee,e as te,f as ie,g as C,h as oe,i as re}from"./chunk-HRDLETNK.js";import{a as J,c as K}from"./chunk-5SSCYBOX.js";import{a as H}from"./chunk-ENB3KY2Q.js";import{b as W}from"./chunk-UKAU3626.js";import"./chunk-G42TUXVK.js";import{b as ne}from"./chunk-RNBI2NK7.js";import{a as i}from"./chunk-RFEBMF6P.js";import"./chunk-FG5PJ7WR.js";import{a as V,d as q}from"./chunk-CXKCNMAZ.js";import"./chunk-ZTZGKGRL.js";import{a as U}from"./chunk-JXYZKXYP.js";import{a as B,c as G}from"./chunk-L3VKWLRX.js";import{u as P,x as Q}from"./chunk-O3EHXZ3L.js";import{Cb as j,Eb as E,Fb as h,Gb as p,Hb as l,Ib as S,Mb as L,Pb as g,Qb as d,W as A,Za as r,ac as m,bc as D,ca as M,cb as f,cc as N,ea as u,f as w,hb as Z,hc as O,la as T,ma as b,mb as y,r as z,ub as c,x as I,xb as _,z as F}from"./chunk-46OIECST.js";var ce=i.object({uuid:i.string().optional(),name:i.string().min(1).optional(),description:i.string().optional(),ingredients:i.array(i.object({name:i.string().min(1).optional(),uuid:i.string().optional(),amount:i.union([i.string(),i.number()]).optional(),product_id:i.string().optional(),recipe_id:i.string().optional(),unit:i.string().optional()})),outcome_amount:i.union([i.string(),i.number()]).optional(),outcome_unit:i.string().optional(),taxTemplateName:i.string().optional(),category_id:i.string().optional()});var pe=new M("CategorizedRecipesList",{factory:()=>{let e=u(v),o=u($);return z(e.loadRecipes()).pipe(A(()=>e.recipes$)).pipe(I(n=>n.toSorted((s,a)=>s.name.localeCompare(a.name))),I(n=>ee(n,"category_id")),F(n=>w(void 0,null,function*(){let s=[];for(let R in n){let x=n[R],se=yield o.getOne(R);s.push({category:se?.name,recipes:x})}if(!s.length)return[];let[a,...k]=s.toSorted((R,x)=>R.category>x.category?1:-1);return a?.category?[a].concat(k):k.concat([a])})))}});var ae=(e,o)=>o==null?null:o.category;function me(e,o){e&1&&(p(0,"lg-button",5),S(1,"mat-icon",6),l()),e&2&&(_("success"),c("icon",!0)("link","/recipes/add")("size","medium"))}function de(e,o){if(e&1&&(p(0,"span"),m(1),l()),e&2){let t=o.$implicit;r(),D(t==null?null:t.name)}}function ue(e,o){if(e&1){let t=L();p(0,"lg-gap-row",4)(1,"div",10)(2,"a",11),m(3),l()(),p(4,"lg-button",12),m(5," Calculate "),l(),p(6,"lg-button",13),g("click",function(){T(t);let s=d().$implicit,a=d(2);return b(a.deleteRecipe(s))}),S(7,"mat-icon",14),l()()}if(e&2){let t=d().$implicit;c("center",!0),r(2),c("routerLink","/recipes/edit/"+t.uuid),r(),D(t.name),r(),_("primary"),c("size","small")("link","/recipes/calculate/"+t.uuid)("flat",!0),r(2),_("danger"),c("size","tiny")("icon",!0)}}function fe(e,o){if(e&1&&y(0,ue,8,12,"ng-template",9),e&2){let t=o.$implicit;c("uuid",t.uuid)}}function _e(e,o){if(e&1){let t=L();p(0,"lg-title",7),m(1),l(),p(2,"lg-card-list",8),g("onSelected",function(s){T(t);let a=d();return b(a.selectionZoneService.putSelected(s))}),E(3,fe,1,1,null,9,j),l()}if(e&2){let t=o.$implicit,n=d();c("level",3),r(),N(" ",(t==null?null:t.category)||"Uncategorized"," "),r(),c("mode",n.selectionZoneService.selectionMode())("selectAll",n.selectionZoneService.selectAll())("deselectAll",n.selectionZoneService.deselectAll()),r(),h(t.recipes)}}function ge(e,o){e&1&&(p(0,"lg-gap-row",4)(1,"lg-title",7),m(2," No recipes found "),l()()),e&2&&(c("center",!0),r(),c("level",5))}var le=class e{constructor(o,t,n,s){this._recipesRepository=o;this._notificationsService=t;this._transferDataService=n;this.selectionZoneService=s}recipes=W(u(pe));Stores=V;RecipeDbInputScheme=ce;ngOnInit(){this.loadRecipes()}deleteRecipe(o){this._recipesRepository.deleteRecipe(o.uuid).then(()=>{this.loadRecipes(),this._notificationsService.success("Recipe deleted")})}loadRecipes(){this._recipesRepository.loadRecipes()}exportRecipes(o){this._transferDataService.exportTable("recipesStore","json",{selected:Array.from(o)})}static \u0275fac=function(t){return new(t||e)(f(v),f(ne),f(re),f(C))};static \u0275cmp=Z({type:e,selectors:[["lg-recipes-list"]],features:[O([C])],decls:15,vars:8,consts:[["lgQuickActionsTpl",""],[3,"click","flat","size"],[3,"onDone","schema","storeName"],["lgImportRowTpl",""],[3,"center"],[3,"icon","link","size"],["aria-hidden","false","fontIcon","add"],[3,"level"],[3,"onSelected","mode","selectAll","deselectAll"],["lgCardListItem","",3,"uuid"],[1,"expand"],[3,"routerLink"],[3,"size","link","flat"],[3,"click","size","icon"],["aria-hidden","false","aria-label","Example home icon","fontIcon","close"]],template:function(t,n){t&1&&(p(0,"lg-controls-bar"),y(1,me,2,5,"ng-template",0),S(2,"lg-selection-tools"),p(3,"lg-button",1),g("click",function(){return n.exportRecipes(n.selectionZoneService.selected())}),m(4," Export "),l(),p(5,"lg-import",2),g("onDone",function(){return n.loadRecipes()}),y(6,de,2,1,"ng-template",3),l()(),p(7,"lg-fade-in")(8,"lg-container")(9,"lg-gap-row",4)(10,"lg-title"),m(11," Recipes "),l()(),E(12,_e,5,5,null,null,ae,!1,ge,3,2,"lg-gap-row",4),l()()),t&2&&(r(3),_("info"),c("flat",!0)("size","small"),r(2),c("schema",n.RecipeDbInputScheme)("storeName",n.Stores.RECIPES),r(4),c("center",!0),r(3),h(n.recipes()))},dependencies:[U,q,P,H,B,G,K,J,Y,X,Q,ie,te,oe],styles:["[_nghost-%COMP%]{display:block}"]})};export{le as RecipesListComponent};
