{
  "version": 3,
  "sources": ["src/app/features/recipes/view/calculate/calculation-price-modifiers/calculation-price-modifiers.component.ts"],
  "sourcesContent": ["import {Component, computed, effect, forwardRef, inject, input, output} from '@angular/core';\nimport {RecipePriceModifier} from '../../../service/models/PriceModifier';\nimport {NumberInputComponent} from '../../../../controls/form/number-input.component';\nimport {ParseMathDirective} from '../../../../../shared/view/directives/parse-math.directive';\nimport {ControlValueAccessor, FormControl, FormGroup, NG_VALUE_ACCESSOR, ReactiveFormsModule} from '@angular/forms';\nimport {UnitGroupItem, UnitSwitcherComponent} from '../../../../../shared/view/ui/unit-switcher.component';\nimport {ControlExtraTemplateDirective} from '../../../../controls/form/control-extra-template.directive';\nimport {SETTINGS} from '../../../../settings/service/providers/settings.token';\nimport {toSignal} from '@angular/core/rxjs-interop';\nimport {CurrencySymbolPipe} from '../../../../../shared/view/pipes/currency-symbol.pipe';\nimport {RecipeCost} from '../../../service/models/RecipeCost';\nimport {FlexRowComponent} from '../../../../../shared/view/layout/flex-row.component';\nimport {matchMediaSignal} from '../../../../../shared/view/signals/match-media.signal';\nimport {mobileBreakpoint} from '../../../../../shared/view/const/breakpoints';\nimport {currencyStringToSymbol} from '../../../../../shared/helpers/assets/currency.helper';\nimport {marker} from '@colsen1991/ngx-translate-extract-marker';\nimport {TranslatePipe} from '@ngx-translate/core';\n\n@Component({\n  selector: 'lg-calculation-price-modifiers',\n  imports: [\n    NumberInputComponent,\n    ParseMathDirective,\n    ReactiveFormsModule,\n    UnitSwitcherComponent,\n    ControlExtraTemplateDirective,\n    CurrencySymbolPipe,\n    FlexRowComponent,\n    TranslatePipe\n  ],\n  template: `\n    <lg-flex-row [formGroup]=\"recipePriceAdditionsForm\">\n      <lg-number-input [moveBeforeAbove]=\"isMobile()\"\n                       [placeholder]=\"'price-modifier.placeholder' | translate\"\n                       formControlName=\"value\"\n                       lgParseMath>\n        <ng-template lgExtraTpl place=\"top\">\n          <div>\n            {{ 'recipe.calculation.price-modifiers.title' | translate }}\n          </div>\n        </ng-template>\n\n        <ng-template lgExtraTpl place=\"before\">\n          <lg-unit-switcher [items]=\"additionalPriceType\"\n                            formControlName=\"type\">\n          </lg-unit-switcher>\n          <lg-unit-switcher [items]=\"additionalPriceAction\"\n                            formControlName=\"action\">\n          </lg-unit-switcher>\n        </ng-template>\n\n\n        @if (roundActionSelected()) {\n          <ng-template lgExtraTpl place=\"after\">\n            {{ userSettings()['currency']|currencySymbol }}\n          </ng-template>\n        } @else {\n          <ng-template lgExtraTpl place=\"after\">\n            <lg-unit-switcher formControlName=\"unit\"\n                              [items]=\"additionalPriceUnit\">\n            </lg-unit-switcher>\n          </ng-template>\n        }\n      </lg-number-input>\n    </lg-flex-row>\n  `,\n  styles: [`\n    :host {\n      width: 100%;\n    }\n  `],\n  providers: [\n    {\n      provide: NG_VALUE_ACCESSOR,\n      useExisting: forwardRef(() => CalculationPriceModifiersComponent),\n      multi: true,\n    },\n  ]\n})\nexport class CalculationPriceModifiersComponent\n  implements ControlValueAccessor {\n  constructor() {\n  }\n  recipePriceAdditionsForm = new FormGroup({\n    action: new FormControl<'add' | 'round'>('add'),\n    value: new FormControl<number | string>(0),\n    unit: new FormControl<'currency' | 'percent'>('currency'),\n    type: new FormControl<'per_unit' | 'total'>('per_unit'),\n  });\n  recipeCost = input<RecipeCost | null>();\n  values = toSignal(this.recipePriceAdditionsForm.valueChanges);\n  userSettings = inject(SETTINGS);\n  additionalPriceUnit: UnitGroupItem[] = [\n    {\n      label: currencyStringToSymbol(this.userSettings()['currency'] || 'USD'),\n      value: 'currency',\n      style: 'secondary',\n    },\n    {\n      label: '%',\n      value: 'percent',\n      style: 'secondary',\n    },\n  ];\n  additionalPriceAction: UnitGroupItem[] = [\n    {\n      label: marker('price-modifier.add'),\n      value: 'add',\n      style: 'secondary',\n    },\n    {\n      label: marker('price-modifier.round'),\n      value: 'round',\n      style: 'secondary',\n    },\n  ];\n  additionalPriceType: UnitGroupItem[] = [\n    {\n      label: marker('price-modifier.per-unit'),\n      value: 'per_unit',\n      style: 'secondary',\n    },\n    {\n      label: marker('price-modifier.total'),\n      value: 'total',\n      style: 'secondary',\n    },\n  ];\n  onChanged = output<RecipePriceModifier[]>();\n  isMobile = matchMediaSignal(mobileBreakpoint);\n\n  roundActionSelected = computed(() => {\n    return this.values()?.action === 'round';\n  });\n\n  onChangeFn: (...args: any[]) => void = () => {\n  };\n\n  changesEffect = effect(() => {\n    this.onChangeFn(this.values());\n  })\n\n  registerOnChange(fn: any): void {\n    this.onChangeFn = fn;\n  }\n\n  registerOnTouched(fn: any): void {\n  }\n\n  writeValue(obj: any): void {\n    this.recipePriceAdditionsForm.patchValue({\n      action: obj?.action || 'add',\n      value: obj?.value || 0,\n      unit: obj?.unit || 'currency',\n      type: obj?.type || 'per_unit',\n    });\n  }\n}\n"],
  "mappings": "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",
  "names": []
}
