import{a as ce}from"./chunk-YINQR7QC.js";import{a as pe,b as ae,c as se,d as me,e as o,f as de,g as _e,h as fe}from"./chunk-7XO35TOQ.js";import"./chunk-IFFI3Z3L.js";import{a as oe}from"./chunk-5KNEWP2J.js";import"./chunk-QACA2TAM.js";import{a as M,c as P}from"./chunk-FO7L5RR7.js";import{b as le}from"./chunk-N2V5OZWS.js";import"./chunk-7RBV76PH.js";import{a as N,b as j}from"./chunk-EV7HX2BJ.js";import{a as Z}from"./chunk-L2DDQP4S.js";import{a as ue}from"./chunk-3QHB6VOP.js";import{a as re}from"./chunk-OLZTOY7N.js";import"./chunk-IQBJLTIP.js";import"./chunk-UQQN4YWH.js";import{a as te,b as z}from"./chunk-E6S7RFCJ.js";import{a as ne}from"./chunk-V2W6RJSW.js";import{a as ie}from"./chunk-CHAXYED4.js";import"./chunk-SNDQO5FA.js";import{j as k,n as y,o as ee,q as F}from"./chunk-NA5D2V2E.js";import"./chunk-HM2AWKWB.js";import"./chunk-5KSZNU56.js";import"./chunk-JSIL5PUL.js";import"./chunk-EQUPZ32H.js";import{u as B,v as O}from"./chunk-C4EXXD6S.js";import"./chunk-NQ6BDAWJ.js";import{s as A,w as V}from"./chunk-DQ7XQQU4.js";import"./chunk-652DFWNF.js";import"./chunk-3K6TXI2T.js";import{$ as J,$b as q,Bb as T,Cb as h,Db as a,Eb as c,Fb as H,Jb as x,Mb as S,Nb as s,Va as l,_a as C,_b as m,ac as g,bc as w,db as I,fc as E,ga as u,gc as X,ha as f,hc as Y,ib as v,lc as d,mc as _,na as K,nc as U,pb as Q,qb as p,tb as R,wb as L,yb as b,zb as W}from"./chunk-P6BGRGC2.js";import"./chunk-DELOOZDJ.js";import"./chunk-2WH2EVR6.js";var ge=o.object({name:o.string(),amount:o.number().or(o.string()),uuid:o.string().optional(),product_id:_e,recipe_id:o.lazy(()=>G),unit:o.enum(["gram","portion","piece"])});var G=o.object({name:o.string(),uuid:o.string().optional(),description:o.string(),ingredients:o.array(o.lazy(()=>ge)),outcome_unit:de,outcome_amount:o.number().or(o.string()),taxTemplateName:o.string().optional(),category_id:o.string().nullable().optional(),createdAt:o.union([o.string(),o.number()]).optional(),updatedAt:o.union([o.string(),o.number()]).optional(),tags:o.array(o.string()).optional(),color:o.string().optional()});var ve=t=>({length:t}),Re=(t,i)=>i.uuid;function ye(t,i){if(t&1){let e=x();a(0,"lg-button",4),S("click",function(){u(e);let n=s(2);return f(n.selectionZoneService.onSelection())}),m(1),d(2,"translate"),c()}t&2&&(R("success"),p("flat",!0)("size","small"),l(),g(" ",_(2,5,"select-many-label")," "))}function De(t,i){if(t&1){let e=x();a(0,"lg-button",4),S("click",function(){u(e);let n=s(2);return f(n.deleteAllDrafts())}),m(1," Delete all "),c()}t&2&&(R("danger"),p("flat",!0)("size","small"))}function Te(t,i){if(t&1){let e=x();a(0,"lg-button",5),S("click",function(){u(e);let n=s(3);return f(n.deletedSelectedDrafts())}),m(1," Delete selected "),c()}if(t&2){let e=s();R("danger"),p("flat",!0)("disabled",!(e.draft!=null&&e.draft.size))("size","small")}}function he(t,i){t&1&&v(0,Te,2,5,"ng-template",1)}function Ie(t,i){t&1&&(m(0),d(1,"translate")),t&2&&g(" ",_(1,1,"draft.list-prefix.existing")," ")}function Le(t,i){t&1&&(m(0),d(1,"translate")),t&2&&g(" ",_(1,1,"draft.list-prefix.new")," ")}function be(t,i){if(t&1&&(a(0,"lg-gap-row",6)(1,"a",7),L(2,Ie,2,3)(3,Le,2,3),m(4),c(),a(5,"small",8),m(6),d(7,"translate"),d(8,"timeAgo"),c()()),t&2){let e=s().$implicit;p("center",!0),l(),p("routerLink","/recipes/draft/"+(e==null?null:e.uuid)),l(),b(!(e==null||e.meta==null)&&e.meta.uuid?2:3),l(2),g(" ",(e==null||e.data==null?null:e.data.name)??""," "),l(2),w(" ",_(7,6,"edited-at-label")," ",_(8,8,(e==null?null:e.updatedAt)||(e==null?null:e.createdAt))," ")}}function we(t,i){if(t&1&&v(0,be,9,10,"ng-template",3),t&2){let e=i.$implicit;p("uuid",e.uuid)}}function Ee(t,i){if(t&1){let e=x();a(0,"lg-expander",0),d(1,"translate"),d(2,"translate"),a(3,"lg-inline-separated-group"),v(4,ye,3,7,"ng-template",1)(5,De,2,4,"ng-template",1),L(6,he,1,0,null,1),c(),a(7,"lg-card-list",2),S("onDeleteOne",function(n){u(e);let D=s();return f(D.deleteDraft(n==null?null:n.uuid))})("onSelected",function(n){u(e);let D=s();return f(D.selectionZoneService.putSelected(n))}),T(8,we,1,1,null,3,Re),c()()}if(t&2){let e,r,n=s();p("closeLabel",_(1,6,"drafts-close-label"))("openLabel",U(2,8,"drafts-label",Y(11,ve,(e=n.drafts())==null?null:e.length))),l(6),b((r=n.selectionZoneService.selected())?6:-1,r),l(),p("mode",n.selectionZoneService.selectionMode())("selectAll",n.selectionZoneService.selectAll().draft)("deselectAll",n.selectionZoneService.deselectAll().draft),l(),h(n.drafts())}}var $=class t{constructor(i,e,r){this._recipesRepository=i;this._notificationsService=e;this.selectionZoneService=r}drafts=K([]);Stores=V;get hidden(){return this.drafts()?.length===0?!0:null}ngOnInit(){let i=this._recipesRepository.getDraftRecipe();i&&this.drafts.set(i)}deleteAllDrafts(){this._recipesRepository.removeDraftMany(this.drafts().map(i=>i.uuid)).then(()=>{this.drafts.set([]),this._notificationsService.success("Drafts deleted")})}deletedSelectedDrafts(){let i=this.selectionZoneService.selected().draft;i&&this._recipesRepository.removeDraftMany(Array.from(i)).then(()=>{this.drafts.update(e=>e.filter(r=>!i.has(r.uuid))),this._notificationsService.success("Drafts deleted")})}deleteDraft(i){i&&(this._recipesRepository.removeDraftRecipe(i),this.drafts.update(e=>e.filter(r=>r?.uuid!==i)))}static \u0275fac=function(e){return new(e||t)(C(F),C(B),C(y))};static \u0275cmp=I({type:t,selectors:[["lg-draft-recipes-list"]],hostVars:1,hostBindings:function(e,r){e&2&&Q("hidden",r.hidden)},features:[E([y])],decls:1,vars:1,consts:[[3,"closeLabel","openLabel"],["lgInlineSeparatedGroup",""],[2,"--card-bg","#bee5ff",3,"onDeleteOne","onSelected","mode","selectAll","deselectAll"],["lgCardListItem","","type","draft",3,"uuid"],[3,"click","flat","size"],[3,"click","flat","disabled","size"],[3,"center"],["lgExpand","",3,"routerLink"],[1,"text-muted","text-cursive"]],template:function(e,r){if(e&1&&L(0,Ee,10,13,"lg-expander",0),e&2){let n;b((n=r.drafts())!=null&&n.length?0:-1)}},dependencies:[z,O,P,M,A,Z,ue,k,fe,j,N],encapsulation:2})};var Ae=()=>["recipe"],Ve=(t,i)=>i==null?null:i.category;function ke(t,i){if(t&1){let e=x();a(0,"lg-button",5),S("click",function(){u(e);let n=s();return f(n.exportRecipes(n.selectionZoneService.selected().recipe))}),m(1),d(2,"translate"),c()}t&2&&(R("info"),p("flat",!0)("size","small"),l(),g(" ",_(2,5,"export-label")," recipes "))}function Be(t,i){if(t&1&&(a(0,"span"),m(1),c()),t&2){let e=i.$implicit;l(),q(e==null?null:e.name)}}function Fe(t,i){if(t&1){let e=x();a(0,"lg-import",6),d(1,"translate"),S("onDone",function(){u(e);let n=s();return f(n.loadRecipes())}),v(2,Be,2,1,"ng-template",7),c()}if(t&2){let e=s();p("label",_(1,3,"import-label")+" products")("schema",e.RecipeScheme)("storeName",e.Stores.RECIPES)}}function Ze(t,i){if(t&1&&(a(0,"lg-gap-row",3)(1,"a",11),m(2),c(),a(3,"lg-button",12),m(4),d(5,"translate"),c(),a(6,"small",13),m(7),d(8,"translate"),d(9,"timeAgo"),c()()),t&2){let e=s().$implicit;p("center",!0),l(),p("routerLink","/recipes/edit/"+e.uuid),l(),q(e.name),l(),R("primary"),p("size","small")("link","/recipes/calculate/"+e.uuid)("flat",!0),l(),g(" ",_(5,11,"recipes.calculate-btn")," "),l(3),w(" ",_(8,13,"edited-at-label")," ",_(9,15,(e==null?null:e.updatedAt)||(e==null?null:e.createdAt))," ")}}function ze(t,i){if(t&1&&v(0,Ze,10,17,"ng-template",10),t&2){let e=i.$implicit;p("uuid",e.uuid)}}function Oe(t,i){if(t&1){let e=x();a(0,"lg-title",8),m(1),d(2,"translate"),c(),a(3,"lg-card-list",9),S("onSelected",function(n){u(e);let D=s();return f(D.selectionZoneService.putSelected(n))})("onDeleteOne",function(n){u(e);let D=s();return f(D.deleteRecipe(n))}),T(4,ze,1,1,null,10,W),c()}if(t&2){let e=i.$implicit,r=s();p("level",3),l(),g(" ",(e==null?null:e.category)||_(2,5,"without-category-label")," "),l(2),p("mode",r.selectionZoneService.selectionMode())("selectAll",r.selectionZoneService.selectAll().recipe)("deselectAll",r.selectionZoneService.deselectAll().recipe),l(),h(e.recipes)}}function Me(t,i){t&1&&(a(0,"lg-gap-row",3)(1,"lg-title",8),m(2),d(3,"translate"),c()()),t&2&&(p("center",!0),l(),p("level",5),l(),g(" ",_(3,3,"no-recipes")," "))}var Ce=class t{constructor(i,e,r,n){this._recipesRepository=i;this._notificationsService=e;this._transferDataService=r;this.selectionZoneService=n}recipes=le(J(ce));Stores=V;RecipeScheme=G;ngOnInit(){this.loadRecipes()}deleteRecipe(i){i?.uuid&&this._recipesRepository.deleteOne(i.uuid).then(()=>{this._notificationsService.success("Recipe deleted"),this.loadRecipes()})}loadRecipes(){this._recipesRepository.loadRecipes()}exportRecipes(i){this._transferDataService.exportTable("recipesStore","json",{selected:Array.from(i||[])})}static \u0275fac=function(e){return new(e||t)(C(F),C(B),C(ee),C(y))};static \u0275cmp=I({type:t,selectors:[["lg-recipes-list"]],features:[E([y])],decls:17,vars:12,consts:[[3,"icon","link","size"],["aria-hidden","false","fontIcon","add"],["lgInlineSeparatedGroup",""],[3,"center"],[3,"selectionTypes"],[3,"click","flat","size"],[3,"onDone","label","schema","storeName"],["lgImportRowTpl",""],[3,"level"],[3,"onSelected","onDeleteOne","mode","selectAll","deselectAll"],["lgCardListItem","","type","recipe",3,"uuid"],[3,"routerLink"],[3,"size","link","flat"],["lgPull","",1,"text-muted","text-cursive"]],template:function(e,r){e&1&&(a(0,"lg-controls-bar")(1,"lg-button",0),H(2,"mat-icon",1),c(),a(3,"lg-inline-separated-group"),v(4,ke,3,7,"ng-template",2)(5,Fe,3,5,"ng-template",2),c()(),a(6,"lg-fade-in")(7,"lg-container")(8,"lg-gap-row",3)(9,"lg-title"),m(10),d(11,"translate"),c()(),H(12,"lg-draft-recipes-list")(13,"lg-selection-tools",4),T(14,Oe,6,7,null,null,Ve,!1,Me,4,5,"lg-gap-row",3),c()()),e&2&&(l(),R("success"),p("icon",!0)("link","/recipes/add")("size","medium"),l(7),p("center",!0),l(2),g(" ",_(11,9,"recipes.list-title")," "),l(3),p("selectionTypes",X(11,Ae)),l(),h(r.recipes()))},dependencies:[z,O,A,re,te,ie,P,M,ae,pe,ne,se,me,Z,oe,k,$,j,N],styles:["[_nghost-%COMP%]{display:block}"]})};export{Ce as RecipesListComponent};
