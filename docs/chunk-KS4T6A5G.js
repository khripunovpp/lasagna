import{a as I}from"./chunk-MILTATWE.js";import{a as P}from"./chunk-DJF77PYH.js";import{a as Q,c as W,d as X,e as Y,f as te}from"./chunk-BXFYC4PP.js";import{a as H,c as J}from"./chunk-6JHNEPZF.js";import{a as q}from"./chunk-DA2HX24K.js";import{b as K}from"./chunk-EURMNGHK.js";import{a as ee}from"./chunk-MNN7Q45Z.js";import"./chunk-FXU5CNHZ.js";import{a as i}from"./chunk-C2HXCXZW.js";import"./chunk-QE7K5G3A.js";import"./chunk-ZUL4ERHZ.js";import{a as Z,d as U}from"./chunk-O7XKGAI7.js";import"./chunk-BBFZC3NA.js";import{a as G}from"./chunk-YBQWK7UJ.js";import{a as $,c as B}from"./chunk-SPWCQEFX.js";import{Ba as g,Ga as F,I as M,Ia as w,Ja as h,Ka as c,La as l,Ma as N,P as V,Qa as v,R as u,Ra as R,Sa as d,V as _,W as f,bb as x,bc as O,cb as m,db as L,eb as j,f as D,ka as r,n as k,na as S,pa as A,r as T,s as z,ta as b,ya as p}from"./chunk-2LMMMB25.js";var ie=i.object({uuid:i.string().optional(),name:i.string().min(1).optional(),description:i.string().optional(),ingredients:i.array(i.object({name:i.string().min(1).optional(),uuid:i.string().optional(),amount:i.union([i.string(),i.number()]).optional(),product_id:i.string().optional(),recipe_id:i.string().optional(),unit:i.string().optional()})),outcome_amount:i.union([i.string(),i.number()]).optional(),outcome_unit:i.string().optional(),taxTemplateName:i.string().optional(),category_id:i.string().optional()});var oe=new V("CategorizedRecipesList",{factory:()=>{let t=u(I),o=u(P);return k(t.loadRecipes()).pipe(M(()=>t.recipes$)).pipe(T(n=>n.toSorted((s,a)=>s.name.localeCompare(a.name))),T(n=>X(n,"category_id")),z(n=>D(void 0,null,function*(){let s=[];for(let C in n){let E=n[C],re=yield o.getOne(C);s.push({category:re?.name,recipes:E})}if(!s.length)return[];let[a,...y]=s.toSorted((C,E)=>C.category>E.category?1:-1);return a?.category?[a].concat(y):y.concat([a])})))}});var pe=(t,o)=>o==null?null:o.category;function ce(t,o){if(t&1&&(c(0,"span"),m(1),l()),t&2){let e=o.$implicit;r(),L(e==null?null:e.name)}}function le(t,o){if(t&1){let e=v();c(0,"lg-gap-row",1)(1,"div",9)(2,"a",10),m(3),l()(),c(4,"lg-button",11),m(5," Calculate "),l(),c(6,"lg-button",12),R("click",function(){_(e);let s=d().$implicit,a=d(2);return f(a.deleteRecipe(s))}),N(7,"mat-icon",13),l()()}if(t&2){let e=d().$implicit;p("center",!0),r(2),p("routerLink","/recipes/edit/"+e.uuid),r(),L(e.name),r(),g("primary"),p("size","small")("link","/recipes/calculate/"+e.uuid)("flat",!0),r(2),g("danger"),p("size","small")("icon",!0)}}function se(t,o){if(t&1&&b(0,le,8,12,"ng-template",8),t&2){let e=o.$implicit;p("uuid",e.uuid)}}function ae(t,o){if(t&1){let e=v();c(0,"lg-title",6),m(1),l(),c(2,"lg-card-list",7),R("onSelected",function(s){_(e),d();let a=x(11);return f(a.putSelected(s))}),w(3,se,1,1,null,8,F),l()}if(t&2){let e=o.$implicit;d();let n=x(11);p("level",3),r(),j(" ",(e==null?null:e.category)||"Uncategorized"," "),r(),p("mode",n.selectionMode())("selectAll",n.selectAll())("deselectAll",n.deselectAll()),r(),h(e.recipes)}}function me(t,o){t&1&&(c(0,"lg-gap-row",1)(1,"lg-title",6),m(2," No recipes found "),l()()),t&2&&(p("center",!0),r(),p("level",5))}var ne=class t{constructor(o,e,n){this._recipesRepository=o;this._notificationsService=e;this._transferDataService=n}recipes=K(u(oe));Stores=Z;RecipeDbInputScheme=ie;ngOnInit(){this.loadRecipes()}deleteRecipe(o){this._recipesRepository.deleteRecipe(o.uuid).then(()=>{this.loadRecipes(),this._notificationsService.success("Recipe deleted")})}loadRecipes(){this._recipesRepository.loadRecipes()}exportRecipes(o){this._transferDataService.exportTable("recipesStore","json",{selected:Array.from(o)})}static \u0275fac=function(e){return new(e||t)(S(I),S(ee),S(te))};static \u0275cmp=A({type:t,selectors:[["lg-recipes-list"]],decls:15,vars:13,consts:[["selectionZone",""],[3,"center"],[3,"flat","link","size"],[3,"click","flat","size"],[3,"onDone","schema","storeName"],["lgImportRowTpl",""],[3,"level"],[3,"onSelected","mode","selectAll","deselectAll"],["lgCardListItem","",3,"uuid"],[1,"expand"],[3,"routerLink"],[3,"size","link","flat"],[3,"click","size","icon"],["aria-hidden","false","aria-label","Example home icon","fontIcon","close"]],template:function(e,n){if(e&1){let s=v();c(0,"lg-container")(1,"lg-gap-row",1)(2,"lg-title"),m(3," Recipes "),l(),c(4,"lg-button",2),m(5," Add "),l(),c(6,"lg-button",3),R("click",function(){_(s);let y=x(11);return f(n.exportRecipes(y.selected()))}),m(7," Export "),l(),c(8,"lg-import",4),R("onDone",function(){return _(s),f(n.loadRecipes())}),b(9,ce,2,1,"ng-template",5),l()(),c(10,"lg-selection-zone",null,0),w(12,ae,5,5,null,null,pe,!1,me,3,2,"lg-gap-row",1),l()()}e&2&&(r(),p("center",!0),r(3),g("primary"),p("flat",!0)("link","/recipes/add")("size","small"),r(2),g("info"),p("flat",!0)("size","small"),r(2),p("schema",n.RecipeDbInputScheme)("storeName",n.Stores.RECIPES),r(4),h(n.recipes()))},dependencies:[G,U,O,q,$,B,J,H,W,Q,Y],styles:["[_nghost-%COMP%]{display:block}"]})};export{ne as RecipesListComponent};
