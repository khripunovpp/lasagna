import{a as h}from"./chunk-VIPBUB74.js";import{B as l,z as d}from"./chunk-4M4BEHIK.js";import{b as n}from"./chunk-V52IA26S.js";import{_ as o,ca as r,da as c,ua as u}from"./chunk-NHWKWTII.js";var a=class i{constructor(t){t&&Array.isArray(t)}settings=new Map;static empty(){return new i}static fromRaw(t){if(t instanceof i)return t;let e=new i;return Array.isArray(t)?t.forEach(s=>{e.addSetting(s.key,s.data)}):Object.entries(t).forEach(([s,v])=>{e.addSetting(s,v)}),e}addSetting(t,e){this.settings.set(t,{key:t,data:e})}getSetting(t){return this.settings.get(t)}getAllSettings(){return Array.from(this.settings.values())}getSettingsMap(){return this.getAllSettings().reduce((t,e)=>(t[e.key]=e.data,t),{})}removeSetting(t){this.settings.delete(t)}toDTO(){return{settings:Array.from(this.settings.values())}}};var g=class i{constructor(t){this._indexDbService=t}async updateSettings(t){return await this._indexDbService.clear("settings"),this._indexDbService.balkAdd("settings",t.toDTO().settings)}getOne(t){return this._indexDbService.search("settings","key",t).then(e=>e?e[0]:null)}getAll(){return this._indexDbService.getAll("settings").then(t=>a.fromRaw(t))}static \u0275fac=function(e){return new(e||i)(r(l))};static \u0275prov=o({token:i,factory:i.\u0275fac,providedIn:"root"})};var m=class i{constructor(t,e){this._settingsRepository=t;this._localisationService=e}settingsModel;settingsSignal=u(void 0);_logger=c(d).withContext({label:"SettingsService",color:"#4CAF50"});get lang(){return this._localisationService.lang}get languages(){return this._localisationService.languages}loadSettings(){return this._settingsRepository.getAll().then(t=>(this.settingsModel=t,this.settingsSignal.set(t),this._logger.log("Settings loaded",t),t))}saveSettings(){return this.settingsModel?(this.settingsSignal.set(this.settingsModel),this._settingsRepository.updateSettings(this.settingsModel).then(()=>{this._logger.log("Settings saved",this.settingsModel)})):Promise.resolve()}changeLang(t){this._localisationService.changeLang(t),this.settingsModel?.addSetting("lang",t),this.saveSettings()}changeCurrency(t){this.settingsModel?.addSetting("currency",t),this.saveSettings()}getInvoicePrefix(){return this.settingsModel?.getSetting("invoicePrefix")?.data}setInvoicePrefix(t){this.settingsModel?.addSetting("invoicePrefix",t)}getInvoiceLogo(){return this.settingsModel?.getSetting("invoiceLogo")?.data}setInvoiceLogo(t){this.settingsModel?.addSetting("invoiceLogo",t)}setInvoicePrecisions(t,e){this.settingsModel?.addSetting("invoicePrecisionRows",t),this.settingsModel?.addSetting("invoicePrecisionTotals",e)}getInvoicePrecision(){let t=this.settingsModel?.getSetting("invoicePrecisionRows")?.data,e=this.settingsModel?.getSetting("invoicePrecisionTotals")?.data;return[t??2,e??2]}static \u0275fac=function(e){return new(e||i)(r(g),r(h))};static \u0275prov=o({token:i,factory:i.\u0275fac,providedIn:"root"})};var p=(e=>(e.customer="customer",e.system="system",e))(p||{});var S=class i{constructor(t){this.update(t||{})}type="customer";name="";privateName="";country="";address="";taxId;phone="";email="";uuid;static fromRaw(t){return new i({type:t?.type||"customer",name:t?.name||"",privateName:t?.privateName||"",country:t?.country||"",address:t?.address||"",taxId:t?.taxId||"",phone:t?.phone||"",email:t?.email||"",uuid:t?.uuid||""})}static empty(){return new i}update(t){return this.uuid=n(t.uuid||this.uuid),this.name=n(t.name||this.name),this.privateName=n(t.privateName||this.privateName),this.country=n(t.country||this.country),this.address=n(t.address||this.address),this.taxId=n(t.taxId||this.taxId),this.phone=n(t.phone||this.phone),this.email=n(t.email||this.email),this.type=t.type||this.type||"customer",this}toDTO(){return{name:this.name||"",privateName:this.privateName||"",country:this.country||"",address:this.address||"",taxId:this.taxId||"",phone:this.phone||"",email:this.email||"",uuid:this.uuid||"",type:this.type}}toFormattedString(){return`${this.name}
${this.address}
${this.country}
${this.phone}
${this.email}
${this.taxId?`Tax ID: ${this.taxId}`:""}

    `}};export{p as a,S as b,m as c};
