import{g as S}from"./chunk-Y27TEGB2.js";import"./chunk-GALYHWJT.js";import"./chunk-T4SSLVVO.js";import"./chunk-RBCT5HP6.js";import{a as le,b as pe}from"./chunk-67DE2WG6.js";import{a as se,b as ae}from"./chunk-KCJ3VAV5.js";import"./chunk-36JX2E4A.js";import"./chunk-FK6H3RFT.js";import"./chunk-E6W2XPUP.js";import{a as me}from"./chunk-GFKJ3IXC.js";import{v as ce}from"./chunk-ZSQGJQ3D.js";import{a as ie}from"./chunk-VQHUADFJ.js";import{a as Y}from"./chunk-IVWGGHZS.js";import{a as ne}from"./chunk-OSRCQ3N6.js";import{b as oe}from"./chunk-VIPBUB74.js";import{c as X}from"./chunk-BJIJ7REJ.js";import"./chunk-4U4Z3QUR.js";import{a as te}from"./chunk-I27O3RKJ.js";import"./chunk-MPFUNZLY.js";import{a as ee}from"./chunk-Q75E6UIP.js";import{$ as C,Y as W,da as re,h as Q,p as U}from"./chunk-JU2NXFC6.js";import{p as q,q as H,u as J}from"./chunk-WNITENYQ.js";import"./chunk-CABIONZL.js";import"./chunk-EMIJRNYJ.js";import{l as G,m as $,n as K}from"./chunk-HDEG74LV.js";import{Ab as B,Bc as a,Cc as f,Dc as y,Fb as Z,Hb as L,Ib as w,Jb as r,Kb as p,Lb as c,Mb as g,Qb as M,U as O,Ub as h,Vb as d,_a as i,ba as R,da as I,db as u,gc as P,ic as s,ka as E,kb as k,kc as v,l as A,la as b,lc as j,mc as N,pb as F,r as T,t as D,vc as V,wc as z}from"./chunk-NHWKWTII.js";import"./chunk-2RGDSI3Q.js";import"./chunk-C6Q5SG76.js";var de=new R("CategorizedInvoicesList",{factory:()=>{let t=I(S);return A(t.loadToObservable()).pipe(O(()=>t.items$)).pipe(T(e=>e.toSorted((o,l)=>o.prefix.localeCompare(l.prefix))),T(e=>Q(e,"prefix")),D(async e=>{let o=[];for(let _ in e)o.push({group_key:_,items:e[_]?.toSorted((x,ve)=>x.createdAt>ve.createdAt?-1:1)||[]});if(!o.length)return[];let[l,...m]=o.toSorted((_,x)=>_.group_key>x.group_key?1:-1);return l?.group_key?[l].concat(m):m.concat([l])}))}});var fe=()=>["product"],_e=(t,n)=>(n.uuid??"")+t;function Ie(t,n){if(t&1&&(p(0,"lg-gap-column",7)(1,"lg-gap-row",3)(2,"lg-gap-row",8)(3,"a",9),s(4),c(),g(5,"div"),c(),p(6,"small",10),a(7,"date"),s(8),a(9,"translate"),a(10,"timeAgo"),c()(),p(11,"lg-gap-row",3)(12,"div"),s(13),a(14,"date"),c(),p(15,"div"),s(16),a(17,"number"),c()()()),t&2){let e=d().$implicit,o=d(2);r("size","medium"),i(),r("center",!0),i(),r("center",!0),i(),r("routerLink","/invoices/edit/"+e.uuid),i(),N(" #",e.prefix,"/",e.invoice_number," - ",e.name," "),i(2),B("title",y(7,13,(e==null?null:e.updatedAt)||(e==null?null:e.createdAt),"short")),i(2),j(" ",f(9,16,"edited-at-label")," ",f(10,18,(e==null?null:e.updatedAt)||(e==null?null:e.createdAt))," "),i(3),r("center",!0),i(2),v(" Date due: ",y(14,20,e.date_due,"shortDate")," "),i(3),v(" Days left: ",y(17,23,(e.date_due-o.nowDate)/(1e3*60*60*24),"1.0-0")," ")}}function ge(t,n){if(t&1&&F(0,Ie,18,26,"ng-template",6),t&2){let e=n.$implicit;r("uuid",e.uuid)}}function ye(t,n){if(t&1){let e=M();p(0,"lg-title",4),s(1),a(2,"translate"),c(),p(3,"lg-card-list",5),h("onSelected",function(l){E(e);let m=d();return b(m.selectionZoneService.putSelected(l))})("onDeleteOne",function(l){E(e);let m=d();return b(m.deleteOne(l))}),L(4,ge,1,1,null,6,_e),c()}if(t&2){let e=n.$implicit,o=d();r("level",3),i(),v(" ",(e==null?null:e.group_key)||f(2,5,"without-category-label")," "),i(2),r("mode",o.selectionZoneService.selectionMode())("selectAll",o.selectionZoneService.selectAll())("deselectAll",o.selectionZoneService.deselectAll()),i(),w(e.items)}}function Ce(t,n){t&1&&(p(0,"lg-gap-row",3)(1,"lg-title",4),s(2),a(3,"translate"),c()()),t&2&&(r("center",!0),i(),r("level",5),i(),v(" ",f(3,3,"no-products")," "))}var ue=class t{constructor(n,e,o,l){this._notificationsService=n;this.selectionZoneService=e;this._invoicesRepository=o;this._router=l}nowDate=Date.now();invoices=U(I(de));Stores=J;deleteOne(n){n?.uuid&&this._invoicesRepository.deleteOne(n.uuid).then(()=>{this._notificationsService.success("invoice.deleted"),this.loadItems()})}ngOnInit(){this.loadItems()}loadItems(){this._invoicesRepository.loadToObservable()}onAddInvoice(){this._invoicesRepository.createEmpty().then(n=>{this._router.navigate(["/invoices/edit",n])})}static \u0275fac=function(e){return new(e||t)(u(W),u(C),u(S),u(q))};static \u0275cmp=k({type:t,selectors:[["lg-invoices-list"]],features:[V([C,K])],decls:11,vars:7,consts:[[3,"click","icon","size"],["aria-hidden","false","fontIcon","add"],[3,"selectionTypes"],[3,"center"],[3,"level"],[3,"onSelected","onDeleteOne","mode","selectAll","deselectAll"],["lgCardListItem","","type","product",3,"uuid"],[3,"size"],["lgExpand","",3,"center"],[3,"routerLink"],[1,"text-muted","text-cursive"]],template:function(e,o){e&1&&(p(0,"lg-controls-bar")(1,"lg-button",0),h("click",function(){return o.onAddInvoice()}),g(2,"mat-icon",1),c()(),p(3,"lg-fade-in")(4,"lg-container")(5,"lg-title"),s(6," Invoices "),c(),g(7,"lg-selection-tools",2),L(8,ye,6,7,null,null,Z,!1,Ce,4,5,"lg-gap-row",3),c()()),e&2&&(i(),P("success"),r("icon",!0)("size","medium"),i(6),r("selectionTypes",z(6,fe)),i(),w(o.invoices()))},dependencies:[ne,re,ce,Y,ee,ae,se,H,te,le,pe,oe,me,X,ie,G,$],styles:["[_nghost-%COMP%]{display:block}"]})};export{ue as InvoicesListComponent};
