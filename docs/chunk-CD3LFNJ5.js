import{a as be}from"./chunk-LDIR7RVT.js";import{a as L,c as ye}from"./chunk-ARIXYXPF.js";import{a as he}from"./chunk-QJR4QN2B.js";import{a as Ce}from"./chunk-FETSE7FJ.js";import{a as _e,b as ve}from"./chunk-6AFDTC2Q.js";import{c as te}from"./chunk-SAILQXXD.js";import{a as T}from"./chunk-IBNW2SRC.js";import{a as me,b as ge}from"./chunk-JAG6QPDF.js";import"./chunk-2CXQCMUY.js";import{a as re,c as M,e as le,f as se,g as ae,h as P,j as ce,k as pe,n as de,q as ue}from"./chunk-AJ3UBX7E.js";import{a as fe}from"./chunk-MCS5HOGQ.js";import{c as k}from"./chunk-234JSS2H.js";import{a as F}from"./chunk-3AY3FMR5.js";import{a as ne,b as ie}from"./chunk-VLWAUHYT.js";import{$a as d,$b as oe,Ca as h,Da as v,Fa as K,Ga as Y,Ha as J,Ia as l,Ib as X,Ja as i,Ka as m,L as H,Oa as y,Pa as c,Qa as g,Ra as U,Sa as B,U as f,V as C,Vb as Z,Xb as ee,Z as _,_a as S,bb as E,gb as V,ha as j,ia as r,la as w,na as u,tb as Q,va as z,wa as a,wb as A,xa as $,xb as b,ya as x,za as q}from"./chunk-7BPNVVWP.js";var we=["*",[["content"]]],xe=["*","content"];function Me(n,e){n&1&&(l(0,"div",3),B(1,1),i())}var I=class n{constructor(){}gap=b(16);displayed=_(!1);full=b(!1);position=b("top");onClose=A();toggle(){this.displayed.set(!this.displayed()),this.displayed()||this.onClose.emit()}close(){this.displayed.set(!1),this.onClose.emit()}onClick(e){e.target instanceof HTMLElement&&(e.target.closest(".tooltip")||(this.displayed.set(!1),this.onClose.emit()))}onKeydown(e){e.key==="Escape"&&(this.displayed.set(!1),this.onClose.emit())}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=u({type:n,selectors:[["lg-tooltip"]],hostBindings:function(t,o){t&1&&c("click",function(p){return o.onClick(p)},j)("keydown",function(p){return o.onKeydown(p)},j)},inputs:{gap:[1,"gap"],full:[1,"full"],position:[1,"position"]},outputs:{onClose:"onClose"},ngContentSelectors:xe,decls:5,vars:6,consts:[[1,"tooltip",3,"ngClass"],[1,"tooltip__anchor"],[3,"click"],[1,"tooltip__content"]],template:function(t,o){t&1&&(U(we),l(0,"div",0)(1,"div",1)(2,"div",2),c("click",function(){return o.toggle()}),B(3),i(),h(4,Me,2,0,"div",3),i()()),t&2&&($("--gap",o.gap(),"px"),x("fullscreen",o.full()),a("ngClass",o.position()),r(4),v(o.displayed()?4:-1))},dependencies:[X],styles:[".tooltip[_ngcontent-%COMP%]{position:relative;display:inline-block}.tooltip__anchor[_ngcontent-%COMP%]{position:relative}.tooltip__content[_ngcontent-%COMP%]{position:absolute;background-color:#fff;border-radius:16px;padding:16px;box-shadow:0 4px 8px #0000001a;z-index:100}.tooltip.top[_ngcontent-%COMP%]   .tooltip__content[_ngcontent-%COMP%], .tooltip.bottom[_ngcontent-%COMP%]   .tooltip__content[_ngcontent-%COMP%]{bottom:calc(100% + var(--gap));right:50%;transform:translate(50%)}.tooltip.left[_ngcontent-%COMP%]   .tooltip__content[_ngcontent-%COMP%]{bottom:50%;right:calc(100% + var(--gap));transform:translateY(50%)}.tooltip.right[_ngcontent-%COMP%]   .tooltip__content[_ngcontent-%COMP%]{bottom:50%;left:calc(100% + var(--gap));transform:translateY(-50%)}.tooltip.fullscreen[_ngcontent-%COMP%]   .tooltip__content[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#fff;border-radius:0;padding:32px;transform:none;overflow-y:auto}"]})};function Se(n,e){if(n&1){let t=y();l(0,"div",3)(1,"lg-eggs-widget",4),c("changed",function(s){f(t);let p=g();return C(p.onEggsChanged(s))}),i()()}}var N=class n{constructor(){}eggsChanged=A();selectedWidget=_(null);onWidgetSelect(e){this.selectedWidget.set(e)}onEggsChanged(e){e&&this.eggsChanged.emit(e)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=u({type:n,selectors:[["lg-amount-widgets"]],outputs:{eggsChanged:"eggsChanged"},decls:5,vars:3,consts:[[1,"amount-widgets"],[1,"amount-widgets__buttons"],[1,"amount-widgets__button",3,"click"],[1,"amount-widgets__wrapper"],[3,"changed"]],template:function(t,o){t&1&&(l(0,"div",0)(1,"div",1)(2,"button",2),c("click",function(){return o.onWidgetSelect("eggs")}),d(3,"Eggs "),i()(),h(4,Se,2,0,"div",3),i()),t&2&&(x("selected",o.selectedWidget()!=null),r(4),v(o.selectedWidget()==="eggs"?4:-1))},dependencies:[be],styles:[".amount-widgets[_ngcontent-%COMP%]{display:flex;gap:16px;flex-direction:column}.amount-widgets__input[_ngcontent-%COMP%]{flex:1}.amount-widgets__buttons[_ngcontent-%COMP%]{display:flex;gap:16px;flex-wrap:wrap;padding:16px;background-color:#fafafa;border-radius:12px;margin:-16px}.amount-widgets.selected[_ngcontent-%COMP%]   .amount-widgets__buttons[_ngcontent-%COMP%]{margin-bottom:0}.amount-widgets__button[_ngcontent-%COMP%]{display:flex;padding:8px 16px;border-radius:16px;background-color:#e5de38;appearance:none;border:none;font-family:inherit;font-size:inherit}"]})};function Ee(n,e){if(n&1){let t=y();l(0,"span",2),c("click",function(){let s=f(t).$implicit,p=g();return C(p.onSelect(s))}),d(1),i()}if(n&2){let t=e.$implicit,o=e.$index,s=e.$count,p=g();x("selected",t.value===p.value),z("data-last",o===s-1?!0:null),r(),E(" ",t.label," ")}}var D=class n{constructor(){}control=b();items=[];onChangeFn;value;selectedItem;onSelect=e=>{this.applyValue(e.value)};registerOnChange(e){this.onChangeFn=e}registerOnTouched(e){}writeValue(e){this.applyValue(e)}applyValue(e){this.value=e,this.onChangeFn?.(e),this.control()?.writeValue(e)}ngOnInit(){}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=u({type:n,selectors:[["lg-chips-list"]],inputs:{control:[1,"control"],items:"items"},features:[V([{provide:re,useExisting:H(()=>n),multi:!0}])],decls:3,vars:0,consts:[[1,"chips-list"],[1,"chip",3,"selected"],[1,"chip",3,"click"]],template:function(t,o){t&1&&(l(0,"div",0),Y(1,Ee,2,4,"span",1,K),i()),t&2&&(r(),J(o.items))},styles:[".chips-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.chip[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;padding:4px 8px;border-radius:16px;font-size:.875rem;display:inline-block;cursor:pointer}.chip.selected[_ngcontent-%COMP%]{background-color:#0d59ab}"]})};function Ae(n,e){if(n&1&&m(0,"lg-chips-list",17),n&2){let t=g(),o=S(19);a("control",o)("items",t.topSources())}}function ke(n,e){if(n&1&&m(0,"lg-chips-list",17),n&2){let t=g(),o=S(24);a("control",o)("items",t.topCategories())}}function Te(n,e){if(n&1){let t=y();l(0,"lg-button",20),c("click",function(){f(t);let s=g();return C(s.editProduct(s.value))}),d(1," Edit Product "),i()}}function Fe(n,e){if(n&1){let t=y();l(0,"lg-button",20),c("click",function(){f(t);let s=g();return C(s.addProduct(s.value))}),d(1," Add Product "),i()}}var W=class n{constructor(e,t,o){this._productsRepository=e;this._selectResourcesService=t;this._router=o}form=new ae({name:new P("",M.required),amount:new P(null,M.required),price:new P(null,M.required),unit:new P("gram"),source:new P(""),category_id:new P(null,M.required)});buttons=[{label:"Grams",value:"gram",style:"secondary",onClick:()=>{console.log("Grams")}},{label:"Pieces",value:"piece",style:"secondary",onClick:()=>{console.log("Piece")}}];uuid=b("");topCategories=_([]);topSources=_([]);uuidEffect=Q(()=>{this.uuid()&&this._productsRepository.getOne(this.uuid()).then(e=>{this.form.reset(e)})});get value(){return this.form.value}eggsChanged(e){this.form.patchValue({amount:e})}ngOnInit(){this.form.valueChanges.subscribe(e=>{console.log(e)}),this._productsRepository.getTopCategories().then(e=>{this.topCategories.set(e.map(t=>({label:t.name,value:t.uuid})))}),this._productsRepository.getTopSources().then(e=>{this.topSources.set(e.map(t=>({label:t,value:t})))})}addProduct(e){this._productsRepository.addProduct(L(e)).then(()=>{this._router.navigate(["/products"])})}editProduct(e){this._productsRepository.editProduct(this.uuid(),L(e)).then(()=>{this._router.navigate(["/products"])})}ngAfterViewInit(){this._selectResourcesService.load().then(e=>{})}static \u0275fac=function(t){return new(t||n)(w(te),w(T),w(ee))};static \u0275cmp=u({type:n,selectors:[["lg-add-product-form"]],inputs:{uuid:[1,"uuid"]},features:[V([{provide:T,useClass:T}])],decls:28,vars:12,consts:[["priceInput",""],["sourceInput",""],["categorySelect",""],[3,"formGroup"],["label","Name"],["formControlName","name",3,"placeholder"],[3,"bottom","mobileMode"],["label","Amount","lgExpand",""],["formControlName","amount","lgParseMath","",3,"onInputChange","placeholder"],["ngProjectAs","after",5,["after"]],["ngProjectAs","content",5,["content"]],[3,"eggsChanged"],["formControlName","unit",3,"items"],["label","Price"],["formControlName","price","lgParseMath","",3,"placeholder"],["label","Source"],["formControlName","source",3,"placeholder"],[3,"control","items"],["label","Category"],["formControlName","category_id",3,"resource"],[3,"click"]],template:function(t,o){if(t&1){let s=y();l(0,"form",3)(1,"lg-gap-column")(2,"lg-control",4),m(3,"lg-input",5),i(),l(4,"lg-gap-row",6)(5,"lg-control",7)(6,"lg-number-input",8),c("onInputChange",function(){f(s);let G=S(15);return C(G.focus())}),l(7,"div",9)(8,"lg-tooltip"),d(9," Widgets "),l(10,"div",10)(11,"lg-amount-widgets",11),c("eggsChanged",function(G){return f(s),C(o.eggsChanged(G))}),i()()()()()(),m(12,"lg-buttons-group",12),i(),l(13,"lg-control",13),m(14,"lg-number-input",14,0),i(),l(16,"lg-gap-column")(17,"lg-control",15),m(18,"lg-input",16,1),i(),h(20,Ae,1,2,"lg-chips-list",17),i(),l(21,"lg-gap-column")(22,"lg-control",18),m(23,"lg-multiselect",19,2),i(),h(25,ke,1,2,"lg-chips-list",17),i(),h(26,Te,2,0,"lg-button")(27,Fe,2,0,"lg-button"),i()()}t&2&&(a("formGroup",o.form),r(3),a("placeholder","Your product name"),r(),a("bottom",!0)("mobileMode",!0),r(2),a("placeholder","In "+o.form.value.unit),r(6),a("items",o.buttons),r(2),a("placeholder","For the entire product in your currency"),r(4),a("placeholder","Where do you buy it?"),r(2),v(o.topSources().length?20:-1),r(3),a("resource","categories"),r(2),v(o.topCategories().length?25:-1),r(),v(o.uuid()?26:27))},dependencies:[ue,ce,le,se,pe,de,me,ge,fe,k,Ce,_e,I,N,ve,F,ye,he,D],styles:[`lg-eggs-widget{min-width:300px}
`],encapsulation:2})};var Pe=class n{constructor(e){this._aRoute=e}uuid=_("");ngOnInit(){this._aRoute.params.subscribe(e=>{this.uuid.set(e.uuid)})}static \u0275fac=function(t){return new(t||n)(w(Z))};static \u0275cmp=u({type:n,selectors:[["app-add-recipe"]],decls:8,vars:8,consts:[[3,"center"],[3,"flat","link","size"],[3,"uuid"]],template:function(t,o){t&1&&(l(0,"lg-container")(1,"lg-gap-row",0)(2,"lg-title"),d(3),i(),l(4,"lg-button",1),d(5," Back to list "),i()(),l(6,"lg-card"),m(7,"lg-add-product-form",2),i()()),t&2&&(r(),a("center",!0),r(2),E("",o.uuid()?"Edit":"Add"," Product"),r(),q("warning"),a("flat",!0)("link","/products")("size","small"),r(3),a("uuid",o.uuid()))},dependencies:[oe,ne,ie,W,k,F],encapsulation:2})};export{Pe as AddProductComponent};
