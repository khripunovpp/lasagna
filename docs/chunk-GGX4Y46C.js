import{a as h}from"./chunk-VIPBUB74.js";import{B as l,z as d}from"./chunk-3NSY2Z6P.js";import{b as n}from"./chunk-CABIONZL.js";import{_ as o,ca as r,da as c,ua as u}from"./chunk-NHWKWTII.js";var a=class i{constructor(e){e&&Array.isArray(e)}settings=new Map;static empty(){return new i}static fromRaw(e){if(e instanceof i)return e;let t=new i;return Array.isArray(e)?e.forEach(s=>{t.addSetting(s.key,s.data)}):Object.entries(e).forEach(([s,v])=>{t.addSetting(s,v)}),t}addSetting(e,t){this.settings.set(e,{key:e,data:t})}getSetting(e){return this.settings.get(e)}getAllSettings(){return Array.from(this.settings.values())}getSettingsMap(){return this.getAllSettings().reduce((e,t)=>(e[t.key]=t.data,e),{})}removeSetting(e){this.settings.delete(e)}toDTO(){return{settings:Array.from(this.settings.values())}}};var g=class i{constructor(e){this._indexDbService=e}async updateSettings(e){return await this._indexDbService.clear("settings"),this._indexDbService.balkAdd("settings",e.toDTO().settings)}getOne(e){return this._indexDbService.search("settings","key",e).then(t=>t?t[0]:null)}getAll(){return this._indexDbService.getAll("settings").then(e=>a.fromRaw(e))}static \u0275fac=function(t){return new(t||i)(r(l))};static \u0275prov=o({token:i,factory:i.\u0275fac,providedIn:"root"})};var m=class i{constructor(e,t){this._settingsRepository=e;this._localisationService=t}settingsModel;settingsSignal=u(void 0);_logger=c(d).withContext({label:"SettingsService",color:"#4CAF50"});get lang(){return this._localisationService.lang}get languages(){return this._localisationService.languages}loadSettings(){return this._settingsRepository.getAll().then(e=>(this.settingsModel=e,this.settingsSignal.set(e),this._logger.log("Settings loaded",e),e))}saveSettings(){return this.settingsModel?(this.settingsSignal.set(this.settingsModel),this._settingsRepository.updateSettings(this.settingsModel).then(()=>{this._logger.log("Settings saved",this.settingsModel)})):Promise.resolve()}changeLang(e){this._localisationService.changeLang(e),this.settingsModel?.addSetting("lang",e),this.saveSettings()}changeCurrency(e){this.settingsModel?.addSetting("currency",e),this.saveSettings()}getInvoicePrefix(){return this.settingsModel?.getSetting("invoicePrefix")?.data}setInvoicePrefix(e){this.settingsModel?.addSetting("invoicePrefix",e)}getInvoiceLogo(){return this.settingsModel?.getSetting("invoiceLogo")?.data}setInvoiceLogo(e){this.settingsModel?.addSetting("invoiceLogo",e)}setInvoicePrecisions(e,t){this.settingsModel?.addSetting("invoicePrecisionRows",e),this.settingsModel?.addSetting("invoicePrecisionTotals",t)}getInvoicePrecision(){let e=this.settingsModel?.getSetting("invoicePrecisionRows")?.data,t=this.settingsModel?.getSetting("invoicePrecisionTotals")?.data;return[e??2,t??2]}static \u0275fac=function(t){return new(t||i)(r(g),r(h))};static \u0275prov=o({token:i,factory:i.\u0275fac,providedIn:"root"})};var p=(t=>(t.customer="customer",t.system="system",t))(p||{});var S=class i{constructor(e){this.update(e||{})}type="customer";name="";privateName="";country="";address="";taxId;phone="";email="";uuid;static fromRaw(e){return typeof e=="string"?new i({uuid:e}):new i({type:e?.type||"customer",name:e?.name||"",privateName:e?.privateName||"",country:e?.country||"",address:e?.address||"",taxId:e?.taxId||"",phone:e?.phone||"",email:e?.email||"",uuid:e?.uuid||""})}static empty(){return new i}update(e){return this.uuid=n(e.uuid||this.uuid),this.name=n(e.name||this.name),this.privateName=n(e.privateName||this.privateName),this.country=n(e.country||this.country),this.address=n(e.address||this.address),this.taxId=n(e.taxId||this.taxId),this.phone=n(e.phone||this.phone),this.email=n(e.email||this.email),this.type=e.type||this.type||"customer",this}toDTO(){return{name:this.name||"",privateName:this.privateName||"",country:this.country||"",address:this.address||"",taxId:this.taxId||"",phone:this.phone||"",email:this.email||"",uuid:this.uuid||"",type:this.type}}toFormattedString(){return`${this.name}
${this.address}
${this.country}
${this.phone}
${this.email}
${this.taxId?`Tax ID: ${this.taxId}`:""}

    `}};export{p as a,S as b,m as c};
