import{U as bn,Y as ki}from"./chunk-KOVCW6OE.js";import{a as No}from"./chunk-DELOOZDJ.js";import{a as gn,b as wn,d as Fo,e as zo,f as ne}from"./chunk-2WH2EVR6.js";var Pi=Fo((Sr,Ir)=>{"use strict";(function(n,o){typeof Sr=="object"&&typeof Ir<"u"?Ir.exports=o():typeof define=="function"&&define.amd?define(o):(n=typeof globalThis<"u"?globalThis:n||self,n.Dexie=o())})(Sr,function(){"use strict";var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var u in s)Object.prototype.hasOwnProperty.call(s,u)&&(r[u]=s[u])},n(e,t)};function o(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return i=Object.assign||function(t){for(var r,s=1,u=arguments.length;s<u;s++){r=arguments[s];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(t[c]=r[c])}return t},i.apply(this,arguments)};function a(e,t,r){if(r||arguments.length===2)for(var s=0,u=t.length,c;s<u;s++)(c||!(s in t))&&(c||(c=Array.prototype.slice.call(t,0,s)),c[s]=t[s]);return e.concat(c||Array.prototype.slice.call(t))}var l=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,f=Object.keys,d=Array.isArray;typeof Promise<"u"&&!l.Promise&&(l.Promise=Promise);function m(e,t){return typeof t!="object"||f(t).forEach(function(r){e[r]=t[r]}),e}var y=Object.getPrototypeOf,b={}.hasOwnProperty;function E(e,t){return b.call(e,t)}function O(e,t){typeof t=="function"&&(t=t(y(e))),(typeof Reflect>"u"?f:Reflect.ownKeys)(t).forEach(function(r){j(e,r,t[r])})}var D=Object.defineProperty;function j(e,t,r,s){D(e,t,m(r&&E(r,"get")&&typeof r.get=="function"?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},s))}function B(e){return{from:function(t){return e.prototype=Object.create(t.prototype),j(e.prototype,"constructor",e),{extend:O.bind(null,e.prototype)}}}}var U=Object.getOwnPropertyDescriptor;function $(e,t){var r=U(e,t),s;return r||(s=y(e))&&$(s,t)}var X=[].slice;function J(e,t,r){return X.call(e,t,r)}function ve(e,t){return t(e)}function oe(e){if(!e)throw new Error("Assertion Failed")}function Z(e){l.setImmediate?setImmediate(e):setTimeout(e,0)}function le(e,t){return e.reduce(function(r,s,u){var c=t(s,u);return c&&(r[c[0]]=c[1]),r},{})}function de(e,t){if(typeof t=="string"&&E(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var r=[],s=0,u=t.length;s<u;++s){var c=de(e,t[s]);r.push(c)}return r}var h=t.indexOf(".");if(h!==-1){var p=e[t.substr(0,h)];return p==null?void 0:de(p,t.substr(h+1))}}function ie(e,t,r){if(!(!e||t===void 0)&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){oe(typeof r!="string"&&"length"in r);for(var s=0,u=t.length;s<u;++s)ie(e,t[s],r[s])}else{var c=t.indexOf(".");if(c!==-1){var h=t.substr(0,c),p=t.substr(c+1);if(p==="")r===void 0?d(e)&&!isNaN(parseInt(h))?e.splice(h,1):delete e[h]:e[h]=r;else{var v=e[h];(!v||!E(e,h))&&(v=e[h]={}),ie(v,p,r)}}else r===void 0?d(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=r}}function ke(e,t){typeof t=="string"?ie(e,t,void 0):"length"in t&&[].map.call(t,function(r){ie(e,r,void 0)})}function we(e){var t={};for(var r in e)E(e,r)&&(t[r]=e[r]);return t}var On=[].concat;function Fr(e){return On.apply([],e)}var us="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Fr([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return l[e]}),zr=new Set(us.map(function(e){return l[e]}));function Nr(e){var t={};for(var r in e)if(E(e,r)){var s=e[r];t[r]=!s||typeof s!="object"||zr.has(s.constructor)?s:Nr(s)}return t}function as(e){for(var t in e)if(E(e,t))return!1;return!0}var xt=null;function Ye(e){xt=new WeakMap;var t=Rn(e);return xt=null,t}function Rn(e){if(!e||typeof e!="object")return e;var t=xt.get(e);if(t)return t;if(d(e)){t=[],xt.set(e,t);for(var r=0,s=e.length;r<s;++r)t.push(Rn(e[r]))}else if(zr.has(e.constructor))t=e;else{var u=y(e);t=u===Object.prototype?{}:Object.create(u),xt.set(e,t);for(var c in e)E(e,c)&&(t[c]=Rn(e[c]))}return t}var ls={}.toString;function Dn(e){return ls.call(e).slice(8,-1)}var Kn=typeof Symbol<"u"?Symbol.iterator:"@@iterator",cs=typeof Kn=="symbol"?function(e){var t;return e!=null&&(t=e[Kn])&&t.apply(e)}:function(){return null};function Qe(e,t){var r=e.indexOf(t);return r>=0&&e.splice(r,1),r>=0}var ct={};function De(e){var t,r,s,u;if(arguments.length===1){if(d(e))return e.slice();if(this===ct&&typeof e=="string")return[e];if(u=cs(e)){for(r=[];s=u.next(),!s.done;)r.push(s.value);return r}if(e==null)return[e];if(t=e.length,typeof t=="number"){for(r=new Array(t);t--;)r[t]=e[t];return r}return[e]}for(t=arguments.length,r=new Array(t);t--;)r[t]=arguments[t];return r}var Bn=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},fs=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],Lr=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Mn=fs.concat(Lr),hs={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function ft(e,t){this.name=e,this.message=t}B(ft).from(Error).extend({toString:function(){return this.name+": "+this.message}});function Ur(e,t){return e+". Errors: "+Object.keys(t).map(function(r){return t[r].toString()}).filter(function(r,s,u){return u.indexOf(r)===s}).join(`
`)}function Vt(e,t,r,s){this.failures=t,this.failedKeys=s,this.successCount=r,this.message=Ur(e,t)}B(Vt).from(ft);function ht(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(r){return t[r]}),this.failuresByPos=t,this.message=Ur(e,this.failures)}B(ht).from(ft);var jn=Mn.reduce(function(e,t){return e[t]=t+"Error",e},{}),ds=ft,H=Mn.reduce(function(e,t){var r=t+"Error";function s(u,c){this.name=r,u?typeof u=="string"?(this.message="".concat(u).concat(c?`
 `+c:""),this.inner=c||null):typeof u=="object"&&(this.message="".concat(u.name," ").concat(u.message),this.inner=u):(this.message=hs[t]||r,this.inner=null)}return B(s).from(ds),e[t]=s,e},{});H.Syntax=SyntaxError,H.Type=TypeError,H.Range=RangeError;var Gr=Lr.reduce(function(e,t){return e[t+"Error"]=H[t],e},{});function ps(e,t){if(!e||e instanceof ft||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Gr[e.name])return e;var r=new Gr[e.name](t||e.message,e);return"stack"in e&&j(r,"stack",{get:function(){return this.inner.stack}}),r}var $t=Mn.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=H[t]),e},{});$t.ModifyError=Vt,$t.DexieError=ft,$t.BulkError=ht;function se(){}function _t(e){return e}function vs(e,t){return e==null||e===_t?t:function(r){return t(e(r))}}function Je(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function ms(e,t){return e===se?t:function(){var r=e.apply(this,arguments);r!==void 0&&(arguments[0]=r);var s=this.onsuccess,u=this.onerror;this.onsuccess=null,this.onerror=null;var c=t.apply(this,arguments);return s&&(this.onsuccess=this.onsuccess?Je(s,this.onsuccess):s),u&&(this.onerror=this.onerror?Je(u,this.onerror):u),c!==void 0?c:r}}function ys(e,t){return e===se?t:function(){e.apply(this,arguments);var r=this.onsuccess,s=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?Je(r,this.onsuccess):r),s&&(this.onerror=this.onerror?Je(s,this.onerror):s)}}function gs(e,t){return e===se?t:function(r){var s=e.apply(this,arguments);m(r,s);var u=this.onsuccess,c=this.onerror;this.onsuccess=null,this.onerror=null;var h=t.apply(this,arguments);return u&&(this.onsuccess=this.onsuccess?Je(u,this.onsuccess):u),c&&(this.onerror=this.onerror?Je(c,this.onerror):c),s===void 0?h===void 0?void 0:h:m(s,h)}}function ws(e,t){return e===se?t:function(){return t.apply(this,arguments)===!1?!1:e.apply(this,arguments)}}function Fn(e,t){return e===se?t:function(){var r=e.apply(this,arguments);if(r&&typeof r.then=="function"){for(var s=this,u=arguments.length,c=new Array(u);u--;)c[u]=arguments[u];return r.then(function(){return t.apply(s,c)})}return t.apply(this,arguments)}}var Ce=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Vr(e,t){Ce=e}var Et={},$r=100,zn=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,y(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,y(t),e]}(),Wr=zn[0],Hr=zn[1],bs=zn[2],xs=Hr&&Hr.then,Xe=Wr&&Wr.constructor,Nn=!!bs;function _s(){queueMicrotask(Ss)}var St=function(e,t){It.push([e,t]),Wt&&(_s(),Wt=!1)},Ln=!0,Wt=!0,Ze=[],Ht=[],Un=_t,Me={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:se,pgp:!1,env:{},finalize:se},G=Me,It=[],qe=0,Yt=[];function z(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=G;if(typeof e!="function"){if(e!==Et)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Vn(this,this._value);return}this._state=null,this._value=null,++t.ref,Qr(this,e)}var Gn={get:function(){var e=G,t=Zt;function r(s,u){var c=this,h=!e.global&&(e!==G||t!==Zt),p=h&&!Fe(),v=new z(function(g,_){$n(c,new Yr(Zr(s,e,h,p),Zr(u,e,h,p),g,_,e))});return this._consoleTask&&(v._consoleTask=this._consoleTask),v}return r.prototype=Et,r},set:function(e){j(this,"then",e&&e.prototype===Et?Gn:{get:function(){return e},set:Gn.set})}};O(z.prototype,{then:Gn,_then:function(e,t){$n(this,new Yr(null,null,e,t,G))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],r=arguments[1];return typeof t=="function"?this.then(null,function(s){return s instanceof t?r(s):Qt(s)}):this.then(null,function(s){return s&&s.name===t?r(s):Qt(s)})},finally:function(e){return this.then(function(t){return z.resolve(e()).then(function(){return t})},function(t){return z.resolve(e()).then(function(){return Qt(t)})})},timeout:function(e,t){var r=this;return e<1/0?new z(function(s,u){var c=setTimeout(function(){return u(new H.Timeout(t))},e);r.then(s,u).finally(clearTimeout.bind(null,c))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&j(z.prototype,Symbol.toStringTag,"Dexie.Promise"),Me.env=Xr();function Yr(e,t,r,s,u){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=r,this.reject=s,this.psd=u}O(z,{all:function(){var e=De.apply(null,arguments).map(qt);return new z(function(t,r){e.length===0&&t([]);var s=e.length;e.forEach(function(u,c){return z.resolve(u).then(function(h){e[c]=h,--s||t(e)},r)})})},resolve:function(e){if(e instanceof z)return e;if(e&&typeof e.then=="function")return new z(function(r,s){e.then(r,s)});var t=new z(Et,!0,e);return t},reject:Qt,race:function(){var e=De.apply(null,arguments).map(qt);return new z(function(t,r){e.map(function(s){return z.resolve(s).then(t,r)})})},PSD:{get:function(){return G},set:function(e){return G=e}},totalEchoes:{get:function(){return Zt}},newPSD:je,usePSD:et,scheduler:{get:function(){return St},set:function(e){St=e}},rejectionMapper:{get:function(){return Un},set:function(e){Un=e}},follow:function(e,t){return new z(function(r,s){return je(function(u,c){var h=G;h.unhandleds=[],h.onunhandled=c,h.finalize=Je(function(){var p=this;Is(function(){p.unhandleds.length===0?u():c(p.unhandleds[0])})},h.finalize),e()},t,r,s)})}}),Xe&&(Xe.allSettled&&j(z,"allSettled",function(){var e=De.apply(null,arguments).map(qt);return new z(function(t){e.length===0&&t([]);var r=e.length,s=new Array(r);e.forEach(function(u,c){return z.resolve(u).then(function(h){return s[c]={status:"fulfilled",value:h}},function(h){return s[c]={status:"rejected",reason:h}}).then(function(){return--r||t(s)})})})}),Xe.any&&typeof AggregateError<"u"&&j(z,"any",function(){var e=De.apply(null,arguments).map(qt);return new z(function(t,r){e.length===0&&r(new AggregateError([]));var s=e.length,u=new Array(s);e.forEach(function(c,h){return z.resolve(c).then(function(p){return t(p)},function(p){u[h]=p,--s||r(new AggregateError(u))})})})}),Xe.withResolvers&&(z.withResolvers=Xe.withResolvers));function Qr(e,t){try{t(function(r){if(e._state===null){if(r===e)throw new TypeError("A promise cannot be resolved with itself.");var s=e._lib&&dt();r&&typeof r.then=="function"?Qr(e,function(u,c){r instanceof z?r._then(u,c):r.then(u,c)}):(e._state=!0,e._value=r,Jr(e)),s&&pt()}},Vn.bind(null,e))}catch(r){Vn(e,r)}}function Vn(e,t){if(Ht.push(t),e._state===null){var r=e._lib&&dt();t=Un(t),e._state=!1,e._value=t,ks(e),Jr(e),r&&pt()}}function Jr(e){var t=e._listeners;e._listeners=[];for(var r=0,s=t.length;r<s;++r)$n(e,t[r]);var u=e._PSD;--u.ref||u.finalize(),qe===0&&(++qe,St(function(){--qe===0&&Wn()},[]))}function $n(e,t){if(e._state===null){e._listeners.push(t);return}var r=e._state?t.onFulfilled:t.onRejected;if(r===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++qe,St(Es,[r,e,t])}function Es(e,t,r){try{var s,u=t._value;!t._state&&Ht.length&&(Ht=[]),s=Ce&&t._consoleTask?t._consoleTask.run(function(){return e(u)}):e(u),!t._state&&Ht.indexOf(u)===-1&&Cs(t),r.resolve(s)}catch(c){r.reject(c)}finally{--qe===0&&Wn(),--r.psd.ref||r.psd.finalize()}}function Ss(){et(Me,function(){dt()&&pt()})}function dt(){var e=Ln;return Ln=!1,Wt=!1,e}function pt(){var e,t,r;do for(;It.length>0;)for(e=It,It=[],r=e.length,t=0;t<r;++t){var s=e[t];s[0].apply(null,s[1])}while(It.length>0);Ln=!0,Wt=!0}function Wn(){var e=Ze;Ze=[],e.forEach(function(s){s._PSD.onunhandled.call(null,s._value,s)});for(var t=Yt.slice(0),r=t.length;r;)t[--r]()}function Is(e){function t(){e(),Yt.splice(Yt.indexOf(t),1)}Yt.push(t),++qe,St(function(){--qe===0&&Wn()},[])}function ks(e){Ze.some(function(t){return t._value===e._value})||Ze.push(e)}function Cs(e){for(var t=Ze.length;t;)if(Ze[--t]._value===e._value){Ze.splice(t,1);return}}function Qt(e){return new z(Et,!1,e)}function ue(e,t){var r=G;return function(){var s=dt(),u=G;try{return ze(r,!0),e.apply(this,arguments)}catch(c){t&&t(c)}finally{ze(u,!1),s&&pt()}}}var pe={awaits:0,echoes:0,id:0},Ps=0,Jt=[],Xt=0,Zt=0,Ts=0;function je(e,t,r,s){var u=G,c=Object.create(u);c.parent=u,c.ref=0,c.global=!1,c.id=++Ts,Me.env,c.env=Nn?{Promise:z,PromiseProp:{value:z,configurable:!0,writable:!0},all:z.all,race:z.race,allSettled:z.allSettled,any:z.any,resolve:z.resolve,reject:z.reject}:{},t&&m(c,t),++u.ref,c.finalize=function(){--this.parent.ref||this.parent.finalize()};var h=et(c,e,r,s);return c.ref===0&&c.finalize(),h}function vt(){return pe.id||(pe.id=++Ps),++pe.awaits,pe.echoes+=$r,pe.id}function Fe(){return pe.awaits?(--pe.awaits===0&&(pe.id=0),pe.echoes=pe.awaits*$r,!0):!1}(""+xs).indexOf("[native code]")===-1&&(vt=Fe=se);function qt(e){return pe.echoes&&e&&e.constructor===Xe?(vt(),e.then(function(t){return Fe(),t},function(t){return Fe(),he(t)})):e}function As(e){++Zt,(!pe.echoes||--pe.echoes===0)&&(pe.echoes=pe.awaits=pe.id=0),Jt.push(G),ze(e,!0)}function Os(){var e=Jt[Jt.length-1];Jt.pop(),ze(e,!1)}function ze(e,t){var r=G;if((t?pe.echoes&&(!Xt++||e!==G):Xt&&(!--Xt||e!==G))&&queueMicrotask(t?As.bind(null,e):Os),e!==G&&(G=e,r===Me&&(Me.env=Xr()),Nn)){var s=Me.env.Promise,u=e.env;(r.global||e.global)&&(Object.defineProperty(l,"Promise",u.PromiseProp),s.all=u.all,s.race=u.race,s.resolve=u.resolve,s.reject=u.reject,u.allSettled&&(s.allSettled=u.allSettled),u.any&&(s.any=u.any))}}function Xr(){var e=l.Promise;return Nn?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(l,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function et(e,t,r,s,u){var c=G;try{return ze(e,!0),t(r,s,u)}finally{ze(c,!1)}}function Zr(e,t,r,s){return typeof e!="function"?e:function(){var u=G;r&&vt(),ze(t,!0);try{return e.apply(this,arguments)}finally{ze(u,!1),s&&queueMicrotask(Fe)}}}function Hn(e){Promise===Xe&&pe.echoes===0?Xt===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}var he=z.reject;function Yn(e,t,r,s){if(!e.idbdb||!e._state.openComplete&&!G.letThrough&&!e._vip){if(e._state.openComplete)return he(new H.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._state.autoOpen)return he(new H.DatabaseClosed);e.open().catch(se)}return e._state.dbReadyPromise.then(function(){return Yn(e,t,r,s)})}else{var u=e._createTransaction(t,r,e._dbSchema);try{u.create(),e._state.PR1398_maxLoop=3}catch(c){return c.name===jn.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return Yn(e,t,r,s)})):he(c)}return u._promise(t,function(c,h){return je(function(){return G.trans=u,s(c,h,u)})}).then(function(c){if(t==="readwrite")try{u.idbtrans.commit()}catch{}return t==="readonly"?c:u._completion.then(function(){return c})})}}var qr="4.0.11",tt="\uFFFF",Qn=-1/0,Ke="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",ei="String expected.",mt=[],en="__dbnames",Jn="readonly",Xn="readwrite";function nt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var ti={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function tn(e){return typeof e=="string"&&!/\./.test(e)?function(t){return t[e]===void 0&&e in t&&(t=Ye(t),delete t[e]),t}:function(t){return t}}function ni(){throw H.Type()}function te(e,t){try{var r=ri(e),s=ri(t);if(r!==s)return r==="Array"?1:s==="Array"?-1:r==="binary"?1:s==="binary"?-1:r==="string"?1:s==="string"?-1:r==="Date"?1:s!=="Date"?NaN:-1;switch(r){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return Ds(ii(e),ii(t));case"Array":return Rs(e,t)}}catch{}return NaN}function Rs(e,t){for(var r=e.length,s=t.length,u=r<s?r:s,c=0;c<u;++c){var h=te(e[c],t[c]);if(h!==0)return h}return r===s?0:r<s?-1:1}function Ds(e,t){for(var r=e.length,s=t.length,u=r<s?r:s,c=0;c<u;++c)if(e[c]!==t[c])return e[c]<t[c]?-1:1;return r===s?0:r<s?-1:1}function ri(e){var t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";var r=Dn(e);return r==="ArrayBuffer"?"binary":r}function ii(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var si=function(){function e(){}return e.prototype._trans=function(t,r,s){var u=this._tx||G.trans,c=this.name,h=Ce&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(t==="readonly"?"read":"write"," ").concat(this.name));function p(_,w,k){if(!k.schema[c])throw new H.NotFound("Table "+c+" not part of transaction");return r(k.idbtrans,k)}var v=dt();try{var g=u&&u.db._novip===this.db._novip?u===G.trans?u._promise(t,p,s):je(function(){return u._promise(t,p,s)},{trans:u,transless:G.transless||G}):Yn(this.db,t,[this.name],p);return h&&(g._consoleTask=h,g=g.catch(function(_){return console.trace(_),he(_)})),g}finally{v&&pt()}},e.prototype.get=function(t,r){var s=this;return t&&t.constructor===Object?this.where(t).first(r):t==null?he(new H.Type("Invalid argument to Table.get()")):this._trans("readonly",function(u){return s.core.get({trans:u,key:t}).then(function(c){return s.hook.reading.fire(c)})}).then(r)},e.prototype.where=function(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(d(t))return new this.db.WhereClause(this,"[".concat(t.join("+"),"]"));var r=f(t);if(r.length===1)return this.where(r[0]).equals(t[r[0]]);var s=this.schema.indexes.concat(this.schema.primKey).filter(function(_){if(_.compound&&r.every(function(k){return _.keyPath.indexOf(k)>=0})){for(var w=0;w<r.length;++w)if(r.indexOf(_.keyPath[w])===-1)return!1;return!0}return!1}).sort(function(_,w){return _.keyPath.length-w.keyPath.length})[0];if(s&&this.db._maxKey!==tt){var u=s.keyPath.slice(0,r.length);return this.where(u).equals(u.map(function(_){return t[_]}))}!s&&Ce&&console.warn("The query ".concat(JSON.stringify(t)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(r.join("+"),"]"));var c=this.schema.idxByName;function h(_,w){return te(_,w)===0}var p=r.reduce(function(_,w){var k=_[0],K=_[1],x=c[w],S=t[w];return[k||x,k||!x?nt(K,x&&x.multi?function(I){var A=de(I,w);return d(A)&&A.some(function(P){return h(S,P)})}:function(I){return h(S,de(I,w))}):K]},[null,null]),v=p[0],g=p[1];return v?this.where(v.name).equals(t[v.keyPath]).filter(g):s?this.filter(g):this.where(r).equals("")},e.prototype.filter=function(t){return this.toCollection().and(t)},e.prototype.count=function(t){return this.toCollection().count(t)},e.prototype.offset=function(t){return this.toCollection().offset(t)},e.prototype.limit=function(t){return this.toCollection().limit(t)},e.prototype.each=function(t){return this.toCollection().each(t)},e.prototype.toArray=function(t){return this.toCollection().toArray(t)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(t){return new this.db.Collection(new this.db.WhereClause(this,d(t)?"[".concat(t.join("+"),"]"):t))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(t){var r=this,s=r.db,u=r.name;this.schema.mappedClass=t,t.prototype instanceof ni&&(t=function(v){o(g,v);function g(){return v!==null&&v.apply(this,arguments)||this}return Object.defineProperty(g.prototype,"db",{get:function(){return s},enumerable:!1,configurable:!0}),g.prototype.table=function(){return u},g}(t));for(var c=new Set,h=t.prototype;h;h=y(h))Object.getOwnPropertyNames(h).forEach(function(v){return c.add(v)});var p=function(v){if(!v)return v;var g=Object.create(t.prototype);for(var _ in v)if(!c.has(_))try{g[_]=v[_]}catch{}return g};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=p,this.hook("reading",p),t},e.prototype.defineClass=function(){function t(r){m(this,r)}return this.mapToClass(t)},e.prototype.add=function(t,r){var s=this,u=this.schema.primKey,c=u.auto,h=u.keyPath,p=t;return h&&c&&(p=tn(h)(t)),this._trans("readwrite",function(v){return s.core.mutate({trans:v,type:"add",keys:r!=null?[r]:null,values:[p]})}).then(function(v){return v.numFailures?z.reject(v.failures[0]):v.lastResult}).then(function(v){if(h)try{ie(t,h,v)}catch{}return v})},e.prototype.update=function(t,r){if(typeof t=="object"&&!d(t)){var s=de(t,this.schema.primKey.keyPath);return s===void 0?he(new H.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(s).modify(r)}else return this.where(":id").equals(t).modify(r)},e.prototype.put=function(t,r){var s=this,u=this.schema.primKey,c=u.auto,h=u.keyPath,p=t;return h&&c&&(p=tn(h)(t)),this._trans("readwrite",function(v){return s.core.mutate({trans:v,type:"put",values:[p],keys:r!=null?[r]:null})}).then(function(v){return v.numFailures?z.reject(v.failures[0]):v.lastResult}).then(function(v){if(h)try{ie(t,h,v)}catch{}return v})},e.prototype.delete=function(t){var r=this;return this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"delete",keys:[t]})}).then(function(s){return s.numFailures?z.reject(s.failures[0]):void 0})},e.prototype.clear=function(){var t=this;return this._trans("readwrite",function(r){return t.core.mutate({trans:r,type:"deleteRange",range:ti})}).then(function(r){return r.numFailures?z.reject(r.failures[0]):void 0})},e.prototype.bulkGet=function(t){var r=this;return this._trans("readonly",function(s){return r.core.getMany({keys:t,trans:s}).then(function(u){return u.map(function(c){return r.hook.reading.fire(c)})})})},e.prototype.bulkAdd=function(t,r,s){var u=this,c=Array.isArray(r)?r:void 0;s=s||(c?void 0:r);var h=s?s.allKeys:void 0;return this._trans("readwrite",function(p){var v=u.schema.primKey,g=v.auto,_=v.keyPath;if(_&&c)throw new H.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(c&&c.length!==t.length)throw new H.InvalidArgument("Arguments objects and keys must have the same length");var w=t.length,k=_&&g?t.map(tn(_)):t;return u.core.mutate({trans:p,type:"add",keys:c,values:k,wantResults:h}).then(function(K){var x=K.numFailures,S=K.results,I=K.lastResult,A=K.failures,P=h?S:I;if(x===0)return P;throw new ht("".concat(u.name,".bulkAdd(): ").concat(x," of ").concat(w," operations failed"),A)})})},e.prototype.bulkPut=function(t,r,s){var u=this,c=Array.isArray(r)?r:void 0;s=s||(c?void 0:r);var h=s?s.allKeys:void 0;return this._trans("readwrite",function(p){var v=u.schema.primKey,g=v.auto,_=v.keyPath;if(_&&c)throw new H.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(c&&c.length!==t.length)throw new H.InvalidArgument("Arguments objects and keys must have the same length");var w=t.length,k=_&&g?t.map(tn(_)):t;return u.core.mutate({trans:p,type:"put",keys:c,values:k,wantResults:h}).then(function(K){var x=K.numFailures,S=K.results,I=K.lastResult,A=K.failures,P=h?S:I;if(x===0)return P;throw new ht("".concat(u.name,".bulkPut(): ").concat(x," of ").concat(w," operations failed"),A)})})},e.prototype.bulkUpdate=function(t){var r=this,s=this.core,u=t.map(function(p){return p.key}),c=t.map(function(p){return p.changes}),h=[];return this._trans("readwrite",function(p){return s.getMany({trans:p,keys:u,cache:"clone"}).then(function(v){var g=[],_=[];t.forEach(function(k,K){var x=k.key,S=k.changes,I=v[K];if(I){for(var A=0,P=Object.keys(S);A<P.length;A++){var T=P[A],R=S[T];if(T===r.schema.primKey.keyPath){if(te(R,x)!==0)throw new H.Constraint("Cannot update primary key in bulkUpdate()")}else ie(I,T,R)}h.push(K),g.push(x),_.push(I)}});var w=g.length;return s.mutate({trans:p,type:"put",keys:g,values:_,updates:{keys:u,changeSpecs:c}}).then(function(k){var K=k.numFailures,x=k.failures;if(K===0)return w;for(var S=0,I=Object.keys(x);S<I.length;S++){var A=I[S],P=h[Number(A)];if(P!=null){var T=x[A];delete x[A],x[P]=T}}throw new ht("".concat(r.name,".bulkUpdate(): ").concat(K," of ").concat(w," operations failed"),x)})})})},e.prototype.bulkDelete=function(t){var r=this,s=t.length;return this._trans("readwrite",function(u){return r.core.mutate({trans:u,type:"delete",keys:t})}).then(function(u){var c=u.numFailures,h=u.lastResult,p=u.failures;if(c===0)return h;throw new ht("".concat(r.name,".bulkDelete(): ").concat(c," of ").concat(s," operations failed"),p)})},e}();function kt(e){var t={},r=function(p,v){if(v){for(var g=arguments.length,_=new Array(g-1);--g;)_[g-1]=arguments[g];return t[p].subscribe.apply(null,_),e}else if(typeof p=="string")return t[p]};r.addEventType=c;for(var s=1,u=arguments.length;s<u;++s)c(arguments[s]);return r;function c(p,v,g){if(typeof p=="object")return h(p);v||(v=ws),g||(g=se);var _={subscribers:[],fire:g,subscribe:function(w){_.subscribers.indexOf(w)===-1&&(_.subscribers.push(w),_.fire=v(_.fire,w))},unsubscribe:function(w){_.subscribers=_.subscribers.filter(function(k){return k!==w}),_.fire=_.subscribers.reduce(v,g)}};return t[p]=r[p]=_,_}function h(p){f(p).forEach(function(v){var g=p[v];if(d(g))c(v,p[v][0],p[v][1]);else if(g==="asap")var _=c(v,_t,function(){for(var k=arguments.length,K=new Array(k);k--;)K[k]=arguments[k];_.subscribers.forEach(function(x){Z(function(){x.apply(null,K)})})});else throw new H.InvalidArgument("Invalid event config")})}}function Ct(e,t){return B(t).from({prototype:e}),t}function Ks(e){return Ct(si.prototype,function(r,s,u){this.db=e,this._tx=u,this.name=r,this.schema=s,this.hook=e._allTables[r]?e._allTables[r].hook:kt(null,{creating:[ms,se],reading:[vs,_t],updating:[gs,se],deleting:[ys,se]})})}function yt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Zn(e,t){e.filter=nt(e.filter,t)}function qn(e,t,r){var s=e.replayFilter;e.replayFilter=s?function(){return nt(s(),t())}:t,e.justLimit=r&&!s}function Bs(e,t){e.isMatch=nt(e.isMatch,t)}function nn(e,t){if(e.isPrimKey)return t.primaryKey;var r=t.getIndexByKeyPath(e.index);if(!r)throw new H.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return r}function oi(e,t,r){var s=nn(e,t.schema);return t.openCursor({trans:r,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:s,range:e.range}})}function rn(e,t,r,s){var u=e.replayFilter?nt(e.filter,e.replayFilter()):e.filter;if(e.or){var c={},h=function(p,v,g){if(!u||u(v,g,function(k){return v.stop(k)},function(k){return v.fail(k)})){var _=v.primaryKey,w=""+_;w==="[object ArrayBuffer]"&&(w=""+new Uint8Array(_)),E(c,w)||(c[w]=!0,t(p,v,g))}};return Promise.all([e.or._iterate(h,r),ui(oi(e,s,r),e.algorithm,h,!e.keysOnly&&e.valueMapper)])}else return ui(oi(e,s,r),nt(e.algorithm,u),t,!e.keysOnly&&e.valueMapper)}function ui(e,t,r,s){var u=s?function(h,p,v){return r(s(h),p,v)}:r,c=ue(u);return e.then(function(h){if(h)return h.start(function(){var p=function(){return h.continue()};(!t||t(h,function(v){return p=v},function(v){h.stop(v),p=se},function(v){h.fail(v),p=se}))&&c(h.value,h,function(v){return p=v}),p()})})}var Pt=function(){function e(t){this["@@propmod"]=t}return e.prototype.execute=function(t){var r,s=this["@@propmod"];if(s.add!==void 0){var u=s.add;if(d(u))return a(a([],d(t)?t:[],!0),u,!0).sort();if(typeof u=="number")return(Number(t)||0)+u;if(typeof u=="bigint")try{return BigInt(t)+u}catch{return BigInt(0)+u}throw new TypeError("Invalid term ".concat(u))}if(s.remove!==void 0){var c=s.remove;if(d(c))return d(t)?t.filter(function(p){return!c.includes(p)}).sort():[];if(typeof c=="number")return Number(t)-c;if(typeof c=="bigint")try{return BigInt(t)-c}catch{return BigInt(0)-c}throw new TypeError("Invalid subtrahend ".concat(c))}var h=(r=s.replacePrefix)===null||r===void 0?void 0:r[0];return h&&typeof t=="string"&&t.startsWith(h)?s.replacePrefix[1]+t.substring(h.length):t},e}(),Ms=function(){function e(){}return e.prototype._read=function(t,r){var s=this._ctx;return s.error?s.table._trans(null,he.bind(null,s.error)):s.table._trans("readonly",t).then(r)},e.prototype._write=function(t){var r=this._ctx;return r.error?r.table._trans(null,he.bind(null,r.error)):r.table._trans("readwrite",t,"locked")},e.prototype._addAlgorithm=function(t){var r=this._ctx;r.algorithm=nt(r.algorithm,t)},e.prototype._iterate=function(t,r){return rn(this._ctx,t,r,this._ctx.table.core)},e.prototype.clone=function(t){var r=Object.create(this.constructor.prototype),s=Object.create(this._ctx);return t&&m(s,t),r._ctx=s,r},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(t){var r=this._ctx;return this._read(function(s){return rn(r,t,s,r.table.core)})},e.prototype.count=function(t){var r=this;return this._read(function(s){var u=r._ctx,c=u.table.core;if(yt(u,!0))return c.count({trans:s,query:{index:nn(u,c.schema),range:u.range}}).then(function(p){return Math.min(p,u.limit)});var h=0;return rn(u,function(){return++h,!1},s,c).then(function(){return h})}).then(t)},e.prototype.sortBy=function(t,r){var s=t.split(".").reverse(),u=s[0],c=s.length-1;function h(g,_){return _?h(g[s[_]],_-1):g[u]}var p=this._ctx.dir==="next"?1:-1;function v(g,_){var w=h(g,c),k=h(_,c);return te(w,k)*p}return this.toArray(function(g){return g.sort(v)}).then(r)},e.prototype.toArray=function(t){var r=this;return this._read(function(s){var u=r._ctx;if(u.dir==="next"&&yt(u,!0)&&u.limit>0){var c=u.valueMapper,h=nn(u,u.table.core.schema);return u.table.core.query({trans:s,limit:u.limit,values:!0,query:{index:h,range:u.range}}).then(function(v){var g=v.result;return c?g.map(c):g})}else{var p=[];return rn(u,function(v){return p.push(v)},s,u.table.core).then(function(){return p})}},t)},e.prototype.offset=function(t){var r=this._ctx;return t<=0?this:(r.offset+=t,yt(r)?qn(r,function(){var s=t;return function(u,c){return s===0?!0:s===1?(--s,!1):(c(function(){u.advance(s),s=0}),!1)}}):qn(r,function(){var s=t;return function(){return--s<0}}),this)},e.prototype.limit=function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),qn(this._ctx,function(){var r=t;return function(s,u,c){return--r<=0&&u(c),r>=0}},!0),this},e.prototype.until=function(t,r){return Zn(this._ctx,function(s,u,c){return t(s.value)?(u(c),r):!0}),this},e.prototype.first=function(t){return this.limit(1).toArray(function(r){return r[0]}).then(t)},e.prototype.last=function(t){return this.reverse().first(t)},e.prototype.filter=function(t){return Zn(this._ctx,function(r){return t(r.value)}),Bs(this._ctx,t),this},e.prototype.and=function(t){return this.filter(t)},e.prototype.or=function(t){return new this.db.WhereClause(this._ctx.table,t,this)},e.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(t){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(s,u){t(u.key,u)})},e.prototype.eachUniqueKey=function(t){return this._ctx.unique="unique",this.eachKey(t)},e.prototype.eachPrimaryKey=function(t){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(s,u){t(u.primaryKey,u)})},e.prototype.keys=function(t){var r=this._ctx;r.keysOnly=!r.isMatch;var s=[];return this.each(function(u,c){s.push(c.key)}).then(function(){return s}).then(t)},e.prototype.primaryKeys=function(t){var r=this._ctx;if(r.dir==="next"&&yt(r,!0)&&r.limit>0)return this._read(function(u){var c=nn(r,r.table.core.schema);return r.table.core.query({trans:u,values:!1,limit:r.limit,query:{index:c,range:r.range}})}).then(function(u){var c=u.result;return c}).then(t);r.keysOnly=!r.isMatch;var s=[];return this.each(function(u,c){s.push(c.primaryKey)}).then(function(){return s}).then(t)},e.prototype.uniqueKeys=function(t){return this._ctx.unique="unique",this.keys(t)},e.prototype.firstKey=function(t){return this.limit(1).keys(function(r){return r[0]}).then(t)},e.prototype.lastKey=function(t){return this.reverse().firstKey(t)},e.prototype.distinct=function(){var t=this._ctx,r=t.index&&t.table.schema.idxByName[t.index];if(!r||!r.multi)return this;var s={};return Zn(this._ctx,function(u){var c=u.primaryKey.toString(),h=E(s,c);return s[c]=!0,!h}),this},e.prototype.modify=function(t){var r=this,s=this._ctx;return this._write(function(u){var c;if(typeof t=="function")c=t;else{var h=f(t),p=h.length;c=function(P){for(var T=!1,R=0;R<p;++R){var C=h[R],M=t[C],N=de(P,C);M instanceof Pt?(ie(P,C,M.execute(N)),T=!0):N!==M&&(ie(P,C,M),T=!0)}return T}}var v=s.table.core,g=v.schema.primaryKey,_=g.outbound,w=g.extractKey,k=200,K=r.db._options.modifyChunkSize;K&&(typeof K=="object"?k=K[v.name]||K["*"]||200:k=K);var x=[],S=0,I=[],A=function(P,T){var R=T.failures,C=T.numFailures;S+=P-C;for(var M=0,N=f(R);M<N.length;M++){var F=N[M];x.push(R[F])}};return r.clone().primaryKeys().then(function(P){var T=yt(s)&&s.limit===1/0&&(typeof t!="function"||t===er)&&{index:s.index,range:s.range},R=function(C){var M=Math.min(k,P.length-C);return v.getMany({trans:u,keys:P.slice(C,C+M),cache:"immutable"}).then(function(N){for(var F=[],Y=[],ee=_?[]:null,L=[],q=0;q<M;++q){var Q=N[q],re={value:Ye(Q),primKey:P[C+q]};c.call(re,re.value,re)!==!1&&(re.value==null?L.push(P[C+q]):!_&&te(w(Q),w(re.value))!==0?(L.push(P[C+q]),F.push(re.value)):(Y.push(re.value),_&&ee.push(P[C+q])))}return Promise.resolve(F.length>0&&v.mutate({trans:u,type:"add",values:F}).then(function(W){for(var ce in W.failures)L.splice(parseInt(ce),1);A(F.length,W)})).then(function(){return(Y.length>0||T&&typeof t=="object")&&v.mutate({trans:u,type:"put",keys:ee,values:Y,criteria:T,changeSpec:typeof t!="function"&&t,isAdditionalChunk:C>0}).then(function(W){return A(Y.length,W)})}).then(function(){return(L.length>0||T&&t===er)&&v.mutate({trans:u,type:"delete",keys:L,criteria:T,isAdditionalChunk:C>0}).then(function(W){return A(L.length,W)})}).then(function(){return P.length>C+M&&R(C+k)})})};return R(0).then(function(){if(x.length>0)throw new Vt("Error modifying one or more objects",x,S,I);return P.length})})})},e.prototype.delete=function(){var t=this._ctx,r=t.range;return yt(t)&&(t.isPrimKey||r.type===3)?this._write(function(s){var u=t.table.core.schema.primaryKey,c=r;return t.table.core.count({trans:s,query:{index:u,range:c}}).then(function(h){return t.table.core.mutate({trans:s,type:"deleteRange",range:c}).then(function(p){var v=p.failures;p.lastResult,p.results;var g=p.numFailures;if(g)throw new Vt("Could not delete some values",Object.keys(v).map(function(_){return v[_]}),h-g);return h-g})})}):this.modify(er)},e}(),er=function(e,t){return t.value=null};function js(e){return Ct(Ms.prototype,function(r,s){this.db=e;var u=ti,c=null;if(s)try{u=s()}catch(g){c=g}var h=r._ctx,p=h.table,v=p.hook.reading.fire;this._ctx={table:p,index:h.index,isPrimKey:!h.index||p.schema.primKey.keyPath&&h.index===p.schema.primKey.name,range:u,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:c,or:h.or,valueMapper:v!==_t?v:null}})}function Fs(e,t){return e<t?-1:e===t?0:1}function zs(e,t){return e>t?-1:e===t?0:1}function xe(e,t,r){var s=e instanceof li?new e.Collection(e):e;return s._ctx.error=r?new r(t):new TypeError(t),s}function gt(e){return new e.Collection(e,function(){return ai("")}).limit(0)}function Ns(e){return e==="next"?function(t){return t.toUpperCase()}:function(t){return t.toLowerCase()}}function Ls(e){return e==="next"?function(t){return t.toLowerCase()}:function(t){return t.toUpperCase()}}function Us(e,t,r,s,u,c){for(var h=Math.min(e.length,s.length),p=-1,v=0;v<h;++v){var g=t[v];if(g!==s[v])return u(e[v],r[v])<0?e.substr(0,v)+r[v]+r.substr(v+1):u(e[v],s[v])<0?e.substr(0,v)+s[v]+r.substr(v+1):p>=0?e.substr(0,p)+t[p]+r.substr(p+1):null;u(e[v],g)<0&&(p=v)}return h<s.length&&c==="next"?e+r.substr(e.length):h<e.length&&c==="prev"?e.substr(0,r.length):p<0?null:e.substr(0,p)+s[p]+r.substr(p+1)}function sn(e,t,r,s){var u,c,h,p,v,g,_,w=r.length;if(!r.every(function(S){return typeof S=="string"}))return xe(e,ei);function k(S){u=Ns(S),c=Ls(S),h=S==="next"?Fs:zs;var I=r.map(function(A){return{lower:c(A),upper:u(A)}}).sort(function(A,P){return h(A.lower,P.lower)});p=I.map(function(A){return A.upper}),v=I.map(function(A){return A.lower}),g=S,_=S==="next"?"":s}k("next");var K=new e.Collection(e,function(){return Ne(p[0],v[w-1]+s)});K._ondirectionchange=function(S){k(S)};var x=0;return K._addAlgorithm(function(S,I,A){var P=S.key;if(typeof P!="string")return!1;var T=c(P);if(t(T,v,x))return!0;for(var R=null,C=x;C<w;++C){var M=Us(P,T,p[C],v[C],h,g);M===null&&R===null?x=C+1:(R===null||h(R,M)>0)&&(R=M)}return I(R!==null?function(){S.continue(R+_)}:A),!1}),K}function Ne(e,t,r,s){return{type:2,lower:e,upper:t,lowerOpen:r,upperOpen:s}}function ai(e){return{type:1,lower:e,upper:e}}var li=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(t,r,s,u){s=s!==!1,u=u===!0;try{return this._cmp(t,r)>0||this._cmp(t,r)===0&&(s||u)&&!(s&&u)?gt(this):new this.Collection(this,function(){return Ne(t,r,!s,!u)})}catch{return xe(this,Ke)}},e.prototype.equals=function(t){return t==null?xe(this,Ke):new this.Collection(this,function(){return ai(t)})},e.prototype.above=function(t){return t==null?xe(this,Ke):new this.Collection(this,function(){return Ne(t,void 0,!0)})},e.prototype.aboveOrEqual=function(t){return t==null?xe(this,Ke):new this.Collection(this,function(){return Ne(t,void 0,!1)})},e.prototype.below=function(t){return t==null?xe(this,Ke):new this.Collection(this,function(){return Ne(void 0,t,!1,!0)})},e.prototype.belowOrEqual=function(t){return t==null?xe(this,Ke):new this.Collection(this,function(){return Ne(void 0,t)})},e.prototype.startsWith=function(t){return typeof t!="string"?xe(this,ei):this.between(t,t+tt,!0,!0)},e.prototype.startsWithIgnoreCase=function(t){return t===""?this.startsWith(t):sn(this,function(r,s){return r.indexOf(s[0])===0},[t],tt)},e.prototype.equalsIgnoreCase=function(t){return sn(this,function(r,s){return r===s[0]},[t],"")},e.prototype.anyOfIgnoreCase=function(){var t=De.apply(ct,arguments);return t.length===0?gt(this):sn(this,function(r,s){return s.indexOf(r)!==-1},t,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var t=De.apply(ct,arguments);return t.length===0?gt(this):sn(this,function(r,s){return s.some(function(u){return r.indexOf(u)===0})},t,tt)},e.prototype.anyOf=function(){var t=this,r=De.apply(ct,arguments),s=this._cmp;try{r.sort(s)}catch{return xe(this,Ke)}if(r.length===0)return gt(this);var u=new this.Collection(this,function(){return Ne(r[0],r[r.length-1])});u._ondirectionchange=function(h){s=h==="next"?t._ascending:t._descending,r.sort(s)};var c=0;return u._addAlgorithm(function(h,p,v){for(var g=h.key;s(g,r[c])>0;)if(++c,c===r.length)return p(v),!1;return s(g,r[c])===0?!0:(p(function(){h.continue(r[c])}),!1)}),u},e.prototype.notEqual=function(t){return this.inAnyRange([[Qn,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var t=De.apply(ct,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return xe(this,Ke)}var r=t.reduce(function(s,u){return s?s.concat([[s[s.length-1][1],u]]):[[Qn,u]]},null);return r.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(r,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(t,r){var s=this,u=this._cmp,c=this._ascending,h=this._descending,p=this._min,v=this._max;if(t.length===0)return gt(this);if(!t.every(function(C){return C[0]!==void 0&&C[1]!==void 0&&c(C[0],C[1])<=0}))return xe(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",H.InvalidArgument);var g=!r||r.includeLowers!==!1,_=r&&r.includeUppers===!0;function w(C,M){for(var N=0,F=C.length;N<F;++N){var Y=C[N];if(u(M[0],Y[1])<0&&u(M[1],Y[0])>0){Y[0]=p(Y[0],M[0]),Y[1]=v(Y[1],M[1]);break}}return N===F&&C.push(M),C}var k=c;function K(C,M){return k(C[0],M[0])}var x;try{x=t.reduce(w,[]),x.sort(K)}catch{return xe(this,Ke)}var S=0,I=_?function(C){return c(C,x[S][1])>0}:function(C){return c(C,x[S][1])>=0},A=g?function(C){return h(C,x[S][0])>0}:function(C){return h(C,x[S][0])>=0};function P(C){return!I(C)&&!A(C)}var T=I,R=new this.Collection(this,function(){return Ne(x[0][0],x[x.length-1][1],!g,!_)});return R._ondirectionchange=function(C){C==="next"?(T=I,k=c):(T=A,k=h),x.sort(K)},R._addAlgorithm(function(C,M,N){for(var F=C.key;T(F);)if(++S,S===x.length)return M(N),!1;return P(F)?!0:(s._cmp(F,x[S][1])===0||s._cmp(F,x[S][0])===0||M(function(){k===c?C.continue(x[S][0]):C.continue(x[S][1])}),!1)}),R},e.prototype.startsWithAnyOf=function(){var t=De.apply(ct,arguments);return t.every(function(r){return typeof r=="string"})?t.length===0?gt(this):this.inAnyRange(t.map(function(r){return[r,r+tt]})):xe(this,"startsWithAnyOf() only works with strings")},e}();function Gs(e){return Ct(li.prototype,function(r,s,u){if(this.db=e,this._ctx={table:r,index:s===":id"?null:s,or:u},this._cmp=this._ascending=te,this._descending=function(c,h){return te(h,c)},this._max=function(c,h){return te(c,h)>0?c:h},this._min=function(c,h){return te(c,h)<0?c:h},this._IDBKeyRange=e._deps.IDBKeyRange,!this._IDBKeyRange)throw new H.MissingAPI})}function Pe(e){return ue(function(t){return Tt(t),e(t.target.error),!1})}function Tt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var At="storagemutated",tr="x-storagemutated-1",Le=kt(null,At),Vs=function(){function e(){}return e.prototype._lock=function(){return oe(!G.global),++this._reculock,this._reculock===1&&!G.global&&(G.lockOwnerFor=this),this},e.prototype._unlock=function(){if(oe(!G.global),--this._reculock===0)for(G.global||(G.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{et(t[1],t[0])}catch{}}return this},e.prototype._locked=function(){return this._reculock&&G.lockOwnerFor!==this},e.prototype.create=function(t){var r=this;if(!this.mode)return this;var s=this.db.idbdb,u=this.db._state.dbOpenError;if(oe(!this.idbtrans),!t&&!s)switch(u&&u.name){case"DatabaseClosedError":throw new H.DatabaseClosed(u);case"MissingAPIError":throw new H.MissingAPI(u.message,u);default:throw new H.OpenFailed(u)}if(!this.active)throw new H.TransactionInactive;return oe(this._completion._state===null),t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):s.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),t.onerror=ue(function(c){Tt(c),r._reject(t.error)}),t.onabort=ue(function(c){Tt(c),r.active&&r._reject(new H.Abort(t.error)),r.active=!1,r.on("abort").fire(c)}),t.oncomplete=ue(function(){r.active=!1,r._resolve(),"mutatedParts"in t&&Le.storagemutated.fire(t.mutatedParts)}),this},e.prototype._promise=function(t,r,s){var u=this;if(t==="readwrite"&&this.mode!=="readwrite")return he(new H.ReadOnly("Transaction is readonly"));if(!this.active)return he(new H.TransactionInactive);if(this._locked())return new z(function(h,p){u._blockedFuncs.push([function(){u._promise(t,r,s).then(h,p)},G])});if(s)return je(function(){var h=new z(function(p,v){u._lock();var g=r(p,v,u);g&&g.then&&g.then(p,v)});return h.finally(function(){return u._unlock()}),h._lib=!0,h});var c=new z(function(h,p){var v=r(h,p,u);v&&v.then&&v.then(h,p)});return c._lib=!0,c},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(t){var r=this._root(),s=z.resolve(t);if(r._waitingFor)r._waitingFor=r._waitingFor.then(function(){return s});else{r._waitingFor=s,r._waitingQueue=[];var u=r.idbtrans.objectStore(r.storeNames[0]);(function h(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(u.get(-1/0).onsuccess=h)})()}var c=r._waitingFor;return new z(function(h,p){s.then(function(v){return r._waitingQueue.push(ue(h.bind(null,v)))},function(v){return r._waitingQueue.push(ue(p.bind(null,v)))}).finally(function(){r._waitingFor===c&&(r._waitingFor=null)})})},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new H.Abort))},e.prototype.table=function(t){var r=this._memoizedTables||(this._memoizedTables={});if(E(r,t))return r[t];var s=this.schema[t];if(!s)throw new H.NotFound("Table "+t+" not part of transaction");var u=new this.db.Table(t,s,this);return u.core=this.db.core.table(t),r[t]=u,u},e}();function $s(e){return Ct(Vs.prototype,function(r,s,u,c,h){var p=this;this.db=e,this.mode=r,this.storeNames=s,this.schema=u,this.chromeTransactionDurability=c,this.idbtrans=null,this.on=kt(this,"complete","error","abort"),this.parent=h||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new z(function(v,g){p._resolve=v,p._reject=g}),this._completion.then(function(){p.active=!1,p.on.complete.fire()},function(v){var g=p.active;return p.active=!1,p.on.error.fire(v),p.parent?p.parent._reject(v):g&&p.idbtrans&&p.idbtrans.abort(),he(v)})})}function nr(e,t,r,s,u,c,h){return{name:e,keyPath:t,unique:r,multi:s,auto:u,compound:c,src:(r&&!h?"&":"")+(s?"*":"")+(u?"++":"")+ci(t)}}function ci(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function rr(e,t,r){return{name:e,primKey:t,indexes:r,mappedClass:null,idxByName:le(r,function(s){return[s.name,s]})}}function Ws(e){return e.length===1?e[0]:e}var Ot=function(e){try{return e.only([[]]),Ot=function(){return[[]]},[[]]}catch{return Ot=function(){return tt},tt}};function ir(e){return e==null?function(){}:typeof e=="string"?Hs(e):function(t){return de(t,e)}}function Hs(e){var t=e.split(".");return t.length===1?function(r){return r[e]}:function(r){return de(r,e)}}function fi(e){return[].slice.call(e)}var Ys=0;function Rt(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function Qs(e,t,r){function s(w,k){var K=fi(w.objectStoreNames);return{schema:{name:w.name,tables:K.map(function(x){return k.objectStore(x)}).map(function(x){var S=x.keyPath,I=x.autoIncrement,A=d(S),P=S==null,T={},R={name:x.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:P,compound:A,keyPath:S,autoIncrement:I,unique:!0,extractKey:ir(S)},indexes:fi(x.indexNames).map(function(C){return x.index(C)}).map(function(C){var M=C.name,N=C.unique,F=C.multiEntry,Y=C.keyPath,ee=d(Y),L={name:M,compound:ee,keyPath:Y,unique:N,multiEntry:F,extractKey:ir(Y)};return T[Rt(Y)]=L,L}),getIndexByKeyPath:function(C){return T[Rt(C)]}};return T[":id"]=R.primaryKey,S!=null&&(T[Rt(S)]=R.primaryKey),R})},hasGetAll:K.length>0&&"getAll"in k.objectStore(K[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function u(w){if(w.type===3)return null;if(w.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var k=w.lower,K=w.upper,x=w.lowerOpen,S=w.upperOpen,I=k===void 0?K===void 0?null:t.upperBound(K,!!S):K===void 0?t.lowerBound(k,!!x):t.bound(k,K,!!x,!!S);return I}function c(w){var k=w.name;function K(I){var A=I.trans,P=I.type,T=I.keys,R=I.values,C=I.range;return new Promise(function(M,N){M=ue(M);var F=A.objectStore(k),Y=F.keyPath==null,ee=P==="put"||P==="add";if(!ee&&P!=="delete"&&P!=="deleteRange")throw new Error("Invalid operation type: "+P);var L=(T||R||{length:1}).length;if(T&&R&&T.length!==R.length)throw new Error("Given keys array must have same length as given values array.");if(L===0)return M({numFailures:0,failures:{},results:[],lastResult:void 0});var q,Q=[],re=[],W=0,ce=function(Ae){++W,Tt(Ae)};if(P==="deleteRange"){if(C.type===4)return M({numFailures:W,failures:re,results:[],lastResult:void 0});C.type===3?Q.push(q=F.clear()):Q.push(q=F.delete(u(C)))}else{var ge=ee?Y?[R,T]:[R,null]:[T,null],Te=ge[0],be=ge[1];if(ee)for(var _e=0;_e<L;++_e)Q.push(q=be&&be[_e]!==void 0?F[P](Te[_e],be[_e]):F[P](Te[_e])),q.onerror=ce;else for(var _e=0;_e<L;++_e)Q.push(q=F[P](Te[_e])),q.onerror=ce}var Ve=function(Ae){var Bt=Ae.target.result;Q.forEach(function(Ee,yn){return Ee.error!=null&&(re[yn]=Ee.error)}),M({numFailures:W,failures:re,results:P==="delete"?T:Q.map(function(Ee){return Ee.result}),lastResult:Bt})};q.onerror=function(Ae){ce(Ae),Ve(Ae)},q.onsuccess=Ve})}function x(I){var A=I.trans,P=I.values,T=I.query,R=I.reverse,C=I.unique;return new Promise(function(M,N){M=ue(M);var F=T.index,Y=T.range,ee=A.objectStore(k),L=F.isPrimaryKey?ee:ee.index(F.name),q=R?C?"prevunique":"prev":C?"nextunique":"next",Q=P||!("openKeyCursor"in L)?L.openCursor(u(Y),q):L.openKeyCursor(u(Y),q);Q.onerror=Pe(N),Q.onsuccess=ue(function(re){var W=Q.result;if(!W){M(null);return}W.___id=++Ys,W.done=!1;var ce=W.continue.bind(W),ge=W.continuePrimaryKey;ge&&(ge=ge.bind(W));var Te=W.advance.bind(W),be=function(){throw new Error("Cursor not started")},_e=function(){throw new Error("Cursor not stopped")};W.trans=A,W.stop=W.continue=W.continuePrimaryKey=W.advance=be,W.fail=ue(N),W.next=function(){var Ve=this,Ae=1;return this.start(function(){return Ae--?Ve.continue():Ve.stop()}).then(function(){return Ve})},W.start=function(Ve){var Ae=new Promise(function(Ee,yn){Ee=ue(Ee),Q.onerror=Pe(yn),W.fail=yn,W.stop=function(jo){W.stop=W.continue=W.continuePrimaryKey=W.advance=_e,Ee(jo)}}),Bt=function(){if(Q.result)try{Ve()}catch(Ee){W.fail(Ee)}else W.done=!0,W.start=function(){throw new Error("Cursor behind last entry")},W.stop()};return Q.onsuccess=ue(function(Ee){Q.onsuccess=Bt,Bt()}),W.continue=ce,W.continuePrimaryKey=ge,W.advance=Te,Bt(),Ae},M(W)},N)})}function S(I){return function(A){return new Promise(function(P,T){P=ue(P);var R=A.trans,C=A.values,M=A.limit,N=A.query,F=M===1/0?void 0:M,Y=N.index,ee=N.range,L=R.objectStore(k),q=Y.isPrimaryKey?L:L.index(Y.name),Q=u(ee);if(M===0)return P({result:[]});if(I){var re=C?q.getAll(Q,F):q.getAllKeys(Q,F);re.onsuccess=function(Te){return P({result:Te.target.result})},re.onerror=Pe(T)}else{var W=0,ce=C||!("openKeyCursor"in q)?q.openCursor(Q):q.openKeyCursor(Q),ge=[];ce.onsuccess=function(Te){var be=ce.result;if(!be)return P({result:ge});if(ge.push(C?be.value:be.primaryKey),++W===M)return P({result:ge});be.continue()},ce.onerror=Pe(T)}})}}return{name:k,schema:w,mutate:K,getMany:function(I){var A=I.trans,P=I.keys;return new Promise(function(T,R){T=ue(T);for(var C=A.objectStore(k),M=P.length,N=new Array(M),F=0,Y=0,ee,L=function(W){var ce=W.target;(N[ce._pos]=ce.result)!=null,++Y===F&&T(N)},q=Pe(R),Q=0;Q<M;++Q){var re=P[Q];re!=null&&(ee=C.get(P[Q]),ee._pos=Q,ee.onsuccess=L,ee.onerror=q,++F)}F===0&&T(N)})},get:function(I){var A=I.trans,P=I.key;return new Promise(function(T,R){T=ue(T);var C=A.objectStore(k),M=C.get(P);M.onsuccess=function(N){return T(N.target.result)},M.onerror=Pe(R)})},query:S(v),openCursor:x,count:function(I){var A=I.query,P=I.trans,T=A.index,R=A.range;return new Promise(function(C,M){var N=P.objectStore(k),F=T.isPrimaryKey?N:N.index(T.name),Y=u(R),ee=Y?F.count(Y):F.count();ee.onsuccess=ue(function(L){return C(L.target.result)}),ee.onerror=Pe(M)})}}}var h=s(e,r),p=h.schema,v=h.hasGetAll,g=p.tables.map(function(w){return c(w)}),_={};return g.forEach(function(w){return _[w.name]=w}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(w){var k=_[w];if(!k)throw new Error("Table '".concat(w,"' not found"));return _[w]},MIN_KEY:-1/0,MAX_KEY:Ot(t),schema:p}}function Js(e,t){return t.reduce(function(r,s){var u=s.create;return i(i({},r),u(r))},e)}function Xs(e,t,r,s){var u=r.IDBKeyRange;r.indexedDB;var c=Js(Qs(t,u,s),e.dbcore);return{dbcore:c}}function on(e,t){var r=t.db,s=Xs(e._middlewares,r,e._deps,t);e.core=s.dbcore,e.tables.forEach(function(u){var c=u.name;e.core.schema.tables.some(function(h){return h.name===c})&&(u.core=e.core.table(c),e[c]instanceof e.Table&&(e[c].core=u.core))})}function un(e,t,r,s){r.forEach(function(u){var c=s[u];t.forEach(function(h){var p=$(h,u);(!p||"value"in p&&p.value===void 0)&&(h===e.Transaction.prototype||h instanceof e.Transaction?j(h,u,{get:function(){return this.table(u)},set:function(v){D(this,u,{value:v,writable:!0,configurable:!0,enumerable:!0})}}):h[u]=new e.Table(u,c))})})}function sr(e,t){t.forEach(function(r){for(var s in r)r[s]instanceof e.Table&&delete r[s]})}function Zs(e,t){return e._cfg.version-t._cfg.version}function qs(e,t,r,s){var u=e._dbSchema;r.objectStoreNames.contains("$meta")&&!u.$meta&&(u.$meta=rr("$meta",di("")[0],[]),e._storeNames.push("$meta"));var c=e._createTransaction("readwrite",e._storeNames,u);c.create(r),c._completion.catch(s);var h=c._reject.bind(c),p=G.transless||G;je(function(){if(G.trans=c,G.transless=p,t===0)f(u).forEach(function(v){ur(r,v,u[v].primKey,u[v].indexes)}),on(e,r),z.follow(function(){return e.on.populate.fire(c)}).catch(h);else return on(e,r),to(e,c,t).then(function(v){return no(e,v,c,r)}).catch(h)})}function eo(e,t){hi(e._dbSchema,t),t.db.version%10===0&&!t.objectStoreNames.contains("$meta")&&t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var r=ln(e,e.idbdb,t);cn(e,e._dbSchema,t);for(var s=or(r,e._dbSchema),u=function(g){if(g.change.length||g.recreate)return console.warn("Unable to patch indexes of table ".concat(g.name," because it has changes on the type of index or primary key.")),{value:void 0};var _=t.objectStore(g.name);g.add.forEach(function(w){Ce&&console.debug("Dexie upgrade patch: Creating missing index ".concat(g.name,".").concat(w.src)),an(_,w)})},c=0,h=s.change;c<h.length;c++){var p=h[c],v=u(p);if(typeof v=="object")return v.value}}function to(e,t,r){return t.storeNames.includes("$meta")?t.table("$meta").get("version").then(function(s){return s??r}):z.resolve(r)}function no(e,t,r,s){var u=[],c=e._versions,h=e._dbSchema=ln(e,e.idbdb,s),p=c.filter(function(g){return g._cfg.version>=t});if(p.length===0)return z.resolve();p.forEach(function(g){u.push(function(){var _=h,w=g._cfg.dbschema;cn(e,_,s),cn(e,w,s),h=e._dbSchema=w;var k=or(_,w);k.add.forEach(function(P){ur(s,P[0],P[1].primKey,P[1].indexes)}),k.change.forEach(function(P){if(P.recreate)throw new H.Upgrade("Not yet support for changing primary key");var T=s.objectStore(P.name);P.add.forEach(function(R){return an(T,R)}),P.change.forEach(function(R){T.deleteIndex(R.name),an(T,R)}),P.del.forEach(function(R){return T.deleteIndex(R)})});var K=g._cfg.contentUpgrade;if(K&&g._cfg.version>t){on(e,s),r._memoizedTables={};var x=we(w);k.del.forEach(function(P){x[P]=_[P]}),sr(e,[e.Transaction.prototype]),un(e,[e.Transaction.prototype],f(x),x),r.schema=x;var S=Bn(K);S&&vt();var I,A=z.follow(function(){if(I=K(r),I&&S){var P=Fe.bind(null,null);I.then(P,P)}});return I&&typeof I.then=="function"?z.resolve(I):A.then(function(){return I})}}),u.push(function(_){var w=g._cfg.dbschema;ro(w,_),sr(e,[e.Transaction.prototype]),un(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),r.schema=e._dbSchema}),u.push(function(_){e.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(e.idbdb.version/10)===g._cfg.version?(e.idbdb.deleteObjectStore("$meta"),delete e._dbSchema.$meta,e._storeNames=e._storeNames.filter(function(w){return w!=="$meta"})):_.objectStore("$meta").put(g._cfg.version,"version"))})});function v(){return u.length?z.resolve(u.shift()(r.idbtrans)).then(v):z.resolve()}return v().then(function(){hi(h,s)})}function or(e,t){var r={del:[],add:[],change:[]},s;for(s in e)t[s]||r.del.push(s);for(s in t){var u=e[s],c=t[s];if(!u)r.add.push([s,c]);else{var h={name:s,def:c,recreate:!1,del:[],add:[],change:[]};if(""+(u.primKey.keyPath||"")!=""+(c.primKey.keyPath||"")||u.primKey.auto!==c.primKey.auto)h.recreate=!0,r.change.push(h);else{var p=u.idxByName,v=c.idxByName,g=void 0;for(g in p)v[g]||h.del.push(g);for(g in v){var _=p[g],w=v[g];_?_.src!==w.src&&h.change.push(w):h.add.push(w)}(h.del.length>0||h.add.length>0||h.change.length>0)&&r.change.push(h)}}}return r}function ur(e,t,r,s){var u=e.db.createObjectStore(t,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return s.forEach(function(c){return an(u,c)}),u}function hi(e,t){f(e).forEach(function(r){t.db.objectStoreNames.contains(r)||(Ce&&console.debug("Dexie: Creating missing table",r),ur(t,r,e[r].primKey,e[r].indexes))})}function ro(e,t){[].slice.call(t.db.objectStoreNames).forEach(function(r){return e[r]==null&&t.db.deleteObjectStore(r)})}function an(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function ln(e,t,r){var s={},u=J(t.objectStoreNames,0);return u.forEach(function(c){for(var h=r.objectStore(c),p=h.keyPath,v=nr(ci(p),p||"",!0,!1,!!h.autoIncrement,p&&typeof p!="string",!0),g=[],_=0;_<h.indexNames.length;++_){var w=h.index(h.indexNames[_]);p=w.keyPath;var k=nr(w.name,p,!!w.unique,!!w.multiEntry,!1,p&&typeof p!="string",!1);g.push(k)}s[c]=rr(c,v,g)}),s}function io(e,t,r){e.verno=t.version/10;var s=e._dbSchema=ln(e,t,r);e._storeNames=J(t.objectStoreNames,0),un(e,[e._allTables],f(s),s)}function so(e,t){var r=ln(e,e.idbdb,t),s=or(r,e._dbSchema);return!(s.add.length||s.change.some(function(u){return u.add.length||u.change.length}))}function cn(e,t,r){for(var s=r.db.objectStoreNames,u=0;u<s.length;++u){var c=s[u],h=r.objectStore(c);e._hasGetAll="getAll"in h;for(var p=0;p<h.indexNames.length;++p){var v=h.indexNames[p],g=h.index(v).keyPath,_=typeof g=="string"?g:"["+J(g).join("+")+"]";if(t[c]){var w=t[c].idxByName[_];w&&(w.name=v,delete t[c].idxByName[_],t[c].idxByName[v]=w)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&l.WorkerGlobalScope&&l instanceof l.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function di(e){return e.split(",").map(function(t,r){t=t.trim();var s=t.replace(/([&*]|\+\+)/g,""),u=/^\[/.test(s)?s.match(/^\[(.*)\]$/)[1].split("+"):s;return nr(s,u||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),d(u),r===0)})}var oo=function(){function e(){}return e.prototype._parseStoresSpec=function(t,r){f(t).forEach(function(s){if(t[s]!==null){var u=di(t[s]),c=u.shift();if(c.unique=!0,c.multi)throw new H.Schema("Primary key cannot be multi-valued");u.forEach(function(h){if(h.auto)throw new H.Schema("Only primary key can be marked as autoIncrement (++)");if(!h.keyPath)throw new H.Schema("Index must have a name and cannot be an empty string")}),r[s]=rr(s,c,u)}})},e.prototype.stores=function(t){var r=this.db;this._cfg.storesSource=this._cfg.storesSource?m(this._cfg.storesSource,t):t;var s=r._versions,u={},c={};return s.forEach(function(h){m(u,h._cfg.storesSource),c=h._cfg.dbschema={},h._parseStoresSpec(u,c)}),r._dbSchema=c,sr(r,[r._allTables,r,r.Transaction.prototype]),un(r,[r._allTables,r,r.Transaction.prototype,this._cfg.tables],f(c),c),r._storeNames=f(c),this},e.prototype.upgrade=function(t){return this._cfg.contentUpgrade=Fn(this._cfg.contentUpgrade||se,t),this},e}();function uo(e){return Ct(oo.prototype,function(r){this.db=e,this._cfg={version:r,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function ar(e,t){var r=e._dbNamesDB;return r||(r=e._dbNamesDB=new Be(en,{addons:[],indexedDB:e,IDBKeyRange:t}),r.version(1).stores({dbnames:"name"})),r.table("dbnames")}function lr(e){return e&&typeof e.databases=="function"}function ao(e){var t=e.indexedDB,r=e.IDBKeyRange;return lr(t)?Promise.resolve(t.databases()).then(function(s){return s.map(function(u){return u.name}).filter(function(u){return u!==en})}):ar(t,r).toCollection().primaryKeys()}function lo(e,t){var r=e.indexedDB,s=e.IDBKeyRange;!lr(r)&&t!==en&&ar(r,s).put({name:t}).catch(se)}function co(e,t){var r=e.indexedDB,s=e.IDBKeyRange;!lr(r)&&t!==en&&ar(r,s).delete(t).catch(se)}function cr(e){return je(function(){return G.letThrough=!0,e()})}function fo(){var e=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!e||!indexedDB.databases)return Promise.resolve();var t;return new Promise(function(r){var s=function(){return indexedDB.databases().finally(r)};t=setInterval(s,100),s()}).finally(function(){return clearInterval(t)})}var fr;function hr(e){return!("from"in e)}var ye=function(e,t){if(this)m(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0});else{var r=new ye;return e&&"d"in e&&m(r,e),r}};O(ye.prototype,(fr={add:function(e){return Kt(this,e),this},addKey:function(e){return Dt(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(r){return Dt(t,r,r)}),this},hasKey:function(e){var t=fn(this).next(e).value;return t&&te(t.from,e)<=0&&te(t.to,e)>=0}},fr[Kn]=function(){return fn(this)},fr));function Dt(e,t,r){var s=te(t,r);if(!isNaN(s)){if(s>0)throw RangeError();if(hr(e))return m(e,{from:t,to:r,d:1});var u=e.l,c=e.r;if(te(r,e.from)<0)return u?Dt(u,t,r):e.l={from:t,to:r,d:1,l:null,r:null},vi(e);if(te(t,e.to)>0)return c?Dt(c,t,r):e.r={from:t,to:r,d:1,l:null,r:null},vi(e);te(t,e.from)<0&&(e.from=t,e.l=null,e.d=c?c.d+1:1),te(r,e.to)>0&&(e.to=r,e.r=null,e.d=e.l?e.l.d+1:1);var h=!e.r;u&&!e.l&&Kt(e,u),c&&h&&Kt(e,c)}}function Kt(e,t){function r(s,u){var c=u.from,h=u.to,p=u.l,v=u.r;Dt(s,c,h),p&&r(s,p),v&&r(s,v)}hr(t)||r(e,t)}function pi(e,t){var r=fn(t),s=r.next();if(s.done)return!1;for(var u=s.value,c=fn(e),h=c.next(u.from),p=h.value;!s.done&&!h.done;){if(te(p.from,u.to)<=0&&te(p.to,u.from)>=0)return!0;te(u.from,p.from)<0?u=(s=r.next(p.from)).value:p=(h=c.next(u.from)).value}return!1}function fn(e){var t=hr(e)?null:{s:0,n:e};return{next:function(r){for(var s=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,s)for(;t.n.l&&te(r,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!s||te(r,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function vi(e){var t,r,s=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((r=e.l)===null||r===void 0?void 0:r.d)||0),u=s>1?"r":s<-1?"l":"";if(u){var c=u==="r"?"l":"r",h=i({},e),p=e[u];e.from=p.from,e.to=p.to,e[u]=p[u],h[u]=p[c],e[c]=h,h.d=mi(h)}e.d=mi(e)}function mi(e){var t=e.r,r=e.l;return(t?r?Math.max(t.d,r.d):t.d:r?r.d:0)+1}function hn(e,t){return f(t).forEach(function(r){e[r]?Kt(e[r],t[r]):e[r]=Nr(t[r])}),e}function dr(e,t){return e.all||t.all||Object.keys(e).some(function(r){return t[r]&&pi(t[r],e[r])})}var rt={},pr={},vr=!1;function dn(e,t){hn(pr,e),vr||(vr=!0,setTimeout(function(){vr=!1;var r=pr;pr={},mr(r,!1)},0))}function mr(e,t){t===void 0&&(t=!1);var r=new Set;if(e.all)for(var s=0,u=Object.values(rt);s<u.length;s++){var c=u[s];yi(c,e,r,t)}else for(var h in e){var p=/^idb\:\/\/(.*)\/(.*)\//.exec(h);if(p){var v=p[1],g=p[2],c=rt["idb://".concat(v,"/").concat(g)];c&&yi(c,e,r,t)}}r.forEach(function(_){return _()})}function yi(e,t,r,s){for(var u=[],c=0,h=Object.entries(e.queries.query);c<h.length;c++){for(var p=h[c],v=p[0],g=p[1],_=[],w=0,k=g;w<k.length;w++){var K=k[w];dr(t,K.obsSet)?K.subscribers.forEach(function(A){return r.add(A)}):s&&_.push(K)}s&&u.push([v,_])}if(s)for(var x=0,S=u;x<S.length;x++){var I=S[x],v=I[0],_=I[1];e.queries.query[v]=_}}function ho(e){var t=e._state,r=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?he(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var s=t.openCanceller,u=Math.round(e.verno*10),c=!1;function h(){if(t.openCanceller!==s)throw new H.DatabaseClosed("db.open() was cancelled")}var p=t.dbReadyResolve,v=null,g=!1,_=function(){return new z(function(w,k){if(h(),!r)throw new H.MissingAPI;var K=e.name,x=t.autoSchema||!u?r.open(K):r.open(K,u);if(!x)throw new H.MissingAPI;x.onerror=Pe(k),x.onblocked=ue(e._fireOnBlocked),x.onupgradeneeded=ue(function(S){if(v=x.transaction,t.autoSchema&&!e._options.allowEmptyDB){x.onerror=Tt,v.abort(),x.result.close();var I=r.deleteDatabase(K);I.onsuccess=I.onerror=ue(function(){k(new H.NoSuchDatabase("Database ".concat(K," doesnt exist")))})}else{v.onerror=Pe(k);var A=S.oldVersion>Math.pow(2,62)?0:S.oldVersion;g=A<1,e.idbdb=x.result,c&&eo(e,v),qs(e,A/10,v,k)}},k),x.onsuccess=ue(function(){v=null;var S=e.idbdb=x.result,I=J(S.objectStoreNames);if(I.length>0)try{var A=S.transaction(Ws(I),"readonly");if(t.autoSchema)io(e,S,A);else if(cn(e,e._dbSchema,A),!so(e,A)&&!c)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),S.close(),u=S.version+1,c=!0,w(_());on(e,A)}catch{}mt.push(e),S.onversionchange=ue(function(P){t.vcFired=!0,e.on("versionchange").fire(P)}),S.onclose=ue(function(P){e.on("close").fire(P)}),g&&lo(e._deps,K),w()},k)}).catch(function(w){switch(w?.name){case"UnknownError":if(t.PR1398_maxLoop>0)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),_();break;case"VersionError":if(u>0)return u=0,_();break}return z.reject(w)})};return z.race([s,(typeof navigator>"u"?z.resolve():fo()).then(_)]).then(function(){return h(),t.onReadyBeingFired=[],z.resolve(cr(function(){return e.on.ready.fire(e.vip)})).then(function w(){if(t.onReadyBeingFired.length>0){var k=t.onReadyBeingFired.reduce(Fn,se);return t.onReadyBeingFired=[],z.resolve(cr(function(){return k(e.vip)})).then(w)}})}).finally(function(){t.openCanceller===s&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(w){t.dbOpenError=w;try{v&&v.abort()}catch{}return s===t.openCanceller&&e._close(),he(w)}).finally(function(){t.openComplete=!0,p()}).then(function(){if(g){var w={};e.tables.forEach(function(k){k.schema.indexes.forEach(function(K){K.name&&(w["idb://".concat(e.name,"/").concat(k.name,"/").concat(K.name)]=new ye(-1/0,[[[]]]))}),w["idb://".concat(e.name,"/").concat(k.name,"/")]=w["idb://".concat(e.name,"/").concat(k.name,"/:dels")]=new ye(-1/0,[[[]]])}),Le(At).fire(w),mr(w,!0)}return e})}function yr(e){var t=function(h){return e.next(h)},r=function(h){return e.throw(h)},s=c(t),u=c(r);function c(h){return function(p){var v=h(p),g=v.value;return v.done?g:!g||typeof g.then!="function"?d(g)?Promise.all(g).then(s,u):s(g):g.then(s,u)}}return c(t)()}function po(e,t,r){var s=arguments.length;if(s<2)throw new H.InvalidArgument("Too few arguments");for(var u=new Array(s-1);--s;)u[s-1]=arguments[s];r=u.pop();var c=Fr(u);return[e,c,r]}function gi(e,t,r,s,u){return z.resolve().then(function(){var c=G.transless||G,h=e._createTransaction(t,r,e._dbSchema,s);h.explicit=!0;var p={trans:h,transless:c};if(s)h.idbtrans=s.idbtrans;else try{h.create(),h.idbtrans._explicit=!0,e._state.PR1398_maxLoop=3}catch(w){return w.name===jn.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return gi(e,t,r,null,u)})):he(w)}var v=Bn(u);v&&vt();var g,_=z.follow(function(){if(g=u.call(h,h),g)if(v){var w=Fe.bind(null,null);g.then(w,w)}else typeof g.next=="function"&&typeof g.throw=="function"&&(g=yr(g))},p);return(g&&typeof g.then=="function"?z.resolve(g).then(function(w){return h.active?w:he(new H.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):_.then(function(){return g})).then(function(w){return s&&h._resolve(),h._completion.then(function(){return w})}).catch(function(w){return h._reject(w),he(w)})})}function pn(e,t,r){for(var s=d(e)?e.slice():[e],u=0;u<r;++u)s.push(t);return s}function vo(e){return i(i({},e),{table:function(t){var r=e.table(t),s=r.schema,u={},c=[];function h(S,I,A){var P=Rt(S),T=u[P]=u[P]||[],R=S==null?0:typeof S=="string"?1:S.length,C=I>0,M=i(i({},A),{name:C?"".concat(P,"(virtual-from:").concat(A.name,")"):A.name,lowLevelIndex:A,isVirtual:C,keyTail:I,keyLength:R,extractKey:ir(S),unique:!C&&A.unique});if(T.push(M),M.isPrimaryKey||c.push(M),R>1){var N=R===2?S[0]:S.slice(0,R-1);h(N,I+1,A)}return T.sort(function(F,Y){return F.keyTail-Y.keyTail}),M}var p=h(s.primaryKey.keyPath,0,s.primaryKey);u[":id"]=[p];for(var v=0,g=s.indexes;v<g.length;v++){var _=g[v];h(_.keyPath,0,_)}function w(S){var I=u[Rt(S)];return I&&I[0]}function k(S,I){return{type:S.type===1?2:S.type,lower:pn(S.lower,S.lowerOpen?e.MAX_KEY:e.MIN_KEY,I),lowerOpen:!0,upper:pn(S.upper,S.upperOpen?e.MIN_KEY:e.MAX_KEY,I),upperOpen:!0}}function K(S){var I=S.query.index;return I.isVirtual?i(i({},S),{query:{index:I.lowLevelIndex,range:k(S.query.range,I.keyTail)}}):S}var x=i(i({},r),{schema:i(i({},s),{primaryKey:p,indexes:c,getIndexByKeyPath:w}),count:function(S){return r.count(K(S))},query:function(S){return r.query(K(S))},openCursor:function(S){var I=S.query.index,A=I.keyTail,P=I.isVirtual,T=I.keyLength;if(!P)return r.openCursor(S);function R(C){function M(F){F!=null?C.continue(pn(F,S.reverse?e.MAX_KEY:e.MIN_KEY,A)):S.unique?C.continue(C.key.slice(0,T).concat(S.reverse?e.MIN_KEY:e.MAX_KEY,A)):C.continue()}var N=Object.create(C,{continue:{value:M},continuePrimaryKey:{value:function(F,Y){C.continuePrimaryKey(pn(F,e.MAX_KEY,A),Y)}},primaryKey:{get:function(){return C.primaryKey}},key:{get:function(){var F=C.key;return T===1?F[0]:F.slice(0,T)}},value:{get:function(){return C.value}}});return N}return r.openCursor(K(S)).then(function(C){return C&&R(C)})}});return x}})}var mo={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:vo};function gr(e,t,r,s){return r=r||{},s=s||"",f(e).forEach(function(u){if(!E(t,u))r[s+u]=void 0;else{var c=e[u],h=t[u];if(typeof c=="object"&&typeof h=="object"&&c&&h){var p=Dn(c),v=Dn(h);p!==v?r[s+u]=t[u]:p==="Object"?gr(c,h,r,s+u+"."):c!==h&&(r[s+u]=t[u])}else c!==h&&(r[s+u]=t[u])}}),f(t).forEach(function(u){E(e,u)||(r[s+u]=t[u])}),r}function wr(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var yo={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return i(i({},e),{table:function(t){var r=e.table(t),s=r.schema.primaryKey,u=i(i({},r),{mutate:function(c){var h=G.trans,p=h.table(t).hook,v=p.deleting,g=p.creating,_=p.updating;switch(c.type){case"add":if(g.fire===se)break;return h._promise("readwrite",function(){return w(c)},!0);case"put":if(g.fire===se&&_.fire===se)break;return h._promise("readwrite",function(){return w(c)},!0);case"delete":if(v.fire===se)break;return h._promise("readwrite",function(){return w(c)},!0);case"deleteRange":if(v.fire===se)break;return h._promise("readwrite",function(){return k(c)},!0)}return r.mutate(c);function w(x){var S=G.trans,I=x.keys||wr(s,x);if(!I)throw new Error("Keys missing");return x=x.type==="add"||x.type==="put"?i(i({},x),{keys:I}):i({},x),x.type!=="delete"&&(x.values=a([],x.values,!0)),x.keys&&(x.keys=a([],x.keys,!0)),go(r,x,I).then(function(A){var P=I.map(function(T,R){var C=A[R],M={onerror:null,onsuccess:null};if(x.type==="delete")v.fire.call(M,T,C,S);else if(x.type==="add"||C===void 0){var N=g.fire.call(M,T,x.values[R],S);T==null&&N!=null&&(T=N,x.keys[R]=T,s.outbound||ie(x.values[R],s.keyPath,T))}else{var F=gr(C,x.values[R]),Y=_.fire.call(M,F,T,C,S);if(Y){var ee=x.values[R];Object.keys(Y).forEach(function(L){E(ee,L)?ee[L]=Y[L]:ie(ee,L,Y[L])})}}return M});return r.mutate(x).then(function(T){for(var R=T.failures,C=T.results,M=T.numFailures,N=T.lastResult,F=0;F<I.length;++F){var Y=C?C[F]:I[F],ee=P[F];Y==null?ee.onerror&&ee.onerror(R[F]):ee.onsuccess&&ee.onsuccess(x.type==="put"&&A[F]?x.values[F]:Y)}return{failures:R,results:C,numFailures:M,lastResult:N}}).catch(function(T){return P.forEach(function(R){return R.onerror&&R.onerror(T)}),Promise.reject(T)})})}function k(x){return K(x.trans,x.range,1e4)}function K(x,S,I){return r.query({trans:x,values:!1,query:{index:s,range:S},limit:I}).then(function(A){var P=A.result;return w({type:"delete",keys:P,trans:x}).then(function(T){return T.numFailures>0?Promise.reject(T.failures[0]):P.length<I?{failures:[],numFailures:0,lastResult:void 0}:K(x,i(i({},S),{lower:P[P.length-1],lowerOpen:!0}),I)})})}}});return u}})}};function go(e,t,r){return t.type==="add"?Promise.resolve([]):e.getMany({trans:t.trans,keys:r,cache:"immutable"})}function wi(e,t,r){try{if(!t||t.keys.length<e.length)return null;for(var s=[],u=0,c=0;u<t.keys.length&&c<e.length;++u)te(t.keys[u],e[c])===0&&(s.push(r?Ye(t.values[u]):t.values[u]),++c);return s.length===e.length?s:null}catch{return null}}var wo={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var r=e.table(t);return i(i({},r),{getMany:function(s){if(!s.cache)return r.getMany(s);var u=wi(s.keys,s.trans._cache,s.cache==="clone");return u?z.resolve(u):r.getMany(s).then(function(c){return s.trans._cache={keys:s.keys,values:s.cache==="clone"?Ye(c):c},c})},mutate:function(s){return s.type!=="add"&&(s.trans._cache=null),r.mutate(s)}})}}}};function bi(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function xi(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":return!1;case"getMany":return!1;case"count":return!1;case"openCursor":return!1}}var bo={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,r=new ye(e.MIN_KEY,e.MAX_KEY);return i(i({},e),{transaction:function(s,u,c){if(G.subscr&&u!=="readonly")throw new H.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(G.querier));return e.transaction(s,u,c)},table:function(s){var u=e.table(s),c=u.schema,h=c.primaryKey,p=c.indexes,v=h.extractKey,g=h.outbound,_=h.autoIncrement&&p.filter(function(x){return x.compound&&x.keyPath.includes(h.keyPath)}),w=i(i({},u),{mutate:function(x){var S,I,A=x.trans,P=x.mutatedParts||(x.mutatedParts={}),T=function(Q){var re="idb://".concat(t,"/").concat(s,"/").concat(Q);return P[re]||(P[re]=new ye)},R=T(""),C=T(":dels"),M=x.type,N=x.type==="deleteRange"?[x.range]:x.type==="delete"?[x.keys]:x.values.length<50?[wr(h,x).filter(function(Q){return Q}),x.values]:[],F=N[0],Y=N[1],ee=x.trans._cache;if(d(F)){R.addKeys(F);var L=M==="delete"||F.length===Y.length?wi(F,ee):null;L||C.addKeys(F),(L||Y)&&xo(T,c,L,Y)}else if(F){var q={from:(S=F.lower)!==null&&S!==void 0?S:e.MIN_KEY,to:(I=F.upper)!==null&&I!==void 0?I:e.MAX_KEY};C.add(q),R.add(q)}else R.add(r),C.add(r),c.indexes.forEach(function(Q){return T(Q.name).add(r)});return u.mutate(x).then(function(Q){return F&&(x.type==="add"||x.type==="put")&&(R.addKeys(Q.results),_&&_.forEach(function(re){for(var W=x.values.map(function(be){return re.extractKey(be)}),ce=re.keyPath.findIndex(function(be){return be===h.keyPath}),ge=0,Te=Q.results.length;ge<Te;++ge)W[ge][ce]=Q.results[ge];T(re.name).addKeys(W)})),A.mutatedParts=hn(A.mutatedParts||{},P),Q})}}),k=function(x){var S,I,A=x.query,P=A.index,T=A.range;return[P,new ye((S=T.lower)!==null&&S!==void 0?S:e.MIN_KEY,(I=T.upper)!==null&&I!==void 0?I:e.MAX_KEY)]},K={get:function(x){return[h,new ye(x.key)]},getMany:function(x){return[h,new ye().addKeys(x.keys)]},count:k,query:k,openCursor:k};return f(K).forEach(function(x){w[x]=function(S){var I=G.subscr,A=!!I,P=bi(G,u)&&xi(x,S),T=P?S.obsSet={}:I;if(A){var R=function(L){var q="idb://".concat(t,"/").concat(s,"/").concat(L);return T[q]||(T[q]=new ye)},C=R(""),M=R(":dels"),N=K[x](S),F=N[0],Y=N[1];if(x==="query"&&F.isPrimaryKey&&!S.values?M.add(Y):R(F.name||"").add(Y),!F.isPrimaryKey)if(x==="count")M.add(r);else{var ee=x==="query"&&g&&S.values&&u.query(i(i({},S),{values:!1}));return u[x].apply(this,arguments).then(function(L){if(x==="query"){if(g&&S.values)return ee.then(function(W){var ce=W.result;return C.addKeys(ce),L});var q=S.values?L.result.map(v):L.result;S.values?C.addKeys(q):M.addKeys(q)}else if(x==="openCursor"){var Q=L,re=S.values;return Q&&Object.create(Q,{key:{get:function(){return M.addKey(Q.primaryKey),Q.key}},primaryKey:{get:function(){var W=Q.primaryKey;return M.addKey(W),W}},value:{get:function(){return re&&C.addKey(Q.primaryKey),Q.value}}})}return L})}}return u[x].apply(this,arguments)}}),w}})}};function xo(e,t,r,s){function u(c){var h=e(c.name||"");function p(g){return g!=null?c.extractKey(g):null}var v=function(g){return c.multiEntry&&d(g)?g.forEach(function(_){return h.addKey(_)}):h.addKey(g)};(r||s).forEach(function(g,_){var w=r&&p(r[_]),k=s&&p(s[_]);te(w,k)!==0&&(w!=null&&v(w),k!=null&&v(k))})}t.indexes.forEach(u)}function _i(e,t,r){if(r.numFailures===0)return t;if(t.type==="deleteRange")return null;var s=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;if(r.numFailures===s)return null;var u=i({},t);return d(u.keys)&&(u.keys=u.keys.filter(function(c,h){return!(h in r.failures)})),"values"in u&&d(u.values)&&(u.values=u.values.filter(function(c,h){return!(h in r.failures)})),u}function _o(e,t){return t.lower===void 0?!0:t.lowerOpen?te(e,t.lower)>0:te(e,t.lower)>=0}function Eo(e,t){return t.upper===void 0?!0:t.upperOpen?te(e,t.upper)<0:te(e,t.upper)<=0}function br(e,t){return _o(e,t)&&Eo(e,t)}function Ei(e,t,r,s,u,c){if(!r||r.length===0)return e;var h=t.query.index,p=h.multiEntry,v=t.query.range,g=s.schema.primaryKey,_=g.extractKey,w=h.extractKey,k=(h.lowLevelIndex||h).extractKey,K=r.reduce(function(x,S){var I=x,A=[];if(S.type==="add"||S.type==="put")for(var P=new ye,T=S.values.length-1;T>=0;--T){var R=S.values[T],C=_(R);if(!P.hasKey(C)){var M=w(R);(p&&d(M)?M.some(function(L){return br(L,v)}):br(M,v))&&(P.addKey(C),A.push(R))}}switch(S.type){case"add":{var N=new ye().addKeys(t.values?x.map(function(L){return _(L)}):x);I=x.concat(t.values?A.filter(function(L){var q=_(L);return N.hasKey(q)?!1:(N.addKey(q),!0)}):A.map(function(L){return _(L)}).filter(function(L){return N.hasKey(L)?!1:(N.addKey(L),!0)}));break}case"put":{var F=new ye().addKeys(S.values.map(function(L){return _(L)}));I=x.filter(function(L){return!F.hasKey(t.values?_(L):L)}).concat(t.values?A:A.map(function(L){return _(L)}));break}case"delete":var Y=new ye().addKeys(S.keys);I=x.filter(function(L){return!Y.hasKey(t.values?_(L):L)});break;case"deleteRange":var ee=S.range;I=x.filter(function(L){return!br(_(L),ee)});break}return I},e);return K===e?e:(K.sort(function(x,S){return te(k(x),k(S))||te(_(x),_(S))}),t.limit&&t.limit<1/0&&(K.length>t.limit?K.length=t.limit:e.length===t.limit&&K.length<t.limit&&(u.dirty=!0)),c?Object.freeze(K):K)}function Si(e,t){return te(e.lower,t.lower)===0&&te(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function So(e,t,r,s){if(e===void 0)return t!==void 0?-1:0;if(t===void 0)return 1;var u=te(e,t);if(u===0){if(r&&s)return 0;if(r)return 1;if(s)return-1}return u}function Io(e,t,r,s){if(e===void 0)return t!==void 0?1:0;if(t===void 0)return-1;var u=te(e,t);if(u===0){if(r&&s)return 0;if(r)return-1;if(s)return 1}return u}function ko(e,t){return So(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&Io(e.upper,t.upper,e.upperOpen,t.upperOpen)>=0}function Co(e,t,r,s){var u=rt["idb://".concat(e,"/").concat(t)];if(!u)return[];var c=u.queries[r];if(!c)return[null,!1,u,null];var h=s.query?s.query.index.name:null,p=c[h||""];if(!p)return[null,!1,u,null];switch(r){case"query":var v=p.find(function(w){return w.req.limit===s.limit&&w.req.values===s.values&&Si(w.req.query.range,s.query.range)});if(v)return[v,!0,u,p];var g=p.find(function(w){var k="limit"in w.req?w.req.limit:1/0;return k>=s.limit&&(s.values?w.req.values:!0)&&ko(w.req.query.range,s.query.range)});return[g,!1,u,p];case"count":var _=p.find(function(w){return Si(w.req.query.range,s.query.range)});return[_,!!_,u,p]}}function Po(e,t,r,s){e.subscribers.add(r),s.addEventListener("abort",function(){e.subscribers.delete(r),e.subscribers.size===0&&To(e,t)})}function To(e,t){setTimeout(function(){e.subscribers.size===0&&Qe(t,e)},3e3)}var Ao={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name,r=i(i({},e),{transaction:function(s,u,c){var h=e.transaction(s,u,c);if(u==="readwrite"){var p=new AbortController,v=p.signal,g=function(_){return function(){if(p.abort(),u==="readwrite"){for(var w=new Set,k=0,K=s;k<K.length;k++){var x=K[k],S=rt["idb://".concat(t,"/").concat(x)];if(S){var I=e.table(x),A=S.optimisticOps.filter(function(re){return re.trans===h});if(h._explicit&&_&&h.mutatedParts)for(var P=0,T=Object.values(S.queries.query);P<T.length;P++)for(var R=T[P],C=0,M=R.slice();C<M.length;C++){var N=M[C];dr(N.obsSet,h.mutatedParts)&&(Qe(R,N),N.subscribers.forEach(function(re){return w.add(re)}))}else if(A.length>0){S.optimisticOps=S.optimisticOps.filter(function(re){return re.trans!==h});for(var F=0,Y=Object.values(S.queries.query);F<Y.length;F++)for(var R=Y[F],ee=0,L=R.slice();ee<L.length;ee++){var N=L[ee];if(N.res!=null&&h.mutatedParts)if(_&&!N.dirty){var q=Object.isFrozen(N.res),Q=Ei(N.res,N.req,A,I,N,q);N.dirty?(Qe(R,N),N.subscribers.forEach(function(ce){return w.add(ce)})):Q!==N.res&&(N.res=Q,N.promise=z.resolve({result:Q}))}else N.dirty&&Qe(R,N),N.subscribers.forEach(function(ce){return w.add(ce)})}}}}w.forEach(function(re){return re()})}}};h.addEventListener("abort",g(!1),{signal:v}),h.addEventListener("error",g(!1),{signal:v}),h.addEventListener("complete",g(!0),{signal:v})}return h},table:function(s){var u=e.table(s),c=u.schema.primaryKey,h=i(i({},u),{mutate:function(p){var v=G.trans;if(c.outbound||v.db._options.cache==="disabled"||v.explicit||v.idbtrans.mode!=="readwrite")return u.mutate(p);var g=rt["idb://".concat(t,"/").concat(s)];if(!g)return u.mutate(p);var _=u.mutate(p);return(p.type==="add"||p.type==="put")&&(p.values.length>=50||wr(c,p).some(function(w){return w==null}))?_.then(function(w){var k=i(i({},p),{values:p.values.map(function(x,S){var I;if(w.failures[S])return x;var A=!((I=c.keyPath)===null||I===void 0)&&I.includes(".")?Ye(x):i({},x);return ie(A,c.keyPath,w.results[S]),A})}),K=_i(g,k,w);g.optimisticOps.push(K),queueMicrotask(function(){return p.mutatedParts&&dn(p.mutatedParts)})}):(g.optimisticOps.push(p),p.mutatedParts&&dn(p.mutatedParts),_.then(function(w){if(w.numFailures>0){Qe(g.optimisticOps,p);var k=_i(g,p,w);k&&g.optimisticOps.push(k),p.mutatedParts&&dn(p.mutatedParts)}}),_.catch(function(){Qe(g.optimisticOps,p),p.mutatedParts&&dn(p.mutatedParts)})),_},query:function(p){var v;if(!bi(G,u)||!xi("query",p))return u.query(p);var g=((v=G.trans)===null||v===void 0?void 0:v.db._options.cache)==="immutable",_=G,w=_.requery,k=_.signal,K=Co(t,s,"query",p),x=K[0],S=K[1],I=K[2],A=K[3];if(x&&S)x.obsSet=p.obsSet;else{var P=u.query(p).then(function(T){var R=T.result;if(x&&(x.res=R),g){for(var C=0,M=R.length;C<M;++C)Object.freeze(R[C]);Object.freeze(R)}else T.result=Ye(R);return T}).catch(function(T){return A&&x&&Qe(A,x),Promise.reject(T)});x={obsSet:p.obsSet,promise:P,subscribers:new Set,type:"query",req:p,dirty:!1},A?A.push(x):(A=[x],I||(I=rt["idb://".concat(t,"/").concat(s)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}}),I.queries.query[p.query.index.name||""]=A)}return Po(x,A,w,k),x.promise.then(function(T){return{result:Ei(T.result,p,I?.optimisticOps,u,x,g)}})}});return h}});return r}};function vn(e,t){return new Proxy(e,{get:function(r,s,u){return s==="db"?t:Reflect.get(r,s,u)}})}var Be=function(){function e(t,r){var s=this;this._middlewares={},this.verno=0;var u=e.dependencies;this._options=r=i({addons:e.addons,autoOpen:!0,indexedDB:u.indexedDB,IDBKeyRange:u.IDBKeyRange,cache:"cloned"},r),this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange};var c=r.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var h={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:se,dbReadyPromise:null,cancelOpen:se,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:r.autoOpen};h.dbReadyPromise=new z(function(v){h.dbReadyResolve=v}),h.openCanceller=new z(function(v,g){h.cancelOpen=g}),this._state=h,this.name=t,this.on=kt(this,"populate","blocked","versionchange","close",{ready:[Fn,se]}),this.on.ready.subscribe=ve(this.on.ready.subscribe,function(v){return function(g,_){e.vip(function(){var w=s._state;if(w.openComplete)w.dbOpenError||z.resolve().then(g),_&&v(g);else if(w.onReadyBeingFired)w.onReadyBeingFired.push(g),_&&v(g);else{v(g);var k=s;_||v(function K(){k.on.ready.unsubscribe(g),k.on.ready.unsubscribe(K)})}})}}),this.Collection=js(this),this.Table=Ks(this),this.Transaction=$s(this),this.Version=uo(this),this.WhereClause=Gs(this),this.on("versionchange",function(v){v.newVersion>0?console.warn("Another connection wants to upgrade database '".concat(s.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(s.name,"'. Closing db now to resume the delete request.")),s.close({disableAutoOpen:!1})}),this.on("blocked",function(v){!v.newVersion||v.newVersion<v.oldVersion?console.warn("Dexie.delete('".concat(s.name,"') was blocked")):console.warn("Upgrade '".concat(s.name,"' blocked by other connection holding version ").concat(v.oldVersion/10))}),this._maxKey=Ot(r.IDBKeyRange),this._createTransaction=function(v,g,_,w){return new s.Transaction(v,g,_,s._options.chromeTransactionDurability,w)},this._fireOnBlocked=function(v){s.on("blocked").fire(v),mt.filter(function(g){return g.name===s.name&&g!==s&&!g._state.vcFired}).map(function(g){return g.on("versionchange").fire(v)})},this.use(wo),this.use(Ao),this.use(bo),this.use(mo),this.use(yo);var p=new Proxy(this,{get:function(v,g,_){if(g==="_vip")return!0;if(g==="table")return function(k){return vn(s.table(k),p)};var w=Reflect.get(v,g,_);return w instanceof si?vn(w,p):g==="tables"?w.map(function(k){return vn(k,p)}):g==="_createTransaction"?function(){var k=w.apply(this,arguments);return vn(k,p)}:w}});this.vip=p,c.forEach(function(v){return v(s)})}return e.prototype.version=function(t){if(isNaN(t)||t<.1)throw new H.Type("Given version is not a positive number");if(t=Math.round(t*10)/10,this.idbdb||this._state.isBeingOpened)throw new H.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var r=this._versions,s=r.filter(function(u){return u._cfg.version===t})[0];return s||(s=new this.Version(t),r.push(s),r.sort(Zs),s.stores({}),this._state.autoSchema=!1,s)},e.prototype._whenReady=function(t){var r=this;return this.idbdb&&(this._state.openComplete||G.letThrough||this._vip)?t():new z(function(s,u){if(r._state.openComplete)return u(new H.DatabaseClosed(r._state.dbOpenError));if(!r._state.isBeingOpened){if(!r._state.autoOpen){u(new H.DatabaseClosed);return}r.open().catch(se)}r._state.dbReadyPromise.then(s,u)}).then(t)},e.prototype.use=function(t){var r=t.stack,s=t.create,u=t.level,c=t.name;c&&this.unuse({stack:r,name:c});var h=this._middlewares[r]||(this._middlewares[r]=[]);return h.push({stack:r,create:s,level:u??10,name:c}),h.sort(function(p,v){return p.level-v.level}),this},e.prototype.unuse=function(t){var r=t.stack,s=t.name,u=t.create;return r&&this._middlewares[r]&&(this._middlewares[r]=this._middlewares[r].filter(function(c){return u?c.create!==u:s?c.name!==s:!1})),this},e.prototype.open=function(){var t=this;return et(Me,function(){return ho(t)})},e.prototype._close=function(){var t=this._state,r=mt.indexOf(this);if(r>=0&&mt.splice(r,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}t.isBeingOpened||(t.dbReadyPromise=new z(function(s){t.dbReadyResolve=s}),t.openCanceller=new z(function(s,u){t.cancelOpen=u}))},e.prototype.close=function(t){var r=t===void 0?{disableAutoOpen:!0}:t,s=r.disableAutoOpen,u=this._state;s?(u.isBeingOpened&&u.cancelOpen(new H.DatabaseClosed),this._close(),u.autoOpen=!1,u.dbOpenError=new H.DatabaseClosed):(this._close(),u.autoOpen=this._options.autoOpen||u.isBeingOpened,u.openComplete=!1,u.dbOpenError=null)},e.prototype.delete=function(t){var r=this;t===void 0&&(t={disableAutoOpen:!0});var s=arguments.length>0&&typeof arguments[0]!="object",u=this._state;return new z(function(c,h){var p=function(){r.close(t);var v=r._deps.indexedDB.deleteDatabase(r.name);v.onsuccess=ue(function(){co(r._deps,r.name),c()}),v.onerror=Pe(h),v.onblocked=r._fireOnBlocked};if(s)throw new H.InvalidArgument("Invalid closeOptions argument to db.delete()");u.isBeingOpened?u.dbReadyPromise.then(p):p()})},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return this.idbdb!==null},e.prototype.hasBeenClosed=function(){var t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"},e.prototype.hasFailed=function(){return this._state.dbOpenError!==null},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var t=this;return f(this._allTables).map(function(r){return t._allTables[r]})},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var t=po.apply(this,arguments);return this._transaction.apply(this,t)},e.prototype._transaction=function(t,r,s){var u=this,c=G.trans;(!c||c.db!==this||t.indexOf("!")!==-1)&&(c=null);var h=t.indexOf("?")!==-1;t=t.replace("!","").replace("?","");var p,v;try{if(v=r.map(function(_){var w=_ instanceof u.Table?_.name:_;if(typeof w!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return w}),t=="r"||t===Jn)p=Jn;else if(t=="rw"||t==Xn)p=Xn;else throw new H.InvalidArgument("Invalid transaction mode: "+t);if(c){if(c.mode===Jn&&p===Xn)if(h)c=null;else throw new H.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");c&&v.forEach(function(_){if(c&&c.storeNames.indexOf(_)===-1)if(h)c=null;else throw new H.SubTransaction("Table "+_+" not included in parent transaction.")}),h&&c&&!c.active&&(c=null)}}catch(_){return c?c._promise(null,function(w,k){k(_)}):he(_)}var g=gi.bind(null,this,p,v,c,s);return c?c._promise(p,g,"lock"):G.trans?et(G.transless,function(){return u._whenReady(g)}):this._whenReady(g)},e.prototype.table=function(t){if(!E(this._allTables,t))throw new H.InvalidTable("Table ".concat(t," does not exist"));return this._allTables[t]},e}(),Oo=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Ro=function(){function e(t){this._subscribe=t}return e.prototype.subscribe=function(t,r,s){return this._subscribe(!t||typeof t=="function"?{next:t,error:r,complete:s}:t)},e.prototype[Oo]=function(){return this},e}(),mn;try{mn={indexedDB:l.indexedDB||l.mozIndexedDB||l.webkitIndexedDB||l.msIndexedDB,IDBKeyRange:l.IDBKeyRange||l.webkitIDBKeyRange}}catch{mn={indexedDB:null,IDBKeyRange:null}}function Ii(e){var t=!1,r,s=new Ro(function(u){var c=Bn(e);function h(A){var P=dt();try{c&&vt();var T=je(e,A);return c&&(T=T.finally(Fe)),T}finally{P&&pt()}}var p=!1,v,g={},_={},w={get closed(){return p},unsubscribe:function(){p||(p=!0,v&&v.abort(),k&&Le.storagemutated.unsubscribe(S))}};u.start&&u.start(w);var k=!1,K=function(){return Hn(I)};function x(){return dr(_,g)}var S=function(A){hn(g,A),x()&&K()},I=function(){if(!(p||!mn.indexedDB)){g={};var A={};v&&v.abort(),v=new AbortController;var P={subscr:A,signal:v.signal,requery:K,querier:e,trans:null},T=h(P);Promise.resolve(T).then(function(R){t=!0,r=R,!(p||P.signal.aborted)&&(g={},_=A,!as(_)&&!k&&(Le(At,S),k=!0),Hn(function(){return!p&&u.next&&u.next(R)}))},function(R){t=!1,["DatabaseClosedError","AbortError"].includes(R?.name)||p||Hn(function(){p||u.error&&u.error(R)})})}};return setTimeout(K,0),w});return s.hasValue=function(){return t},s.getValue=function(){return r},s}var it=Be;O(it,i(i({},$t),{delete:function(e){var t=new it(e,{addons:[]});return t.delete()},exists:function(e){return new it(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return ao(it.dependencies).then(e)}catch{return he(new H.MissingAPI)}},defineClass:function(){function e(t){m(this,t)}return e},ignoreTransaction:function(e){return G.trans?et(G.transless,e):e()},vip:cr,async:function(e){return function(){try{var t=yr(e.apply(this,arguments));return!t||typeof t.then!="function"?z.resolve(t):t}catch(r){return he(r)}}},spawn:function(e,t,r){try{var s=yr(e.apply(r,t||[]));return!s||typeof s.then!="function"?z.resolve(s):s}catch(u){return he(u)}},currentTransaction:{get:function(){return G.trans||null}},waitFor:function(e,t){var r=z.resolve(typeof e=="function"?it.ignoreTransaction(e):e).timeout(t||6e4);return G.trans?G.trans.waitFor(r):r},Promise:z,debug:{get:function(){return Ce},set:function(e){Vr(e)}},derive:B,extend:m,props:O,override:ve,Events:kt,on:Le,liveQuery:Ii,extendObservabilitySet:hn,getByKeyPath:de,setByKeyPath:ie,delByKeyPath:ke,shallowClone:we,deepClone:Ye,getObjectDiff:gr,cmp:te,asap:Z,minKey:Qn,addons:[],connections:mt,errnames:jn,dependencies:mn,cache:rt,semVer:qr,version:qr.split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,r){return e+t/Math.pow(10,r*2)})})),it.maxKey=Ot(it.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Le(At,function(e){if(!Ue){var t;t=new CustomEvent(tr,{detail:e}),Ue=!0,dispatchEvent(t),Ue=!1}}),addEventListener(tr,function(e){var t=e.detail;Ue||xr(t)}));function xr(e){var t=Ue;try{Ue=!0,Le.storagemutated.fire(e),mr(e,!0)}finally{Ue=t}}var Ue=!1,Ge,_r=function(){};typeof BroadcastChannel<"u"&&(_r=function(){Ge=new BroadcastChannel(tr),Ge.onmessage=function(e){return e.data&&xr(e.data)}},_r(),typeof Ge.unref=="function"&&Ge.unref(),Le(At,function(e){Ue||Ge.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!Be.disableBfCache&&e.persisted){Ce&&console.debug("Dexie: handling persisted pagehide"),Ge?.close();for(var t=0,r=mt;t<r.length;t++){var s=r[t];s.close({disableAutoOpen:!1})}}}),addEventListener("pageshow",function(e){!Be.disableBfCache&&e.persisted&&(Ce&&console.debug("Dexie: handling persisted pageshow"),_r(),xr({all:new ye(-1/0,[[]])}))}));function Do(e){return new Pt({add:e})}function Ko(e){return new Pt({remove:e})}function Bo(e,t){return new Pt({replacePrefix:[e,t]})}z.rejectionMapper=ps,Vr(Ce);var Mo=Object.freeze({__proto__:null,Dexie:Be,liveQuery:Ii,Entity:ni,cmp:te,PropModification:Pt,replacePrefix:Bo,add:Do,remove:Ko,default:Be,RangeSet:ye,mergeRanges:Kt,rangesOverlap:pi});return i(Be,Mo,{default:Be}),Be})});var Er=(m=>(m.PRODUCTS="productsStore",m.RECIPES="recipesStore",m.CATEGORIES="categoryStore",m.PRODUCTS_CATEGORIES="categoryProductsStore",m.RECIPES_CATEGORIES="categoryRecipesStore",m.INDICES="indicesStore",m.DOCUMENTATION="documentation",m))(Er||{});var Lo=n=>{let o={};for(let i in n)Array.isArray(n[i])?o[i]=n[i].reduce((a,l)=>(a.push(Lo(l)),a),[]):n[i]?.uuid!=null?o[i]=n[i].uuid:o[i]=n[i];return o},Uo=n=>{let o={};for(let i in n)Array.isArray(n[i])?o[i]=n[i].filter(a=>a!=null).map(Uo):n[i]!=null&&(o[i]=n[i]);return o},Ci=()=>Math.random().toString(36).substring(2)+Date.now().toString(36);var xn=zo(Pi(),1),Ti=Symbol.for("Dexie"),_n=globalThis[Ti]||(globalThis[Ti]=xn.default);if(xn.default.semVer!==_n.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${xn.default.semVer} and ${_n.semVer}`);var{liveQuery:lu,mergeRanges:cu,rangesOverlap:fu,RangeSet:hu,cmp:du,Entity:pu,PropModification:vu,replacePrefix:mu,add:yu,remove:gu}=_n;var Ai=_n;var Oi=[{version:1,schema:{productsStore:"++uuid,name",recipesStore:"++uuid,name",categoryStore:"++uuid,name"}},{version:2,schema:{productsStore:"++uuid,name",recipesStore:"++uuid,name",categoryStore:"++uuid,name",categoryProductsStore:"++uuid,name"},update:n=>new Promise(o=>ne(void 0,null,function*(){let i=yield n.table("categoryStore").toArray(),a=n.table("categoryProductsStore");yield Promise.all(i.map(l=>a.add(l))),yield n.table("categoryStore").clear()}))},{version:3,schema:{productsStore:"++uuid,name",recipesStore:"++uuid,name",categoryProductsStore:"++uuid,name",categoryRecipesStore:"++uuid,name"}},{version:4,schema:{productsStore:"++uuid,name",recipesStore:"++uuid,name",categoryProductsStore:"++uuid,name",categoryRecipesStore:"++uuid,name"}},{version:5,schema:{productsStore:"++uuid,name",recipesStore:"++uuid,name",categoryProductsStore:"++uuid,name",categoryRecipesStore:"++uuid,name"},update:n=>new Promise(o=>ne(void 0,null,function*(){let i=[{uuid:"\u0423\u043A\u0441\u0443\u0441\u044B",name:"\u0423\u043A\u0441\u0443\u0441\u044B"}],a=["\u0421\u0438\u0440\u043E\u043F\u044B \u0438 \u043F\u0440\u043E\u043F\u0438\u0442\u043A\u0438"],l=[{old:"\u0420\u0430\u0437\u0440\u044B\u0445\u043B\u0438\u0442\u0435\u043B\u0438 \u0438 \u0441\u0442\u0430\u0431\u0438\u043B\u0438\u0437\u0430\u0442\u043E\u0440\u044B",new:"\u0420\u0430\u0437\u0440\u044B\u0445\u043B\u0438\u0442\u0435\u043B\u0438 \u0438 \u0441\u043E\u0434\u044B"}],f=n.table("categoryProductsStore"),d=yield f.toArray(),m=d.filter(b=>a.includes(b.name)).map(b=>b.uuid),y=d.filter(b=>l.map(E=>E.old).includes(b.name));yield Promise.all(y.map(b=>{let E=l.find(O=>O.old===b.name)?.new;return f.update(b.uuid,{name:E})})),yield Promise.all(m.map(b=>f.delete(b))),yield Promise.all(i.map(b=>f.add(b)))}))},{version:6,schema:{productsStore:"++uuid,name",recipesStore:"++uuid,name,source",categoryProductsStore:"++uuid,name",categoryRecipesStore:"++uuid,name"}},{version:7,schema:{productsStore:"++uuid,name,source",recipesStore:"++uuid,name",categoryProductsStore:"++uuid,name",categoryRecipesStore:"++uuid,name"}},{version:8,schema:{productsStore:"++uuid,name,source",recipesStore:"++uuid,name",categoryProductsStore:"++uuid,name",categoryRecipesStore:"++uuid,name"},update:n=>{let o=["productsStore","recipesStore","categoryProductsStore","categoryRecipesStore"];return Promise.all([new Promise(i=>ne(void 0,null,function*(){let a=n.table("categoryProductsStore"),l=yield a.toArray(),f=n.table("productsStore"),d=yield f.toArray();yield Promise.all(d.map(m=>{let y=l.find(b=>b.uuid===m.category_id);return y?f.update(m.uuid,{category_id:y.name}):Promise.resolve()})),yield Promise.all(l.map(m=>a.update(m.uuid,{uuid:m.name}))),i()})),new Promise(i=>ne(void 0,null,function*(){let a=n.table("categoryRecipesStore"),l=yield a.toArray(),f=n.table("recipesStore"),d=yield f.toArray();yield Promise.all(d.map(m=>{let y=l.find(b=>b.uuid===m.category_id);return y?f.update(m.uuid,{category_id:y.name}):Promise.resolve()})),yield Promise.all(l.map(m=>a.update(m.uuid,{uuid:m.name}))),i()}))]).then(()=>{})}},{version:9,schema:{productsStore:"++uuid,name,source",recipesStore:"++uuid,name",categoryProductsStore:"++uuid,name",categoryRecipesStore:"++uuid,name",indicesStore:"++uuid"}},{version:10,schema:{productsStore:"++uuid,name,source",recipesStore:"++uuid,name",categoryProductsStore:"++uuid,name",categoryRecipesStore:"++uuid,name",indicesStore:"++uuid",documentation:"++key"}}];var V;function me(n,o,i){let a=typeof i,l=typeof n;if(a!=="undefined"){if(l!=="undefined"){if(i){if(l==="function"&&a===l)return function(m){return n(i(m))};if(o=n.constructor,o===i.constructor){if(o===Array)return i.concat(n);if(o===Map){var f=new Map(i);for(var d of n)f.set(d[0],d[1]);return f}if(o===Set){d=new Set(i);for(f of n.values())d.add(f);return d}}}return n}return i}return l==="undefined"?o:n}function fe(){return Object.create(null)}function Se(n){return typeof n=="string"}function zt(n){return typeof n=="object"}function Go(n){let o=[];for(let i of n.keys())o.push(i);return o}function Nt(n,o){if(Se(o))n=n[o];else for(let i=0;n&&i<o.length;i++)n=n[o[i]];return n}function Vo(n){let o=0;for(let i=0,a;i<n.length;i++)(a=n[i])&&o<a.length&&(o=a.length);return o}var $o=/[^\p{L}\p{N}]+/u,Wo=/(\d{3})/g,Ho=/(\D)(\d{3})/g,Yo=/(\d{3})(\D)/g,Ri=/[\u0300-\u036f]/g;function Lt(n={}){if(!this||this.constructor!==Lt)return new Lt(...arguments);if(arguments.length)for(n=0;n<arguments.length;n++)this.assign(arguments[n]);else this.assign(n)}V=Lt.prototype;V.assign=function(n){this.normalize=me(n.normalize,!0,this.normalize);let o=n.include,i=o||n.exclude||n.split,a;if(i||i===""){if(typeof i=="object"&&i.constructor!==RegExp){let l="";a=!o,o||(l+="\\p{Z}"),i.letter&&(l+="\\p{L}"),i.number&&(l+="\\p{N}",a=!!o),i.symbol&&(l+="\\p{S}"),i.punctuation&&(l+="\\p{P}"),i.control&&(l+="\\p{C}"),(i=i.char)&&(l+=typeof i=="object"?i.join(""):i);try{this.split=new RegExp("["+(o?"^":"")+l+"]+","u")}catch{this.split=/\s+/}}else this.split=i,a=i===!1||2>"a1a".split(i).length;this.numeric=me(n.numeric,a)}else{try{this.split=me(this.split,$o)}catch{this.split=/\s+/}this.numeric=me(n.numeric,me(this.numeric,!0))}if(this.prepare=me(n.prepare,null,this.prepare),this.finalize=me(n.finalize,null,this.finalize),i=n.filter,this.filter=typeof i=="function"?i:me(i&&new Set(i),null,this.filter),this.dedupe=me(n.dedupe,!0,this.dedupe),this.matcher=me((i=n.matcher)&&new Map(i),null,this.matcher),this.mapper=me((i=n.mapper)&&new Map(i),null,this.mapper),this.stemmer=me((i=n.stemmer)&&new Map(i),null,this.stemmer),this.replacer=me(n.replacer,null,this.replacer),this.minlength=me(n.minlength,1,this.minlength),this.maxlength=me(n.maxlength,1024,this.maxlength),this.rtl=me(n.rtl,!1,this.rtl),(this.cache=i=me(n.cache,!0,this.cache))&&(this.H=null,this.S=typeof i=="number"?i:2e5,this.B=new Map,this.G=new Map,this.L=this.K=128),this.h="",this.M=null,this.A="",this.N=null,this.matcher)for(let l of this.matcher.keys())this.h+=(this.h?"|":"")+l;if(this.stemmer)for(let l of this.stemmer.keys())this.A+=(this.A?"|":"")+l;return this};V.addStemmer=function(n,o){return this.stemmer||(this.stemmer=new Map),this.stemmer.set(n,o),this.A+=(this.A?"|":"")+n,this.N=null,this.cache&&ot(this),this};V.addFilter=function(n){return typeof n=="function"?this.filter=n:(this.filter||(this.filter=new Set),this.filter.add(n)),this.cache&&ot(this),this};V.addMapper=function(n,o){return typeof n=="object"?this.addReplacer(n,o):1<n.length?this.addMatcher(n,o):(this.mapper||(this.mapper=new Map),this.mapper.set(n,o),this.cache&&ot(this),this)};V.addMatcher=function(n,o){return typeof n=="object"?this.addReplacer(n,o):2>n.length&&(this.dedupe||this.mapper)?this.addMapper(n,o):(this.matcher||(this.matcher=new Map),this.matcher.set(n,o),this.h+=(this.h?"|":"")+n,this.M=null,this.cache&&ot(this),this)};V.addReplacer=function(n,o){return typeof n=="string"?this.addMatcher(n,o):(this.replacer||(this.replacer=[]),this.replacer.push(n,o),this.cache&&ot(this),this)};V.encode=function(n,o){if(this.cache&&n.length<=this.K)if(this.H){if(this.B.has(n))return this.B.get(n)}else this.H=setTimeout(ot,50,this);this.normalize&&(typeof this.normalize=="function"?n=this.normalize(n):n=Ri?n.normalize("NFKD").replace(Ri,"").toLowerCase():n.toLowerCase()),this.prepare&&(n=this.prepare(n)),this.numeric&&3<n.length&&(n=n.replace(Ho,"$1 $2").replace(Yo,"$1 $2").replace(Wo,"$1 "));let i=!(this.dedupe||this.mapper||this.filter||this.matcher||this.stemmer||this.replacer),a=[],l=fe(),f,d,m=this.split||this.split===""?n.split(this.split):[n];for(let b=0,E,O;b<m.length;b++)if((E=O=m[b])&&!(E.length<this.minlength||E.length>this.maxlength)){if(o){if(l[E])continue;l[E]=1}else{if(f===E)continue;f=E}if(i)a.push(E);else if(!this.filter||(typeof this.filter=="function"?this.filter(E):!this.filter.has(E))){if(this.cache&&E.length<=this.L)if(this.H){var y=this.G.get(E);if(y||y===""){y&&a.push(y);continue}}else this.H=setTimeout(ot,50,this);if(this.stemmer){this.N||(this.N=new RegExp("(?!^)("+this.A+")$"));let D;for(;D!==E&&2<E.length;)D=E,E=E.replace(this.N,j=>this.stemmer.get(j))}if(E&&(this.mapper||this.dedupe&&1<E.length)){y="";for(let D=0,j="",B,U;D<E.length;D++)B=E.charAt(D),B===j&&this.dedupe||((U=this.mapper&&this.mapper.get(B))||U===""?U===j&&this.dedupe||!(j=U)||(y+=U):y+=j=B);E=y}if(this.matcher&&1<E.length&&(this.M||(this.M=new RegExp("("+this.h+")","g")),E=E.replace(this.M,D=>this.matcher.get(D))),E&&this.replacer)for(y=0;E&&y<this.replacer.length;y+=2)E=E.replace(this.replacer[y],this.replacer[y+1]);if(this.cache&&O.length<=this.L&&(this.G.set(O,E),this.G.size>this.S&&(this.G.clear(),this.L=this.L/1.1|0)),E){if(E!==O)if(o){if(l[E])continue;l[E]=1}else{if(d===E)continue;d=E}a.push(E)}}}return this.finalize&&(a=this.finalize(a)||a),this.cache&&n.length<=this.K&&(this.B.set(n,a),this.B.size>this.S&&(this.B.clear(),this.K=this.K/1.1|0)),a};function ot(n){n.H=null,n.B.clear(),n.G.clear()}var wt,Mt;function Qo(n){return ne(this,null,function*(){n=n.data;var o=n.task;let i=n.id,a=n.args;switch(o){case"init":Mt=n.options||{},(o=n.factory)?(Function("return "+o)()(self),wt=new self.FlexSearch.Index(Mt),delete self.FlexSearch):wt=new Re(Mt),postMessage({id:i});break;default:let l;o==="export"&&(a[1]?(a[0]=Mt.export,a[2]=0,a[3]=1):a=null),o==="import"?a[0]&&(n=yield Mt.import.call(wt,a[0]),wt.import(a[0],n)):(l=a&&wt[o].apply(wt,a))&&l.then&&(l=yield l),postMessage(o==="search"?{id:i,msg:l}:{id:i})}})}function Kr(n){jt.call(n,"add"),jt.call(n,"append"),jt.call(n,"search"),jt.call(n,"update"),jt.call(n,"remove")}var Tr,Di,In;function Jo(){Tr=In=0}function jt(n){this[n+"Async"]=function(){let o=arguments;var i=o[o.length-1];let a;if(typeof i=="function"&&(a=i,delete o[o.length-1]),Tr?In||(In=Date.now()-Di>=this.priority*this.priority*3):(Tr=setTimeout(Jo,0),Di=Date.now()),In){let f=this;return new Promise(d=>{setTimeout(function(){d(f[n+"Async"].apply(f,o))},0)})}let l=this[n].apply(this,o);return i=l.then?l:new Promise(f=>f(l)),a&&i.then(a),i}}var bt=0;function Ut(n={}){function o(d){function m(y){y=y.data||y;let b=y.id,E=b&&l.h[b];E&&(E(y.msg),delete l.h[b])}if(this.worker=d,this.h=fe(),this.worker)return a?this.worker.on("message",m):this.worker.onmessage=m,n.config?new Promise(function(y){l.h[++bt]=function(){y(l),1e9<bt&&(bt=0)},l.worker.postMessage({id:bt,task:"init",factory:i,options:n})}):(this.worker.postMessage({task:"init",factory:i,options:n}),this.priority=n.priority||4,this)}if(!this||this.constructor!==Ut)return new Ut(n);let i=typeof self<"u"?self._factory:typeof window<"u"?window._factory:null;i&&(i=i.toString());let a=typeof window>"u",l=this,f=Xo(i,a,n.worker);return f.then?f.then(function(d){return o.call(l,d)}):o.call(this,f)}We("add");We("append");We("search");We("update");We("remove");We("clear");We("export");We("import");Kr(Ut.prototype);function We(n){Ut.prototype[n]=function(){let o=this,i=[].slice.call(arguments);var a=i[i.length-1];let l;return typeof a=="function"&&(l=a,i.pop()),a=new Promise(function(f){n==="export"&&typeof i[0]=="function"&&(i[0]=null),o.h[++bt]=f,o.worker.postMessage({task:n,id:bt,args:i})}),l?(a.then(l),this):a}}function Xo(n,o,i){return o?typeof module<"u"?new(No()).Worker(__dirname+"/worker/node.js"):import("./chunk-55JXXOPV.js").then(function(a){return new a.Worker(import.meta.dirname+"/node/node.mjs")}):n?new window.Worker(URL.createObjectURL(new Blob(["onmessage="+Qo.toString()],{type:"text/javascript"}))):new window.Worker(typeof i=="string"?i:import.meta.url.replace("/worker.js","/worker/worker.js").replace("flexsearch.bundle.module.min.js","module/worker/worker.js"),{type:"module"})}function Br(n,o=0){let i=[],a=[];o&&(o=25e4/o*5e3|0);for(let l of n.entries())a.push(l),a.length===o&&(i.push(a),a=[]);return a.length&&i.push(a),i}function Mr(n,o){o||(o=new Map);for(let i=0,a;i<n.length;i++)a=n[i],o.set(a[0],a[1]);return o}function Vi(n,o=0){let i=[],a=[];o&&(o=25e4/o*1e3|0);for(let l of n.entries())a.push([l[0],Br(l[1])[0]]),a.length===o&&(i.push(a),a=[]);return a.length&&i.push(a),i}function $i(n,o){o||(o=new Map);for(let i=0,a,l;i<n.length;i++)a=n[i],l=o.get(a[0]),o.set(a[0],Mr(a[1],l));return o}function Wi(n){let o=[],i=[];for(let a of n.keys())i.push(a),i.length===25e4&&(o.push(i),i=[]);return i.length&&o.push(i),o}function Hi(n,o){o||(o=new Set);for(let i=0;i<n.length;i++)o.add(n[i]);return o}function kn(n,o,i,a,l,f,d=0){let m=a&&a.constructor===Array;var y=m?a.shift():a;if(!y)return this.export(n,o,l,f+1);if((y=n((o?o+".":"")+(d+1)+"."+i,JSON.stringify(y)))&&y.then){let b=this;return y.then(function(){return kn.call(b,n,o,i,m?a:null,l,f,d+1)})}return kn.call(this,n,o,i,m?a:null,l,f,d+1)}function Ki(n,o){let i="";for(let a of n.entries()){n=a[0];let l=a[1],f="";for(let d=0,m;d<l.length;d++){m=l[d]||[""];let y="";for(let b=0;b<m.length;b++)y+=(y?",":"")+(o==="string"?'"'+m[b]+'"':m[b]);y="["+y+"]",f+=(f?",":"")+y}f='["'+n+'",['+f+"]]",i+=(i?",":"")+f}return i}function Bi(n,o,i,a){let l=[];for(let f=0,d;f<n.index.length;f++)if(d=n.index[f],o>=d.length)o-=d.length;else{o=d[a?"splice":"slice"](o,i);let m=o.length;if(m&&(l=l.length?l.concat(o):o,i-=m,a&&(n.length-=m),!i))break;o=0}return l}function ut(n){if(!this||this.constructor!==ut)return new ut(n);this.index=n?[n]:[],this.length=n?n.length:0;let o=this;return new Proxy([],{get(i,a){if(a==="length")return o.length;if(a==="push")return function(l){o.index[o.index.length-1].push(l),o.length++};if(a==="pop")return function(){if(o.length)return o.length--,o.index[o.index.length-1].pop()};if(a==="indexOf")return function(l){let f=0;for(let d=0,m,y;d<o.index.length;d++){if(m=o.index[d],y=m.indexOf(l),0<=y)return f+y;f+=m.length}return-1};if(a==="includes")return function(l){for(let f=0;f<o.index.length;f++)if(o.index[f].includes(l))return!0;return!1};if(a==="slice")return function(l,f){return Bi(o,l||0,f||o.length,!1)};if(a==="splice")return function(l,f){return Bi(o,l||0,f||o.length,!0)};if(a==="constructor")return Array;if(typeof a!="symbol")return(i=o.index[a/2**31|0])&&i[a]},set(i,a,l){return i=a/2**31|0,(o.index[i]||(o.index[i]=[]))[a]=l,o.length++,!0}})}ut.prototype.clear=function(){this.index.length=0};ut.prototype.destroy=function(){this.proxy=this.index=null};ut.prototype.push=function(){};function Oe(n=8){if(!this||this.constructor!==Oe)return new Oe(n);this.index=fe(),this.h=[],this.size=0,32<n?(this.B=Qi,this.A=BigInt(n)):(this.B=Yi,this.A=n)}Oe.prototype.get=function(n){let o=this.index[this.B(n)];return o&&o.get(n)};Oe.prototype.set=function(n,o){var i=this.B(n);let a=this.index[i];a?(i=a.size,a.set(n,o),(i-=a.size)&&this.size++):(this.index[i]=a=new Map([[n,o]]),this.h.push(a),this.size++)};function Ie(n=8){if(!this||this.constructor!==Ie)return new Ie(n);this.index=fe(),this.h=[],this.size=0,32<n?(this.B=Qi,this.A=BigInt(n)):(this.B=Yi,this.A=n)}Ie.prototype.add=function(n){var o=this.B(n);let i=this.index[o];i?(o=i.size,i.add(n),(o-=i.size)&&this.size++):(this.index[o]=i=new Set([n]),this.h.push(i),this.size++)};V=Oe.prototype;V.has=Ie.prototype.has=function(n){let o=this.index[this.B(n)];return o&&o.has(n)};V.delete=Ie.prototype.delete=function(n){let o=this.index[this.B(n)];o&&o.delete(n)&&this.size--};V.clear=Ie.prototype.clear=function(){this.index=fe(),this.h=[],this.size=0};V.values=Ie.prototype.values=function*(){for(let n=0;n<this.h.length;n++)for(let o of this.h[n].values())yield o};V.keys=Ie.prototype.keys=function*(){for(let n=0;n<this.h.length;n++)for(let o of this.h[n].keys())yield o};V.entries=Ie.prototype.entries=function*(){for(let n=0;n<this.h.length;n++)for(let o of this.h[n].entries())yield o};function Yi(n){let o=2**this.A-1;if(typeof n=="number")return n&o;let i=0,a=this.A+1;for(let l=0;l<n.length;l++)i=(i*a^n.charCodeAt(l))&o;return this.A===32?i+2**31:i}function Qi(n){let o=BigInt(2)**this.A-BigInt(1);var i=typeof n;if(i==="bigint")return n&o;if(i==="number")return BigInt(n)&o;i=BigInt(0);let a=this.A+BigInt(1);for(let l=0;l<n.length;l++)i=(i*a^BigInt(n.charCodeAt(l)))&o;return i}at.prototype.add=function(n,o,i){if(zt(n)&&(o=n,n=Nt(o,this.key)),o&&(n||n===0)){if(!i&&this.reg.has(n))return this.update(n,o);for(let m=0,y;m<this.field.length;m++){y=this.F[m];var a=this.index.get(this.field[m]);if(typeof y=="function"){var l=y(o);l&&a.add(n,l,!1,!0)}else l=y.I,(!l||l(o))&&(y.constructor===String?y=[""+y]:Se(y)&&(y=[y]),Or(o,y,this.J,0,a,n,y[0],i))}if(this.tag)for(a=0;a<this.D.length;a++){var f=this.D[a];l=this.tag.get(this.R[a]);let m=fe();if(typeof f=="function"){if(f=f(o),!f)continue}else{var d=f.I;if(d&&!d(o))continue;f.constructor===String&&(f=""+f),f=Nt(o,f)}if(l&&f){Se(f)&&(f=[f]);for(let y=0,b,E;y<f.length;y++)if(b=f[y],!m[b]&&(m[b]=1,(d=l.get(b))?E=d:l.set(b,E=[]),!i||!E.includes(n))){if(E.length===2**31-1){if(d=new ut(E),this.fastupdate)for(let O of this.reg.values())O.includes(E)&&(O[O.indexOf(E)]=d);l.set(b,E=d)}E.push(n),this.fastupdate&&((d=this.reg.get(n))?d.push(E):this.reg.set(n,[E]))}}}if(this.store&&(!i||!this.store.has(n))){let m;if(this.C){m=fe();for(let y=0,b;y<this.C.length;y++){if(b=this.C[y],(i=b.I)&&!i(o))continue;let E;if(typeof b=="function"){if(E=b(o),!E)continue;b=[b.V]}else if(Se(b)||b.constructor===String){m[b]=o[b];continue}Ar(o,m,b,0,b[0],E)}}this.store.set(n,m||o)}this.worker&&(this.fastupdate||this.reg.add(n))}return this};function Ar(n,o,i,a,l,f){if(n=n[l],a===i.length-1)o[l]=f||n;else if(n)if(n.constructor===Array)for(o=o[l]=Array(n.length),l=0;l<n.length;l++)Ar(n,o,i,a,l);else o=o[l]||(o[l]=fe()),l=i[++a],Ar(n,o,i,a,l)}function Or(n,o,i,a,l,f,d,m){if(n=n[d])if(a===o.length-1){if(n.constructor===Array){if(i[a]){for(o=0;o<n.length;o++)l.add(f,n[o],!0,!0);return}n=n.join(" ")}l.add(f,n,m,!0)}else if(n.constructor===Array)for(d=0;d<n.length;d++)Or(n,o,i,a,l,f,d,m);else d=o[++a],Or(n,o,i,a,l,f,d,m);else l.db&&l.remove(f)}function Ji(n,o,i,a,l,f,d){let m=n.length,y=[],b,E;b=fe();for(let O=0,D,j,B,U;O<o;O++)for(let $=0;$<m;$++)if(B=n[$],O<B.length&&(D=B[O]))for(let X=0;X<D.length;X++){if(j=D[X],(E=b[j])?b[j]++:(E=0,b[j]=1),U=y[E]||(y[E]=[]),!d){let J=O+($||!l?0:f||0);U=U[J]||(U[J]=[])}if(U.push(j),d&&i&&E===m-1&&U.length-a===i)return a?U.slice(a):U}if(n=y.length)if(l)y=1<y.length?Xi(y,i,a,d,f):(y=y[0]).length>i||a?y.slice(a,i+a):y;else{if(n<m)return[];if(y=y[n-1],i||a)if(d)(y.length>i||a)&&(y=y.slice(a,i+a));else{l=[];for(let O=0,D;O<y.length;O++)if(D=y[O],D.length>a)a-=D.length;else if((D.length>i||a)&&(D=D.slice(a,i+a),i-=D.length,a&&(a-=D.length)),l.push(D),!i)break;y=1<l.length?[].concat.apply([],l):l[0]}}return y}function Xi(n,o,i,a,l){let f=[],d=fe(),m;var y=n.length;let b;if(a){for(l=y-1;0<=l;l--)if(b=(a=n[l])&&a.length){for(y=0;y<b;y++)if(m=a[y],!d[m]){if(d[m]=1,i)i--;else if(f.push(m),f.length===o)return f}}}else for(let E=y-1,O,D=0;0<=E;E--){O=n[E];for(let j=0;j<O.length;j++)if(b=(a=O[j])&&a.length){for(let B=0;B<b;B++)if(m=a[B],!d[m])if(d[m]=1,i)i--;else{let U=(j+(E<y-1&&l||0))/(E+1)|0;if((f[U]||(f[U]=[])).push(m),++D===o)return f}}}return f}function Zo(n,o,i){let a=fe(),l=[];for(let f=0,d;f<o.length;f++){d=o[f];for(let m=0;m<d.length;m++)a[d[m]]=1}if(i)for(let f=0,d;f<n.length;f++)d=n[f],a[d]&&(l.push(d),a[d]=0);else for(let f=0,d,m;f<n.result.length;f++)for(d=n.result[f],o=0;o<d.length;o++)m=d[o],a[m]&&((l[f]||(l[f]=[])).push(m),a[m]=0);return l}function jr(n,o,i,a){if(!n.length)return n;if(n.length===1)return n=n[0],n=i||n.length>o?o?n.slice(i,i+o):n.slice(i):n,a?$e.call(this,n):n;let l=[];for(let f=0,d,m;f<n.length;f++)if((d=n[f])&&(m=d.length)){if(i){if(i>=m){i-=m;continue}i<m&&(d=o?d.slice(i,i+o):d.slice(i),m=d.length,i=0)}if(m>o&&(d=d.slice(0,o),m=o),!l.length&&m>=o)return a?$e.call(this,d):d;if(l.push(d),o-=m,!o)break}return l=1<l.length?[].concat.apply([],l):l[0],a?$e.call(this,l):l}function Tn(n,o,i){var a=i[0];if(a.then)return Promise.all(i).then(function(E){return n[o].apply(n,E)});if(a[0]&&a[0].index)return n[o].apply(n,a);a=[];let l=[],f=0,d=0,m,y,b;for(let E=0,O;E<i.length;E++)if(O=i[E]){let D;if(O.constructor===ae)D=O.result;else if(O.constructor===Array)D=O;else if(f=O.limit||0,d=O.offset||0,b=O.suggest,y=O.resolve,m=O.enrich&&y,O.index)O.resolve=!1,D=O.index.search(O).result,O.resolve=y;else if(O.and)D=n.and(O.and);else if(O.or)D=n.or(O.or);else if(O.xor)D=n.xor(O.xor);else if(O.not)D=n.not(O.not);else continue;if(D.then)l.push(D);else if(D.length)a[E]=D;else if(!b&&(o==="and"||o==="xor")){a=[];break}}return{O:a,P:l,limit:f,offset:d,enrich:m,resolve:y,suggest:b}}ae.prototype.or=function(){let{O:n,P:o,limit:i,offset:a,enrich:l,resolve:f}=Tn(this,"or",arguments);return Zi.call(this,n,o,i,a,l,f)};function Zi(n,o,i,a,l,f){if(o.length){let d=this;return Promise.all(o).then(function(m){n=[];for(let y=0,b;y<m.length;y++)(b=m[y]).length&&(n[y]=b);return Zi.call(d,n,[],i,a,l,f)})}return n.length&&(this.result.length&&n.push(this.result),2>n.length?this.result=n[0]:(this.result=Xi(n,i,a,!1,this.h),a=0)),f?this.resolve(i,a,l):this}ae.prototype.and=function(){let n=this.result.length,o,i,a,l;if(!n){let f=arguments[0];f&&(n=!!f.suggest,l=f.resolve,o=f.limit,i=f.offset,a=f.enrich&&l)}if(n){let{O:f,P:d,limit:m,offset:y,enrich:b,resolve:E,suggest:O}=Tn(this,"and",arguments);return qi.call(this,f,d,m,y,b,E,O)}return l?this.resolve(o,i,a):this};function qi(n,o,i,a,l,f,d){if(o.length){let m=this;return Promise.all(o).then(function(y){n=[];for(let b=0,E;b<y.length;b++)(E=y[b]).length&&(n[b]=E);return qi.call(m,n,[],i,a,l,f,d)})}if(n.length)if(this.result.length&&n.unshift(this.result),2>n.length)this.result=n[0];else{if(o=Vo(n))return this.result=Ji(n,o,i,a,d,this.h,f),f?l?$e.call(this.index,this.result):this.result:this;this.result=[]}else d||(this.result=n);return f?this.resolve(i,a,l):this}ae.prototype.xor=function(){let{O:n,P:o,limit:i,offset:a,enrich:l,resolve:f,suggest:d}=Tn(this,"xor",arguments);return es.call(this,n,o,i,a,l,f,d)};function es(n,o,i,a,l,f,d){if(o.length){let m=this;return Promise.all(o).then(function(y){n=[];for(let b=0,E;b<y.length;b++)(E=y[b]).length&&(n[b]=E);return es.call(m,n,[],i,a,l,f,d)})}if(n.length)if(this.result.length&&n.unshift(this.result),2>n.length)this.result=n[0];else return this.result=qo.call(this,n,i,a,f,this.h),f?l?$e.call(this.index,this.result):this.result:this;else d||(this.result=n);return f?this.resolve(i,a,l):this}function qo(n,o,i,a,l){let f=[],d=fe(),m=0;for(let y=0,b;y<n.length;y++)if(b=n[y]){m<b.length&&(m=b.length);for(let E=0,O;E<b.length;E++)if(O=b[E])for(let D=0,j;D<O.length;D++)j=O[D],d[j]=d[j]?2:1}for(let y=0,b,E=0;y<m;y++)for(let O=0,D;O<n.length;O++)if((D=n[O])&&(b=D[y])){for(let j=0,B;j<b.length;j++)if(B=b[j],d[B]===1)if(i)i--;else if(a){if(f.push(B),f.length===o)return f}else{let U=y+(O?l:0);if(f[U]||(f[U]=[]),f[U].push(B),++E===o)return f}}return f}ae.prototype.not=function(){let{O:n,P:o,limit:i,offset:a,enrich:l,resolve:f,suggest:d}=Tn(this,"not",arguments);return ts.call(this,n,o,i,a,l,f,d)};function ts(n,o,i,a,l,f,d){if(o.length){let m=this;return Promise.all(o).then(function(y){n=[];for(let b=0,E;b<y.length;b++)(E=y[b]).length&&(n[b]=E);return ts.call(m,n,[],i,a,l,f,d)})}if(n.length&&this.result.length)this.result=eu.call(this,n,i,a,f);else if(f)return this.resolve(i,a,l);return f?l?$e.call(this.index,this.result):this.result:this}function eu(n,o,i,a){let l=[];n=new Set(n.flat().flat());for(let f=0,d,m=0;f<this.result.length;f++)if(d=this.result[f]){for(let y=0,b;y<d.length;y++)if(b=d[y],!n.has(b)){if(i)i--;else if(a){if(l.push(b),l.length===o)return l}else if(l[f]||(l[f]=[]),l[f].push(b),++m===o)return l}}return l}function ae(n){if(!this||this.constructor!==ae)return new ae(n);if(n&&n.index)return n.resolve=!1,this.index=n.index,this.h=n.boost||0,this.result=n.index.search(n).result,this;this.index=null,this.result=n||[],this.h=0}ae.prototype.limit=function(n){if(this.result.length){let o=[];for(let i=0,a;i<this.result.length;i++)if(a=this.result[i])if(a.length<=n){if(o[i]=a,n-=a.length,!n)break}else{o[i]=a.slice(0,n);break}this.result=o}return this};ae.prototype.offset=function(n){if(this.result.length){let o=[];for(let i=0,a;i<this.result.length;i++)(a=this.result[i])&&(a.length<=n?n-=a.length:(o[i]=a.slice(n),n=0));this.result=o}return this};ae.prototype.boost=function(n){return this.h+=n,this};ae.prototype.resolve=function(n,o,i){let a=this.result,l=this.index;return this.result=this.index=null,a.length?(typeof n=="object"&&(i=n.enrich,o=n.offset,n=n.limit),jr.call(l,a,n||100,o,i)):a};fe();at.prototype.search=function(n,o,i,a){i||(!o&&zt(n)?(i=n,n=""):zt(o)&&(i=o,o=0));let l=[];var f=[];let d;var m;let y,b,E,O=0;var D=!0;let j;if(i){i.constructor===Array&&(i={index:i}),n=i.query||n,d=i.pluck,y=i.merge,b=d||i.field||(b=i.index)&&(b.index?null:b),E=this.tag&&i.tag;var B=i.suggest;D=i.resolve!==!1,D||d||!(b=b||this.field)||(Se(b)?d=b:(b.constructor===Array&&b.length===1&&(b=b[0]),d=b.field||b.index)),j=(m=this.store&&i.enrich&&D)&&i.highlight,o=i.limit||o;var U=i.offset||0;if(o||(o=100),E&&(!this.db||!a)){E.constructor!==Array&&(E=[E]);var $=[];for(let oe=0,Z;oe<E.length;oe++)if(Z=E[oe],Z.field&&Z.tag){var X=Z.tag;if(X.constructor===Array)for(var J=0;J<X.length;J++)$.push(Z.field,X[J]);else $.push(Z.field,X)}else{X=Object.keys(Z);for(let le=0,de,ie;le<X.length;le++)if(de=X[le],ie=Z[de],ie.constructor===Array)for(J=0;J<ie.length;J++)$.push(de,ie[J]);else $.push(de,ie)}if(E=$,!n){if(D=[],$.length)for(f=0;f<$.length;f+=2){if(this.db){if(B=this.index.get($[f]),!B)continue;D.push(B=B.db.tag($[f+1],o,U,m))}else B=tu.call(this,$[f],$[f+1],o,U,m);l.push({field:$[f],tag:$[f+1],result:B})}return D.length?Promise.all(D).then(function(oe){for(let Z=0;Z<oe.length;Z++)l[Z].result=oe[Z];return l}):l}}b&&b.constructor!==Array&&(b=[b])}b||(b=this.field),$=!a&&(this.worker||this.db)&&[];let ve;for(let oe=0,Z,le,de;oe<b.length;oe++){if(le=b[oe],this.db&&this.tag&&!this.F[oe])continue;let ie;if(Se(le)||(ie=le,le=ie.field,n=ie.query||n,o=ie.limit||o,U=ie.offset||U,B=ie.suggest||B,m=this.store&&(ie.enrich||m)),a)Z=a[oe];else if(X=ie||i,J=this.index.get(le),E&&(this.db&&(X.tag=E,ve=J.db.support_tag_search,X.field=b),ve||(X.enrich=!1)),$){$[oe]=J.search(n,o,X),X&&m&&(X.enrich=m);continue}else Z=J.search(n,o,X),X&&m&&(X.enrich=m);if(de=Z&&(D?Z.length:Z.result.length),E&&de){if(X=[],J=0,this.db&&a){if(!ve)for(let ke=b.length;ke<a.length;ke++){let we=a[ke];if(we&&we.length)J++,X.push(we);else if(!B)return D?l:new ae(l)}}else for(let ke=0,we,On;ke<E.length;ke+=2){if(we=this.tag.get(E[ke]),!we){if(B)continue;return D?l:new ae(l)}if(On=(we=we&&we.get(E[ke+1]))&&we.length)J++,X.push(we);else if(!B)return D?l:new ae(l)}if(J){if(Z=Zo(Z,X,D),de=Z.length,!de&&!B)return D?Z:new ae(Z);J--}}if(de)f[O]=le,l.push(Z),O++;else if(b.length===1)return D?l:new ae(l)}if($){if(this.db&&E&&E.length&&!ve)for(m=0;m<E.length;m+=2){if(f=this.index.get(E[m]),!f){if(B)continue;return D?l:new ae(l)}$.push(f.db.tag(E[m+1],o,U,!1))}let oe=this;return Promise.all($).then(function(Z){return Z.length?oe.search(n,o,i,Z):Z})}if(!O)return D?l:new ae(l);if(d&&(!m||!this.store))return l[0];for($=[],U=0;U<f.length;U++){if(B=l[U],m&&B.length&&typeof B[0].doc>"u"&&(this.db?$.push(B=this.index.get(this.field[0]).db.enrich(B)):B=$e.call(this,B)),d)return D?j?kr(n,B,this.index,d,j):B:new ae(B);l[U]={field:f[U],result:B}}if(m&&this.db&&$.length){let oe=this;return Promise.all($).then(function(Z){for(let le=0;le<Z.length;le++)l[le].result=Z[le];return y?Mi(l):j?kr(n,l,oe.index,d,j):l})}return y?Mi(l):j?kr(n,l,this.index,d,j):l};function kr(n,o,i,a,l){let f,d;for(let y=0,b,E,O;y<o.length;y++){let D;if(a)D=o,O=a;else{var m=o[y];if(O=m.field,!O)continue;D=m.result}E=i.get(O),b=E.encoder,m=E.tokenize,b!==f&&(f=b,d=f.encode(n));for(let j=0;j<D.length;j++){let B="",U=Nt(D[j].doc,O).split(/\s+/);for(let $=0,X,J;$<U.length;$++){X=U[$],J=b.encode(X),J=1<J.length?J.join(" "):J[0];let ve;if(J&&X)for(let oe=0,Z;oe<d.length;oe++)if(Z=d[oe],m==="strict"){if(J===Z){B+=(B?" ":"")+l.replace("$1",X),ve=!0;break}}else{let le=J.indexOf(Z);if(-1<le){B+=(B?" ":"")+X.substring(0,le)+l.replace("$1",X.substring(le,le+Z.length))+X.substring(le+Z.length),ve=!0;break}}ve||(B+=(B?" ":"")+U[$])}D[j].highlight=B}if(a)break}return o}function Mi(n){let o=[],i=fe();for(let a=0,l,f;a<n.length;a++){l=n[a],f=l.result;for(let d=0,m,y,b;d<f.length;d++)y=f[d],typeof y!="object"&&(y={id:y}),m=y.id,(b=i[m])?b.push(l.field):(y.field=i[m]=[l.field],o.push(y))}return o}function tu(n,o,i,a,l){if(n=this.tag.get(n),!n)return[];if((o=(n=n&&n.get(o))&&n.length-a)&&0<o)return(o>i||a)&&(n=n.slice(a,a+i)),l&&(n=$e.call(this,n)),n}function $e(n){if(!this||!this.store)return n;let o=Array(n.length);for(let i=0,a;i<n.length;i++)a=n[i],o[i]={id:a,doc:this.store.get(a)};return o}function at(n){if(!this||this.constructor!==at)return new at(n);let o=n.document||n.doc||n,i,a;if(this.F=[],this.field=[],this.J=[],this.key=(i=o.key||o.id)&&Cn(i,this.J)||"id",(a=n.keystore||0)&&(this.keystore=a),this.fastupdate=!!n.fastupdate,this.reg=!this.fastupdate||n.worker||n.db?a?new Ie(a):new Set:a?new Oe(a):new Map,this.C=(i=o.store||null)&&i&&i!==!0&&[],this.store=i&&(a?new Oe(a):new Map),this.cache=(i=n.cache||null)&&new lt(i),n.cache=!1,this.worker=n.worker||!1,this.priority=n.priority||4,this.index=nu.call(this,n,o),this.tag=null,(i=o.tag)&&(typeof i=="string"&&(i=[i]),i.length)){this.tag=new Map,this.D=[],this.R=[];for(let l=0,f,d;l<i.length;l++){if(f=i[l],d=f.field||f,!d)throw Error("The tag field from the document descriptor is undefined.");f.custom?this.D[l]=f.custom:(this.D[l]=Cn(d,this.J),f.filter&&(typeof this.D[l]=="string"&&(this.D[l]=new String(this.D[l])),this.D[l].I=f.filter)),this.R[l]=d,this.tag.set(d,new Map)}}if(this.worker){this.fastupdate=!1;let l=[];for(let f of this.index.values())f.then&&l.push(f);if(l.length){let f=this;return Promise.all(l).then(function(d){let m=new Map,y=0;for(let E of f.index.entries()){let O=E[0];var b=E[1];if(b.then){b=l[y].encoder||{};let D=m.get(b);D||(D=b.encode?b:new Lt(b),m.set(b,D)),b=d[y],b.encoder=D,f.index.set(O,b),y++}}return f})}}else n.db&&(this.fastupdate=!1,this.mount(n.db))}V=at.prototype;V.mount=function(n){let o=this.field;if(this.tag)for(let f=0,d;f<this.R.length;f++){d=this.R[f];var i=void 0;this.index.set(d,i=new Re({},this.reg)),o===this.field&&(o=o.slice(0)),o.push(d),i.tag=this.tag.get(d)}i=[];let a={db:n.db,type:n.type,fastupdate:n.fastupdate};for(let f=0,d,m;f<o.length;f++){a.field=m=o[f],d=this.index.get(m);let y=new n.constructor(n.id,a);y.id=n.id,i[f]=y.mount(d),d.document=!0,f?d.bypass=!0:d.store=this.store}let l=this;return this.db=Promise.all(i).then(function(){l.db=!0})};V.commit=function(n,o){return ne(this,null,function*(){let i=[];for(let a of this.index.values())i.push(a.commit(n,o));yield Promise.all(i),this.reg.clear()})};V.destroy=function(){let n=[];for(let o of this.index.values())n.push(o.destroy());return Promise.all(n)};function nu(n,o){let i=new Map,a=o.index||o.field||o;Se(a)&&(a=[a]);for(let l=0,f,d;l<a.length;l++){if(f=a[l],Se(f)||(d=f,f=f.field),d=zt(d)?Object.assign({},n,d):n,this.worker){let m=new Ut(d);m.encoder=d.encoder,i.set(f,m)}this.worker||i.set(f,new Re(d,this.reg)),d.custom?this.F[l]=d.custom:(this.F[l]=Cn(f,this.J),d.filter&&(typeof this.F[l]=="string"&&(this.F[l]=new String(this.F[l])),this.F[l].I=d.filter)),this.field[l]=f}if(this.C){n=o.store,Se(n)&&(n=[n]);for(let l=0,f,d;l<n.length;l++)f=n[l],d=f.field||f,f.custom?(this.C[l]=f.custom,f.custom.V=d):(this.C[l]=Cn(d,this.J),f.filter&&(typeof this.C[l]=="string"&&(this.C[l]=new String(this.C[l])),this.C[l].I=f.filter))}return i}function Cn(n,o){let i=n.split(":"),a=0;for(let l=0;l<i.length;l++)n=i[l],n[n.length-1]==="]"&&(n=n.substring(0,n.length-2))&&(o[a]=!0),n&&(i[a++]=n);return a<i.length&&(i.length=a),1<a?i:i[0]}V.append=function(n,o){return this.add(n,o,!0)};V.update=function(n,o){return this.remove(n).add(n,o)};V.remove=function(n){zt(n)&&(n=Nt(n,this.key));for(var o of this.index.values())o.remove(n,!0);if(this.reg.has(n)){if(this.tag&&!this.fastupdate)for(let i of this.tag.values())for(let a of i){o=a[0];let l=a[1],f=l.indexOf(n);-1<f&&(1<l.length?l.splice(f,1):i.delete(o))}this.store&&this.store.delete(n),this.reg.delete(n)}return this.cache&&this.cache.remove(n),this};V.clear=function(){let n=[];for(let o of this.index.values()){let i=o.clear();i.then&&n.push(i)}if(this.tag)for(let o of this.tag.values())o.clear();return this.store&&this.store.clear(),this.cache&&this.cache.clear(),n.length?Promise.all(n):this};V.contain=function(n){return this.db?this.index.get(this.field[0]).db.has(n):this.reg.has(n)};V.cleanup=function(){for(let n of this.index.values())n.cleanup();return this};V.get=function(n){return this.db?this.index.get(this.field[0]).db.enrich(n).then(function(o){return o[0]&&o[0].doc||null}):this.store.get(n)||null};V.set=function(n,o){return typeof n=="object"&&(o=n,n=Nt(o,this.key)),this.store.set(n,o),this};V.searchCache=ns;V.export=function(n,o,i=0,a=0){if(i<this.field.length){let d=this.field[i];if((o=this.index.get(d).export(n,d,i,a=1))&&o.then){let m=this;return o.then(function(){return m.export(n,d,i+1)})}return this.export(n,d,i+1)}let l,f;switch(a){case 0:l="reg",f=Wi(this.reg),o=null;break;case 1:l="tag",f=this.tag&&Vi(this.tag,this.reg.size),o=null;break;case 2:l="doc",f=this.store&&Br(this.store),o=null;break;default:return}return kn.call(this,n,o,l,f,i,a)};V.import=function(n,o){var i=n.split(".");i[i.length-1]==="json"&&i.pop();let a=2<i.length?i[0]:"";if(i=2<i.length?i[2]:i[1],this.worker&&a)return this.index.get(a).import(n);if(o){if(typeof o=="string"&&(o=JSON.parse(o)),a)return this.index.get(a).import(i,o);switch(i){case"reg":this.fastupdate=!1,this.reg=Hi(o,this.reg);for(let l=0,f;l<this.field.length;l++)f=this.index.get(this.field[l]),f.fastupdate=!1,f.reg=this.reg;if(this.worker){o=[];for(let l of this.index.values())o.push(l.import(n));return Promise.all(o)}break;case"tag":this.tag=$i(o,this.tag);break;case"doc":this.store=Mr(o,this.store)}}};Kr(at.prototype);function ns(n,o,i){let a=(typeof n=="object"?""+n.query:n).toLowerCase();this.cache||(this.cache=new lt);let l=this.cache.get(a);if(!l){if(l=this.search(n,o,i),l.then){let f=this;l.then(function(d){return f.cache.set(a,d),d})}this.cache.set(a,l)}return l}function lt(n){this.limit=n&&n!==!0?n:1e3,this.cache=new Map,this.h=""}lt.prototype.set=function(n,o){this.cache.set(this.h=n,o),this.cache.size>this.limit&&this.cache.delete(this.cache.keys().next().value)};lt.prototype.get=function(n){let o=this.cache.get(n);return o&&this.h!==n&&(this.cache.delete(n),this.cache.set(this.h=n,o)),o};lt.prototype.remove=function(n){for(let o of this.cache){let i=o[0];o[1].includes(n)&&this.cache.delete(i)}};lt.prototype.clear=function(){this.cache.clear(),this.h=""};var ji={normalize:!1,numeric:!1,dedupe:!1},En={},Cr=new Map([["b","p"],["v","f"],["w","f"],["z","s"],["x","s"],["d","t"],["n","m"],["c","k"],["g","k"],["j","k"],["q","k"],["i","e"],["y","e"],["u","o"]]),Fi=new Map([["ae","a"],["oe","o"],["sh","s"],["kh","k"],["th","t"],["ph","f"],["pf","f"]]),zi=[/([^aeo])h(.)/g,"$1$2",/([aeo])h([^aeo]|$)/g,"$1$2",/(.)\1+/g,"$1"],Ni={a:"",e:"",i:"",o:"",u:"",y:"",b:1,f:1,p:1,v:1,c:2,g:2,j:2,k:2,q:2,s:2,x:2,z:2,\u00DF:2,d:3,t:3,l:4,m:5,n:5,r:6},ru={Exact:ji,Default:En,Normalize:En,LatinBalance:{mapper:Cr},LatinAdvanced:{mapper:Cr,matcher:Fi,replacer:zi},LatinExtra:{mapper:Cr,replacer:zi.concat([/(?!^)[aeo]/g,""]),matcher:Fi},LatinSoundex:{dedupe:!1,include:{letter:!0},finalize:function(n){for(let i=0;i<n.length;i++){var o=n[i];let a=o.charAt(0),l=Ni[a];for(let f=1,d;f<o.length&&(d=o.charAt(f),d==="h"||d==="w"||!(d=Ni[d])||d===l||(a+=d,l=d,a.length!==4));f++);n[i]=a}}},CJK:{split:""},LatinExact:ji,LatinDefault:En,LatinSimple:En};Re.prototype.remove=function(n,o){let i=this.reg.size&&(this.fastupdate?this.reg.get(n):this.reg.has(n));if(i){if(this.fastupdate){for(let a=0,l;a<i.length;a++)if(l=i[a])if(2>l.length)l.pop();else{let f=l.indexOf(n);f===i.length-1?l.pop():l.splice(f,1)}}else Gt(this.map,n),this.depth&&Gt(this.ctx,n);o||this.reg.delete(n)}return this.db&&(this.commit_task.push({del:n}),this.T&&rs(this)),this.cache&&this.cache.remove(n),this};function Gt(n,o){let i=0;var a=typeof o>"u";if(n.constructor===Array){for(let l=0,f,d;l<n.length;l++)if((f=n[l])&&f.length)if(a)i++;else if(d=f.indexOf(o),0<=d){1<f.length?(f.splice(d,1),i++):delete n[l];break}else i++}else for(let l of n.entries()){a=l[0];let f=Gt(l[1],o);f?i+=f:n.delete(a)}return i}var iu={memory:{resolution:1},performance:{resolution:3,fastupdate:!0,context:{depth:1,resolution:1}},match:{tokenize:"forward"},score:{resolution:9,context:{depth:2,resolution:3}}};Re.prototype.add=function(n,o,i,a){if(o&&(n||n===0)){if(!a&&!i&&this.reg.has(n))return this.update(n,o);a=this.depth,o=this.encoder.encode(o,!a);let b=o.length;if(b){let E=fe(),O=fe(),D=this.resolution;for(let j=0;j<b;j++){let B=o[this.rtl?b-1-j:j];var l=B.length;if(l&&(a||!O[B])){var f=this.score?this.score(o,B,j,null,0):Sn(D,b,j),d="";switch(this.tokenize){case"full":if(2<l){for(let U=0,$;U<l;U++)for(f=l;f>U;f--){d=B.substring(U,f),$=this.rtl?l-1-U:U;var m=this.score?this.score(o,B,j,d,$):Sn(D,b,j,l,$);Ft(this,O,d,m,n,i)}break}case"bidirectional":case"reverse":if(1<l){for(m=l-1;0<m;m--){d=B[this.rtl?l-1-m:m]+d;var y=this.score?this.score(o,B,j,d,m):Sn(D,b,j,l,m);Ft(this,O,d,y,n,i)}d=""}case"forward":if(1<l){for(m=0;m<l;m++)d+=B[this.rtl?l-1-m:m],Ft(this,O,d,f,n,i);break}default:if(Ft(this,O,B,f,n,i),a&&1<b&&j<b-1){for(l=fe(),d=this.U,f=B,m=Math.min(a+1,this.rtl?j+1:b-j),l[f]=1,y=1;y<m;y++)if((B=o[this.rtl?b-1-j-y:j+y])&&!l[B]){l[B]=1;let U=this.score?this.score(o,f,j,B,y-1):Sn(d+(b/2>d?0:1),b,j,m-1,y-1),$=this.bidirectional&&B>f;Ft(this,E,$?f:B,U,n,i,$?B:f)}}}}}this.fastupdate||this.reg.add(n)}else o=""}return this.db&&(o||this.commit_task.push({del:n}),this.T&&rs(this)),this};function Ft(n,o,i,a,l,f,d){let m=d?n.ctx:n.map,y;if((!o[i]||d&&!(y=o[i])[d])&&(d?(o=y||(o[i]=fe()),o[d]=1,(y=m.get(d))?m=y:m.set(d,m=new Map)):o[i]=1,(y=m.get(i))?m=y:m.set(i,m=y=[]),m=m[a]||(m[a]=[]),!f||!m.includes(l))){if(m.length===2**31-1){if(o=new ut(m),n.fastupdate)for(let b of n.reg.values())b.includes(m)&&(b[b.indexOf(m)]=o);y[a]=m=o}m.push(l),n.fastupdate&&((a=n.reg.get(l))?a.push(m):n.reg.set(l,[m]))}}function Sn(n,o,i,a,l){return i&&1<n?o+(a||0)<=n?i+(l||0):(n-1)/(o+(a||0))*(i+(l||0))+1|0:0}Re.prototype.search=function(n,o,i){i||(o||typeof n!="object"?typeof o=="object"&&(i=o,o=0):(i=n,n=""));let a=[],l,f,d,m=0,y,b,E,O,D;i?(n=i.query||n,o=i.limit||o,m=i.offset||0,f=i.context,d=i.suggest,D=(y=i.resolve!==!1)&&i.enrich,E=i.boost,O=i.resolution,b=this.db&&i.tag):y=this.resolve,f=this.depth&&f!==!1;let j=this.encoder.encode(n,!f);if(l=j.length,o=o||(y?100:0),l===1)return Ui.call(this,j[0],"",o,m,y,D,b);if(l===2&&f&&!d)return Ui.call(this,j[1],j[0],o,m,y,D,b);let B=fe(),U=0,$;if(f&&($=j[0],U=1),O||O===0||(O=$?this.U:this.resolution),this.db){if(this.db.search&&(n=this.db.search(this,j,o,m,d,y,D,b),n!==!1))return n;let X=this;return function(){return ne(this,null,function*(){for(let J,ve;U<l;U++){if((ve=j[U])&&!B[ve]){if(B[ve]=1,J=yield Rr(X,ve,$,0,0,!1,!1),J=Gi(J,a,d,O)){a=J;break}$&&(d&&J&&a.length||($=ve))}d&&$&&U===l-1&&!a.length&&(O=X.resolution,$="",U=-1,B=fe())}return Li(a,O,o,m,d,E,y)})}()}for(let X,J;U<l;U++){if((J=j[U])&&!B[J]){if(B[J]=1,X=Rr(this,J,$,0,0,!1,!1),X=Gi(X,a,d,O)){a=X;break}$&&(d&&X&&a.length||($=J))}d&&$&&U===l-1&&!a.length&&(O=this.resolution,$="",U=-1,B=fe())}return Li(a,O,o,m,d,E,y)};function Li(n,o,i,a,l,f,d){let m=n.length,y=n;if(1<m)y=Ji(n,o,i,a,l,f,d);else if(m===1)return d?jr.call(null,n[0],i,a):new ae(n[0]);return d?y:new ae(y)}function Ui(n,o,i,a,l,f,d){return n=Rr(this,n,o,i,a,l,f,d),this.db?n.then(function(m){return l?m||[]:new ae(m)}):n&&n.length?l?jr.call(this,n,i,a):new ae(n):l?[]:new ae}function Gi(n,o,i,a){let l=[];if(n&&n.length){if(n.length<=a){o.push(n);return}for(let f=0,d;f<a;f++)(d=n[f])&&(l[f]=d);if(l.length){o.push(l);return}}if(!i)return l}function Rr(n,o,i,a,l,f,d,m){let y;return i&&(y=n.bidirectional&&o>i)&&(y=i,i=o,o=y),n.db?n.db.get(o,i,a,l,f,d,m):(n=i?(n=n.ctx.get(i))&&n.get(o):n.map.get(o),n)}function Re(n,o){if(!this||this.constructor!==Re)return new Re(n);if(n){var i=Se(n)?n:n.preset;i&&(n=Object.assign({},iu[i],n))}else n={};i=n.context;let a=i===!0?{depth:1}:i||{},l=Se(n.encoder)?ru[n.encoder]:n.encode||n.encoder||{};this.encoder=l.encode?l:typeof l=="object"?new Lt(l):{encode:l},this.resolution=n.resolution||9,this.tokenize=i=(i=n.tokenize)&&i!=="default"&&i!=="exact"&&i||"strict",this.depth=i==="strict"&&a.depth||0,this.bidirectional=a.bidirectional!==!1,this.fastupdate=!!n.fastupdate,this.score=n.score||null,(i=n.keystore||0)&&(this.keystore=i),this.map=i?new Oe(i):new Map,this.ctx=i?new Oe(i):new Map,this.reg=o||(this.fastupdate?i?new Oe(i):new Map:i?new Ie(i):new Set),this.U=a.resolution||3,this.rtl=l.rtl||n.rtl||!1,this.cache=(i=n.cache||null)&&new lt(i),this.resolve=n.resolve!==!1,(i=n.db)&&(this.db=this.mount(i)),this.T=n.commit!==!1,this.commit_task=[],this.commit_timer=null,this.priority=n.priority||4}V=Re.prototype;V.mount=function(n){return this.commit_timer&&(clearTimeout(this.commit_timer),this.commit_timer=null),n.mount(this)};V.commit=function(n,o){return this.commit_timer&&(clearTimeout(this.commit_timer),this.commit_timer=null),this.db.commit(this,n,o)};V.destroy=function(){return this.commit_timer&&(clearTimeout(this.commit_timer),this.commit_timer=null),this.db.destroy()};function rs(n){n.commit_timer||(n.commit_timer=setTimeout(function(){n.commit_timer=null,n.db.commit(n,void 0,void 0)},1))}V.clear=function(){return this.map.clear(),this.ctx.clear(),this.reg.clear(),this.cache&&this.cache.clear(),this.db&&(this.commit_timer&&clearTimeout(this.commit_timer),this.commit_timer=null,this.commit_task=[{clear:!0}]),this};V.append=function(n,o){return this.add(n,o,!0)};V.contain=function(n){return this.db?this.db.has(n):this.reg.has(n)};V.update=function(n,o){let i=this,a=this.remove(n);return a&&a.then?a.then(()=>i.add(n,o)):this.add(n,o)};V.cleanup=function(){return this.fastupdate?(Gt(this.map),this.depth&&Gt(this.ctx),this):this};V.searchCache=ns;V.export=function(n,o,i=0,a=0){let l,f;switch(a){case 0:l="reg",f=Wi(this.reg);break;case 1:l="cfg",f=null;break;case 2:l="map",f=Br(this.map,this.reg.size);break;case 3:l="ctx",f=Vi(this.ctx,this.reg.size);break;default:return}return kn.call(this,n,o,l,f,i,a)};V.import=function(n,o){if(o)switch(typeof o=="string"&&(o=JSON.parse(o)),n=n.split("."),n[n.length-1]==="json"&&n.pop(),n.length===3&&n.shift(),n=1<n.length?n[1]:n[0],n){case"reg":this.fastupdate=!1,this.reg=Hi(o,this.reg);break;case"map":this.map=Mr(o,this.map);break;case"ctx":this.ctx=$i(o,this.ctx)}};V.serialize=function(n=!0){let o="",i="",a="";if(this.reg.size){let f;for(var l of this.reg.keys())f||(f=typeof l),o+=(o?",":"")+(f==="string"?'"'+l+'"':l);o="index.reg=new Set(["+o+"]);",i=Ki(this.map,f),i="index.map=new Map(["+i+"]);";for(let d of this.ctx.entries()){l=d[0];let m=Ki(d[1],f);m="new Map(["+m+"])",m='["'+l+'",'+m+"]",a+=(a?",":"")+m}a="index.ctx=new Map(["+a+"]);"}return n?"function inject(index){"+o+i+a+"}":o+i+a};Kr(Re.prototype);var is=typeof window<"u"&&(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB),Pn=["map","ctx","tag","reg","cfg"],st=fe();function Dr(n,o={}){if(!this||this.constructor!==Dr)return new Dr(n,o);typeof n=="object"&&(o=n,n=n.name),n||console.info("Default storage space was used, because a name was not passed."),this.id="flexsearch"+(n?":"+n.toLowerCase().replace(/[^a-z0-9_\-]/g,""):""),this.field=o.field?o.field.toLowerCase().replace(/[^a-z0-9_\-]/g,""):"",this.type=o.type,this.fastupdate=this.support_tag_search=!1,this.db=null,this.h={}}V=Dr.prototype;V.mount=function(n){return n.index?n.mount(this):(n.db=this,this.open())};V.open=function(){if(this.db)return this.db;let n=this;navigator.storage&&navigator.storage.persist(),st[n.id]||(st[n.id]=[]),st[n.id].push(n.field);let o=is.open(n.id,1);return o.onupgradeneeded=function(){let i=n.db=this.result;for(let a=0,l;a<Pn.length;a++){l=Pn[a];for(let f=0,d;f<st[n.id].length;f++)d=st[n.id][f],i.objectStoreNames.contains(l+(l!=="reg"&&d?":"+d:""))||i.createObjectStore(l+(l!=="reg"&&d?":"+d:""))}},n.db=He(o,function(i){n.db=i,n.db.onversionchange=function(){n.close()}})};V.close=function(){this.db&&this.db.close(),this.db=null};V.destroy=function(){let n=is.deleteDatabase(this.id);return He(n)};V.clear=function(){let n=[];for(let i=0,a;i<Pn.length;i++){a=Pn[i];for(let l=0,f;l<st[this.id].length;l++)f=st[this.id][l],n.push(a+(a!=="reg"&&f?":"+f:""))}let o=this.db.transaction(n,"readwrite");for(let i=0;i<n.length;i++)o.objectStore(n[i]).clear();return He(o)};V.get=function(n,o,i=0,a=0,l=!0,f=!1){n=this.db.transaction((o?"ctx":"map")+(this.field?":"+this.field:""),"readonly").objectStore((o?"ctx":"map")+(this.field?":"+this.field:"")).get(o?o+":"+n:n);let d=this;return He(n).then(function(m){let y=[];if(!m||!m.length)return y;if(l){if(!i&&!a&&m.length===1)return m[0];for(let b=0,E;b<m.length;b++)if((E=m[b])&&E.length){if(a>=E.length){a-=E.length;continue}let O=i?a+Math.min(E.length-a,i):E.length;for(let D=a;D<O;D++)y.push(E[D]);if(a=0,y.length===i)break}return f?d.enrich(y):y}return m})};V.tag=function(n,o=0,i=0,a=!1){n=this.db.transaction("tag"+(this.field?":"+this.field:""),"readonly").objectStore("tag"+(this.field?":"+this.field:"")).get(n);let l=this;return He(n).then(function(f){return!f||!f.length||i>=f.length?[]:!o&&!i?f:(f=f.slice(i,i+o),a?l.enrich(f):f)})};V.enrich=function(n){typeof n!="object"&&(n=[n]);let o=this.db.transaction("reg","readonly").objectStore("reg"),i=[];for(let a=0;a<n.length;a++)i[a]=He(o.get(n[a]));return Promise.all(i).then(function(a){for(let l=0;l<a.length;l++)a[l]={id:n[l],doc:a[l]?JSON.parse(a[l]):null};return a})};V.has=function(n){return n=this.db.transaction("reg","readonly").objectStore("reg").getKey(n),He(n).then(function(o){return!!o})};V.search=null;V.info=function(){};V.transaction=function(n,o,i){n+=n!=="reg"&&this.field?":"+this.field:"";let a=this.h[n+":"+o];if(a)return i.call(this,a);let l=this.db.transaction(n,o);this.h[n+":"+o]=a=l.objectStore(n);let f=i.call(this,a);return this.h[n+":"+o]=null,He(l).finally(function(){return l=a=null,f})};V.commit=function(n,o,i){return ne(this,null,function*(){if(o)yield this.clear(),n.commit_task=[];else{let a=n.commit_task;n.commit_task=[];for(let l=0,f;l<a.length;l++)if(f=a[l],f.clear){yield this.clear(),o=!0;break}else a[l]=f.del;o||(i||(a=a.concat(Go(n.reg))),a.length&&(yield this.remove(a)))}n.reg.size&&(yield this.transaction("map","readwrite",function(a){for(let l of n.map){let f=l[0],d=l[1];d.length&&(o?a.put(d,f):a.get(f).onsuccess=function(){let m=this.result;var y;if(m&&m.length){let b=Math.max(m.length,d.length);for(let E=0,O,D;E<b;E++)if((D=d[E])&&D.length){if((O=m[E])&&O.length)for(y=0;y<D.length;y++)O.push(D[y]);else m[E]=D;y=1}}else m=d,y=1;y&&a.put(m,f)})}}),yield this.transaction("ctx","readwrite",function(a){for(let l of n.ctx){let f=l[0],d=l[1];for(let m of d){let y=m[0],b=m[1];b.length&&(o?a.put(b,f+":"+y):a.get(f+":"+y).onsuccess=function(){let E=this.result;var O;if(E&&E.length){let D=Math.max(E.length,b.length);for(let j=0,B,U;j<D;j++)if((U=b[j])&&U.length){if((B=E[j])&&B.length)for(O=0;O<U.length;O++)B.push(U[O]);else E[j]=U;O=1}}else E=b,O=1;O&&a.put(E,f+":"+y)})}}}),n.store?yield this.transaction("reg","readwrite",function(a){for(let l of n.store){let f=l[0],d=l[1];a.put(typeof d=="object"?JSON.stringify(d):1,f)}}):n.bypass||(yield this.transaction("reg","readwrite",function(a){for(let l of n.reg.keys())a.put(1,l)})),n.tag&&(yield this.transaction("tag","readwrite",function(a){for(let l of n.tag){let f=l[0],d=l[1];d.length&&(a.get(f).onsuccess=function(){let m=this.result;m=m&&m.length?m.concat(d):d,a.put(m,f)})}})),n.map.clear(),n.ctx.clear(),n.tag&&n.tag.clear(),n.store&&n.store.clear(),n.document||n.reg.clear())})};function Pr(n,o,i){let a=n.value,l,f=0;for(let d=0,m;d<a.length;d++){if(m=i?a:a[d]){for(let y=0,b,E;y<o.length;y++)if(E=o[y],b=m.indexOf(E),0<=b)if(l=1,1<m.length)m.splice(b,1);else{a[d]=[];break}f+=m.length}if(i)break}f?l&&n.update(a):n.delete(),n.continue()}V.remove=function(n){return typeof n!="object"&&(n=[n]),Promise.all([this.transaction("map","readwrite",function(o){o.openCursor().onsuccess=function(){let i=this.result;i&&Pr(i,n)}}),this.transaction("ctx","readwrite",function(o){o.openCursor().onsuccess=function(){let i=this.result;i&&Pr(i,n)}}),this.transaction("tag","readwrite",function(o){o.openCursor().onsuccess=function(){let i=this.result;i&&Pr(i,n,!0)}}),this.transaction("reg","readwrite",function(o){for(let i=0;i<n.length;i++)o.delete(n[i])})])};function He(n,o){return new Promise((i,a)=>{n.onsuccess=n.oncomplete=function(){o&&o(this.result),o=null,i(this.result)},n.onerror=n.onblocked=a,n=null})}var ss=at;var An=class n{constructor(){}indices={};initIndex(o,i,a){return ne(this,null,function*(){this.indices[i]=this.createIndex(a)})}search(o,i){return ne(this,null,function*(){let a=this.indices[o];return a?yield a.searchAsync(i,{limit:10,enrich:!0}):[]})}getIndex(o){return this.indices[o]}addToIndex(o,i){return ne(this,null,function*(){let a=this.indices[o];a&&a.add(i)})}importIndex(o,i){return ne(this,null,function*(){try{let a=this.indices[o],l=JSON.parse(i);if(a&&l)for(let f of l)yield a.import(f.key,f.data)}catch(a){throw new Error(`Error importing index for table ${o}: ${a}`)}})}exportIndex(o){return ne(this,null,function*(){let i=this.indices[o];if(!i)throw new Error(`No index found for table ${o}`);let a=[];return yield i.export((l,f)=>{a.push({key:l.toString(),data:f})}),JSON.stringify(a)})}removeFromIndex(o,i){return ne(this,null,function*(){let a=this.indices[o];a&&a.remove(i)})}clearIndex(o){return ne(this,null,function*(){this.indices[o]=this.createIndex(["name"])})}createIndex(o){return new ss({tokenize:"forward",cache:!0,document:{id:"uuid",index:o}})}static \u0275fac=function(i){return new(i||n)};static \u0275prov=bn({token:n,factory:n.\u0275fac,providedIn:"root"})};var os=class n extends Ai{constructor(i){super("lasagna-db");this.flexsearchIndexService=i;let a=new Set;for(let l of Oi){if(a.has(l.version))throw new Error(`Duplicate migration version: ${l.version}`);a.add(l.version);let f=this.version(l.version).stores(l.schema);l.update&&f.upgrade(l.update),console.log(`Migration ${l.version} applied`)}setTimeout(()=>{this.initIndexes()})}productsStore;recipesStore;categoryStore;initIndexes(){return Promise.all([this.initIndex("productsStore"),this.initIndex("recipesStore"),this.initIndex("categoryProductsStore"),this.initIndex("categoryRecipesStore")]).then(()=>{})}initIndex(i){return ne(this,null,function*(){yield this.flexsearchIndexService.initIndex(this.getStore(i),i,["name"]);let a=yield this.getOne("indicesStore",i);a?yield this.flexsearchIndexService.importIndex(i,a.indexData):(yield this.getAll(i).then(l=>ne(this,null,function*(){for(let f of l)yield this.flexsearchIndexService.addToIndex(i,f)})),yield this.saveIndex(i))})}saveIndex(i){return ne(this,null,function*(){try{if(this.flexsearchIndexService.getIndex(i)){let l=yield this.flexsearchIndexService.exportIndex(i);yield this.replaceData("indicesStore",i,{table:i,indexData:l})}else{console.error("No index data found for table:",i);return}}catch(a){throw console.error("Error saving index:",a),a}})}loadIndex(i){return ne(this,null,function*(){let a=yield this.filter("indicesStore","table",i,!0);return a?.[0]?a[0].indexData:null})}addData(i,a,l){return ne(this,null,function*(){try{let f=l||this.generateUuid(),d=wn(gn({},a),{uuid:f});return yield this[i].put(d),i==="indicesStore"||(yield this.flexsearchIndexService.addToIndex(i,d),yield this.saveIndex(i)),f}catch(f){throw f}})}replaceData(i,a,l){return ne(this,null,function*(){let f=wn(gn({},l),{uuid:a});yield this[i].put(f),i!=="indicesStore"&&(yield this.flexsearchIndexService.addToIndex(i,f),yield this.saveIndex(i))})}search(i,a,l){return ne(this,null,function*(){return this[i].where(a).equals(l).toArray()})}filter(i,a,l,f=!1){return ne(this,null,function*(){return this[i].filter(d=>f?d[a]===l:d[a]?.toLowerCase().includes(l.toLowerCase())).toArray()})}getStore(i){return this[i]}getOne(i,a){return ne(this,null,function*(){return this[i].get(a)})}getAll(i){return ne(this,null,function*(){return this[i].toArray()})}getFirst(i){return ne(this,null,function*(){return this[i].toCollection().first()})}getMany(i,a){return ne(this,null,function*(){return this[i].where("uuid").anyOf(a).toArray()})}remove(i,a){return ne(this,null,function*(){yield this[i].delete(a),i!=="indicesStore"&&(yield this.flexsearchIndexService.removeFromIndex(i,a),yield this.saveIndex(i))})}clear(i){return ne(this,null,function*(){yield this[i].clear(),yield this.flexsearchIndexService.clearIndex(i),yield this.saveIndex(i)})}generateUuid(){return Ci()}balkAdd(i,a,l=!0){return ne(this,null,function*(){yield this[i].bulkPut(a.map(f=>wn(gn({},f),{uuid:l?this.generateUuid():f.uuid})))})}uniqueKeys(i,a){return ne(this,null,function*(){return this[i].orderBy(a).uniqueKeys()})}static \u0275fac=function(a){return new(a||n)(ki(An))};static \u0275prov=bn({token:n,factory:n.\u0275fac,providedIn:"root"})};export{Er as a,lu as b,Lo as c,Uo as d,Ci as e,An as f,os as g};
