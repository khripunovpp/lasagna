import{a as T}from"./chunk-GDWMH77M.js";import{a as P}from"./chunk-T25PAPNV.js";import{a as W,c as X,d as Y,e as ee,f as te,g as ie,h as ne}from"./chunk-QGYLIZFA.js";import{a as H,c as J}from"./chunk-OPWIYIGK.js";import{a as q}from"./chunk-65PCG7KQ.js";import{b as K}from"./chunk-UKAU3626.js";import"./chunk-G42TUXVK.js";import{a as oe}from"./chunk-ZBULITSO.js";import"./chunk-7JNSNANE.js";import{a as i}from"./chunk-RFEBMF6P.js";import"./chunk-Q24HNGKZ.js";import"./chunk-FG5PJ7WR.js";import{a as Z,d as U}from"./chunk-URRPTXWM.js";import"./chunk-E64ZE4KI.js";import{a as Q}from"./chunk-5PVAHMKX.js";import{a as $,c as B}from"./chunk-PXM5XOY4.js";import{t as O,w as G}from"./chunk-JUGNCNLY.js";import{$b as I,Cb as N,Eb as w,Fb as h,Gb as c,Hb as l,Ib as L,Mb as x,Pb as R,Qb as d,W as F,Za as r,ac as m,bc as D,ca as M,cb as S,cc as j,ea as u,f as k,hb as V,la as f,ma as _,mb as v,r as z,ub as p,x as b,xb as g,z as A}from"./chunk-46OIECST.js";var re=i.object({uuid:i.string().optional(),name:i.string().min(1).optional(),description:i.string().optional(),ingredients:i.array(i.object({name:i.string().min(1).optional(),uuid:i.string().optional(),amount:i.union([i.string(),i.number()]).optional(),product_id:i.string().optional(),recipe_id:i.string().optional(),unit:i.string().optional()})),outcome_amount:i.union([i.string(),i.number()]).optional(),outcome_unit:i.string().optional(),taxTemplateName:i.string().optional(),category_id:i.string().optional()});var pe=new M("CategorizedRecipesList",{factory:()=>{let e=u(T),o=u(P);return z(e.loadRecipes()).pipe(F(()=>e.recipes$)).pipe(b(n=>n.toSorted((s,a)=>s.name.localeCompare(a.name))),b(n=>Y(n,"category_id")),A(n=>k(void 0,null,function*(){let s=[];for(let C in n){let E=n[C],le=yield o.getOne(C);s.push({category:le?.name,recipes:E})}if(!s.length)return[];let[a,...y]=s.toSorted((C,E)=>C.category>E.category?1:-1);return a?.category?[a].concat(y):y.concat([a])})))}});var se=(e,o)=>o==null?null:o.category;function ae(e,o){e&1&&(c(0,"lg-button",6),L(1,"mat-icon",7),l()),e&2&&(g("success"),p("link","/recipes/add")("icon",!0)("size","medium"))}function me(e,o){if(e&1&&(c(0,"span"),m(1),l()),e&2){let t=o.$implicit;r(),D(t==null?null:t.name)}}function de(e,o){if(e&1){let t=x();c(0,"lg-gap-row",5)(1,"div",11)(2,"a",12),m(3),l()(),c(4,"lg-button",13),m(5," Calculate "),l(),c(6,"lg-button",14),R("click",function(){f(t);let s=d().$implicit,a=d(2);return _(a.deleteRecipe(s))}),L(7,"mat-icon",15),l()()}if(e&2){let t=d().$implicit;p("center",!0),r(2),p("routerLink","/recipes/edit/"+t.uuid),r(),D(t.name),r(),g("primary"),p("size","small")("link","/recipes/calculate/"+t.uuid)("flat",!0),r(2),g("danger"),p("size","tiny")("icon",!0)}}function ue(e,o){if(e&1&&v(0,de,8,12,"ng-template",10),e&2){let t=o.$implicit;p("uuid",t.uuid)}}function fe(e,o){if(e&1){let t=x();c(0,"lg-title",8),m(1),l(),c(2,"lg-card-list",9),R("onSelected",function(s){f(t),d();let a=I(12);return _(a.putSelected(s))}),w(3,ue,1,1,null,10,N),l()}if(e&2){let t=o.$implicit;d();let n=I(12);p("level",3),r(),j(" ",(t==null?null:t.category)||"Uncategorized"," "),r(),p("mode",n.selectionMode())("selectAll",n.selectAll())("deselectAll",n.deselectAll()),r(),h(t.recipes)}}function _e(e,o){e&1&&(c(0,"lg-gap-row",5)(1,"lg-title",8),m(2," No recipes found "),l()()),e&2&&(p("center",!0),r(),p("level",5))}var ce=class e{constructor(o,t,n){this._recipesRepository=o;this._notificationsService=t;this._transferDataService=n}recipes=K(u(pe));Stores=Z;RecipeDbInputScheme=re;ngOnInit(){this.loadRecipes()}deleteRecipe(o){this._recipesRepository.deleteRecipe(o.uuid).then(()=>{this.loadRecipes(),this._notificationsService.success("Recipe deleted")})}loadRecipes(){this._recipesRepository.loadRecipes()}exportRecipes(o){this._transferDataService.exportTable("recipesStore","json",{selected:Array.from(o)})}static \u0275fac=function(t){return new(t||e)(S(T),S(oe),S(ne))};static \u0275cmp=V({type:e,selectors:[["lg-recipes-list"]],decls:16,vars:8,consts:[["selectionZone",""],["lgQuickActionsTpl",""],[3,"click","flat","size"],[3,"onDone","schema","storeName"],["lgImportRowTpl",""],[3,"center"],[3,"link","icon","size"],["aria-hidden","false","fontIcon","add"],[3,"level"],[3,"onSelected","mode","selectAll","deselectAll"],["lgCardListItem","",3,"uuid"],[1,"expand"],[3,"routerLink"],[3,"size","link","flat"],[3,"click","size","icon"],["aria-hidden","false","aria-label","Example home icon","fontIcon","close"]],template:function(t,n){if(t&1){let s=x();c(0,"lg-controls-bar"),v(1,ae,2,5,"ng-template",1),c(2,"lg-button",2),R("click",function(){f(s);let y=I(12);return _(n.exportRecipes(y.selected()))}),m(3," Export "),l(),c(4,"lg-import",3),R("onDone",function(){return f(s),_(n.loadRecipes())}),v(5,me,2,1,"ng-template",4),l()(),c(6,"lg-fade-in")(7,"lg-container")(8,"lg-gap-row",5)(9,"lg-title"),m(10," Recipes "),l()(),c(11,"lg-selection-zone",null,0),w(13,fe,5,5,null,null,se,!1,_e,3,2,"lg-gap-row",5),l()()()}t&2&&(r(2),g("info"),p("flat",!0)("size","small"),r(2),p("schema",n.RecipeDbInputScheme)("storeName",n.Stores.RECIPES),r(4),p("center",!0),r(5),h(n.recipes()))},dependencies:[Q,U,O,q,$,B,J,H,X,W,ee,G,ie,te],styles:["[_nghost-%COMP%]{display:block}"]})};export{ce as RecipesListComponent};
