{
  "version": 3,
  "sources": ["src/app/features/settings/view/categories/category-recipe/add-category/add-category-recipe-form.component.ts"],
  "sourcesContent": ["import {Component, effect, EventEmitter, Inject, input, OnInit, Output, signal} from '@angular/core';\nimport {FormControl, FormGroup, ReactiveFormsModule, Validators} from '@angular/forms';\nimport {InputComponent} from '../../../../../controls/form/input.component';\nimport {ControlComponent} from '../../../../../controls/form/control-item/control.component';\nimport {ButtonComponent} from '../../../../../../shared/view/ui/button/button.component';\nimport {FlexRowComponent} from '../../../../../../shared/view/layout/flex-row.component';\nimport {ExpandDirective} from '../../../../../../shared/view/directives/expand.directive';\nimport {NoWrapDirective} from '../../../../../../shared/view/directives/no-wrap.directive';\nimport {NotificationsService, SelectResourcesService} from '../../../../../../shared/service/services';\nimport {CategoryRecipesRepository} from '../../../../../../shared/service/repositories';\nimport {Router} from '@angular/router';\nimport {CategoryRecipe} from '../../../../service/models/CategoryRecipe';\nimport {\n  categoryRecipeDTOFromFormValue,\n  categoryRecipeToFormValue,\n  errorHandler\n} from '../../../../../../shared/helpers';\nimport {TranslatePipe} from '@ngx-translate/core';\nimport {FadeInComponent} from '../../../../../../shared/view/ui/fade-in.component';\nimport {FlexColumnComponent} from '../../../../../../shared/view/layout/flex-column.component';\nimport {TitleComponent} from '../../../../../../shared/view/layout/title.component';\nimport {matchMediaSignal} from '../../../../../../shared/view/signals/match-media.signal';\nimport {mobileBreakpoint} from '../../../../../../shared/view/const/breakpoints';\n\n@Component({\n  selector: 'lg-add-category-recipe-form',\n  standalone: true,\n  template: `\n    <lg-fade-in>\n     <lg-flex-column [size]=\"'small'\">\n        <div class=\"text-small\">{{ 'categories.add-product' | translate }}</div>\n\n        <form [formGroup]=\"form\">\n          <lg-flex-row [bottom]=\"true\"\n                       [size]=\"'medium'\">\n            <lg-control lgExpand>\n              <lg-input (onEnter)=\"onEnter()\"\n                        [placeholder]=\"'settings.category.placeholder' | translate\"\n                        [size]=\"isMobile() ? 'small' : 'normal'\"\n                        formControlName=\"name\"></lg-input>\n            </lg-control>\n\n            <div lgNoWrap>\n              @if (uuid()) {\n                <lg-button [disabled]=\"!form.dirty\"\n                           [style]=\"'primary'\"\n                           [size]=\"isMobile() ? 'small' : 'regular'\"\n                           (click)=\"editCategory()\">\n                  @if (form.dirty) {\n                    {{ 'settings.category.save' | translate }}\n                  } @else {\n                    {{ 'settings.category.no-changes' | translate }}\n                  }\n                </lg-button>\n              } @else {\n                <lg-button [disabled]=\"!form.dirty\"\n                           [style]=\"'primary'\"\n                           [size]=\"isMobile() ? 'small' : 'regular'\"\n                           (click)=\"addCategory()\">\n                  @if (form.dirty) {\n                    {{ 'settings.category.add' | translate }}\n                  } @else {\n                    {{ 'settings.category.enter-name' | translate }}\n                  }\n                </lg-button>\n              }\n            </div>\n          </lg-flex-row>\n        </form>\n      </lg-flex-column>\n    </lg-fade-in>\n  `,\n  imports: [\n    ReactiveFormsModule,\n    InputComponent,\n    ControlComponent,\n    ButtonComponent,\n    FlexRowComponent,\n    ExpandDirective,\n    NoWrapDirective,\n    TranslatePipe,\n    FadeInComponent,\n    FlexColumnComponent,\n    TitleComponent\n  ],\n  styles: [\n    `\n    `\n  ],\n})\nexport class AddCategoryRecipeFormComponent\n  implements OnInit {\n  constructor(\n    public _categoryRepository: CategoryRecipesRepository,\n    @Inject(SelectResourcesService) public _selectResourcesService: SelectResourcesService,\n    private _router: Router,\n    private _notificationsService: NotificationsService,\n  ) {\n  }\n\n  isMobile = matchMediaSignal(mobileBreakpoint);\n  form = new FormGroup({\n    name: new FormControl('', Validators.required),\n  });\n  category = signal<CategoryRecipe | undefined>(undefined);\n  uuid = input<string>('');\n  @Output() onSaved = new EventEmitter<string>();\n  private uuidEffect = effect(() => {\n    if (!this.uuid()) {\n      this.category.set(CategoryRecipe.empty());\n      return;\n    }\n    this._categoryRepository.getOne(this.uuid())\n      .then(category => {\n        this.form.reset(categoryRecipeToFormValue(category));\n        this.category.set(category);\n        this.form.markAsPristine();\n      })\n      .catch(error => {\n        this._notificationsService.error(errorHandler(error));\n      });\n  });\n\n  ngOnInit() {\n    this.form.valueChanges.subscribe(values => {\n      this.category()?.update(categoryRecipeDTOFromFormValue(values));\n    })\n  }\n\n  addCategory() {\n    if (!this.category() || !this.form.dirty) {\n      return Promise.resolve();\n    }\n\n    return this._categoryRepository.addCategory(this.category()!)\n      .then(() => {\n        this.onSaved.emit(this.uuid());\n        this.form.reset({\n          name: '',\n        });\n        this._notificationsService.success('settings.category.added');\n        this.form.markAsPristine();\n        this._categoryRepository.loadAll();\n      })\n      .catch(error => {\n        this._notificationsService.error(errorHandler(error));\n      });\n  }\n\n  editCategory() {\n    if (!this.category() || !this.form.dirty) {\n      return Promise.resolve();\n    }\n\n    return this._categoryRepository.editCategory(this.uuid(), this.category()!)\n      .then(() => {\n        this.onSaved.emit(this.uuid());\n        this.form.reset({\n          name: '',\n        });\n        this._notificationsService.success('settings.category.edited');\n        this.form.markAsPristine();\n        this._categoryRepository.loadAll();\n      })\n      .catch(error => {\n        this._notificationsService.error(errorHandler(error));\n      });\n  }\n\n  onEnter() {\n    if (this.uuid()) {\n      this.editCategory();\n    } else {\n      this.addCategory();\n    }\n  }\n}\n"],
  "mappings": "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",
  "names": []
}
