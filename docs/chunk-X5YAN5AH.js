import{a as il}from"./chunk-DELOOZDJ.js";import{a as Di,c as ls,e as cs,w as fs,x as nr}from"./chunk-UAPQ4Z4N.js";import{Ab as wi,Ac as as,Ca as yt,Eb as Ci,Fb as qo,Fc as us,Ib as Rt,Jb as tr,Kb as Zo,Lb as es,S as Jn,Sa as yi,Sb as ts,T as Le,Tb as ns,U as nn,Ub as xi,V as Xn,Wa as _i,X as vt,Xa as ie,Y as Ho,ab as Yo,ac as ze,bb as Zn,bc as rs,cb as we,ea as $o,eb as Ae,f as Go,fa as Wo,fb as er,hb as Qo,jc as is,k as Uo,la as rn,nb as sn,oc as tt,pa as on,pb as Pt,pc as an,q as Lo,qa as qn,sa as vi,tb as Jo,tc as os,ub as Xo,uc as Ve,vc as ss,w as zo,zb as bi}from"./chunk-SYQBEC7E.js";import{a as be,b as De,d as nl,e as rl,f as re}from"./chunk-2WH2EVR6.js";var Ws=nl((Ni,ji)=>{"use strict";(function(e,i){typeof Ni=="object"&&typeof ji<"u"?ji.exports=i():typeof define=="function"&&define.amd?define(i):(e=typeof globalThis<"u"?globalThis:e||self,e.Dexie=i())})(Ni,function(){"use strict";var e=function(n,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var l in u)Object.prototype.hasOwnProperty.call(u,l)&&(o[l]=u[l])},e(n,r)};function i(n,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(n,r);function o(){this.constructor=n}n.prototype=r===null?Object.create(r):(o.prototype=r.prototype,new o)}var t=function(){return t=Object.assign||function(r){for(var o,u=1,l=arguments.length;u<l;u++){o=arguments[u];for(var f in o)Object.prototype.hasOwnProperty.call(o,f)&&(r[f]=o[f])}return r},t.apply(this,arguments)};function s(n,r,o){if(o||arguments.length===2)for(var u=0,l=r.length,f;u<l;u++)(f||!(u in r))&&(f||(f=Array.prototype.slice.call(r,0,u)),f[u]=r[u]);return n.concat(f||Array.prototype.slice.call(r))}var a=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,c=Object.keys,h=Array.isArray;typeof Promise<"u"&&!a.Promise&&(a.Promise=Promise);function m(n,r){return typeof r!="object"||c(r).forEach(function(o){n[o]=r[o]}),n}var v=Object.getPrototypeOf,b={}.hasOwnProperty;function x(n,r){return b.call(n,r)}function k(n,r){typeof r=="function"&&(r=r(v(n))),(typeof Reflect>"u"?c:Reflect.ownKeys)(r).forEach(function(o){B(n,o,r[o])})}var P=Object.defineProperty;function B(n,r,o,u){P(n,r,m(o&&x(o,"get")&&typeof o.get=="function"?{get:o.get,set:o.set,configurable:!0}:{value:o,configurable:!0,writable:!0},u))}function T(n){return{from:function(r){return n.prototype=Object.create(r.prototype),B(n.prototype,"constructor",n),{extend:k.bind(null,n.prototype)}}}}var U=Object.getOwnPropertyDescriptor;function H(n,r){var o=U(n,r),u;return o||(u=v(n))&&H(u,r)}var X=[].slice;function J(n,r,o){return X.call(n,r,o)}function me(n,r){return r(n)}function ae(n){if(!n)throw new Error("Assertion Failed")}function q(n){a.setImmediate?setImmediate(n):setTimeout(n,0)}function ce(n,r){return n.reduce(function(o,u,l){var f=r(u,l);return f&&(o[f[0]]=f[1]),o},{})}function pe(n,r){if(typeof r=="string"&&x(n,r))return n[r];if(!r)return n;if(typeof r!="string"){for(var o=[],u=0,l=r.length;u<l;++u){var f=pe(n,r[u]);o.push(f)}return o}var d=r.indexOf(".");if(d!==-1){var p=n[r.substr(0,d)];return p==null?void 0:pe(p,r.substr(d+1))}}function oe(n,r,o){if(!(!n||r===void 0)&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof r!="string"&&"length"in r){ae(typeof o!="string"&&"length"in o);for(var u=0,l=r.length;u<l;++u)oe(n,r[u],o[u])}else{var f=r.indexOf(".");if(f!==-1){var d=r.substr(0,f),p=r.substr(f+1);if(p==="")o===void 0?h(n)&&!isNaN(parseInt(d))?n.splice(d,1):delete n[d]:n[d]=o;else{var g=n[d];(!g||!x(n,d))&&(g=n[d]={}),oe(g,p,o)}}else o===void 0?h(n)&&!isNaN(parseInt(r))?n.splice(r,1):delete n[r]:n[r]=o}}function Pe(n,r){typeof r=="string"?oe(n,r,void 0):"length"in r&&[].map.call(r,function(o){oe(n,o,void 0)})}function Ce(n){var r={};for(var o in n)x(n,o)&&(r[o]=n[o]);return r}var Er=[].concat;function qi(n){return Er.apply([],n)}var Aa="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(qi([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(r){return r+n+"Array"})}))).filter(function(n){return a[n]}),Zi=new Set(Aa.map(function(n){return a[n]}));function eo(n){var r={};for(var o in n)if(x(n,o)){var u=n[o];r[o]=!u||typeof u!="object"||Zi.has(u.constructor)?u:eo(u)}return r}function Sa(n){for(var r in n)if(x(n,r))return!1;return!0}var Gt=null;function st(n){Gt=new WeakMap;var r=Ar(n);return Gt=null,r}function Ar(n){if(!n||typeof n!="object")return n;var r=Gt.get(n);if(r)return r;if(h(n)){r=[],Gt.set(n,r);for(var o=0,u=n.length;o<u;++o)r.push(Ar(n[o]))}else if(Zi.has(n.constructor))r=n;else{var l=v(n);r=l===Object.prototype?{}:Object.create(l),Gt.set(n,r);for(var f in n)x(n,f)&&(r[f]=Ar(n[f]))}return r}var Ia={}.toString;function Sr(n){return Ia.call(n).slice(8,-1)}var Ir=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Va=typeof Ir=="symbol"?function(n){var r;return n!=null&&(r=n[Ir])&&r.apply(n)}:function(){return null};function at(n,r){var o=n.indexOf(r);return o>=0&&n.splice(o,1),o>=0}var Dt={};function Ke(n){var r,o,u,l;if(arguments.length===1){if(h(n))return n.slice();if(this===Dt&&typeof n=="string")return[n];if(l=Va(n)){for(o=[];u=l.next(),!u.done;)o.push(u.value);return o}if(n==null)return[n];if(r=n.length,typeof r=="number"){for(o=new Array(r);r--;)o[r]=n[r];return o}return[n]}for(r=arguments.length,o=new Array(r);r--;)o[r]=arguments[r];return o}var Vr=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Ma=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],to=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Mr=Ma.concat(to),ka={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Et(n,r){this.name=n,this.message=r}T(Et).from(Error).extend({toString:function(){return this.name+": "+this.message}});function no(n,r){return n+". Errors: "+Object.keys(r).map(function(o){return r[o].toString()}).filter(function(o,u,l){return l.indexOf(o)===u}).join(`
`)}function xn(n,r,o,u){this.failures=r,this.failedKeys=u,this.successCount=o,this.message=no(n,r)}T(xn).from(Et);function At(n,r){this.name="BulkError",this.failures=Object.keys(r).map(function(o){return r[o]}),this.failuresByPos=r,this.message=no(n,this.failures)}T(At).from(Et);var kr=Mr.reduce(function(n,r){return n[r]=r+"Error",n},{}),Oa=Et,W=Mr.reduce(function(n,r){var o=r+"Error";function u(l,f){this.name=o,l?typeof l=="string"?(this.message="".concat(l).concat(f?`
 `+f:""),this.inner=f||null):typeof l=="object"&&(this.message="".concat(l.name," ").concat(l.message),this.inner=l):(this.message=ka[r]||o,this.inner=null)}return T(u).from(Oa),n[r]=u,n},{});W.Syntax=SyntaxError,W.Type=TypeError,W.Range=RangeError;var ro=to.reduce(function(n,r){return n[r+"Error"]=W[r],n},{});function Pa(n,r){if(!n||n instanceof Et||n instanceof TypeError||n instanceof SyntaxError||!n.name||!ro[n.name])return n;var o=new ro[n.name](r||n.message,n);return"stack"in n&&B(o,"stack",{get:function(){return this.inner.stack}}),o}var Dn=Mr.reduce(function(n,r){return["Syntax","Type","Range"].indexOf(r)===-1&&(n[r+"Error"]=W[r]),n},{});Dn.ModifyError=xn,Dn.DexieError=Et,Dn.BulkError=At;function se(){}function Ut(n){return n}function Ra(n,r){return n==null||n===Ut?r:function(o){return r(n(o))}}function ut(n,r){return function(){n.apply(this,arguments),r.apply(this,arguments)}}function Ta(n,r){return n===se?r:function(){var o=n.apply(this,arguments);o!==void 0&&(arguments[0]=o);var u=this.onsuccess,l=this.onerror;this.onsuccess=null,this.onerror=null;var f=r.apply(this,arguments);return u&&(this.onsuccess=this.onsuccess?ut(u,this.onsuccess):u),l&&(this.onerror=this.onerror?ut(l,this.onerror):l),f!==void 0?f:o}}function Fa(n,r){return n===se?r:function(){n.apply(this,arguments);var o=this.onsuccess,u=this.onerror;this.onsuccess=this.onerror=null,r.apply(this,arguments),o&&(this.onsuccess=this.onsuccess?ut(o,this.onsuccess):o),u&&(this.onerror=this.onerror?ut(u,this.onerror):u)}}function Ba(n,r){return n===se?r:function(o){var u=n.apply(this,arguments);m(o,u);var l=this.onsuccess,f=this.onerror;this.onsuccess=null,this.onerror=null;var d=r.apply(this,arguments);return l&&(this.onsuccess=this.onsuccess?ut(l,this.onsuccess):l),f&&(this.onerror=this.onerror?ut(f,this.onerror):f),u===void 0?d===void 0?void 0:d:m(u,d)}}function Na(n,r){return n===se?r:function(){return r.apply(this,arguments)===!1?!1:n.apply(this,arguments)}}function Or(n,r){return n===se?r:function(){var o=n.apply(this,arguments);if(o&&typeof o.then=="function"){for(var u=this,l=arguments.length,f=new Array(l);l--;)f[l]=arguments[l];return o.then(function(){return r.apply(u,f)})}return r.apply(this,arguments)}}var Re=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function io(n,r){Re=n}var Lt={},oo=100,Pr=typeof Promise>"u"?[]:function(){var n=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[n,v(n),n];var r=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[r,v(r),n]}(),so=Pr[0],ao=Pr[1],ja=Pr[2],Ka=ao&&ao.then,lt=so&&so.constructor,Rr=!!ja;function Ga(){queueMicrotask(La)}var zt=function(n,r){Ht.push([n,r]),En&&(Ga(),En=!1)},Tr=!0,En=!0,ct=[],An=[],Fr=Ut,$e={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:se,pgp:!1,env:{},finalize:se},L=$e,Ht=[],ft=0,Sn=[];function j(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var r=this._PSD=L;if(typeof n!="function"){if(n!==Lt)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Nr(this,this._value);return}this._state=null,this._value=null,++r.ref,lo(this,n)}var Br={get:function(){var n=L,r=kn;function o(u,l){var f=this,d=!n.global&&(n!==L||r!==kn),p=d&&!Ye(),g=new j(function(y,C){jr(f,new uo(ho(u,n,d,p),ho(l,n,d,p),y,C,n))});return this._consoleTask&&(g._consoleTask=this._consoleTask),g}return o.prototype=Lt,o},set:function(n){B(this,"then",n&&n.prototype===Lt?Br:{get:function(){return n},set:Br.set})}};k(j.prototype,{then:Br,_then:function(n,r){jr(this,new uo(null,null,n,r,L))},catch:function(n){if(arguments.length===1)return this.then(null,n);var r=arguments[0],o=arguments[1];return typeof r=="function"?this.then(null,function(u){return u instanceof r?o(u):In(u)}):this.then(null,function(u){return u&&u.name===r?o(u):In(u)})},finally:function(n){return this.then(function(r){return j.resolve(n()).then(function(){return r})},function(r){return j.resolve(n()).then(function(){return In(r)})})},timeout:function(n,r){var o=this;return n<1/0?new j(function(u,l){var f=setTimeout(function(){return l(new W.Timeout(r))},n);o.then(u,l).finally(clearTimeout.bind(null,f))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&B(j.prototype,Symbol.toStringTag,"Dexie.Promise"),$e.env=fo();function uo(n,r,o,u,l){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof r=="function"?r:null,this.resolve=o,this.reject=u,this.psd=l}k(j,{all:function(){var n=Ke.apply(null,arguments).map(On);return new j(function(r,o){n.length===0&&r([]);var u=n.length;n.forEach(function(l,f){return j.resolve(l).then(function(d){n[f]=d,--u||r(n)},o)})})},resolve:function(n){if(n instanceof j)return n;if(n&&typeof n.then=="function")return new j(function(o,u){n.then(o,u)});var r=new j(Lt,!0,n);return r},reject:In,race:function(){var n=Ke.apply(null,arguments).map(On);return new j(function(r,o){n.map(function(u){return j.resolve(u).then(r,o)})})},PSD:{get:function(){return L},set:function(n){return L=n}},totalEchoes:{get:function(){return kn}},newPSD:We,usePSD:ht,scheduler:{get:function(){return zt},set:function(n){zt=n}},rejectionMapper:{get:function(){return Fr},set:function(n){Fr=n}},follow:function(n,r){return new j(function(o,u){return We(function(l,f){var d=L;d.unhandleds=[],d.onunhandled=f,d.finalize=ut(function(){var p=this;za(function(){p.unhandleds.length===0?l():f(p.unhandleds[0])})},d.finalize),n()},r,o,u)})}}),lt&&(lt.allSettled&&B(j,"allSettled",function(){var n=Ke.apply(null,arguments).map(On);return new j(function(r){n.length===0&&r([]);var o=n.length,u=new Array(o);n.forEach(function(l,f){return j.resolve(l).then(function(d){return u[f]={status:"fulfilled",value:d}},function(d){return u[f]={status:"rejected",reason:d}}).then(function(){return--o||r(u)})})})}),lt.any&&typeof AggregateError<"u"&&B(j,"any",function(){var n=Ke.apply(null,arguments).map(On);return new j(function(r,o){n.length===0&&o(new AggregateError([]));var u=n.length,l=new Array(u);n.forEach(function(f,d){return j.resolve(f).then(function(p){return r(p)},function(p){l[d]=p,--u||o(new AggregateError(l))})})})}),lt.withResolvers&&(j.withResolvers=lt.withResolvers));function lo(n,r){try{r(function(o){if(n._state===null){if(o===n)throw new TypeError("A promise cannot be resolved with itself.");var u=n._lib&&St();o&&typeof o.then=="function"?lo(n,function(l,f){o instanceof j?o._then(l,f):o.then(l,f)}):(n._state=!0,n._value=o,co(n)),u&&It()}},Nr.bind(null,n))}catch(o){Nr(n,o)}}function Nr(n,r){if(An.push(r),n._state===null){var o=n._lib&&St();r=Fr(r),n._state=!1,n._value=r,Ha(n),co(n),o&&It()}}function co(n){var r=n._listeners;n._listeners=[];for(var o=0,u=r.length;o<u;++o)jr(n,r[o]);var l=n._PSD;--l.ref||l.finalize(),ft===0&&(++ft,zt(function(){--ft===0&&Kr()},[]))}function jr(n,r){if(n._state===null){n._listeners.push(r);return}var o=n._state?r.onFulfilled:r.onRejected;if(o===null)return(n._state?r.resolve:r.reject)(n._value);++r.psd.ref,++ft,zt(Ua,[o,n,r])}function Ua(n,r,o){try{var u,l=r._value;!r._state&&An.length&&(An=[]),u=Re&&r._consoleTask?r._consoleTask.run(function(){return n(l)}):n(l),!r._state&&An.indexOf(l)===-1&&$a(r),o.resolve(u)}catch(f){o.reject(f)}finally{--ft===0&&Kr(),--o.psd.ref||o.psd.finalize()}}function La(){ht($e,function(){St()&&It()})}function St(){var n=Tr;return Tr=!1,En=!1,n}function It(){var n,r,o;do for(;Ht.length>0;)for(n=Ht,Ht=[],o=n.length,r=0;r<o;++r){var u=n[r];u[0].apply(null,u[1])}while(Ht.length>0);Tr=!0,En=!0}function Kr(){var n=ct;ct=[],n.forEach(function(u){u._PSD.onunhandled.call(null,u._value,u)});for(var r=Sn.slice(0),o=r.length;o;)r[--o]()}function za(n){function r(){n(),Sn.splice(Sn.indexOf(r),1)}Sn.push(r),++ft,zt(function(){--ft===0&&Kr()},[])}function Ha(n){ct.some(function(r){return r._value===n._value})||ct.push(n)}function $a(n){for(var r=ct.length;r;)if(ct[--r]._value===n._value){ct.splice(r,1);return}}function In(n){return new j(Lt,!1,n)}function ue(n,r){var o=L;return function(){var u=St(),l=L;try{return Qe(o,!0),n.apply(this,arguments)}catch(f){r&&r(f)}finally{Qe(l,!1),u&&It()}}}var ge={awaits:0,echoes:0,id:0},Wa=0,Vn=[],Mn=0,kn=0,Ya=0;function We(n,r,o,u){var l=L,f=Object.create(l);f.parent=l,f.ref=0,f.global=!1,f.id=++Ya,$e.env,f.env=Rr?{Promise:j,PromiseProp:{value:j,configurable:!0,writable:!0},all:j.all,race:j.race,allSettled:j.allSettled,any:j.any,resolve:j.resolve,reject:j.reject}:{},r&&m(f,r),++l.ref,f.finalize=function(){--this.parent.ref||this.parent.finalize()};var d=ht(f,n,o,u);return f.ref===0&&f.finalize(),d}function Vt(){return ge.id||(ge.id=++Wa),++ge.awaits,ge.echoes+=oo,ge.id}function Ye(){return ge.awaits?(--ge.awaits===0&&(ge.id=0),ge.echoes=ge.awaits*oo,!0):!1}(""+Ka).indexOf("[native code]")===-1&&(Vt=Ye=se);function On(n){return ge.echoes&&n&&n.constructor===lt?(Vt(),n.then(function(r){return Ye(),r},function(r){return Ye(),de(r)})):n}function Qa(n){++kn,(!ge.echoes||--ge.echoes===0)&&(ge.echoes=ge.awaits=ge.id=0),Vn.push(L),Qe(n,!0)}function Ja(){var n=Vn[Vn.length-1];Vn.pop(),Qe(n,!1)}function Qe(n,r){var o=L;if((r?ge.echoes&&(!Mn++||n!==L):Mn&&(!--Mn||n!==L))&&queueMicrotask(r?Qa.bind(null,n):Ja),n!==L&&(L=n,o===$e&&($e.env=fo()),Rr)){var u=$e.env.Promise,l=n.env;(o.global||n.global)&&(Object.defineProperty(a,"Promise",l.PromiseProp),u.all=l.all,u.race=l.race,u.resolve=l.resolve,u.reject=l.reject,l.allSettled&&(u.allSettled=l.allSettled),l.any&&(u.any=l.any))}}function fo(){var n=a.Promise;return Rr?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(a,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function ht(n,r,o,u,l){var f=L;try{return Qe(n,!0),r(o,u,l)}finally{Qe(f,!1)}}function ho(n,r,o,u){return typeof n!="function"?n:function(){var l=L;o&&Vt(),Qe(r,!0);try{return n.apply(this,arguments)}finally{Qe(l,!1),u&&queueMicrotask(Ye)}}}function Gr(n){Promise===lt&&ge.echoes===0?Mn===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}var de=j.reject;function Ur(n,r,o,u){if(!n.idbdb||!n._state.openComplete&&!L.letThrough&&!n._vip){if(n._state.openComplete)return de(new W.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._state.autoOpen)return de(new W.DatabaseClosed);n.open().catch(se)}return n._state.dbReadyPromise.then(function(){return Ur(n,r,o,u)})}else{var l=n._createTransaction(r,o,n._dbSchema);try{l.create(),n._state.PR1398_maxLoop=3}catch(f){return f.name===kr.InvalidState&&n.isOpen()&&--n._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),n.close({disableAutoOpen:!1}),n.open().then(function(){return Ur(n,r,o,u)})):de(f)}return l._promise(r,function(f,d){return We(function(){return L.trans=l,u(f,d,l)})}).then(function(f){if(r==="readwrite")try{l.idbtrans.commit()}catch{}return r==="readonly"?f:l._completion.then(function(){return f})})}}var po="4.0.11",dt="\uFFFF",Lr=-1/0,Ge="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",go="String expected.",Mt=[],Pn="__dbnames",zr="readonly",Hr="readwrite";function pt(n,r){return n?r?function(){return n.apply(this,arguments)&&r.apply(this,arguments)}:n:r}var mo={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Rn(n){return typeof n=="string"&&!/\./.test(n)?function(r){return r[n]===void 0&&n in r&&(r=st(r),delete r[n]),r}:function(r){return r}}function vo(){throw W.Type()}function te(n,r){try{var o=yo(n),u=yo(r);if(o!==u)return o==="Array"?1:u==="Array"?-1:o==="binary"?1:u==="binary"?-1:o==="string"?1:u==="string"?-1:o==="Date"?1:u!=="Date"?NaN:-1;switch(o){case"number":case"Date":case"string":return n>r?1:n<r?-1:0;case"binary":return qa(_o(n),_o(r));case"Array":return Xa(n,r)}}catch{}return NaN}function Xa(n,r){for(var o=n.length,u=r.length,l=o<u?o:u,f=0;f<l;++f){var d=te(n[f],r[f]);if(d!==0)return d}return o===u?0:o<u?-1:1}function qa(n,r){for(var o=n.length,u=r.length,l=o<u?o:u,f=0;f<l;++f)if(n[f]!==r[f])return n[f]<r[f]?-1:1;return o===u?0:o<u?-1:1}function yo(n){var r=typeof n;if(r!=="object")return r;if(ArrayBuffer.isView(n))return"binary";var o=Sr(n);return o==="ArrayBuffer"?"binary":o}function _o(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}var bo=function(){function n(){}return n.prototype._trans=function(r,o,u){var l=this._tx||L.trans,f=this.name,d=Re&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(r==="readonly"?"read":"write"," ").concat(this.name));function p(C,_,A){if(!A.schema[f])throw new W.NotFound("Table "+f+" not part of transaction");return o(A.idbtrans,A)}var g=St();try{var y=l&&l.db._novip===this.db._novip?l===L.trans?l._promise(r,p,u):We(function(){return l._promise(r,p,u)},{trans:l,transless:L.transless||L}):Ur(this.db,r,[this.name],p);return d&&(y._consoleTask=d,y=y.catch(function(C){return console.trace(C),de(C)})),y}finally{g&&It()}},n.prototype.get=function(r,o){var u=this;return r&&r.constructor===Object?this.where(r).first(o):r==null?de(new W.Type("Invalid argument to Table.get()")):this._trans("readonly",function(l){return u.core.get({trans:l,key:r}).then(function(f){return u.hook.reading.fire(f)})}).then(o)},n.prototype.where=function(r){if(typeof r=="string")return new this.db.WhereClause(this,r);if(h(r))return new this.db.WhereClause(this,"[".concat(r.join("+"),"]"));var o=c(r);if(o.length===1)return this.where(o[0]).equals(r[o[0]]);var u=this.schema.indexes.concat(this.schema.primKey).filter(function(C){if(C.compound&&o.every(function(A){return C.keyPath.indexOf(A)>=0})){for(var _=0;_<o.length;++_)if(o.indexOf(C.keyPath[_])===-1)return!1;return!0}return!1}).sort(function(C,_){return C.keyPath.length-_.keyPath.length})[0];if(u&&this.db._maxKey!==dt){var l=u.keyPath.slice(0,o.length);return this.where(l).equals(l.map(function(C){return r[C]}))}!u&&Re&&console.warn("The query ".concat(JSON.stringify(r)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(o.join("+"),"]"));var f=this.schema.idxByName;function d(C,_){return te(C,_)===0}var p=o.reduce(function(C,_){var A=C[0],R=C[1],w=f[_],D=r[_];return[A||w,A||!w?pt(R,w&&w.multi?function(E){var M=pe(E,_);return h(M)&&M.some(function(I){return d(D,I)})}:function(E){return d(D,pe(E,_))}):R]},[null,null]),g=p[0],y=p[1];return g?this.where(g.name).equals(r[g.keyPath]).filter(y):u?this.filter(y):this.where(o).equals("")},n.prototype.filter=function(r){return this.toCollection().and(r)},n.prototype.count=function(r){return this.toCollection().count(r)},n.prototype.offset=function(r){return this.toCollection().offset(r)},n.prototype.limit=function(r){return this.toCollection().limit(r)},n.prototype.each=function(r){return this.toCollection().each(r)},n.prototype.toArray=function(r){return this.toCollection().toArray(r)},n.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},n.prototype.orderBy=function(r){return new this.db.Collection(new this.db.WhereClause(this,h(r)?"[".concat(r.join("+"),"]"):r))},n.prototype.reverse=function(){return this.toCollection().reverse()},n.prototype.mapToClass=function(r){var o=this,u=o.db,l=o.name;this.schema.mappedClass=r,r.prototype instanceof vo&&(r=function(g){i(y,g);function y(){return g!==null&&g.apply(this,arguments)||this}return Object.defineProperty(y.prototype,"db",{get:function(){return u},enumerable:!1,configurable:!0}),y.prototype.table=function(){return l},y}(r));for(var f=new Set,d=r.prototype;d;d=v(d))Object.getOwnPropertyNames(d).forEach(function(g){return f.add(g)});var p=function(g){if(!g)return g;var y=Object.create(r.prototype);for(var C in g)if(!f.has(C))try{y[C]=g[C]}catch{}return y};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=p,this.hook("reading",p),r},n.prototype.defineClass=function(){function r(o){m(this,o)}return this.mapToClass(r)},n.prototype.add=function(r,o){var u=this,l=this.schema.primKey,f=l.auto,d=l.keyPath,p=r;return d&&f&&(p=Rn(d)(r)),this._trans("readwrite",function(g){return u.core.mutate({trans:g,type:"add",keys:o!=null?[o]:null,values:[p]})}).then(function(g){return g.numFailures?j.reject(g.failures[0]):g.lastResult}).then(function(g){if(d)try{oe(r,d,g)}catch{}return g})},n.prototype.update=function(r,o){if(typeof r=="object"&&!h(r)){var u=pe(r,this.schema.primKey.keyPath);return u===void 0?de(new W.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(u).modify(o)}else return this.where(":id").equals(r).modify(o)},n.prototype.put=function(r,o){var u=this,l=this.schema.primKey,f=l.auto,d=l.keyPath,p=r;return d&&f&&(p=Rn(d)(r)),this._trans("readwrite",function(g){return u.core.mutate({trans:g,type:"put",values:[p],keys:o!=null?[o]:null})}).then(function(g){return g.numFailures?j.reject(g.failures[0]):g.lastResult}).then(function(g){if(d)try{oe(r,d,g)}catch{}return g})},n.prototype.delete=function(r){var o=this;return this._trans("readwrite",function(u){return o.core.mutate({trans:u,type:"delete",keys:[r]})}).then(function(u){return u.numFailures?j.reject(u.failures[0]):void 0})},n.prototype.clear=function(){var r=this;return this._trans("readwrite",function(o){return r.core.mutate({trans:o,type:"deleteRange",range:mo})}).then(function(o){return o.numFailures?j.reject(o.failures[0]):void 0})},n.prototype.bulkGet=function(r){var o=this;return this._trans("readonly",function(u){return o.core.getMany({keys:r,trans:u}).then(function(l){return l.map(function(f){return o.hook.reading.fire(f)})})})},n.prototype.bulkAdd=function(r,o,u){var l=this,f=Array.isArray(o)?o:void 0;u=u||(f?void 0:o);var d=u?u.allKeys:void 0;return this._trans("readwrite",function(p){var g=l.schema.primKey,y=g.auto,C=g.keyPath;if(C&&f)throw new W.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(f&&f.length!==r.length)throw new W.InvalidArgument("Arguments objects and keys must have the same length");var _=r.length,A=C&&y?r.map(Rn(C)):r;return l.core.mutate({trans:p,type:"add",keys:f,values:A,wantResults:d}).then(function(R){var w=R.numFailures,D=R.results,E=R.lastResult,M=R.failures,I=d?D:E;if(w===0)return I;throw new At("".concat(l.name,".bulkAdd(): ").concat(w," of ").concat(_," operations failed"),M)})})},n.prototype.bulkPut=function(r,o,u){var l=this,f=Array.isArray(o)?o:void 0;u=u||(f?void 0:o);var d=u?u.allKeys:void 0;return this._trans("readwrite",function(p){var g=l.schema.primKey,y=g.auto,C=g.keyPath;if(C&&f)throw new W.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(f&&f.length!==r.length)throw new W.InvalidArgument("Arguments objects and keys must have the same length");var _=r.length,A=C&&y?r.map(Rn(C)):r;return l.core.mutate({trans:p,type:"put",keys:f,values:A,wantResults:d}).then(function(R){var w=R.numFailures,D=R.results,E=R.lastResult,M=R.failures,I=d?D:E;if(w===0)return I;throw new At("".concat(l.name,".bulkPut(): ").concat(w," of ").concat(_," operations failed"),M)})})},n.prototype.bulkUpdate=function(r){var o=this,u=this.core,l=r.map(function(p){return p.key}),f=r.map(function(p){return p.changes}),d=[];return this._trans("readwrite",function(p){return u.getMany({trans:p,keys:l,cache:"clone"}).then(function(g){var y=[],C=[];r.forEach(function(A,R){var w=A.key,D=A.changes,E=g[R];if(E){for(var M=0,I=Object.keys(D);M<I.length;M++){var V=I[M],O=D[V];if(V===o.schema.primKey.keyPath){if(te(O,w)!==0)throw new W.Constraint("Cannot update primary key in bulkUpdate()")}else oe(E,V,O)}d.push(R),y.push(w),C.push(E)}});var _=y.length;return u.mutate({trans:p,type:"put",keys:y,values:C,updates:{keys:l,changeSpecs:f}}).then(function(A){var R=A.numFailures,w=A.failures;if(R===0)return _;for(var D=0,E=Object.keys(w);D<E.length;D++){var M=E[D],I=d[Number(M)];if(I!=null){var V=w[M];delete w[M],w[I]=V}}throw new At("".concat(o.name,".bulkUpdate(): ").concat(R," of ").concat(_," operations failed"),w)})})})},n.prototype.bulkDelete=function(r){var o=this,u=r.length;return this._trans("readwrite",function(l){return o.core.mutate({trans:l,type:"delete",keys:r})}).then(function(l){var f=l.numFailures,d=l.lastResult,p=l.failures;if(f===0)return d;throw new At("".concat(o.name,".bulkDelete(): ").concat(f," of ").concat(u," operations failed"),p)})},n}();function $t(n){var r={},o=function(p,g){if(g){for(var y=arguments.length,C=new Array(y-1);--y;)C[y-1]=arguments[y];return r[p].subscribe.apply(null,C),n}else if(typeof p=="string")return r[p]};o.addEventType=f;for(var u=1,l=arguments.length;u<l;++u)f(arguments[u]);return o;function f(p,g,y){if(typeof p=="object")return d(p);g||(g=Na),y||(y=se);var C={subscribers:[],fire:y,subscribe:function(_){C.subscribers.indexOf(_)===-1&&(C.subscribers.push(_),C.fire=g(C.fire,_))},unsubscribe:function(_){C.subscribers=C.subscribers.filter(function(A){return A!==_}),C.fire=C.subscribers.reduce(g,y)}};return r[p]=o[p]=C,C}function d(p){c(p).forEach(function(g){var y=p[g];if(h(y))f(g,p[g][0],p[g][1]);else if(y==="asap")var C=f(g,Ut,function(){for(var A=arguments.length,R=new Array(A);A--;)R[A]=arguments[A];C.subscribers.forEach(function(w){q(function(){w.apply(null,R)})})});else throw new W.InvalidArgument("Invalid event config")})}}function Wt(n,r){return T(r).from({prototype:n}),r}function Za(n){return Wt(bo.prototype,function(o,u,l){this.db=n,this._tx=l,this.name=o,this.schema=u,this.hook=n._allTables[o]?n._allTables[o].hook:$t(null,{creating:[Ta,se],reading:[Ra,Ut],updating:[Ba,se],deleting:[Fa,se]})})}function kt(n,r){return!(n.filter||n.algorithm||n.or)&&(r?n.justLimit:!n.replayFilter)}function $r(n,r){n.filter=pt(n.filter,r)}function Wr(n,r,o){var u=n.replayFilter;n.replayFilter=u?function(){return pt(u(),r())}:r,n.justLimit=o&&!u}function eu(n,r){n.isMatch=pt(n.isMatch,r)}function Tn(n,r){if(n.isPrimKey)return r.primaryKey;var o=r.getIndexByKeyPath(n.index);if(!o)throw new W.Schema("KeyPath "+n.index+" on object store "+r.name+" is not indexed");return o}function wo(n,r,o){var u=Tn(n,r.schema);return r.openCursor({trans:o,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:u,range:n.range}})}function Fn(n,r,o,u){var l=n.replayFilter?pt(n.filter,n.replayFilter()):n.filter;if(n.or){var f={},d=function(p,g,y){if(!l||l(g,y,function(A){return g.stop(A)},function(A){return g.fail(A)})){var C=g.primaryKey,_=""+C;_==="[object ArrayBuffer]"&&(_=""+new Uint8Array(C)),x(f,_)||(f[_]=!0,r(p,g,y))}};return Promise.all([n.or._iterate(d,o),Co(wo(n,u,o),n.algorithm,d,!n.keysOnly&&n.valueMapper)])}else return Co(wo(n,u,o),pt(n.algorithm,l),r,!n.keysOnly&&n.valueMapper)}function Co(n,r,o,u){var l=u?function(d,p,g){return o(u(d),p,g)}:o,f=ue(l);return n.then(function(d){if(d)return d.start(function(){var p=function(){return d.continue()};(!r||r(d,function(g){return p=g},function(g){d.stop(g),p=se},function(g){d.fail(g),p=se}))&&f(d.value,d,function(g){return p=g}),p()})})}var Yt=function(){function n(r){this["@@propmod"]=r}return n.prototype.execute=function(r){var o,u=this["@@propmod"];if(u.add!==void 0){var l=u.add;if(h(l))return s(s([],h(r)?r:[],!0),l,!0).sort();if(typeof l=="number")return(Number(r)||0)+l;if(typeof l=="bigint")try{return BigInt(r)+l}catch{return BigInt(0)+l}throw new TypeError("Invalid term ".concat(l))}if(u.remove!==void 0){var f=u.remove;if(h(f))return h(r)?r.filter(function(p){return!f.includes(p)}).sort():[];if(typeof f=="number")return Number(r)-f;if(typeof f=="bigint")try{return BigInt(r)-f}catch{return BigInt(0)-f}throw new TypeError("Invalid subtrahend ".concat(f))}var d=(o=u.replacePrefix)===null||o===void 0?void 0:o[0];return d&&typeof r=="string"&&r.startsWith(d)?u.replacePrefix[1]+r.substring(d.length):r},n}(),tu=function(){function n(){}return n.prototype._read=function(r,o){var u=this._ctx;return u.error?u.table._trans(null,de.bind(null,u.error)):u.table._trans("readonly",r).then(o)},n.prototype._write=function(r){var o=this._ctx;return o.error?o.table._trans(null,de.bind(null,o.error)):o.table._trans("readwrite",r,"locked")},n.prototype._addAlgorithm=function(r){var o=this._ctx;o.algorithm=pt(o.algorithm,r)},n.prototype._iterate=function(r,o){return Fn(this._ctx,r,o,this._ctx.table.core)},n.prototype.clone=function(r){var o=Object.create(this.constructor.prototype),u=Object.create(this._ctx);return r&&m(u,r),o._ctx=u,o},n.prototype.raw=function(){return this._ctx.valueMapper=null,this},n.prototype.each=function(r){var o=this._ctx;return this._read(function(u){return Fn(o,r,u,o.table.core)})},n.prototype.count=function(r){var o=this;return this._read(function(u){var l=o._ctx,f=l.table.core;if(kt(l,!0))return f.count({trans:u,query:{index:Tn(l,f.schema),range:l.range}}).then(function(p){return Math.min(p,l.limit)});var d=0;return Fn(l,function(){return++d,!1},u,f).then(function(){return d})}).then(r)},n.prototype.sortBy=function(r,o){var u=r.split(".").reverse(),l=u[0],f=u.length-1;function d(y,C){return C?d(y[u[C]],C-1):y[l]}var p=this._ctx.dir==="next"?1:-1;function g(y,C){var _=d(y,f),A=d(C,f);return te(_,A)*p}return this.toArray(function(y){return y.sort(g)}).then(o)},n.prototype.toArray=function(r){var o=this;return this._read(function(u){var l=o._ctx;if(l.dir==="next"&&kt(l,!0)&&l.limit>0){var f=l.valueMapper,d=Tn(l,l.table.core.schema);return l.table.core.query({trans:u,limit:l.limit,values:!0,query:{index:d,range:l.range}}).then(function(g){var y=g.result;return f?y.map(f):y})}else{var p=[];return Fn(l,function(g){return p.push(g)},u,l.table.core).then(function(){return p})}},r)},n.prototype.offset=function(r){var o=this._ctx;return r<=0?this:(o.offset+=r,kt(o)?Wr(o,function(){var u=r;return function(l,f){return u===0?!0:u===1?(--u,!1):(f(function(){l.advance(u),u=0}),!1)}}):Wr(o,function(){var u=r;return function(){return--u<0}}),this)},n.prototype.limit=function(r){return this._ctx.limit=Math.min(this._ctx.limit,r),Wr(this._ctx,function(){var o=r;return function(u,l,f){return--o<=0&&l(f),o>=0}},!0),this},n.prototype.until=function(r,o){return $r(this._ctx,function(u,l,f){return r(u.value)?(l(f),o):!0}),this},n.prototype.first=function(r){return this.limit(1).toArray(function(o){return o[0]}).then(r)},n.prototype.last=function(r){return this.reverse().first(r)},n.prototype.filter=function(r){return $r(this._ctx,function(o){return r(o.value)}),eu(this._ctx,r),this},n.prototype.and=function(r){return this.filter(r)},n.prototype.or=function(r){return new this.db.WhereClause(this._ctx.table,r,this)},n.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},n.prototype.desc=function(){return this.reverse()},n.prototype.eachKey=function(r){var o=this._ctx;return o.keysOnly=!o.isMatch,this.each(function(u,l){r(l.key,l)})},n.prototype.eachUniqueKey=function(r){return this._ctx.unique="unique",this.eachKey(r)},n.prototype.eachPrimaryKey=function(r){var o=this._ctx;return o.keysOnly=!o.isMatch,this.each(function(u,l){r(l.primaryKey,l)})},n.prototype.keys=function(r){var o=this._ctx;o.keysOnly=!o.isMatch;var u=[];return this.each(function(l,f){u.push(f.key)}).then(function(){return u}).then(r)},n.prototype.primaryKeys=function(r){var o=this._ctx;if(o.dir==="next"&&kt(o,!0)&&o.limit>0)return this._read(function(l){var f=Tn(o,o.table.core.schema);return o.table.core.query({trans:l,values:!1,limit:o.limit,query:{index:f,range:o.range}})}).then(function(l){var f=l.result;return f}).then(r);o.keysOnly=!o.isMatch;var u=[];return this.each(function(l,f){u.push(f.primaryKey)}).then(function(){return u}).then(r)},n.prototype.uniqueKeys=function(r){return this._ctx.unique="unique",this.keys(r)},n.prototype.firstKey=function(r){return this.limit(1).keys(function(o){return o[0]}).then(r)},n.prototype.lastKey=function(r){return this.reverse().firstKey(r)},n.prototype.distinct=function(){var r=this._ctx,o=r.index&&r.table.schema.idxByName[r.index];if(!o||!o.multi)return this;var u={};return $r(this._ctx,function(l){var f=l.primaryKey.toString(),d=x(u,f);return u[f]=!0,!d}),this},n.prototype.modify=function(r){var o=this,u=this._ctx;return this._write(function(l){var f;if(typeof r=="function")f=r;else{var d=c(r),p=d.length;f=function(I){for(var V=!1,O=0;O<p;++O){var S=d[O],F=r[S],K=pe(I,S);F instanceof Yt?(oe(I,S,F.execute(K)),V=!0):K!==F&&(oe(I,S,F),V=!0)}return V}}var g=u.table.core,y=g.schema.primaryKey,C=y.outbound,_=y.extractKey,A=200,R=o.db._options.modifyChunkSize;R&&(typeof R=="object"?A=R[g.name]||R["*"]||200:A=R);var w=[],D=0,E=[],M=function(I,V){var O=V.failures,S=V.numFailures;D+=I-S;for(var F=0,K=c(O);F<K.length;F++){var N=K[F];w.push(O[N])}};return o.clone().primaryKeys().then(function(I){var V=kt(u)&&u.limit===1/0&&(typeof r!="function"||r===Yr)&&{index:u.index,range:u.range},O=function(S){var F=Math.min(A,I.length-S);return g.getMany({trans:l,keys:I.slice(S,S+F),cache:"immutable"}).then(function(K){for(var N=[],Y=[],ee=C?[]:null,G=[],Z=0;Z<F;++Z){var Q=K[Z],ne={value:st(Q),primKey:I[S+Z]};f.call(ne,ne.value,ne)!==!1&&(ne.value==null?G.push(I[S+Z]):!C&&te(_(Q),_(ne.value))!==0?(G.push(I[S+Z]),N.push(ne.value)):(Y.push(ne.value),C&&ee.push(I[S+Z])))}return Promise.resolve(N.length>0&&g.mutate({trans:l,type:"add",values:N}).then(function($){for(var fe in $.failures)G.splice(parseInt(fe),1);M(N.length,$)})).then(function(){return(Y.length>0||V&&typeof r=="object")&&g.mutate({trans:l,type:"put",keys:ee,values:Y,criteria:V,changeSpec:typeof r!="function"&&r,isAdditionalChunk:S>0}).then(function($){return M(Y.length,$)})}).then(function(){return(G.length>0||V&&r===Yr)&&g.mutate({trans:l,type:"delete",keys:G,criteria:V,isAdditionalChunk:S>0}).then(function($){return M(G.length,$)})}).then(function(){return I.length>S+F&&O(S+A)})})};return O(0).then(function(){if(w.length>0)throw new xn("Error modifying one or more objects",w,D,E);return I.length})})})},n.prototype.delete=function(){var r=this._ctx,o=r.range;return kt(r)&&(r.isPrimKey||o.type===3)?this._write(function(u){var l=r.table.core.schema.primaryKey,f=o;return r.table.core.count({trans:u,query:{index:l,range:f}}).then(function(d){return r.table.core.mutate({trans:u,type:"deleteRange",range:f}).then(function(p){var g=p.failures;p.lastResult,p.results;var y=p.numFailures;if(y)throw new xn("Could not delete some values",Object.keys(g).map(function(C){return g[C]}),d-y);return d-y})})}):this.modify(Yr)},n}(),Yr=function(n,r){return r.value=null};function nu(n){return Wt(tu.prototype,function(o,u){this.db=n;var l=mo,f=null;if(u)try{l=u()}catch(y){f=y}var d=o._ctx,p=d.table,g=p.hook.reading.fire;this._ctx={table:p,index:d.index,isPrimKey:!d.index||p.schema.primKey.keyPath&&d.index===p.schema.primKey.name,range:l,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:f,or:d.or,valueMapper:g!==Ut?g:null}})}function ru(n,r){return n<r?-1:n===r?0:1}function iu(n,r){return n>r?-1:n===r?0:1}function Ee(n,r,o){var u=n instanceof Do?new n.Collection(n):n;return u._ctx.error=o?new o(r):new TypeError(r),u}function Ot(n){return new n.Collection(n,function(){return xo("")}).limit(0)}function ou(n){return n==="next"?function(r){return r.toUpperCase()}:function(r){return r.toLowerCase()}}function su(n){return n==="next"?function(r){return r.toLowerCase()}:function(r){return r.toUpperCase()}}function au(n,r,o,u,l,f){for(var d=Math.min(n.length,u.length),p=-1,g=0;g<d;++g){var y=r[g];if(y!==u[g])return l(n[g],o[g])<0?n.substr(0,g)+o[g]+o.substr(g+1):l(n[g],u[g])<0?n.substr(0,g)+u[g]+o.substr(g+1):p>=0?n.substr(0,p)+r[p]+o.substr(p+1):null;l(n[g],y)<0&&(p=g)}return d<u.length&&f==="next"?n+o.substr(n.length):d<n.length&&f==="prev"?n.substr(0,o.length):p<0?null:n.substr(0,p)+u[p]+o.substr(p+1)}function Bn(n,r,o,u){var l,f,d,p,g,y,C,_=o.length;if(!o.every(function(D){return typeof D=="string"}))return Ee(n,go);function A(D){l=ou(D),f=su(D),d=D==="next"?ru:iu;var E=o.map(function(M){return{lower:f(M),upper:l(M)}}).sort(function(M,I){return d(M.lower,I.lower)});p=E.map(function(M){return M.upper}),g=E.map(function(M){return M.lower}),y=D,C=D==="next"?"":u}A("next");var R=new n.Collection(n,function(){return Je(p[0],g[_-1]+u)});R._ondirectionchange=function(D){A(D)};var w=0;return R._addAlgorithm(function(D,E,M){var I=D.key;if(typeof I!="string")return!1;var V=f(I);if(r(V,g,w))return!0;for(var O=null,S=w;S<_;++S){var F=au(I,V,p[S],g[S],d,y);F===null&&O===null?w=S+1:(O===null||d(O,F)>0)&&(O=F)}return E(O!==null?function(){D.continue(O+C)}:M),!1}),R}function Je(n,r,o,u){return{type:2,lower:n,upper:r,lowerOpen:o,upperOpen:u}}function xo(n){return{type:1,lower:n,upper:n}}var Do=function(){function n(){}return Object.defineProperty(n.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),n.prototype.between=function(r,o,u,l){u=u!==!1,l=l===!0;try{return this._cmp(r,o)>0||this._cmp(r,o)===0&&(u||l)&&!(u&&l)?Ot(this):new this.Collection(this,function(){return Je(r,o,!u,!l)})}catch{return Ee(this,Ge)}},n.prototype.equals=function(r){return r==null?Ee(this,Ge):new this.Collection(this,function(){return xo(r)})},n.prototype.above=function(r){return r==null?Ee(this,Ge):new this.Collection(this,function(){return Je(r,void 0,!0)})},n.prototype.aboveOrEqual=function(r){return r==null?Ee(this,Ge):new this.Collection(this,function(){return Je(r,void 0,!1)})},n.prototype.below=function(r){return r==null?Ee(this,Ge):new this.Collection(this,function(){return Je(void 0,r,!1,!0)})},n.prototype.belowOrEqual=function(r){return r==null?Ee(this,Ge):new this.Collection(this,function(){return Je(void 0,r)})},n.prototype.startsWith=function(r){return typeof r!="string"?Ee(this,go):this.between(r,r+dt,!0,!0)},n.prototype.startsWithIgnoreCase=function(r){return r===""?this.startsWith(r):Bn(this,function(o,u){return o.indexOf(u[0])===0},[r],dt)},n.prototype.equalsIgnoreCase=function(r){return Bn(this,function(o,u){return o===u[0]},[r],"")},n.prototype.anyOfIgnoreCase=function(){var r=Ke.apply(Dt,arguments);return r.length===0?Ot(this):Bn(this,function(o,u){return u.indexOf(o)!==-1},r,"")},n.prototype.startsWithAnyOfIgnoreCase=function(){var r=Ke.apply(Dt,arguments);return r.length===0?Ot(this):Bn(this,function(o,u){return u.some(function(l){return o.indexOf(l)===0})},r,dt)},n.prototype.anyOf=function(){var r=this,o=Ke.apply(Dt,arguments),u=this._cmp;try{o.sort(u)}catch{return Ee(this,Ge)}if(o.length===0)return Ot(this);var l=new this.Collection(this,function(){return Je(o[0],o[o.length-1])});l._ondirectionchange=function(d){u=d==="next"?r._ascending:r._descending,o.sort(u)};var f=0;return l._addAlgorithm(function(d,p,g){for(var y=d.key;u(y,o[f])>0;)if(++f,f===o.length)return p(g),!1;return u(y,o[f])===0?!0:(p(function(){d.continue(o[f])}),!1)}),l},n.prototype.notEqual=function(r){return this.inAnyRange([[Lr,r],[r,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},n.prototype.noneOf=function(){var r=Ke.apply(Dt,arguments);if(r.length===0)return new this.Collection(this);try{r.sort(this._ascending)}catch{return Ee(this,Ge)}var o=r.reduce(function(u,l){return u?u.concat([[u[u.length-1][1],l]]):[[Lr,l]]},null);return o.push([r[r.length-1],this.db._maxKey]),this.inAnyRange(o,{includeLowers:!1,includeUppers:!1})},n.prototype.inAnyRange=function(r,o){var u=this,l=this._cmp,f=this._ascending,d=this._descending,p=this._min,g=this._max;if(r.length===0)return Ot(this);if(!r.every(function(S){return S[0]!==void 0&&S[1]!==void 0&&f(S[0],S[1])<=0}))return Ee(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",W.InvalidArgument);var y=!o||o.includeLowers!==!1,C=o&&o.includeUppers===!0;function _(S,F){for(var K=0,N=S.length;K<N;++K){var Y=S[K];if(l(F[0],Y[1])<0&&l(F[1],Y[0])>0){Y[0]=p(Y[0],F[0]),Y[1]=g(Y[1],F[1]);break}}return K===N&&S.push(F),S}var A=f;function R(S,F){return A(S[0],F[0])}var w;try{w=r.reduce(_,[]),w.sort(R)}catch{return Ee(this,Ge)}var D=0,E=C?function(S){return f(S,w[D][1])>0}:function(S){return f(S,w[D][1])>=0},M=y?function(S){return d(S,w[D][0])>0}:function(S){return d(S,w[D][0])>=0};function I(S){return!E(S)&&!M(S)}var V=E,O=new this.Collection(this,function(){return Je(w[0][0],w[w.length-1][1],!y,!C)});return O._ondirectionchange=function(S){S==="next"?(V=E,A=f):(V=M,A=d),w.sort(R)},O._addAlgorithm(function(S,F,K){for(var N=S.key;V(N);)if(++D,D===w.length)return F(K),!1;return I(N)?!0:(u._cmp(N,w[D][1])===0||u._cmp(N,w[D][0])===0||F(function(){A===f?S.continue(w[D][0]):S.continue(w[D][1])}),!1)}),O},n.prototype.startsWithAnyOf=function(){var r=Ke.apply(Dt,arguments);return r.every(function(o){return typeof o=="string"})?r.length===0?Ot(this):this.inAnyRange(r.map(function(o){return[o,o+dt]})):Ee(this,"startsWithAnyOf() only works with strings")},n}();function uu(n){return Wt(Do.prototype,function(o,u,l){if(this.db=n,this._ctx={table:o,index:u===":id"?null:u,or:l},this._cmp=this._ascending=te,this._descending=function(f,d){return te(d,f)},this._max=function(f,d){return te(f,d)>0?f:d},this._min=function(f,d){return te(f,d)<0?f:d},this._IDBKeyRange=n._deps.IDBKeyRange,!this._IDBKeyRange)throw new W.MissingAPI})}function Te(n){return ue(function(r){return Qt(r),n(r.target.error),!1})}function Qt(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var Jt="storagemutated",Qr="x-storagemutated-1",Xe=$t(null,Jt),lu=function(){function n(){}return n.prototype._lock=function(){return ae(!L.global),++this._reculock,this._reculock===1&&!L.global&&(L.lockOwnerFor=this),this},n.prototype._unlock=function(){if(ae(!L.global),--this._reculock===0)for(L.global||(L.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var r=this._blockedFuncs.shift();try{ht(r[1],r[0])}catch{}}return this},n.prototype._locked=function(){return this._reculock&&L.lockOwnerFor!==this},n.prototype.create=function(r){var o=this;if(!this.mode)return this;var u=this.db.idbdb,l=this.db._state.dbOpenError;if(ae(!this.idbtrans),!r&&!u)switch(l&&l.name){case"DatabaseClosedError":throw new W.DatabaseClosed(l);case"MissingAPIError":throw new W.MissingAPI(l.message,l);default:throw new W.OpenFailed(l)}if(!this.active)throw new W.TransactionInactive;return ae(this._completion._state===null),r=this.idbtrans=r||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):u.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),r.onerror=ue(function(f){Qt(f),o._reject(r.error)}),r.onabort=ue(function(f){Qt(f),o.active&&o._reject(new W.Abort(r.error)),o.active=!1,o.on("abort").fire(f)}),r.oncomplete=ue(function(){o.active=!1,o._resolve(),"mutatedParts"in r&&Xe.storagemutated.fire(r.mutatedParts)}),this},n.prototype._promise=function(r,o,u){var l=this;if(r==="readwrite"&&this.mode!=="readwrite")return de(new W.ReadOnly("Transaction is readonly"));if(!this.active)return de(new W.TransactionInactive);if(this._locked())return new j(function(d,p){l._blockedFuncs.push([function(){l._promise(r,o,u).then(d,p)},L])});if(u)return We(function(){var d=new j(function(p,g){l._lock();var y=o(p,g,l);y&&y.then&&y.then(p,g)});return d.finally(function(){return l._unlock()}),d._lib=!0,d});var f=new j(function(d,p){var g=o(d,p,l);g&&g.then&&g.then(d,p)});return f._lib=!0,f},n.prototype._root=function(){return this.parent?this.parent._root():this},n.prototype.waitFor=function(r){var o=this._root(),u=j.resolve(r);if(o._waitingFor)o._waitingFor=o._waitingFor.then(function(){return u});else{o._waitingFor=u,o._waitingQueue=[];var l=o.idbtrans.objectStore(o.storeNames[0]);(function d(){for(++o._spinCount;o._waitingQueue.length;)o._waitingQueue.shift()();o._waitingFor&&(l.get(-1/0).onsuccess=d)})()}var f=o._waitingFor;return new j(function(d,p){u.then(function(g){return o._waitingQueue.push(ue(d.bind(null,g)))},function(g){return o._waitingQueue.push(ue(p.bind(null,g)))}).finally(function(){o._waitingFor===f&&(o._waitingFor=null)})})},n.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new W.Abort))},n.prototype.table=function(r){var o=this._memoizedTables||(this._memoizedTables={});if(x(o,r))return o[r];var u=this.schema[r];if(!u)throw new W.NotFound("Table "+r+" not part of transaction");var l=new this.db.Table(r,u,this);return l.core=this.db.core.table(r),o[r]=l,l},n}();function cu(n){return Wt(lu.prototype,function(o,u,l,f,d){var p=this;this.db=n,this.mode=o,this.storeNames=u,this.schema=l,this.chromeTransactionDurability=f,this.idbtrans=null,this.on=$t(this,"complete","error","abort"),this.parent=d||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new j(function(g,y){p._resolve=g,p._reject=y}),this._completion.then(function(){p.active=!1,p.on.complete.fire()},function(g){var y=p.active;return p.active=!1,p.on.error.fire(g),p.parent?p.parent._reject(g):y&&p.idbtrans&&p.idbtrans.abort(),de(g)})})}function Jr(n,r,o,u,l,f,d){return{name:n,keyPath:r,unique:o,multi:u,auto:l,compound:f,src:(o&&!d?"&":"")+(u?"*":"")+(l?"++":"")+Eo(r)}}function Eo(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function Xr(n,r,o){return{name:n,primKey:r,indexes:o,mappedClass:null,idxByName:ce(o,function(u){return[u.name,u]})}}function fu(n){return n.length===1?n[0]:n}var Xt=function(n){try{return n.only([[]]),Xt=function(){return[[]]},[[]]}catch{return Xt=function(){return dt},dt}};function qr(n){return n==null?function(){}:typeof n=="string"?hu(n):function(r){return pe(r,n)}}function hu(n){var r=n.split(".");return r.length===1?function(o){return o[n]}:function(o){return pe(o,n)}}function Ao(n){return[].slice.call(n)}var du=0;function qt(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function pu(n,r,o){function u(_,A){var R=Ao(_.objectStoreNames);return{schema:{name:_.name,tables:R.map(function(w){return A.objectStore(w)}).map(function(w){var D=w.keyPath,E=w.autoIncrement,M=h(D),I=D==null,V={},O={name:w.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:I,compound:M,keyPath:D,autoIncrement:E,unique:!0,extractKey:qr(D)},indexes:Ao(w.indexNames).map(function(S){return w.index(S)}).map(function(S){var F=S.name,K=S.unique,N=S.multiEntry,Y=S.keyPath,ee=h(Y),G={name:F,compound:ee,keyPath:Y,unique:K,multiEntry:N,extractKey:qr(Y)};return V[qt(Y)]=G,G}),getIndexByKeyPath:function(S){return V[qt(S)]}};return V[":id"]=O.primaryKey,D!=null&&(V[qt(D)]=O.primaryKey),O})},hasGetAll:R.length>0&&"getAll"in A.objectStore(R[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function l(_){if(_.type===3)return null;if(_.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var A=_.lower,R=_.upper,w=_.lowerOpen,D=_.upperOpen,E=A===void 0?R===void 0?null:r.upperBound(R,!!D):R===void 0?r.lowerBound(A,!!w):r.bound(A,R,!!w,!!D);return E}function f(_){var A=_.name;function R(E){var M=E.trans,I=E.type,V=E.keys,O=E.values,S=E.range;return new Promise(function(F,K){F=ue(F);var N=M.objectStore(A),Y=N.keyPath==null,ee=I==="put"||I==="add";if(!ee&&I!=="delete"&&I!=="deleteRange")throw new Error("Invalid operation type: "+I);var G=(V||O||{length:1}).length;if(V&&O&&V.length!==O.length)throw new Error("Given keys array must have same length as given values array.");if(G===0)return F({numFailures:0,failures:{},results:[],lastResult:void 0});var Z,Q=[],ne=[],$=0,fe=function(Be){++$,Qt(Be)};if(I==="deleteRange"){if(S.type===4)return F({numFailures:$,failures:ne,results:[],lastResult:void 0});S.type===3?Q.push(Z=N.clear()):Q.push(Z=N.delete(l(S)))}else{var _e=ee?Y?[O,V]:[O,null]:[V,null],Fe=_e[0],xe=_e[1];if(ee)for(var Ie=0;Ie<G;++Ie)Q.push(Z=xe&&xe[Ie]!==void 0?N[I](Fe[Ie],xe[Ie]):N[I](Fe[Ie])),Z.onerror=fe;else for(var Ie=0;Ie<G;++Ie)Q.push(Z=N[I](Fe[Ie])),Z.onerror=fe}var et=function(Be){var tn=Be.target.result;Q.forEach(function(Me,Qn){return Me.error!=null&&(ne[Qn]=Me.error)}),F({numFailures:$,failures:ne,results:I==="delete"?V:Q.map(function(Me){return Me.result}),lastResult:tn})};Z.onerror=function(Be){fe(Be),et(Be)},Z.onsuccess=et})}function w(E){var M=E.trans,I=E.values,V=E.query,O=E.reverse,S=E.unique;return new Promise(function(F,K){F=ue(F);var N=V.index,Y=V.range,ee=M.objectStore(A),G=N.isPrimaryKey?ee:ee.index(N.name),Z=O?S?"prevunique":"prev":S?"nextunique":"next",Q=I||!("openKeyCursor"in G)?G.openCursor(l(Y),Z):G.openKeyCursor(l(Y),Z);Q.onerror=Te(K),Q.onsuccess=ue(function(ne){var $=Q.result;if(!$){F(null);return}$.___id=++du,$.done=!1;var fe=$.continue.bind($),_e=$.continuePrimaryKey;_e&&(_e=_e.bind($));var Fe=$.advance.bind($),xe=function(){throw new Error("Cursor not started")},Ie=function(){throw new Error("Cursor not stopped")};$.trans=M,$.stop=$.continue=$.continuePrimaryKey=$.advance=xe,$.fail=ue(K),$.next=function(){var et=this,Be=1;return this.start(function(){return Be--?et.continue():et.stop()}).then(function(){return et})},$.start=function(et){var Be=new Promise(function(Me,Qn){Me=ue(Me),Q.onerror=Te(Qn),$.fail=Qn,$.stop=function(tl){$.stop=$.continue=$.continuePrimaryKey=$.advance=Ie,Me(tl)}}),tn=function(){if(Q.result)try{et()}catch(Me){$.fail(Me)}else $.done=!0,$.start=function(){throw new Error("Cursor behind last entry")},$.stop()};return Q.onsuccess=ue(function(Me){Q.onsuccess=tn,tn()}),$.continue=fe,$.continuePrimaryKey=_e,$.advance=Fe,tn(),Be},F($)},K)})}function D(E){return function(M){return new Promise(function(I,V){I=ue(I);var O=M.trans,S=M.values,F=M.limit,K=M.query,N=F===1/0?void 0:F,Y=K.index,ee=K.range,G=O.objectStore(A),Z=Y.isPrimaryKey?G:G.index(Y.name),Q=l(ee);if(F===0)return I({result:[]});if(E){var ne=S?Z.getAll(Q,N):Z.getAllKeys(Q,N);ne.onsuccess=function(Fe){return I({result:Fe.target.result})},ne.onerror=Te(V)}else{var $=0,fe=S||!("openKeyCursor"in Z)?Z.openCursor(Q):Z.openKeyCursor(Q),_e=[];fe.onsuccess=function(Fe){var xe=fe.result;if(!xe)return I({result:_e});if(_e.push(S?xe.value:xe.primaryKey),++$===F)return I({result:_e});xe.continue()},fe.onerror=Te(V)}})}}return{name:A,schema:_,mutate:R,getMany:function(E){var M=E.trans,I=E.keys;return new Promise(function(V,O){V=ue(V);for(var S=M.objectStore(A),F=I.length,K=new Array(F),N=0,Y=0,ee,G=function($){var fe=$.target;(K[fe._pos]=fe.result)!=null,++Y===N&&V(K)},Z=Te(O),Q=0;Q<F;++Q){var ne=I[Q];ne!=null&&(ee=S.get(I[Q]),ee._pos=Q,ee.onsuccess=G,ee.onerror=Z,++N)}N===0&&V(K)})},get:function(E){var M=E.trans,I=E.key;return new Promise(function(V,O){V=ue(V);var S=M.objectStore(A),F=S.get(I);F.onsuccess=function(K){return V(K.target.result)},F.onerror=Te(O)})},query:D(g),openCursor:w,count:function(E){var M=E.query,I=E.trans,V=M.index,O=M.range;return new Promise(function(S,F){var K=I.objectStore(A),N=V.isPrimaryKey?K:K.index(V.name),Y=l(O),ee=Y?N.count(Y):N.count();ee.onsuccess=ue(function(G){return S(G.target.result)}),ee.onerror=Te(F)})}}}var d=u(n,o),p=d.schema,g=d.hasGetAll,y=p.tables.map(function(_){return f(_)}),C={};return y.forEach(function(_){return C[_.name]=_}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(_){var A=C[_];if(!A)throw new Error("Table '".concat(_,"' not found"));return C[_]},MIN_KEY:-1/0,MAX_KEY:Xt(r),schema:p}}function gu(n,r){return r.reduce(function(o,u){var l=u.create;return t(t({},o),l(o))},n)}function mu(n,r,o,u){var l=o.IDBKeyRange;o.indexedDB;var f=gu(pu(r,l,u),n.dbcore);return{dbcore:f}}function Nn(n,r){var o=r.db,u=mu(n._middlewares,o,n._deps,r);n.core=u.dbcore,n.tables.forEach(function(l){var f=l.name;n.core.schema.tables.some(function(d){return d.name===f})&&(l.core=n.core.table(f),n[f]instanceof n.Table&&(n[f].core=l.core))})}function jn(n,r,o,u){o.forEach(function(l){var f=u[l];r.forEach(function(d){var p=H(d,l);(!p||"value"in p&&p.value===void 0)&&(d===n.Transaction.prototype||d instanceof n.Transaction?B(d,l,{get:function(){return this.table(l)},set:function(g){P(this,l,{value:g,writable:!0,configurable:!0,enumerable:!0})}}):d[l]=new n.Table(l,f))})})}function Zr(n,r){r.forEach(function(o){for(var u in o)o[u]instanceof n.Table&&delete o[u]})}function vu(n,r){return n._cfg.version-r._cfg.version}function yu(n,r,o,u){var l=n._dbSchema;o.objectStoreNames.contains("$meta")&&!l.$meta&&(l.$meta=Xr("$meta",Io("")[0],[]),n._storeNames.push("$meta"));var f=n._createTransaction("readwrite",n._storeNames,l);f.create(o),f._completion.catch(u);var d=f._reject.bind(f),p=L.transless||L;We(function(){if(L.trans=f,L.transless=p,r===0)c(l).forEach(function(g){ti(o,g,l[g].primKey,l[g].indexes)}),Nn(n,o),j.follow(function(){return n.on.populate.fire(f)}).catch(d);else return Nn(n,o),bu(n,f,r).then(function(g){return wu(n,g,f,o)}).catch(d)})}function _u(n,r){So(n._dbSchema,r),r.db.version%10===0&&!r.objectStoreNames.contains("$meta")&&r.db.createObjectStore("$meta").add(Math.ceil(r.db.version/10-1),"version");var o=Gn(n,n.idbdb,r);Un(n,n._dbSchema,r);for(var u=ei(o,n._dbSchema),l=function(y){if(y.change.length||y.recreate)return console.warn("Unable to patch indexes of table ".concat(y.name," because it has changes on the type of index or primary key.")),{value:void 0};var C=r.objectStore(y.name);y.add.forEach(function(_){Re&&console.debug("Dexie upgrade patch: Creating missing index ".concat(y.name,".").concat(_.src)),Kn(C,_)})},f=0,d=u.change;f<d.length;f++){var p=d[f],g=l(p);if(typeof g=="object")return g.value}}function bu(n,r,o){return r.storeNames.includes("$meta")?r.table("$meta").get("version").then(function(u){return u??o}):j.resolve(o)}function wu(n,r,o,u){var l=[],f=n._versions,d=n._dbSchema=Gn(n,n.idbdb,u),p=f.filter(function(y){return y._cfg.version>=r});if(p.length===0)return j.resolve();p.forEach(function(y){l.push(function(){var C=d,_=y._cfg.dbschema;Un(n,C,u),Un(n,_,u),d=n._dbSchema=_;var A=ei(C,_);A.add.forEach(function(I){ti(u,I[0],I[1].primKey,I[1].indexes)}),A.change.forEach(function(I){if(I.recreate)throw new W.Upgrade("Not yet support for changing primary key");var V=u.objectStore(I.name);I.add.forEach(function(O){return Kn(V,O)}),I.change.forEach(function(O){V.deleteIndex(O.name),Kn(V,O)}),I.del.forEach(function(O){return V.deleteIndex(O)})});var R=y._cfg.contentUpgrade;if(R&&y._cfg.version>r){Nn(n,u),o._memoizedTables={};var w=Ce(_);A.del.forEach(function(I){w[I]=C[I]}),Zr(n,[n.Transaction.prototype]),jn(n,[n.Transaction.prototype],c(w),w),o.schema=w;var D=Vr(R);D&&Vt();var E,M=j.follow(function(){if(E=R(o),E&&D){var I=Ye.bind(null,null);E.then(I,I)}});return E&&typeof E.then=="function"?j.resolve(E):M.then(function(){return E})}}),l.push(function(C){var _=y._cfg.dbschema;Cu(_,C),Zr(n,[n.Transaction.prototype]),jn(n,[n.Transaction.prototype],n._storeNames,n._dbSchema),o.schema=n._dbSchema}),l.push(function(C){n.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(n.idbdb.version/10)===y._cfg.version?(n.idbdb.deleteObjectStore("$meta"),delete n._dbSchema.$meta,n._storeNames=n._storeNames.filter(function(_){return _!=="$meta"})):C.objectStore("$meta").put(y._cfg.version,"version"))})});function g(){return l.length?j.resolve(l.shift()(o.idbtrans)).then(g):j.resolve()}return g().then(function(){So(d,u)})}function ei(n,r){var o={del:[],add:[],change:[]},u;for(u in n)r[u]||o.del.push(u);for(u in r){var l=n[u],f=r[u];if(!l)o.add.push([u,f]);else{var d={name:u,def:f,recreate:!1,del:[],add:[],change:[]};if(""+(l.primKey.keyPath||"")!=""+(f.primKey.keyPath||"")||l.primKey.auto!==f.primKey.auto)d.recreate=!0,o.change.push(d);else{var p=l.idxByName,g=f.idxByName,y=void 0;for(y in p)g[y]||d.del.push(y);for(y in g){var C=p[y],_=g[y];C?C.src!==_.src&&d.change.push(_):d.add.push(_)}(d.del.length>0||d.add.length>0||d.change.length>0)&&o.change.push(d)}}}return o}function ti(n,r,o,u){var l=n.db.createObjectStore(r,o.keyPath?{keyPath:o.keyPath,autoIncrement:o.auto}:{autoIncrement:o.auto});return u.forEach(function(f){return Kn(l,f)}),l}function So(n,r){c(n).forEach(function(o){r.db.objectStoreNames.contains(o)||(Re&&console.debug("Dexie: Creating missing table",o),ti(r,o,n[o].primKey,n[o].indexes))})}function Cu(n,r){[].slice.call(r.db.objectStoreNames).forEach(function(o){return n[o]==null&&r.db.deleteObjectStore(o)})}function Kn(n,r){n.createIndex(r.name,r.keyPath,{unique:r.unique,multiEntry:r.multi})}function Gn(n,r,o){var u={},l=J(r.objectStoreNames,0);return l.forEach(function(f){for(var d=o.objectStore(f),p=d.keyPath,g=Jr(Eo(p),p||"",!0,!1,!!d.autoIncrement,p&&typeof p!="string",!0),y=[],C=0;C<d.indexNames.length;++C){var _=d.index(d.indexNames[C]);p=_.keyPath;var A=Jr(_.name,p,!!_.unique,!!_.multiEntry,!1,p&&typeof p!="string",!1);y.push(A)}u[f]=Xr(f,g,y)}),u}function xu(n,r,o){n.verno=r.version/10;var u=n._dbSchema=Gn(n,r,o);n._storeNames=J(r.objectStoreNames,0),jn(n,[n._allTables],c(u),u)}function Du(n,r){var o=Gn(n,n.idbdb,r),u=ei(o,n._dbSchema);return!(u.add.length||u.change.some(function(l){return l.add.length||l.change.length}))}function Un(n,r,o){for(var u=o.db.objectStoreNames,l=0;l<u.length;++l){var f=u[l],d=o.objectStore(f);n._hasGetAll="getAll"in d;for(var p=0;p<d.indexNames.length;++p){var g=d.indexNames[p],y=d.index(g).keyPath,C=typeof y=="string"?y:"["+J(y).join("+")+"]";if(r[f]){var _=r[f].idxByName[C];_&&(_.name=g,delete r[f].idxByName[C],r[f].idxByName[g]=_)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&a.WorkerGlobalScope&&a instanceof a.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function Io(n){return n.split(",").map(function(r,o){r=r.trim();var u=r.replace(/([&*]|\+\+)/g,""),l=/^\[/.test(u)?u.match(/^\[(.*)\]$/)[1].split("+"):u;return Jr(u,l||null,/\&/.test(r),/\*/.test(r),/\+\+/.test(r),h(l),o===0)})}var Eu=function(){function n(){}return n.prototype._parseStoresSpec=function(r,o){c(r).forEach(function(u){if(r[u]!==null){var l=Io(r[u]),f=l.shift();if(f.unique=!0,f.multi)throw new W.Schema("Primary key cannot be multi-valued");l.forEach(function(d){if(d.auto)throw new W.Schema("Only primary key can be marked as autoIncrement (++)");if(!d.keyPath)throw new W.Schema("Index must have a name and cannot be an empty string")}),o[u]=Xr(u,f,l)}})},n.prototype.stores=function(r){var o=this.db;this._cfg.storesSource=this._cfg.storesSource?m(this._cfg.storesSource,r):r;var u=o._versions,l={},f={};return u.forEach(function(d){m(l,d._cfg.storesSource),f=d._cfg.dbschema={},d._parseStoresSpec(l,f)}),o._dbSchema=f,Zr(o,[o._allTables,o,o.Transaction.prototype]),jn(o,[o._allTables,o,o.Transaction.prototype,this._cfg.tables],c(f),f),o._storeNames=c(f),this},n.prototype.upgrade=function(r){return this._cfg.contentUpgrade=Or(this._cfg.contentUpgrade||se,r),this},n}();function Au(n){return Wt(Eu.prototype,function(o){this.db=n,this._cfg={version:o,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function ni(n,r){var o=n._dbNamesDB;return o||(o=n._dbNamesDB=new Ue(Pn,{addons:[],indexedDB:n,IDBKeyRange:r}),o.version(1).stores({dbnames:"name"})),o.table("dbnames")}function ri(n){return n&&typeof n.databases=="function"}function Su(n){var r=n.indexedDB,o=n.IDBKeyRange;return ri(r)?Promise.resolve(r.databases()).then(function(u){return u.map(function(l){return l.name}).filter(function(l){return l!==Pn})}):ni(r,o).toCollection().primaryKeys()}function Iu(n,r){var o=n.indexedDB,u=n.IDBKeyRange;!ri(o)&&r!==Pn&&ni(o,u).put({name:r}).catch(se)}function Vu(n,r){var o=n.indexedDB,u=n.IDBKeyRange;!ri(o)&&r!==Pn&&ni(o,u).delete(r).catch(se)}function ii(n){return We(function(){return L.letThrough=!0,n()})}function Mu(){var n=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!n||!indexedDB.databases)return Promise.resolve();var r;return new Promise(function(o){var u=function(){return indexedDB.databases().finally(o)};r=setInterval(u,100),u()}).finally(function(){return clearInterval(r)})}var oi;function si(n){return!("from"in n)}var ye=function(n,r){if(this)m(this,arguments.length?{d:1,from:n,to:arguments.length>1?r:n}:{d:0});else{var o=new ye;return n&&"d"in n&&m(o,n),o}};k(ye.prototype,(oi={add:function(n){return en(this,n),this},addKey:function(n){return Zt(this,n,n),this},addKeys:function(n){var r=this;return n.forEach(function(o){return Zt(r,o,o)}),this},hasKey:function(n){var r=Ln(this).next(n).value;return r&&te(r.from,n)<=0&&te(r.to,n)>=0}},oi[Ir]=function(){return Ln(this)},oi));function Zt(n,r,o){var u=te(r,o);if(!isNaN(u)){if(u>0)throw RangeError();if(si(n))return m(n,{from:r,to:o,d:1});var l=n.l,f=n.r;if(te(o,n.from)<0)return l?Zt(l,r,o):n.l={from:r,to:o,d:1,l:null,r:null},Mo(n);if(te(r,n.to)>0)return f?Zt(f,r,o):n.r={from:r,to:o,d:1,l:null,r:null},Mo(n);te(r,n.from)<0&&(n.from=r,n.l=null,n.d=f?f.d+1:1),te(o,n.to)>0&&(n.to=o,n.r=null,n.d=n.l?n.l.d+1:1);var d=!n.r;l&&!n.l&&en(n,l),f&&d&&en(n,f)}}function en(n,r){function o(u,l){var f=l.from,d=l.to,p=l.l,g=l.r;Zt(u,f,d),p&&o(u,p),g&&o(u,g)}si(r)||o(n,r)}function Vo(n,r){var o=Ln(r),u=o.next();if(u.done)return!1;for(var l=u.value,f=Ln(n),d=f.next(l.from),p=d.value;!u.done&&!d.done;){if(te(p.from,l.to)<=0&&te(p.to,l.from)>=0)return!0;te(l.from,p.from)<0?l=(u=o.next(p.from)).value:p=(d=f.next(l.from)).value}return!1}function Ln(n){var r=si(n)?null:{s:0,n};return{next:function(o){for(var u=arguments.length>0;r;)switch(r.s){case 0:if(r.s=1,u)for(;r.n.l&&te(o,r.n.from)<0;)r={up:r,n:r.n.l,s:1};else for(;r.n.l;)r={up:r,n:r.n.l,s:1};case 1:if(r.s=2,!u||te(o,r.n.to)<=0)return{value:r.n,done:!1};case 2:if(r.n.r){r.s=3,r={up:r,n:r.n.r,s:0};continue}case 3:r=r.up}return{done:!0}}}}function Mo(n){var r,o,u=(((r=n.r)===null||r===void 0?void 0:r.d)||0)-(((o=n.l)===null||o===void 0?void 0:o.d)||0),l=u>1?"r":u<-1?"l":"";if(l){var f=l==="r"?"l":"r",d=t({},n),p=n[l];n.from=p.from,n.to=p.to,n[l]=p[l],d[l]=p[f],n[f]=d,d.d=ko(d)}n.d=ko(n)}function ko(n){var r=n.r,o=n.l;return(r?o?Math.max(r.d,o.d):r.d:o?o.d:0)+1}function zn(n,r){return c(r).forEach(function(o){n[o]?en(n[o],r[o]):n[o]=eo(r[o])}),n}function ai(n,r){return n.all||r.all||Object.keys(n).some(function(o){return r[o]&&Vo(r[o],n[o])})}var gt={},ui={},li=!1;function Hn(n,r){zn(ui,n),li||(li=!0,setTimeout(function(){li=!1;var o=ui;ui={},ci(o,!1)},0))}function ci(n,r){r===void 0&&(r=!1);var o=new Set;if(n.all)for(var u=0,l=Object.values(gt);u<l.length;u++){var f=l[u];Oo(f,n,o,r)}else for(var d in n){var p=/^idb\:\/\/(.*)\/(.*)\//.exec(d);if(p){var g=p[1],y=p[2],f=gt["idb://".concat(g,"/").concat(y)];f&&Oo(f,n,o,r)}}o.forEach(function(C){return C()})}function Oo(n,r,o,u){for(var l=[],f=0,d=Object.entries(n.queries.query);f<d.length;f++){for(var p=d[f],g=p[0],y=p[1],C=[],_=0,A=y;_<A.length;_++){var R=A[_];ai(r,R.obsSet)?R.subscribers.forEach(function(M){return o.add(M)}):u&&C.push(R)}u&&l.push([g,C])}if(u)for(var w=0,D=l;w<D.length;w++){var E=D[w],g=E[0],C=E[1];n.queries.query[g]=C}}function ku(n){var r=n._state,o=n._deps.indexedDB;if(r.isBeingOpened||n.idbdb)return r.dbReadyPromise.then(function(){return r.dbOpenError?de(r.dbOpenError):n});r.isBeingOpened=!0,r.dbOpenError=null,r.openComplete=!1;var u=r.openCanceller,l=Math.round(n.verno*10),f=!1;function d(){if(r.openCanceller!==u)throw new W.DatabaseClosed("db.open() was cancelled")}var p=r.dbReadyResolve,g=null,y=!1,C=function(){return new j(function(_,A){if(d(),!o)throw new W.MissingAPI;var R=n.name,w=r.autoSchema||!l?o.open(R):o.open(R,l);if(!w)throw new W.MissingAPI;w.onerror=Te(A),w.onblocked=ue(n._fireOnBlocked),w.onupgradeneeded=ue(function(D){if(g=w.transaction,r.autoSchema&&!n._options.allowEmptyDB){w.onerror=Qt,g.abort(),w.result.close();var E=o.deleteDatabase(R);E.onsuccess=E.onerror=ue(function(){A(new W.NoSuchDatabase("Database ".concat(R," doesnt exist")))})}else{g.onerror=Te(A);var M=D.oldVersion>Math.pow(2,62)?0:D.oldVersion;y=M<1,n.idbdb=w.result,f&&_u(n,g),yu(n,M/10,g,A)}},A),w.onsuccess=ue(function(){g=null;var D=n.idbdb=w.result,E=J(D.objectStoreNames);if(E.length>0)try{var M=D.transaction(fu(E),"readonly");if(r.autoSchema)xu(n,D,M);else if(Un(n,n._dbSchema,M),!Du(n,M)&&!f)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),D.close(),l=D.version+1,f=!0,_(C());Nn(n,M)}catch{}Mt.push(n),D.onversionchange=ue(function(I){r.vcFired=!0,n.on("versionchange").fire(I)}),D.onclose=ue(function(I){n.on("close").fire(I)}),y&&Iu(n._deps,R),_()},A)}).catch(function(_){switch(_?.name){case"UnknownError":if(r.PR1398_maxLoop>0)return r.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),C();break;case"VersionError":if(l>0)return l=0,C();break}return j.reject(_)})};return j.race([u,(typeof navigator>"u"?j.resolve():Mu()).then(C)]).then(function(){return d(),r.onReadyBeingFired=[],j.resolve(ii(function(){return n.on.ready.fire(n.vip)})).then(function _(){if(r.onReadyBeingFired.length>0){var A=r.onReadyBeingFired.reduce(Or,se);return r.onReadyBeingFired=[],j.resolve(ii(function(){return A(n.vip)})).then(_)}})}).finally(function(){r.openCanceller===u&&(r.onReadyBeingFired=null,r.isBeingOpened=!1)}).catch(function(_){r.dbOpenError=_;try{g&&g.abort()}catch{}return u===r.openCanceller&&n._close(),de(_)}).finally(function(){r.openComplete=!0,p()}).then(function(){if(y){var _={};n.tables.forEach(function(A){A.schema.indexes.forEach(function(R){R.name&&(_["idb://".concat(n.name,"/").concat(A.name,"/").concat(R.name)]=new ye(-1/0,[[[]]]))}),_["idb://".concat(n.name,"/").concat(A.name,"/")]=_["idb://".concat(n.name,"/").concat(A.name,"/:dels")]=new ye(-1/0,[[[]]])}),Xe(Jt).fire(_),ci(_,!0)}return n})}function fi(n){var r=function(d){return n.next(d)},o=function(d){return n.throw(d)},u=f(r),l=f(o);function f(d){return function(p){var g=d(p),y=g.value;return g.done?y:!y||typeof y.then!="function"?h(y)?Promise.all(y).then(u,l):u(y):y.then(u,l)}}return f(r)()}function Ou(n,r,o){var u=arguments.length;if(u<2)throw new W.InvalidArgument("Too few arguments");for(var l=new Array(u-1);--u;)l[u-1]=arguments[u];o=l.pop();var f=qi(l);return[n,f,o]}function Po(n,r,o,u,l){return j.resolve().then(function(){var f=L.transless||L,d=n._createTransaction(r,o,n._dbSchema,u);d.explicit=!0;var p={trans:d,transless:f};if(u)d.idbtrans=u.idbtrans;else try{d.create(),d.idbtrans._explicit=!0,n._state.PR1398_maxLoop=3}catch(_){return _.name===kr.InvalidState&&n.isOpen()&&--n._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),n.close({disableAutoOpen:!1}),n.open().then(function(){return Po(n,r,o,null,l)})):de(_)}var g=Vr(l);g&&Vt();var y,C=j.follow(function(){if(y=l.call(d,d),y)if(g){var _=Ye.bind(null,null);y.then(_,_)}else typeof y.next=="function"&&typeof y.throw=="function"&&(y=fi(y))},p);return(y&&typeof y.then=="function"?j.resolve(y).then(function(_){return d.active?_:de(new W.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):C.then(function(){return y})).then(function(_){return u&&d._resolve(),d._completion.then(function(){return _})}).catch(function(_){return d._reject(_),de(_)})})}function $n(n,r,o){for(var u=h(n)?n.slice():[n],l=0;l<o;++l)u.push(r);return u}function Pu(n){return t(t({},n),{table:function(r){var o=n.table(r),u=o.schema,l={},f=[];function d(D,E,M){var I=qt(D),V=l[I]=l[I]||[],O=D==null?0:typeof D=="string"?1:D.length,S=E>0,F=t(t({},M),{name:S?"".concat(I,"(virtual-from:").concat(M.name,")"):M.name,lowLevelIndex:M,isVirtual:S,keyTail:E,keyLength:O,extractKey:qr(D),unique:!S&&M.unique});if(V.push(F),F.isPrimaryKey||f.push(F),O>1){var K=O===2?D[0]:D.slice(0,O-1);d(K,E+1,M)}return V.sort(function(N,Y){return N.keyTail-Y.keyTail}),F}var p=d(u.primaryKey.keyPath,0,u.primaryKey);l[":id"]=[p];for(var g=0,y=u.indexes;g<y.length;g++){var C=y[g];d(C.keyPath,0,C)}function _(D){var E=l[qt(D)];return E&&E[0]}function A(D,E){return{type:D.type===1?2:D.type,lower:$n(D.lower,D.lowerOpen?n.MAX_KEY:n.MIN_KEY,E),lowerOpen:!0,upper:$n(D.upper,D.upperOpen?n.MIN_KEY:n.MAX_KEY,E),upperOpen:!0}}function R(D){var E=D.query.index;return E.isVirtual?t(t({},D),{query:{index:E.lowLevelIndex,range:A(D.query.range,E.keyTail)}}):D}var w=t(t({},o),{schema:t(t({},u),{primaryKey:p,indexes:f,getIndexByKeyPath:_}),count:function(D){return o.count(R(D))},query:function(D){return o.query(R(D))},openCursor:function(D){var E=D.query.index,M=E.keyTail,I=E.isVirtual,V=E.keyLength;if(!I)return o.openCursor(D);function O(S){function F(N){N!=null?S.continue($n(N,D.reverse?n.MAX_KEY:n.MIN_KEY,M)):D.unique?S.continue(S.key.slice(0,V).concat(D.reverse?n.MIN_KEY:n.MAX_KEY,M)):S.continue()}var K=Object.create(S,{continue:{value:F},continuePrimaryKey:{value:function(N,Y){S.continuePrimaryKey($n(N,n.MAX_KEY,M),Y)}},primaryKey:{get:function(){return S.primaryKey}},key:{get:function(){var N=S.key;return V===1?N[0]:N.slice(0,V)}},value:{get:function(){return S.value}}});return K}return o.openCursor(R(D)).then(function(S){return S&&O(S)})}});return w}})}var Ru={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:Pu};function hi(n,r,o,u){return o=o||{},u=u||"",c(n).forEach(function(l){if(!x(r,l))o[u+l]=void 0;else{var f=n[l],d=r[l];if(typeof f=="object"&&typeof d=="object"&&f&&d){var p=Sr(f),g=Sr(d);p!==g?o[u+l]=r[l]:p==="Object"?hi(f,d,o,u+l+"."):f!==d&&(o[u+l]=r[l])}else f!==d&&(o[u+l]=r[l])}}),c(r).forEach(function(l){x(n,l)||(o[u+l]=r[l])}),o}function di(n,r){return r.type==="delete"?r.keys:r.keys||r.values.map(n.extractKey)}var Tu={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return t(t({},n),{table:function(r){var o=n.table(r),u=o.schema.primaryKey,l=t(t({},o),{mutate:function(f){var d=L.trans,p=d.table(r).hook,g=p.deleting,y=p.creating,C=p.updating;switch(f.type){case"add":if(y.fire===se)break;return d._promise("readwrite",function(){return _(f)},!0);case"put":if(y.fire===se&&C.fire===se)break;return d._promise("readwrite",function(){return _(f)},!0);case"delete":if(g.fire===se)break;return d._promise("readwrite",function(){return _(f)},!0);case"deleteRange":if(g.fire===se)break;return d._promise("readwrite",function(){return A(f)},!0)}return o.mutate(f);function _(w){var D=L.trans,E=w.keys||di(u,w);if(!E)throw new Error("Keys missing");return w=w.type==="add"||w.type==="put"?t(t({},w),{keys:E}):t({},w),w.type!=="delete"&&(w.values=s([],w.values,!0)),w.keys&&(w.keys=s([],w.keys,!0)),Fu(o,w,E).then(function(M){var I=E.map(function(V,O){var S=M[O],F={onerror:null,onsuccess:null};if(w.type==="delete")g.fire.call(F,V,S,D);else if(w.type==="add"||S===void 0){var K=y.fire.call(F,V,w.values[O],D);V==null&&K!=null&&(V=K,w.keys[O]=V,u.outbound||oe(w.values[O],u.keyPath,V))}else{var N=hi(S,w.values[O]),Y=C.fire.call(F,N,V,S,D);if(Y){var ee=w.values[O];Object.keys(Y).forEach(function(G){x(ee,G)?ee[G]=Y[G]:oe(ee,G,Y[G])})}}return F});return o.mutate(w).then(function(V){for(var O=V.failures,S=V.results,F=V.numFailures,K=V.lastResult,N=0;N<E.length;++N){var Y=S?S[N]:E[N],ee=I[N];Y==null?ee.onerror&&ee.onerror(O[N]):ee.onsuccess&&ee.onsuccess(w.type==="put"&&M[N]?w.values[N]:Y)}return{failures:O,results:S,numFailures:F,lastResult:K}}).catch(function(V){return I.forEach(function(O){return O.onerror&&O.onerror(V)}),Promise.reject(V)})})}function A(w){return R(w.trans,w.range,1e4)}function R(w,D,E){return o.query({trans:w,values:!1,query:{index:u,range:D},limit:E}).then(function(M){var I=M.result;return _({type:"delete",keys:I,trans:w}).then(function(V){return V.numFailures>0?Promise.reject(V.failures[0]):I.length<E?{failures:[],numFailures:0,lastResult:void 0}:R(w,t(t({},D),{lower:I[I.length-1],lowerOpen:!0}),E)})})}}});return l}})}};function Fu(n,r,o){return r.type==="add"?Promise.resolve([]):n.getMany({trans:r.trans,keys:o,cache:"immutable"})}function Ro(n,r,o){try{if(!r||r.keys.length<n.length)return null;for(var u=[],l=0,f=0;l<r.keys.length&&f<n.length;++l)te(r.keys[l],n[f])===0&&(u.push(o?st(r.values[l]):r.values[l]),++f);return u.length===n.length?u:null}catch{return null}}var Bu={stack:"dbcore",level:-1,create:function(n){return{table:function(r){var o=n.table(r);return t(t({},o),{getMany:function(u){if(!u.cache)return o.getMany(u);var l=Ro(u.keys,u.trans._cache,u.cache==="clone");return l?j.resolve(l):o.getMany(u).then(function(f){return u.trans._cache={keys:u.keys,values:u.cache==="clone"?st(f):f},f})},mutate:function(u){return u.type!=="add"&&(u.trans._cache=null),o.mutate(u)}})}}}};function To(n,r){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!r.schema.primaryKey.outbound}function Fo(n,r){switch(n){case"query":return r.values&&!r.unique;case"get":return!1;case"getMany":return!1;case"count":return!1;case"openCursor":return!1}}var Nu={stack:"dbcore",level:0,name:"Observability",create:function(n){var r=n.schema.name,o=new ye(n.MIN_KEY,n.MAX_KEY);return t(t({},n),{transaction:function(u,l,f){if(L.subscr&&l!=="readonly")throw new W.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(L.querier));return n.transaction(u,l,f)},table:function(u){var l=n.table(u),f=l.schema,d=f.primaryKey,p=f.indexes,g=d.extractKey,y=d.outbound,C=d.autoIncrement&&p.filter(function(w){return w.compound&&w.keyPath.includes(d.keyPath)}),_=t(t({},l),{mutate:function(w){var D,E,M=w.trans,I=w.mutatedParts||(w.mutatedParts={}),V=function(Q){var ne="idb://".concat(r,"/").concat(u,"/").concat(Q);return I[ne]||(I[ne]=new ye)},O=V(""),S=V(":dels"),F=w.type,K=w.type==="deleteRange"?[w.range]:w.type==="delete"?[w.keys]:w.values.length<50?[di(d,w).filter(function(Q){return Q}),w.values]:[],N=K[0],Y=K[1],ee=w.trans._cache;if(h(N)){O.addKeys(N);var G=F==="delete"||N.length===Y.length?Ro(N,ee):null;G||S.addKeys(N),(G||Y)&&ju(V,f,G,Y)}else if(N){var Z={from:(D=N.lower)!==null&&D!==void 0?D:n.MIN_KEY,to:(E=N.upper)!==null&&E!==void 0?E:n.MAX_KEY};S.add(Z),O.add(Z)}else O.add(o),S.add(o),f.indexes.forEach(function(Q){return V(Q.name).add(o)});return l.mutate(w).then(function(Q){return N&&(w.type==="add"||w.type==="put")&&(O.addKeys(Q.results),C&&C.forEach(function(ne){for(var $=w.values.map(function(xe){return ne.extractKey(xe)}),fe=ne.keyPath.findIndex(function(xe){return xe===d.keyPath}),_e=0,Fe=Q.results.length;_e<Fe;++_e)$[_e][fe]=Q.results[_e];V(ne.name).addKeys($)})),M.mutatedParts=zn(M.mutatedParts||{},I),Q})}}),A=function(w){var D,E,M=w.query,I=M.index,V=M.range;return[I,new ye((D=V.lower)!==null&&D!==void 0?D:n.MIN_KEY,(E=V.upper)!==null&&E!==void 0?E:n.MAX_KEY)]},R={get:function(w){return[d,new ye(w.key)]},getMany:function(w){return[d,new ye().addKeys(w.keys)]},count:A,query:A,openCursor:A};return c(R).forEach(function(w){_[w]=function(D){var E=L.subscr,M=!!E,I=To(L,l)&&Fo(w,D),V=I?D.obsSet={}:E;if(M){var O=function(G){var Z="idb://".concat(r,"/").concat(u,"/").concat(G);return V[Z]||(V[Z]=new ye)},S=O(""),F=O(":dels"),K=R[w](D),N=K[0],Y=K[1];if(w==="query"&&N.isPrimaryKey&&!D.values?F.add(Y):O(N.name||"").add(Y),!N.isPrimaryKey)if(w==="count")F.add(o);else{var ee=w==="query"&&y&&D.values&&l.query(t(t({},D),{values:!1}));return l[w].apply(this,arguments).then(function(G){if(w==="query"){if(y&&D.values)return ee.then(function($){var fe=$.result;return S.addKeys(fe),G});var Z=D.values?G.result.map(g):G.result;D.values?S.addKeys(Z):F.addKeys(Z)}else if(w==="openCursor"){var Q=G,ne=D.values;return Q&&Object.create(Q,{key:{get:function(){return F.addKey(Q.primaryKey),Q.key}},primaryKey:{get:function(){var $=Q.primaryKey;return F.addKey($),$}},value:{get:function(){return ne&&S.addKey(Q.primaryKey),Q.value}}})}return G})}}return l[w].apply(this,arguments)}}),_}})}};function ju(n,r,o,u){function l(f){var d=n(f.name||"");function p(y){return y!=null?f.extractKey(y):null}var g=function(y){return f.multiEntry&&h(y)?y.forEach(function(C){return d.addKey(C)}):d.addKey(y)};(o||u).forEach(function(y,C){var _=o&&p(o[C]),A=u&&p(u[C]);te(_,A)!==0&&(_!=null&&g(_),A!=null&&g(A))})}r.indexes.forEach(l)}function Bo(n,r,o){if(o.numFailures===0)return r;if(r.type==="deleteRange")return null;var u=r.keys?r.keys.length:"values"in r&&r.values?r.values.length:1;if(o.numFailures===u)return null;var l=t({},r);return h(l.keys)&&(l.keys=l.keys.filter(function(f,d){return!(d in o.failures)})),"values"in l&&h(l.values)&&(l.values=l.values.filter(function(f,d){return!(d in o.failures)})),l}function Ku(n,r){return r.lower===void 0?!0:r.lowerOpen?te(n,r.lower)>0:te(n,r.lower)>=0}function Gu(n,r){return r.upper===void 0?!0:r.upperOpen?te(n,r.upper)<0:te(n,r.upper)<=0}function pi(n,r){return Ku(n,r)&&Gu(n,r)}function No(n,r,o,u,l,f){if(!o||o.length===0)return n;var d=r.query.index,p=d.multiEntry,g=r.query.range,y=u.schema.primaryKey,C=y.extractKey,_=d.extractKey,A=(d.lowLevelIndex||d).extractKey,R=o.reduce(function(w,D){var E=w,M=[];if(D.type==="add"||D.type==="put")for(var I=new ye,V=D.values.length-1;V>=0;--V){var O=D.values[V],S=C(O);if(!I.hasKey(S)){var F=_(O);(p&&h(F)?F.some(function(G){return pi(G,g)}):pi(F,g))&&(I.addKey(S),M.push(O))}}switch(D.type){case"add":{var K=new ye().addKeys(r.values?w.map(function(G){return C(G)}):w);E=w.concat(r.values?M.filter(function(G){var Z=C(G);return K.hasKey(Z)?!1:(K.addKey(Z),!0)}):M.map(function(G){return C(G)}).filter(function(G){return K.hasKey(G)?!1:(K.addKey(G),!0)}));break}case"put":{var N=new ye().addKeys(D.values.map(function(G){return C(G)}));E=w.filter(function(G){return!N.hasKey(r.values?C(G):G)}).concat(r.values?M:M.map(function(G){return C(G)}));break}case"delete":var Y=new ye().addKeys(D.keys);E=w.filter(function(G){return!Y.hasKey(r.values?C(G):G)});break;case"deleteRange":var ee=D.range;E=w.filter(function(G){return!pi(C(G),ee)});break}return E},n);return R===n?n:(R.sort(function(w,D){return te(A(w),A(D))||te(C(w),C(D))}),r.limit&&r.limit<1/0&&(R.length>r.limit?R.length=r.limit:n.length===r.limit&&R.length<r.limit&&(l.dirty=!0)),f?Object.freeze(R):R)}function jo(n,r){return te(n.lower,r.lower)===0&&te(n.upper,r.upper)===0&&!!n.lowerOpen==!!r.lowerOpen&&!!n.upperOpen==!!r.upperOpen}function Uu(n,r,o,u){if(n===void 0)return r!==void 0?-1:0;if(r===void 0)return 1;var l=te(n,r);if(l===0){if(o&&u)return 0;if(o)return 1;if(u)return-1}return l}function Lu(n,r,o,u){if(n===void 0)return r!==void 0?1:0;if(r===void 0)return-1;var l=te(n,r);if(l===0){if(o&&u)return 0;if(o)return-1;if(u)return 1}return l}function zu(n,r){return Uu(n.lower,r.lower,n.lowerOpen,r.lowerOpen)<=0&&Lu(n.upper,r.upper,n.upperOpen,r.upperOpen)>=0}function Hu(n,r,o,u){var l=gt["idb://".concat(n,"/").concat(r)];if(!l)return[];var f=l.queries[o];if(!f)return[null,!1,l,null];var d=u.query?u.query.index.name:null,p=f[d||""];if(!p)return[null,!1,l,null];switch(o){case"query":var g=p.find(function(_){return _.req.limit===u.limit&&_.req.values===u.values&&jo(_.req.query.range,u.query.range)});if(g)return[g,!0,l,p];var y=p.find(function(_){var A="limit"in _.req?_.req.limit:1/0;return A>=u.limit&&(u.values?_.req.values:!0)&&zu(_.req.query.range,u.query.range)});return[y,!1,l,p];case"count":var C=p.find(function(_){return jo(_.req.query.range,u.query.range)});return[C,!!C,l,p]}}function $u(n,r,o,u){n.subscribers.add(o),u.addEventListener("abort",function(){n.subscribers.delete(o),n.subscribers.size===0&&Wu(n,r)})}function Wu(n,r){setTimeout(function(){n.subscribers.size===0&&at(r,n)},3e3)}var Yu={stack:"dbcore",level:0,name:"Cache",create:function(n){var r=n.schema.name,o=t(t({},n),{transaction:function(u,l,f){var d=n.transaction(u,l,f);if(l==="readwrite"){var p=new AbortController,g=p.signal,y=function(C){return function(){if(p.abort(),l==="readwrite"){for(var _=new Set,A=0,R=u;A<R.length;A++){var w=R[A],D=gt["idb://".concat(r,"/").concat(w)];if(D){var E=n.table(w),M=D.optimisticOps.filter(function(ne){return ne.trans===d});if(d._explicit&&C&&d.mutatedParts)for(var I=0,V=Object.values(D.queries.query);I<V.length;I++)for(var O=V[I],S=0,F=O.slice();S<F.length;S++){var K=F[S];ai(K.obsSet,d.mutatedParts)&&(at(O,K),K.subscribers.forEach(function(ne){return _.add(ne)}))}else if(M.length>0){D.optimisticOps=D.optimisticOps.filter(function(ne){return ne.trans!==d});for(var N=0,Y=Object.values(D.queries.query);N<Y.length;N++)for(var O=Y[N],ee=0,G=O.slice();ee<G.length;ee++){var K=G[ee];if(K.res!=null&&d.mutatedParts)if(C&&!K.dirty){var Z=Object.isFrozen(K.res),Q=No(K.res,K.req,M,E,K,Z);K.dirty?(at(O,K),K.subscribers.forEach(function(fe){return _.add(fe)})):Q!==K.res&&(K.res=Q,K.promise=j.resolve({result:Q}))}else K.dirty&&at(O,K),K.subscribers.forEach(function(fe){return _.add(fe)})}}}}_.forEach(function(ne){return ne()})}}};d.addEventListener("abort",y(!1),{signal:g}),d.addEventListener("error",y(!1),{signal:g}),d.addEventListener("complete",y(!0),{signal:g})}return d},table:function(u){var l=n.table(u),f=l.schema.primaryKey,d=t(t({},l),{mutate:function(p){var g=L.trans;if(f.outbound||g.db._options.cache==="disabled"||g.explicit||g.idbtrans.mode!=="readwrite")return l.mutate(p);var y=gt["idb://".concat(r,"/").concat(u)];if(!y)return l.mutate(p);var C=l.mutate(p);return(p.type==="add"||p.type==="put")&&(p.values.length>=50||di(f,p).some(function(_){return _==null}))?C.then(function(_){var A=t(t({},p),{values:p.values.map(function(w,D){var E;if(_.failures[D])return w;var M=!((E=f.keyPath)===null||E===void 0)&&E.includes(".")?st(w):t({},w);return oe(M,f.keyPath,_.results[D]),M})}),R=Bo(y,A,_);y.optimisticOps.push(R),queueMicrotask(function(){return p.mutatedParts&&Hn(p.mutatedParts)})}):(y.optimisticOps.push(p),p.mutatedParts&&Hn(p.mutatedParts),C.then(function(_){if(_.numFailures>0){at(y.optimisticOps,p);var A=Bo(y,p,_);A&&y.optimisticOps.push(A),p.mutatedParts&&Hn(p.mutatedParts)}}),C.catch(function(){at(y.optimisticOps,p),p.mutatedParts&&Hn(p.mutatedParts)})),C},query:function(p){var g;if(!To(L,l)||!Fo("query",p))return l.query(p);var y=((g=L.trans)===null||g===void 0?void 0:g.db._options.cache)==="immutable",C=L,_=C.requery,A=C.signal,R=Hu(r,u,"query",p),w=R[0],D=R[1],E=R[2],M=R[3];if(w&&D)w.obsSet=p.obsSet;else{var I=l.query(p).then(function(V){var O=V.result;if(w&&(w.res=O),y){for(var S=0,F=O.length;S<F;++S)Object.freeze(O[S]);Object.freeze(O)}else V.result=st(O);return V}).catch(function(V){return M&&w&&at(M,w),Promise.reject(V)});w={obsSet:p.obsSet,promise:I,subscribers:new Set,type:"query",req:p,dirty:!1},M?M.push(w):(M=[w],E||(E=gt["idb://".concat(r,"/").concat(u)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}}),E.queries.query[p.query.index.name||""]=M)}return $u(w,M,_,A),w.promise.then(function(V){return{result:No(V.result,p,E?.optimisticOps,l,w,y)}})}});return d}});return o}};function Wn(n,r){return new Proxy(n,{get:function(o,u,l){return u==="db"?r:Reflect.get(o,u,l)}})}var Ue=function(){function n(r,o){var u=this;this._middlewares={},this.verno=0;var l=n.dependencies;this._options=o=t({addons:n.addons,autoOpen:!0,indexedDB:l.indexedDB,IDBKeyRange:l.IDBKeyRange,cache:"cloned"},o),this._deps={indexedDB:o.indexedDB,IDBKeyRange:o.IDBKeyRange};var f=o.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var d={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:se,dbReadyPromise:null,cancelOpen:se,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:o.autoOpen};d.dbReadyPromise=new j(function(g){d.dbReadyResolve=g}),d.openCanceller=new j(function(g,y){d.cancelOpen=y}),this._state=d,this.name=r,this.on=$t(this,"populate","blocked","versionchange","close",{ready:[Or,se]}),this.on.ready.subscribe=me(this.on.ready.subscribe,function(g){return function(y,C){n.vip(function(){var _=u._state;if(_.openComplete)_.dbOpenError||j.resolve().then(y),C&&g(y);else if(_.onReadyBeingFired)_.onReadyBeingFired.push(y),C&&g(y);else{g(y);var A=u;C||g(function R(){A.on.ready.unsubscribe(y),A.on.ready.unsubscribe(R)})}})}}),this.Collection=nu(this),this.Table=Za(this),this.Transaction=cu(this),this.Version=Au(this),this.WhereClause=uu(this),this.on("versionchange",function(g){g.newVersion>0?console.warn("Another connection wants to upgrade database '".concat(u.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(u.name,"'. Closing db now to resume the delete request.")),u.close({disableAutoOpen:!1})}),this.on("blocked",function(g){!g.newVersion||g.newVersion<g.oldVersion?console.warn("Dexie.delete('".concat(u.name,"') was blocked")):console.warn("Upgrade '".concat(u.name,"' blocked by other connection holding version ").concat(g.oldVersion/10))}),this._maxKey=Xt(o.IDBKeyRange),this._createTransaction=function(g,y,C,_){return new u.Transaction(g,y,C,u._options.chromeTransactionDurability,_)},this._fireOnBlocked=function(g){u.on("blocked").fire(g),Mt.filter(function(y){return y.name===u.name&&y!==u&&!y._state.vcFired}).map(function(y){return y.on("versionchange").fire(g)})},this.use(Bu),this.use(Yu),this.use(Nu),this.use(Ru),this.use(Tu);var p=new Proxy(this,{get:function(g,y,C){if(y==="_vip")return!0;if(y==="table")return function(A){return Wn(u.table(A),p)};var _=Reflect.get(g,y,C);return _ instanceof bo?Wn(_,p):y==="tables"?_.map(function(A){return Wn(A,p)}):y==="_createTransaction"?function(){var A=_.apply(this,arguments);return Wn(A,p)}:_}});this.vip=p,f.forEach(function(g){return g(u)})}return n.prototype.version=function(r){if(isNaN(r)||r<.1)throw new W.Type("Given version is not a positive number");if(r=Math.round(r*10)/10,this.idbdb||this._state.isBeingOpened)throw new W.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,r);var o=this._versions,u=o.filter(function(l){return l._cfg.version===r})[0];return u||(u=new this.Version(r),o.push(u),o.sort(vu),u.stores({}),this._state.autoSchema=!1,u)},n.prototype._whenReady=function(r){var o=this;return this.idbdb&&(this._state.openComplete||L.letThrough||this._vip)?r():new j(function(u,l){if(o._state.openComplete)return l(new W.DatabaseClosed(o._state.dbOpenError));if(!o._state.isBeingOpened){if(!o._state.autoOpen){l(new W.DatabaseClosed);return}o.open().catch(se)}o._state.dbReadyPromise.then(u,l)}).then(r)},n.prototype.use=function(r){var o=r.stack,u=r.create,l=r.level,f=r.name;f&&this.unuse({stack:o,name:f});var d=this._middlewares[o]||(this._middlewares[o]=[]);return d.push({stack:o,create:u,level:l??10,name:f}),d.sort(function(p,g){return p.level-g.level}),this},n.prototype.unuse=function(r){var o=r.stack,u=r.name,l=r.create;return o&&this._middlewares[o]&&(this._middlewares[o]=this._middlewares[o].filter(function(f){return l?f.create!==l:u?f.name!==u:!1})),this},n.prototype.open=function(){var r=this;return ht($e,function(){return ku(r)})},n.prototype._close=function(){var r=this._state,o=Mt.indexOf(this);if(o>=0&&Mt.splice(o,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}r.isBeingOpened||(r.dbReadyPromise=new j(function(u){r.dbReadyResolve=u}),r.openCanceller=new j(function(u,l){r.cancelOpen=l}))},n.prototype.close=function(r){var o=r===void 0?{disableAutoOpen:!0}:r,u=o.disableAutoOpen,l=this._state;u?(l.isBeingOpened&&l.cancelOpen(new W.DatabaseClosed),this._close(),l.autoOpen=!1,l.dbOpenError=new W.DatabaseClosed):(this._close(),l.autoOpen=this._options.autoOpen||l.isBeingOpened,l.openComplete=!1,l.dbOpenError=null)},n.prototype.delete=function(r){var o=this;r===void 0&&(r={disableAutoOpen:!0});var u=arguments.length>0&&typeof arguments[0]!="object",l=this._state;return new j(function(f,d){var p=function(){o.close(r);var g=o._deps.indexedDB.deleteDatabase(o.name);g.onsuccess=ue(function(){Vu(o._deps,o.name),f()}),g.onerror=Te(d),g.onblocked=o._fireOnBlocked};if(u)throw new W.InvalidArgument("Invalid closeOptions argument to db.delete()");l.isBeingOpened?l.dbReadyPromise.then(p):p()})},n.prototype.backendDB=function(){return this.idbdb},n.prototype.isOpen=function(){return this.idbdb!==null},n.prototype.hasBeenClosed=function(){var r=this._state.dbOpenError;return r&&r.name==="DatabaseClosed"},n.prototype.hasFailed=function(){return this._state.dbOpenError!==null},n.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(n.prototype,"tables",{get:function(){var r=this;return c(this._allTables).map(function(o){return r._allTables[o]})},enumerable:!1,configurable:!0}),n.prototype.transaction=function(){var r=Ou.apply(this,arguments);return this._transaction.apply(this,r)},n.prototype._transaction=function(r,o,u){var l=this,f=L.trans;(!f||f.db!==this||r.indexOf("!")!==-1)&&(f=null);var d=r.indexOf("?")!==-1;r=r.replace("!","").replace("?","");var p,g;try{if(g=o.map(function(C){var _=C instanceof l.Table?C.name:C;if(typeof _!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return _}),r=="r"||r===zr)p=zr;else if(r=="rw"||r==Hr)p=Hr;else throw new W.InvalidArgument("Invalid transaction mode: "+r);if(f){if(f.mode===zr&&p===Hr)if(d)f=null;else throw new W.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");f&&g.forEach(function(C){if(f&&f.storeNames.indexOf(C)===-1)if(d)f=null;else throw new W.SubTransaction("Table "+C+" not included in parent transaction.")}),d&&f&&!f.active&&(f=null)}}catch(C){return f?f._promise(null,function(_,A){A(C)}):de(C)}var y=Po.bind(null,this,p,g,f,u);return f?f._promise(p,y,"lock"):L.trans?ht(L.transless,function(){return l._whenReady(y)}):this._whenReady(y)},n.prototype.table=function(r){if(!x(this._allTables,r))throw new W.InvalidTable("Table ".concat(r," does not exist"));return this._allTables[r]},n}(),Qu=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Ju=function(){function n(r){this._subscribe=r}return n.prototype.subscribe=function(r,o,u){return this._subscribe(!r||typeof r=="function"?{next:r,error:o,complete:u}:r)},n.prototype[Qu]=function(){return this},n}(),Yn;try{Yn={indexedDB:a.indexedDB||a.mozIndexedDB||a.webkitIndexedDB||a.msIndexedDB,IDBKeyRange:a.IDBKeyRange||a.webkitIDBKeyRange}}catch{Yn={indexedDB:null,IDBKeyRange:null}}function Ko(n){var r=!1,o,u=new Ju(function(l){var f=Vr(n);function d(M){var I=St();try{f&&Vt();var V=We(n,M);return f&&(V=V.finally(Ye)),V}finally{I&&It()}}var p=!1,g,y={},C={},_={get closed(){return p},unsubscribe:function(){p||(p=!0,g&&g.abort(),A&&Xe.storagemutated.unsubscribe(D))}};l.start&&l.start(_);var A=!1,R=function(){return Gr(E)};function w(){return ai(C,y)}var D=function(M){zn(y,M),w()&&R()},E=function(){if(!(p||!Yn.indexedDB)){y={};var M={};g&&g.abort(),g=new AbortController;var I={subscr:M,signal:g.signal,requery:R,querier:n,trans:null},V=d(I);Promise.resolve(V).then(function(O){r=!0,o=O,!(p||I.signal.aborted)&&(y={},C=M,!Sa(C)&&!A&&(Xe(Jt,D),A=!0),Gr(function(){return!p&&l.next&&l.next(O)}))},function(O){r=!1,["DatabaseClosedError","AbortError"].includes(O?.name)||p||Gr(function(){p||l.error&&l.error(O)})})}};return setTimeout(R,0),_});return u.hasValue=function(){return r},u.getValue=function(){return o},u}var mt=Ue;k(mt,t(t({},Dn),{delete:function(n){var r=new mt(n,{addons:[]});return r.delete()},exists:function(n){return new mt(n,{addons:[]}).open().then(function(r){return r.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return Su(mt.dependencies).then(n)}catch{return de(new W.MissingAPI)}},defineClass:function(){function n(r){m(this,r)}return n},ignoreTransaction:function(n){return L.trans?ht(L.transless,n):n()},vip:ii,async:function(n){return function(){try{var r=fi(n.apply(this,arguments));return!r||typeof r.then!="function"?j.resolve(r):r}catch(o){return de(o)}}},spawn:function(n,r,o){try{var u=fi(n.apply(o,r||[]));return!u||typeof u.then!="function"?j.resolve(u):u}catch(l){return de(l)}},currentTransaction:{get:function(){return L.trans||null}},waitFor:function(n,r){var o=j.resolve(typeof n=="function"?mt.ignoreTransaction(n):n).timeout(r||6e4);return L.trans?L.trans.waitFor(o):o},Promise:j,debug:{get:function(){return Re},set:function(n){io(n)}},derive:T,extend:m,props:k,override:me,Events:$t,on:Xe,liveQuery:Ko,extendObservabilitySet:zn,getByKeyPath:pe,setByKeyPath:oe,delByKeyPath:Pe,shallowClone:Ce,deepClone:st,getObjectDiff:hi,cmp:te,asap:q,minKey:Lr,addons:[],connections:Mt,errnames:kr,dependencies:Yn,cache:gt,semVer:po,version:po.split(".").map(function(n){return parseInt(n)}).reduce(function(n,r,o){return n+r/Math.pow(10,o*2)})})),mt.maxKey=Xt(mt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Xe(Jt,function(n){if(!qe){var r;r=new CustomEvent(Qr,{detail:n}),qe=!0,dispatchEvent(r),qe=!1}}),addEventListener(Qr,function(n){var r=n.detail;qe||gi(r)}));function gi(n){var r=qe;try{qe=!0,Xe.storagemutated.fire(n),ci(n,!0)}finally{qe=r}}var qe=!1,Ze,mi=function(){};typeof BroadcastChannel<"u"&&(mi=function(){Ze=new BroadcastChannel(Qr),Ze.onmessage=function(n){return n.data&&gi(n.data)}},mi(),typeof Ze.unref=="function"&&Ze.unref(),Xe(Jt,function(n){qe||Ze.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!Ue.disableBfCache&&n.persisted){Re&&console.debug("Dexie: handling persisted pagehide"),Ze?.close();for(var r=0,o=Mt;r<o.length;r++){var u=o[r];u.close({disableAutoOpen:!1})}}}),addEventListener("pageshow",function(n){!Ue.disableBfCache&&n.persisted&&(Re&&console.debug("Dexie: handling persisted pageshow"),mi(),gi({all:new ye(-1/0,[[]])}))}));function Xu(n){return new Yt({add:n})}function qu(n){return new Yt({remove:n})}function Zu(n,r){return new Yt({replacePrefix:[n,r]})}j.rejectionMapper=Pa,io(Re);var el=Object.freeze({__proto__:null,Dexie:Ue,liveQuery:Ko,Entity:vo,cmp:te,PropModification:Yt,replacePrefix:Zu,add:Xu,remove:qu,default:Ue,RangeSet:ye,mergeRanges:en,rangesOverlap:Vo});return t(Ue,el,{default:Ue}),Ue})});var Ei=(h=>(h.PRODUCTS="productsStore",h.RECIPES="recipesStore",h.CATEGORIES="categoryStore",h.PRODUCTS_CATEGORIES="categoryProductsStore",h.RECIPES_CATEGORIES="categoryRecipesStore",h.INDICES="indicesStore",h))(Ei||{});var ol=e=>{let i={};for(let t in e)Array.isArray(e[t])?i[t]=e[t].reduce((s,a)=>(s.push(ol(a)),s),[]):e[t]?.uuid!=null?i[t]=e[t].uuid:i[t]=e[t];return i},sl=e=>{let i={};for(let t in e)Array.isArray(e[t])?i[t]=e[t].filter(s=>s!=null).map(sl):e[t]!=null&&(i[t]=e[t]);return i},hs=()=>Math.random().toString(36).substring(2)+Date.now().toString(36);var al=["*"],ul=()=>["route-active"];function ll(e,i){e&1&&Ci(0)}function cl(e,i){if(e&1&&(bi(0,"a",3),er(1,ll,1,0,"ng-container",4),wi()),e&2){let t=tr(),s=xi(3);Pt("active",t.active())("flat",t.flat())("icon",t.icon())("no-bottom-radius",t.noBottomRadius())("no-left-radius",t.noLeftRadius())("no-radius",t.noRadius())("no-right-radius",t.noRightRadius())("no-top-radius",t.noTopRadius()),sn("ngClass",t.style()+" "+t.size())("routerLink",t.link()?t.link():null)("routerLinkActive",rs(20,ul)),yi(),sn("ngTemplateOutlet",s)}}function fl(e,i){e&1&&Ci(0)}function hl(e,i){if(e&1){let t=qo();bi(0,"button",5),Rt("click",function(a){$o(t);let c=tr();return Wo(c.onClick.emit(a))}),er(1,fl,1,0,"ng-container",4),wi()}if(e&2){let t=tr(),s=xi(3);Pt("active",t.active())("flat",t.flat())("icon",t.icon())("no-bottom-radius",t.noBottomRadius())("no-left-radius",t.noLeftRadius())("no-radius",t.noRadius())("no-right-radius",t.noRightRadius())("no-top-radius",t.noTopRadius()),sn("ngClass",t.style()+" "+t.size()),yi(),sn("ngTemplateOutlet",s)}}function dl(e,i){e&1&&es(0)}var ds=class e{constructor(){}onClick=os();style=Ve("default");size=Ve("default");icon=Ve(!1);flat=Ve(!1);link=Ve("");noRightRadius=Ve(!1);noLeftRadius=Ve(!1);noRadius=Ve(!1);noTopRadius=Ve(!1);noBottomRadius=Ve(!1);active=Ve(!1);routerLinkActive=ss(nr);static \u0275fac=function(t){return new(t||e)};static \u0275cmp=Yo({type:e,selectors:[["lg-button"]],viewQuery:function(t,s){t&1&&ts(s.routerLinkActive,nr,5),t&2&&ns()},inputs:{style:[1,"style"],size:[1,"size"],icon:[1,"icon"],flat:[1,"flat"],link:[1,"link"],noRightRadius:[1,"noRightRadius"],noLeftRadius:[1,"noLeftRadius"],noRadius:[1,"noRadius"],noTopRadius:[1,"noTopRadius"],noBottomRadius:[1,"noBottomRadius"],active:[1,"active"]},outputs:{onClick:"onClick"},ngContentSelectors:al,decls:4,vars:1,consts:[["content",""],[1,"button",3,"active","flat","icon","no-bottom-radius","no-left-radius","no-radius","no-right-radius","no-top-radius","ngClass","routerLink","routerLinkActive"],["type","button",1,"button",3,"active","flat","icon","no-bottom-radius","no-left-radius","no-radius","no-right-radius","no-top-radius","ngClass"],[1,"button",3,"ngClass","routerLink","routerLinkActive"],[4,"ngTemplateOutlet"],["type","button",1,"button",3,"click","ngClass"]],template:function(t,s){t&1&&(Zo(),Jo(0,cl,2,21,"a",1)(1,hl,2,18,"button",2),er(2,dl,1,0,"ng-template",null,0,is)),t&2&&Xo(s.link()?0:1)},dependencies:[ls,fs,cs,nr],styles:[`.button{background-color:#fff;color:var(--text-color);padding:16px 24px;font-size:1rem;font-family:inherit;border:none;border-radius:16px;cursor:pointer;appearance:none;display:flex;align-items:center;text-decoration:none;justify-content:center}.button:focus{outline-color:var(--active-color)}.button.no-radius{border-radius:0}.button.no-top-radius{border-top-left-radius:0;border-top-right-radius:0}.button.no-bottom-radius{border-bottom-left-radius:0;border-bottom-right-radius:0}.button.no-right-radius{border-top-right-radius:0;border-bottom-right-radius:0}.button.no-left-radius{border-top-left-radius:0;border-bottom-left-radius:0}.button.active{filter:brightness(.95)}.button.active.flat{color:var(--active-color)}.button.default{background-color:#fab6b6}.button.primary{background-color:#28a63c}.button.primary.flat{color:#28a63c}.button.secondary{background-color:#fafafa}.button.secondary.flat{color:#fafafa}.button.success{background-color:#1a8c50;color:#fff8fa}.button.success.flat{color:#1a8c50}.button.danger{background-color:#e33;color:#fff8fa}.button.danger.flat{color:#e33}.button.warning{background-color:#ec7b1c}.button.warning.flat{color:#ec7b1c}.button.info{background-color:#2531c2}.button.info.flat{color:#2531c2}.button.small{padding:8px 16px;font-size:.9rem;border-radius:12px}.button.transcluent{-webkit-backdrop-filter:blur(3px);backdrop-filter:blur(3px);background-color:#ffffff80}.button.icon{border-radius:50%;padding:16px}.button.icon.medium{padding:10px}.button.icon.medium .mat-icon{font-size:16px}.button.icon.small{padding:6px}.button.icon.small .mat-icon{font-size:16px}.button.icon.tiny{padding:2px}.button.icon.tiny .mat-icon{font-size:10px;width:16px;height:16px}.button.icon .mat-icon{font-size:24px;width:24px;height:24px;display:flex;align-items:center;justify-content:center}.button.flat{padding:0;background-color:transparent}
`],encapsulation:2})};var xs=(()=>{class e{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,s){this._renderer=t,this._elementRef=s}setProperty(t,s){this._renderer.setProperty(this._elementRef.nativeElement,t,s)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(s){return new(s||e)(ie(_i),ie(vi))};static \u0275dir=we({type:e})}return e})(),Ds=(()=>{class e extends xs{static \u0275fac=(()=>{let t;return function(a){return(t||(t=qn(e)))(a||e)}})();static \u0275dir=we({type:e,features:[Ae]})}return e})(),dn=new vt(""),pl={provide:dn,useExisting:Le(()=>gl),multi:!0},gl=(()=>{class e extends Ds{writeValue(t){this.setProperty("checked",t)}static \u0275fac=(()=>{let t;return function(a){return(t||(t=qn(e)))(a||e)}})();static \u0275dir=we({type:e,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(s,a){s&1&&Rt("change",function(h){return a.onChange(h.target.checked)})("blur",function(){return a.onTouched()})},standalone:!1,features:[ze([pl]),Ae]})}return e})(),ml={provide:dn,useExisting:Le(()=>Es),multi:!0};function vl(){let e=Di()?Di().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}var yl=new vt(""),Es=(()=>{class e extends xs{_compositionMode;_composing=!1;constructor(t,s,a){super(t,s),this._compositionMode=a,this._compositionMode==null&&(this._compositionMode=!vl())}writeValue(t){let s=t??"";this.setProperty("value",s)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(s){return new(s||e)(ie(_i),ie(vi),ie(yl,8))};static \u0275dir=we({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(s,a){s&1&&Rt("input",function(h){return a._handleInput(h.target.value)})("blur",function(){return a.onTouched()})("compositionstart",function(){return a._compositionStart()})("compositionend",function(h){return a._compositionEnd(h.target.value)})},standalone:!1,features:[ze([ml]),Ae]})}return e})();function Mi(e){return e==null||ki(e)===0}function ki(e){return e==null?null:Array.isArray(e)||typeof e=="string"?e.length:e instanceof Set?e.size:null}var Bt=new vt(""),Nt=new vt(""),_l=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,ps=class{static min(i){return bl(i)}static max(i){return wl(i)}static required(i){return Cl(i)}static requiredTrue(i){return xl(i)}static email(i){return Dl(i)}static minLength(i){return El(i)}static maxLength(i){return Al(i)}static pattern(i){return Sl(i)}static nullValidator(i){return As()}static compose(i){return Os(i)}static composeAsync(i){return Rs(i)}};function bl(e){return i=>{if(i.value==null||e==null)return null;let t=parseFloat(i.value);return!isNaN(t)&&t<e?{min:{min:e,actual:i.value}}:null}}function wl(e){return i=>{if(i.value==null||e==null)return null;let t=parseFloat(i.value);return!isNaN(t)&&t>e?{max:{max:e,actual:i.value}}:null}}function Cl(e){return Mi(e.value)?{required:!0}:null}function xl(e){return e.value===!0?null:{required:!0}}function Dl(e){return Mi(e.value)||_l.test(e.value)?null:{email:!0}}function El(e){return i=>{let t=i.value?.length??ki(i.value);return t===null||t===0?null:t<e?{minlength:{requiredLength:e,actualLength:t}}:null}}function Al(e){return i=>{let t=i.value?.length??ki(i.value);return t!==null&&t>e?{maxlength:{requiredLength:e,actualLength:t}}:null}}function Sl(e){if(!e)return As;let i,t;return typeof e=="string"?(t="",e.charAt(0)!=="^"&&(t+="^"),t+=e,e.charAt(e.length-1)!=="$"&&(t+="$"),i=new RegExp(t)):(t=e.toString(),i=e),s=>{if(Mi(s.value))return null;let a=s.value;return i.test(a)?null:{pattern:{requiredPattern:t,actualValue:a}}}}function As(e){return null}function Ss(e){return e!=null}function Is(e){return Qo(e)?Uo(e):e}function Vs(e){let i={};return e.forEach(t=>{i=t!=null?be(be({},i),t):i}),Object.keys(i).length===0?null:i}function Ms(e,i){return i.map(t=>t(e))}function Il(e){return!e.validate}function ks(e){return e.map(i=>Il(i)?i:t=>i.validate(t))}function Os(e){if(!e)return null;let i=e.filter(Ss);return i.length==0?null:function(t){return Vs(Ms(t,i))}}function Ps(e){return e!=null?Os(ks(e)):null}function Rs(e){if(!e)return null;let i=e.filter(Ss);return i.length==0?null:function(t){let s=Ms(t,i).map(Is);return zo(s).pipe(Lo(Vs))}}function Ts(e){return e!=null?Rs(ks(e)):null}function gs(e,i){return e===null?[i]:Array.isArray(e)?[...e,i]:[e,i]}function Fs(e){return e._rawValidators}function Bs(e){return e._rawAsyncValidators}function Si(e){return e?Array.isArray(e)?e:[e]:[]}function ir(e,i){return Array.isArray(e)?e.includes(i):e===i}function ms(e,i){let t=Si(i);return Si(e).forEach(a=>{ir(t,a)||t.push(a)}),t}function vs(e,i){return Si(i).filter(t=>!ir(e,t))}var or=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(i){this._rawValidators=i||[],this._composedValidatorFn=Ps(this._rawValidators)}_setAsyncValidators(i){this._rawAsyncValidators=i||[],this._composedAsyncValidatorFn=Ts(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(i){this._onDestroyCallbacks.push(i)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(i=>i()),this._onDestroyCallbacks=[]}reset(i=void 0){this.control&&this.control.reset(i)}hasError(i,t){return this.control?this.control.hasError(i,t):!1}getError(i,t){return this.control?this.control.getError(i,t):null}},Se=class extends or{name;get formDirective(){return null}get path(){return null}},He=class extends or{_parent=null;name=null;valueAccessor=null},sr=class{_cd;constructor(i){this._cd=i}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},Vl={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Hc=De(be({},Vl),{"[class.ng-submitted]":"isSubmitted"}),$c=(()=>{class e extends sr{constructor(t){super(t)}static \u0275fac=function(s){return new(s||e)(ie(He,2))};static \u0275dir=we({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(s,a){s&2&&Pt("ng-untouched",a.isUntouched)("ng-touched",a.isTouched)("ng-pristine",a.isPristine)("ng-dirty",a.isDirty)("ng-valid",a.isValid)("ng-invalid",a.isInvalid)("ng-pending",a.isPending)},standalone:!1,features:[Ae]})}return e})(),Wc=(()=>{class e extends sr{constructor(t){super(t)}static \u0275fac=function(s){return new(s||e)(ie(Se,10))};static \u0275dir=we({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(s,a){s&2&&Pt("ng-untouched",a.isUntouched)("ng-touched",a.isTouched)("ng-pristine",a.isPristine)("ng-dirty",a.isDirty)("ng-valid",a.isValid)("ng-invalid",a.isInvalid)("ng-pending",a.isPending)("ng-submitted",a.isSubmitted)},standalone:!1,features:[Ae]})}return e})();var un="VALID",rr="INVALID",Tt="PENDING",ln="DISABLED",nt=class{},ar=class extends nt{value;source;constructor(i,t){super(),this.value=i,this.source=t}},cn=class extends nt{pristine;source;constructor(i,t){super(),this.pristine=i,this.source=t}},fn=class extends nt{touched;source;constructor(i,t){super(),this.touched=i,this.source=t}},Ft=class extends nt{status;source;constructor(i,t){super(),this.status=i,this.source=t}},Ii=class extends nt{source;constructor(i){super(),this.source=i}},Vi=class extends nt{source;constructor(i){super(),this.source=i}};function Oi(e){return(hr(e)?e.validators:e)||null}function Ml(e){return Array.isArray(e)?Ps(e):e||null}function Pi(e,i){return(hr(i)?i.asyncValidators:e)||null}function kl(e){return Array.isArray(e)?Ts(e):e||null}function hr(e){return e!=null&&!Array.isArray(e)&&typeof e=="object"}function Ns(e,i,t){let s=e.controls;if(!(i?Object.keys(s):s).length)throw new Jn(1e3,"");if(!s[t])throw new Jn(1001,"")}function js(e,i,t){e._forEachChild((s,a)=>{if(t[a]===void 0)throw new Jn(1002,"")})}var hn=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(i,t){this._assignValidators(i),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(i){this._rawValidators=this._composedValidatorFn=i}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(i){this._rawAsyncValidators=this._composedAsyncValidatorFn=i}get parent(){return this._parent}get status(){return tt(this.statusReactive)}set status(i){tt(()=>this.statusReactive.set(i))}_status=an(()=>this.statusReactive());statusReactive=rn(void 0);get valid(){return this.status===un}get invalid(){return this.status===rr}get pending(){return this.status==Tt}get disabled(){return this.status===ln}get enabled(){return this.status!==ln}errors;get pristine(){return tt(this.pristineReactive)}set pristine(i){tt(()=>this.pristineReactive.set(i))}_pristine=an(()=>this.pristineReactive());pristineReactive=rn(!0);get dirty(){return!this.pristine}get touched(){return tt(this.touchedReactive)}set touched(i){tt(()=>this.touchedReactive.set(i))}_touched=an(()=>this.touchedReactive());touchedReactive=rn(!1);get untouched(){return!this.touched}_events=new Go;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(i){this._assignValidators(i)}setAsyncValidators(i){this._assignAsyncValidators(i)}addValidators(i){this.setValidators(ms(i,this._rawValidators))}addAsyncValidators(i){this.setAsyncValidators(ms(i,this._rawAsyncValidators))}removeValidators(i){this.setValidators(vs(i,this._rawValidators))}removeAsyncValidators(i){this.setAsyncValidators(vs(i,this._rawAsyncValidators))}hasValidator(i){return ir(this._rawValidators,i)}hasAsyncValidator(i){return ir(this._rawAsyncValidators,i)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(i={}){let t=this.touched===!1;this.touched=!0;let s=i.sourceControl??this;this._parent&&!i.onlySelf&&this._parent.markAsTouched(De(be({},i),{sourceControl:s})),t&&i.emitEvent!==!1&&this._events.next(new fn(!0,s))}markAllAsDirty(i={}){this.markAsDirty({onlySelf:!0,emitEvent:i.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsDirty(i))}markAllAsTouched(i={}){this.markAsTouched({onlySelf:!0,emitEvent:i.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(i))}markAsUntouched(i={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let s=i.sourceControl??this;this._forEachChild(a=>{a.markAsUntouched({onlySelf:!0,emitEvent:i.emitEvent,sourceControl:s})}),this._parent&&!i.onlySelf&&this._parent._updateTouched(i,s),t&&i.emitEvent!==!1&&this._events.next(new fn(!1,s))}markAsDirty(i={}){let t=this.pristine===!0;this.pristine=!1;let s=i.sourceControl??this;this._parent&&!i.onlySelf&&this._parent.markAsDirty(De(be({},i),{sourceControl:s})),t&&i.emitEvent!==!1&&this._events.next(new cn(!1,s))}markAsPristine(i={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let s=i.sourceControl??this;this._forEachChild(a=>{a.markAsPristine({onlySelf:!0,emitEvent:i.emitEvent})}),this._parent&&!i.onlySelf&&this._parent._updatePristine(i,s),t&&i.emitEvent!==!1&&this._events.next(new cn(!0,s))}markAsPending(i={}){this.status=Tt;let t=i.sourceControl??this;i.emitEvent!==!1&&(this._events.next(new Ft(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!i.onlySelf&&this._parent.markAsPending(De(be({},i),{sourceControl:t}))}disable(i={}){let t=this._parentMarkedDirty(i.onlySelf);this.status=ln,this.errors=null,this._forEachChild(a=>{a.disable(De(be({},i),{onlySelf:!0}))}),this._updateValue();let s=i.sourceControl??this;i.emitEvent!==!1&&(this._events.next(new ar(this.value,s)),this._events.next(new Ft(this.status,s)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(De(be({},i),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(a=>a(!0))}enable(i={}){let t=this._parentMarkedDirty(i.onlySelf);this.status=un,this._forEachChild(s=>{s.enable(De(be({},i),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:i.emitEvent}),this._updateAncestors(De(be({},i),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(s=>s(!1))}_updateAncestors(i,t){this._parent&&!i.onlySelf&&(this._parent.updateValueAndValidity(i),i.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(i){this._parent=i}getRawValue(){return this.value}updateValueAndValidity(i={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let s=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===un||this.status===Tt)&&this._runAsyncValidator(s,i.emitEvent)}let t=i.sourceControl??this;i.emitEvent!==!1&&(this._events.next(new ar(this.value,t)),this._events.next(new Ft(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!i.onlySelf&&this._parent.updateValueAndValidity(De(be({},i),{sourceControl:t}))}_updateTreeValidity(i={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(i)),this.updateValueAndValidity({onlySelf:!0,emitEvent:i.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?ln:un}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(i,t){if(this.asyncValidator){this.status=Tt,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1,shouldHaveEmitted:i!==!1};let s=Is(this.asyncValidator(this));this._asyncValidationSubscription=s.subscribe(a=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(a,{emitEvent:t,shouldHaveEmitted:i})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let i=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,i}return!1}setErrors(i,t={}){this.errors=i,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(i){let t=i;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((s,a)=>s&&s._find(a),this)}getError(i,t){let s=t?this.get(t):this;return s&&s.errors?s.errors[i]:null}hasError(i,t){return!!this.getError(i,t)}get root(){let i=this;for(;i._parent;)i=i._parent;return i}_updateControlsErrors(i,t,s){this.status=this._calculateStatus(),i&&this.statusChanges.emit(this.status),(i||s)&&this._events.next(new Ft(this.status,t)),this._parent&&this._parent._updateControlsErrors(i,t,s)}_initObservables(){this.valueChanges=new yt,this.statusChanges=new yt}_calculateStatus(){return this._allControlsDisabled()?ln:this.errors?rr:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Tt)?Tt:this._anyControlsHaveStatus(rr)?rr:un}_anyControlsHaveStatus(i){return this._anyControls(t=>t.status===i)}_anyControlsDirty(){return this._anyControls(i=>i.dirty)}_anyControlsTouched(){return this._anyControls(i=>i.touched)}_updatePristine(i,t){let s=!this._anyControlsDirty(),a=this.pristine!==s;this.pristine=s,this._parent&&!i.onlySelf&&this._parent._updatePristine(i,t),a&&this._events.next(new cn(this.pristine,t))}_updateTouched(i={},t){this.touched=this._anyControlsTouched(),this._events.next(new fn(this.touched,t)),this._parent&&!i.onlySelf&&this._parent._updateTouched(i,t)}_onDisabledChange=[];_registerOnCollectionChange(i){this._onCollectionChange=i}_setUpdateStrategy(i){hr(i)&&i.updateOn!=null&&(this._updateOn=i.updateOn)}_parentMarkedDirty(i){let t=this._parent&&this._parent.dirty;return!i&&!!t&&!this._parent._anyControlsDirty()}_find(i){return null}_assignValidators(i){this._rawValidators=Array.isArray(i)?i.slice():i,this._composedValidatorFn=Ml(this._rawValidators)}_assignAsyncValidators(i){this._rawAsyncValidators=Array.isArray(i)?i.slice():i,this._composedAsyncValidatorFn=kl(this._rawAsyncValidators)}},ys=class extends hn{constructor(i,t,s){super(Oi(t),Pi(s,t)),this.controls=i,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(i,t){return this.controls[i]?this.controls[i]:(this.controls[i]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(i,t,s={}){this.registerControl(i,t),this.updateValueAndValidity({emitEvent:s.emitEvent}),this._onCollectionChange()}removeControl(i,t={}){this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),delete this.controls[i],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(i,t,s={}){this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),delete this.controls[i],t&&this.registerControl(i,t),this.updateValueAndValidity({emitEvent:s.emitEvent}),this._onCollectionChange()}contains(i){return this.controls.hasOwnProperty(i)&&this.controls[i].enabled}setValue(i,t={}){js(this,!0,i),Object.keys(i).forEach(s=>{Ns(this,!0,s),this.controls[s].setValue(i[s],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(i,t={}){i!=null&&(Object.keys(i).forEach(s=>{let a=this.controls[s];a&&a.patchValue(i[s],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(i={},t={}){this._forEachChild((s,a)=>{s.reset(i?i[a]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(i,t,s)=>(i[s]=t.getRawValue(),i))}_syncPendingControls(){let i=this._reduceChildren(!1,(t,s)=>s._syncPendingControls()?!0:t);return i&&this.updateValueAndValidity({onlySelf:!0}),i}_forEachChild(i){Object.keys(this.controls).forEach(t=>{let s=this.controls[t];s&&i(s,t)})}_setUpControls(){this._forEachChild(i=>{i.setParent(this),i._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(i){for(let[t,s]of Object.entries(this.controls))if(this.contains(t)&&i(s))return!0;return!1}_reduceValue(){let i={};return this._reduceChildren(i,(t,s,a)=>((s.enabled||this.disabled)&&(t[a]=s.value),t))}_reduceChildren(i,t){let s=i;return this._forEachChild((a,c)=>{s=t(s,a,c)}),s}_allControlsDisabled(){for(let i of Object.keys(this.controls))if(this.controls[i].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(i){return this.controls.hasOwnProperty(i)?this.controls[i]:null}};var pn=new vt("",{providedIn:"root",factory:()=>dr}),dr="always";function pr(e,i){return[...i.path,e]}function ur(e,i,t=dr){Ri(e,i),i.valueAccessor.writeValue(e.value),(e.disabled||t==="always")&&i.valueAccessor.setDisabledState?.(e.disabled),Pl(e,i),Tl(e,i),Rl(e,i),Ol(e,i)}function lr(e,i,t=!0){let s=()=>{};i.valueAccessor&&(i.valueAccessor.registerOnChange(s),i.valueAccessor.registerOnTouched(s)),fr(e,i),e&&(i._invokeOnDestroyCallbacks(),e._registerOnCollectionChange(()=>{}))}function cr(e,i){e.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(i)})}function Ol(e,i){if(i.valueAccessor.setDisabledState){let t=s=>{i.valueAccessor.setDisabledState(s)};e.registerOnDisabledChange(t),i._registerOnDestroy(()=>{e._unregisterOnDisabledChange(t)})}}function Ri(e,i){let t=Fs(e);i.validator!==null?e.setValidators(gs(t,i.validator)):typeof t=="function"&&e.setValidators([t]);let s=Bs(e);i.asyncValidator!==null?e.setAsyncValidators(gs(s,i.asyncValidator)):typeof s=="function"&&e.setAsyncValidators([s]);let a=()=>e.updateValueAndValidity();cr(i._rawValidators,a),cr(i._rawAsyncValidators,a)}function fr(e,i){let t=!1;if(e!==null){if(i.validator!==null){let a=Fs(e);if(Array.isArray(a)&&a.length>0){let c=a.filter(h=>h!==i.validator);c.length!==a.length&&(t=!0,e.setValidators(c))}}if(i.asyncValidator!==null){let a=Bs(e);if(Array.isArray(a)&&a.length>0){let c=a.filter(h=>h!==i.asyncValidator);c.length!==a.length&&(t=!0,e.setAsyncValidators(c))}}}let s=()=>{};return cr(i._rawValidators,s),cr(i._rawAsyncValidators,s),t}function Pl(e,i){i.valueAccessor.registerOnChange(t=>{e._pendingValue=t,e._pendingChange=!0,e._pendingDirty=!0,e.updateOn==="change"&&Ks(e,i)})}function Rl(e,i){i.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,e.updateOn==="blur"&&e._pendingChange&&Ks(e,i),e.updateOn!=="submit"&&e.markAsTouched()})}function Ks(e,i){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),i.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function Tl(e,i){let t=(s,a)=>{i.valueAccessor.writeValue(s),a&&i.viewToModelUpdate(s)};e.registerOnChange(t),i._registerOnDestroy(()=>{e._unregisterOnChange(t)})}function Fl(e,i){e==null,Ri(e,i)}function Bl(e,i){return fr(e,i)}function Ti(e,i){if(!e.hasOwnProperty("model"))return!1;let t=e.model;return t.isFirstChange()?!0:!Object.is(i,t.currentValue)}function Nl(e){return Object.getPrototypeOf(e.constructor)===Ds}function jl(e,i){e._syncPendingControls(),i.forEach(t=>{let s=t.control;s.updateOn==="submit"&&s._pendingChange&&(t.viewToModelUpdate(s._pendingValue),s._pendingChange=!1)})}function Fi(e,i){if(!i)return null;Array.isArray(i);let t,s,a;return i.forEach(c=>{c.constructor===Es?t=c:Nl(c)?s=c:a=c}),a||s||t||null}function Kl(e,i){let t=e.indexOf(i);t>-1&&e.splice(t,1)}function _s(e,i){let t=e.indexOf(i);t>-1&&e.splice(t,1)}function bs(e){return typeof e=="object"&&e!==null&&Object.keys(e).length===2&&"value"in e&&"disabled"in e}var Gs=class extends hn{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(i=null,t,s){super(Oi(t),Pi(s,t)),this._applyFormState(i),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),hr(t)&&(t.nonNullable||t.initialValueIsDefault)&&(bs(i)?this.defaultValue=i.value:this.defaultValue=i)}setValue(i,t={}){this.value=this._pendingValue=i,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(s=>s(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(i,t={}){this.setValue(i,t)}reset(i=this.defaultValue,t={}){this._applyFormState(i),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(i){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(i){this._onChange.push(i)}_unregisterOnChange(i){_s(this._onChange,i)}registerOnDisabledChange(i){this._onDisabledChange.push(i)}_unregisterOnDisabledChange(i){_s(this._onDisabledChange,i)}_forEachChild(i){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(i){bs(i)?(this.value=this._pendingValue=i.value,i.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=i}};var Gl=e=>e instanceof Gs,Ul=(()=>{class e extends Se{_parent;ngOnInit(){this._checkParentType(),this.formDirective.addFormGroup(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormGroup(this)}get control(){return this.formDirective.getFormGroup(this)}get path(){return pr(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}static \u0275fac=(()=>{let t;return function(a){return(t||(t=qn(e)))(a||e)}})();static \u0275dir=we({type:e,standalone:!1,features:[Ae]})}return e})();var Ll={provide:He,useExisting:Le(()=>zl)},ws=Promise.resolve(),zl=(()=>{class e extends He{_changeDetectorRef;callSetDisabledState;control=new Gs;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new yt;constructor(t,s,a,c,h,m){super(),this._changeDetectorRef=h,this.callSetDisabledState=m,this._parent=t,this._setValidators(s),this._setAsyncValidators(a),this.valueAccessor=Fi(this,c)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let s=t.name.previousValue;this.formDirective.removeControl({name:s,path:this._getPath(s)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),Ti(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){ur(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){ws.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let s=t.isDisabled.currentValue,a=s!==0&&us(s);ws.then(()=>{a&&!this.control.disabled?this.control.disable():!a&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?pr(t,this._parent):[t]}static \u0275fac=function(s){return new(s||e)(ie(Se,9),ie(Bt,10),ie(Nt,10),ie(dn,10),ie(as,8),ie(pn,8))};static \u0275dir=we({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[ze([Ll]),Ae,on]})}return e})();var Qc=(()=>{class e{static \u0275fac=function(s){return new(s||e)};static \u0275dir=we({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return e})();var Bi=new vt(""),Hl={provide:He,useExisting:Le(()=>$l)},$l=(()=>{class e extends He{_ngModelWarningConfig;callSetDisabledState;viewModel;form;set isDisabled(t){}model;update=new yt;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(t,s,a,c,h){super(),this._ngModelWarningConfig=c,this.callSetDisabledState=h,this._setValidators(t),this._setAsyncValidators(s),this.valueAccessor=Fi(this,a)}ngOnChanges(t){if(this._isControlChanged(t)){let s=t.form.previousValue;s&&lr(s,this,!1),ur(this.form,this,this.callSetDisabledState),this.form.updateValueAndValidity({emitEvent:!1})}Ti(t,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&lr(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_isControlChanged(t){return t.hasOwnProperty("form")}static \u0275fac=function(s){return new(s||e)(ie(Bt,10),ie(Nt,10),ie(dn,10),ie(Bi,8),ie(pn,8))};static \u0275dir=we({type:e,selectors:[["","formControl",""]],inputs:{form:[0,"formControl","form"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],standalone:!1,features:[ze([Hl]),Ae,on]})}return e})(),Wl={provide:Se,useExisting:Le(()=>Us)},Us=(()=>{class e extends Se{callSetDisabledState;get submitted(){return tt(this._submittedReactive)}set submitted(t){this._submittedReactive.set(t)}_submitted=an(()=>this._submittedReactive());_submittedReactive=rn(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];form=null;ngSubmit=new yt;constructor(t,s,a){super(),this.callSetDisabledState=a,this._setValidators(t),this._setAsyncValidators(s)}ngOnChanges(t){t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(fr(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){let s=this.form.get(t.path);return ur(s,t,this.callSetDisabledState),s.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),s}getControl(t){return this.form.get(t.path)}removeControl(t){lr(t.control||null,t,!1),Kl(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,s){this.form.get(t.path).setValue(s)}onSubmit(t){return this._submittedReactive.set(!0),jl(this.form,this.directives),this.ngSubmit.emit(t),this.form._events.next(new Ii(this.control)),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0,s={}){this.form.reset(t,s),this._submittedReactive.set(!1),s?.emitEvent!==!1&&this.form._events.next(new Vi(this.form))}_updateDomValue(){this.directives.forEach(t=>{let s=t.control,a=this.form.get(t.path);s!==a&&(lr(s||null,t),Gl(a)&&(ur(a,t,this.callSetDisabledState),t.control=a))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let s=this.form.get(t.path);Fl(s,t),s.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let s=this.form.get(t.path);s&&Bl(s,t)&&s.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Ri(this.form,this),this._oldForm&&fr(this._oldForm,this)}static \u0275fac=function(s){return new(s||e)(ie(Bt,10),ie(Nt,10),ie(pn,8))};static \u0275dir=we({type:e,selectors:[["","formGroup",""]],hostBindings:function(s,a){s&1&&Rt("submit",function(h){return a.onSubmit(h)})("reset",function(){return a.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[ze([Wl]),Ae,on]})}return e})(),Yl={provide:Se,useExisting:Le(()=>Ls)},Ls=(()=>{class e extends Ul{name=null;constructor(t,s,a){super(),this._parent=t,this._setValidators(s),this._setAsyncValidators(a)}_checkParentType(){Hs(this._parent)}static \u0275fac=function(s){return new(s||e)(ie(Se,13),ie(Bt,10),ie(Nt,10))};static \u0275dir=we({type:e,selectors:[["","formGroupName",""]],inputs:{name:[0,"formGroupName","name"]},standalone:!1,features:[ze([Yl]),Ae]})}return e})(),Ql={provide:Se,useExisting:Le(()=>zs)},zs=(()=>{class e extends Se{_parent;name=null;constructor(t,s,a){super(),this._parent=t,this._setValidators(s),this._setAsyncValidators(a)}ngOnInit(){Hs(this._parent),this.formDirective.addFormArray(this)}ngOnDestroy(){this.formDirective?.removeFormArray(this)}get control(){return this.formDirective.getFormArray(this)}get formDirective(){return this._parent?this._parent.formDirective:null}get path(){return pr(this.name==null?this.name:this.name.toString(),this._parent)}static \u0275fac=function(s){return new(s||e)(ie(Se,13),ie(Bt,10),ie(Nt,10))};static \u0275dir=we({type:e,selectors:[["","formArrayName",""]],inputs:{name:[0,"formArrayName","name"]},standalone:!1,features:[ze([Ql]),Ae]})}return e})();function Hs(e){return!(e instanceof Ls)&&!(e instanceof Us)&&!(e instanceof zs)}var Jl={provide:He,useExisting:Le(()=>Xl)},Xl=(()=>{class e extends He{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(t){}model;update=new yt;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(t,s,a,c,h){super(),this._ngModelWarningConfig=h,this._parent=t,this._setValidators(s),this._setAsyncValidators(a),this.valueAccessor=Fi(this,c)}ngOnChanges(t){this._added||this._setUpControl(),Ti(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return pr(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(s){return new(s||e)(ie(Se,13),ie(Bt,10),ie(Nt,10),ie(dn,10),ie(Bi,8))};static \u0275dir=we({type:e,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[ze([Jl]),Ae,on]})}return e})();var $s=(()=>{class e{static \u0275fac=function(s){return new(s||e)};static \u0275mod=Zn({type:e});static \u0275inj=Xn({})}return e})(),Cs=class extends hn{constructor(i,t,s){super(Oi(t),Pi(s,t)),this.controls=i,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(i){return this.controls[this._adjustIndex(i)]}push(i,t={}){this.controls.push(i),this._registerControl(i),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(i,t,s={}){this.controls.splice(i,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:s.emitEvent})}removeAt(i,t={}){let s=this._adjustIndex(i);s<0&&(s=0),this.controls[s]&&this.controls[s]._registerOnCollectionChange(()=>{}),this.controls.splice(s,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(i,t,s={}){let a=this._adjustIndex(i);a<0&&(a=0),this.controls[a]&&this.controls[a]._registerOnCollectionChange(()=>{}),this.controls.splice(a,1),t&&(this.controls.splice(a,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:s.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(i,t={}){js(this,!1,i),i.forEach((s,a)=>{Ns(this,!1,a),this.at(a).setValue(s,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(i,t={}){i!=null&&(i.forEach((s,a)=>{this.at(a)&&this.at(a).patchValue(s,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(i=[],t={}){this._forEachChild((s,a)=>{s.reset(i[a],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(i=>i.getRawValue())}clear(i={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:i.emitEvent}))}_adjustIndex(i){return i<0?i+this.length:i}_syncPendingControls(){let i=this.controls.reduce((t,s)=>s._syncPendingControls()?!0:t,!1);return i&&this.updateValueAndValidity({onlySelf:!0}),i}_forEachChild(i){this.controls.forEach((t,s)=>{i(t,s)})}_updateValue(){this.value=this.controls.filter(i=>i.enabled||this.disabled).map(i=>i.value)}_anyControls(i){return this.controls.some(t=>t.enabled&&i(t))}_setUpControls(){this._forEachChild(i=>this._registerControl(i))}_allControlsDisabled(){for(let i of this.controls)if(i.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(i){i.setParent(this),i._registerOnCollectionChange(this._onCollectionChange)}_find(i){return this.at(i)??null}};var Jc=(()=>{class e{static withConfig(t){return{ngModule:e,providers:[{provide:pn,useValue:t.callSetDisabledState??dr}]}}static \u0275fac=function(s){return new(s||e)};static \u0275mod=Zn({type:e});static \u0275inj=Xn({imports:[$s]})}return e})(),Xc=(()=>{class e{static withConfig(t){return{ngModule:e,providers:[{provide:Bi,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:pn,useValue:t.callSetDisabledState??dr}]}}static \u0275fac=function(s){return new(s||e)};static \u0275mod=Zn({type:e});static \u0275inj=Xn({imports:[$s]})}return e})();var gr=rl(Ws(),1),Ys=Symbol.for("Dexie"),mr=globalThis[Ys]||(globalThis[Ys]=gr.default);if(gr.default.semVer!==mr.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${gr.default.semVer} and ${mr.semVer}`);var{liveQuery:ef,mergeRanges:tf,rangesOverlap:nf,RangeSet:rf,cmp:of,Entity:sf,PropModification:af,replacePrefix:uf,add:lf,remove:cf}=mr;var Qs=mr;var Js=[{version:1,schema:{productsStore:"++uuid,name",recipesStore:"++uuid,name",categoryStore:"++uuid,name"}},{version:2,schema:{productsStore:"++uuid,name",recipesStore:"++uuid,name",categoryStore:"++uuid,name",categoryProductsStore:"++uuid,name"},update:e=>new Promise(i=>re(void 0,null,function*(){let t=yield e.table("categoryStore").toArray(),s=e.table("categoryProductsStore");yield Promise.all(t.map(a=>s.add(a))),yield e.table("categoryStore").clear()}))},{version:3,schema:{productsStore:"++uuid,name",recipesStore:"++uuid,name",categoryProductsStore:"++uuid,name",categoryRecipesStore:"++uuid,name"}},{version:4,schema:{productsStore:"++uuid,name",recipesStore:"++uuid,name",categoryProductsStore:"++uuid,name",categoryRecipesStore:"++uuid,name"}},{version:5,schema:{productsStore:"++uuid,name",recipesStore:"++uuid,name",categoryProductsStore:"++uuid,name",categoryRecipesStore:"++uuid,name"},update:e=>new Promise(i=>re(void 0,null,function*(){let t=[{uuid:"\u0423\u043A\u0441\u0443\u0441\u044B",name:"\u0423\u043A\u0441\u0443\u0441\u044B"}],s=["\u0421\u0438\u0440\u043E\u043F\u044B \u0438 \u043F\u0440\u043E\u043F\u0438\u0442\u043A\u0438"],a=[{old:"\u0420\u0430\u0437\u0440\u044B\u0445\u043B\u0438\u0442\u0435\u043B\u0438 \u0438 \u0441\u0442\u0430\u0431\u0438\u043B\u0438\u0437\u0430\u0442\u043E\u0440\u044B",new:"\u0420\u0430\u0437\u0440\u044B\u0445\u043B\u0438\u0442\u0435\u043B\u0438 \u0438 \u0441\u043E\u0434\u044B"}],c=e.table("categoryProductsStore"),h=yield c.toArray(),m=h.filter(b=>s.includes(b.name)).map(b=>b.uuid),v=h.filter(b=>a.map(x=>x.old).includes(b.name));yield Promise.all(v.map(b=>{let x=a.find(k=>k.old===b.name)?.new;return c.update(b.uuid,{name:x})})),yield Promise.all(m.map(b=>c.delete(b))),yield Promise.all(t.map(b=>c.add(b)))}))},{version:6,schema:{productsStore:"++uuid,name",recipesStore:"++uuid,name,source",categoryProductsStore:"++uuid,name",categoryRecipesStore:"++uuid,name"}},{version:7,schema:{productsStore:"++uuid,name,source",recipesStore:"++uuid,name",categoryProductsStore:"++uuid,name",categoryRecipesStore:"++uuid,name"}},{version:8,schema:{productsStore:"++uuid,name,source",recipesStore:"++uuid,name",categoryProductsStore:"++uuid,name",categoryRecipesStore:"++uuid,name"},update:e=>{let i=["productsStore","recipesStore","categoryProductsStore","categoryRecipesStore"];return Promise.all([new Promise(t=>re(void 0,null,function*(){let s=e.table("categoryProductsStore"),a=yield s.toArray(),c=e.table("productsStore"),h=yield c.toArray();yield Promise.all(h.map(m=>{let v=a.find(b=>b.uuid===m.category_id);return v?c.update(m.uuid,{category_id:v.name}):Promise.resolve()})),yield Promise.all(a.map(m=>s.update(m.uuid,{uuid:m.name}))),t()})),new Promise(t=>re(void 0,null,function*(){let s=e.table("categoryRecipesStore"),a=yield s.toArray(),c=e.table("recipesStore"),h=yield c.toArray();yield Promise.all(h.map(m=>{let v=a.find(b=>b.uuid===m.category_id);return v?c.update(m.uuid,{category_id:v.name}):Promise.resolve()})),yield Promise.all(a.map(m=>s.update(m.uuid,{uuid:m.name}))),t()}))]).then(()=>{})}},{version:9,schema:{productsStore:"++uuid,name,source",recipesStore:"++uuid,name",categoryProductsStore:"++uuid,name",categoryRecipesStore:"++uuid,name",indicesStore:"++table_name"}}];var z;function ve(e,i,t){let s=typeof t,a=typeof e;if(s!=="undefined"){if(a!=="undefined"){if(t){if(a==="function"&&s===a)return function(m){return e(t(m))};if(i=e.constructor,i===t.constructor){if(i===Array)return t.concat(e);if(i===Map){var c=new Map(t);for(var h of e)c.set(h[0],h[1]);return c}if(i===Set){h=new Set(t);for(c of e.values())h.add(c);return h}}}return e}return t}return a==="undefined"?i:e}function he(){return Object.create(null)}function ke(e){return typeof e=="string"}function yn(e){return typeof e=="object"}function ql(e){let i=[];for(let t of e.keys())i.push(t);return i}function _n(e,i){if(ke(i))e=e[i];else for(let t=0;e&&t<i.length;t++)e=e[i[t]];return e}function Zl(e){let i=0;for(let t=0,s;t<e.length;t++)(s=e[t])&&i<s.length&&(i=s.length);return i}var ec=/[^\p{L}\p{N}]+/u,tc=/(\d{3})/g,nc=/(\D)(\d{3})/g,rc=/(\d{3})(\D)/g,Xs=/[\u0300-\u036f]/g;function bn(e={}){if(!this||this.constructor!==bn)return new bn(...arguments);if(arguments.length)for(e=0;e<arguments.length;e++)this.assign(arguments[e]);else this.assign(e)}z=bn.prototype;z.assign=function(e){this.normalize=ve(e.normalize,!0,this.normalize);let i=e.include,t=i||e.exclude||e.split,s;if(t||t===""){if(typeof t=="object"&&t.constructor!==RegExp){let a="";s=!i,i||(a+="\\p{Z}"),t.letter&&(a+="\\p{L}"),t.number&&(a+="\\p{N}",s=!!i),t.symbol&&(a+="\\p{S}"),t.punctuation&&(a+="\\p{P}"),t.control&&(a+="\\p{C}"),(t=t.char)&&(a+=typeof t=="object"?t.join(""):t);try{this.split=new RegExp("["+(i?"^":"")+a+"]+","u")}catch{this.split=/\s+/}}else this.split=t,s=t===!1||2>"a1a".split(t).length;this.numeric=ve(e.numeric,s)}else{try{this.split=ve(this.split,ec)}catch{this.split=/\s+/}this.numeric=ve(e.numeric,ve(this.numeric,!0))}if(this.prepare=ve(e.prepare,null,this.prepare),this.finalize=ve(e.finalize,null,this.finalize),t=e.filter,this.filter=typeof t=="function"?t:ve(t&&new Set(t),null,this.filter),this.dedupe=ve(e.dedupe,!0,this.dedupe),this.matcher=ve((t=e.matcher)&&new Map(t),null,this.matcher),this.mapper=ve((t=e.mapper)&&new Map(t),null,this.mapper),this.stemmer=ve((t=e.stemmer)&&new Map(t),null,this.stemmer),this.replacer=ve(e.replacer,null,this.replacer),this.minlength=ve(e.minlength,1,this.minlength),this.maxlength=ve(e.maxlength,1024,this.maxlength),this.rtl=ve(e.rtl,!1,this.rtl),(this.cache=t=ve(e.cache,!0,this.cache))&&(this.H=null,this.S=typeof t=="number"?t:2e5,this.B=new Map,this.G=new Map,this.L=this.K=128),this.h="",this.M=null,this.A="",this.N=null,this.matcher)for(let a of this.matcher.keys())this.h+=(this.h?"|":"")+a;if(this.stemmer)for(let a of this.stemmer.keys())this.A+=(this.A?"|":"")+a;return this};z.addStemmer=function(e,i){return this.stemmer||(this.stemmer=new Map),this.stemmer.set(e,i),this.A+=(this.A?"|":"")+e,this.N=null,this.cache&&bt(this),this};z.addFilter=function(e){return typeof e=="function"?this.filter=e:(this.filter||(this.filter=new Set),this.filter.add(e)),this.cache&&bt(this),this};z.addMapper=function(e,i){return typeof e=="object"?this.addReplacer(e,i):1<e.length?this.addMatcher(e,i):(this.mapper||(this.mapper=new Map),this.mapper.set(e,i),this.cache&&bt(this),this)};z.addMatcher=function(e,i){return typeof e=="object"?this.addReplacer(e,i):2>e.length&&(this.dedupe||this.mapper)?this.addMapper(e,i):(this.matcher||(this.matcher=new Map),this.matcher.set(e,i),this.h+=(this.h?"|":"")+e,this.M=null,this.cache&&bt(this),this)};z.addReplacer=function(e,i){return typeof e=="string"?this.addMatcher(e,i):(this.replacer||(this.replacer=[]),this.replacer.push(e,i),this.cache&&bt(this),this)};z.encode=function(e,i){if(this.cache&&e.length<=this.K)if(this.H){if(this.B.has(e))return this.B.get(e)}else this.H=setTimeout(bt,50,this);this.normalize&&(typeof this.normalize=="function"?e=this.normalize(e):e=Xs?e.normalize("NFKD").replace(Xs,"").toLowerCase():e.toLowerCase()),this.prepare&&(e=this.prepare(e)),this.numeric&&3<e.length&&(e=e.replace(nc,"$1 $2").replace(rc,"$1 $2").replace(tc,"$1 "));let t=!(this.dedupe||this.mapper||this.filter||this.matcher||this.stemmer||this.replacer),s=[],a=he(),c,h,m=this.split||this.split===""?e.split(this.split):[e];for(let b=0,x,k;b<m.length;b++)if((x=k=m[b])&&!(x.length<this.minlength||x.length>this.maxlength)){if(i){if(a[x])continue;a[x]=1}else{if(c===x)continue;c=x}if(t)s.push(x);else if(!this.filter||(typeof this.filter=="function"?this.filter(x):!this.filter.has(x))){if(this.cache&&x.length<=this.L)if(this.H){var v=this.G.get(x);if(v||v===""){v&&s.push(v);continue}}else this.H=setTimeout(bt,50,this);if(this.stemmer){this.N||(this.N=new RegExp("(?!^)("+this.A+")$"));let P;for(;P!==x&&2<x.length;)P=x,x=x.replace(this.N,B=>this.stemmer.get(B))}if(x&&(this.mapper||this.dedupe&&1<x.length)){v="";for(let P=0,B="",T,U;P<x.length;P++)T=x.charAt(P),T===B&&this.dedupe||((U=this.mapper&&this.mapper.get(T))||U===""?U===B&&this.dedupe||!(B=U)||(v+=U):v+=B=T);x=v}if(this.matcher&&1<x.length&&(this.M||(this.M=new RegExp("("+this.h+")","g")),x=x.replace(this.M,P=>this.matcher.get(P))),x&&this.replacer)for(v=0;x&&v<this.replacer.length;v+=2)x=x.replace(this.replacer[v],this.replacer[v+1]);if(this.cache&&k.length<=this.L&&(this.G.set(k,x),this.G.size>this.S&&(this.G.clear(),this.L=this.L/1.1|0)),x){if(x!==k)if(i){if(a[x])continue;a[x]=1}else{if(h===x)continue;h=x}s.push(x)}}}return this.finalize&&(s=this.finalize(s)||s),this.cache&&e.length<=this.K&&(this.B.set(e,s),this.B.size>this.S&&(this.B.clear(),this.K=this.K/1.1|0)),s};function bt(e){e.H=null,e.B.clear(),e.G.clear()}var jt,gn;function ic(e){return re(this,null,function*(){e=e.data;var i=e.task;let t=e.id,s=e.args;switch(i){case"init":gn=e.options||{},(i=e.factory)?(Function("return "+i)()(self),jt=new self.FlexSearch.Index(gn),delete self.FlexSearch):jt=new je(gn),postMessage({id:t});break;default:let a;i==="export"&&(s[1]?(s[0]=gn.export,s[2]=0,s[3]=1):s=null),i==="import"?s[0]&&(e=yield gn.import.call(jt,s[0]),jt.import(s[0],e)):(a=s&&jt[i].apply(jt,s))&&a.then&&(a=yield a),postMessage(i==="search"?{id:t,msg:a}:{id:t})}})}function Yi(e){mn.call(e,"add"),mn.call(e,"append"),mn.call(e,"search"),mn.call(e,"update"),mn.call(e,"remove")}var Li,qs,_r;function oc(){Li=_r=0}function mn(e){this[e+"Async"]=function(){let i=arguments;var t=i[i.length-1];let s;if(typeof t=="function"&&(s=t,delete i[i.length-1]),Li?_r||(_r=Date.now()-qs>=this.priority*this.priority*3):(Li=setTimeout(oc,0),qs=Date.now()),_r){let c=this;return new Promise(h=>{setTimeout(function(){h(c[e+"Async"].apply(c,i))},0)})}let a=this[e].apply(this,i);return t=a.then?a:new Promise(c=>c(a)),s&&t.then(s),t}}var Kt=0;function wn(e={}){function i(h){function m(v){v=v.data||v;let b=v.id,x=b&&a.h[b];x&&(x(v.msg),delete a.h[b])}if(this.worker=h,this.h=he(),this.worker)return s?this.worker.on("message",m):this.worker.onmessage=m,e.config?new Promise(function(v){a.h[++Kt]=function(){v(a),1e9<Kt&&(Kt=0)},a.worker.postMessage({id:Kt,task:"init",factory:t,options:e})}):(this.worker.postMessage({task:"init",factory:t,options:e}),this.priority=e.priority||4,this)}if(!this||this.constructor!==wn)return new wn(e);let t=typeof self<"u"?self._factory:typeof window<"u"?window._factory:null;t&&(t=t.toString());let s=typeof window>"u",a=this,c=sc(t,s,e.worker);return c.then?c.then(function(h){return i.call(a,h)}):i.call(this,c)}it("add");it("append");it("search");it("update");it("remove");it("clear");it("export");it("import");Yi(wn.prototype);function it(e){wn.prototype[e]=function(){let i=this,t=[].slice.call(arguments);var s=t[t.length-1];let a;return typeof s=="function"&&(a=s,t.pop()),s=new Promise(function(c){e==="export"&&typeof t[0]=="function"&&(t[0]=null),i.h[++Kt]=c,i.worker.postMessage({task:e,id:Kt,args:t})}),a?(s.then(a),this):s}}function sc(e,i,t){return i?typeof module<"u"?new(il()).Worker(__dirname+"/worker/node.js"):import("./chunk-55JXXOPV.js").then(function(s){return new s.Worker(import.meta.dirname+"/node/node.mjs")}):e?new window.Worker(URL.createObjectURL(new Blob(["onmessage="+ic.toString()],{type:"text/javascript"}))):new window.Worker(typeof t=="string"?t:import.meta.url.replace("/worker.js","/worker/worker.js").replace("flexsearch.bundle.module.min.js","module/worker/worker.js"),{type:"module"})}function Qi(e,i=0){let t=[],s=[];i&&(i=25e4/i*5e3|0);for(let a of e.entries())s.push(a),s.length===i&&(t.push(s),s=[]);return s.length&&t.push(s),t}function Ji(e,i){i||(i=new Map);for(let t=0,s;t<e.length;t++)s=e[t],i.set(s[0],s[1]);return i}function la(e,i=0){let t=[],s=[];i&&(i=25e4/i*1e3|0);for(let a of e.entries())s.push([a[0],Qi(a[1])[0]]),s.length===i&&(t.push(s),s=[]);return s.length&&t.push(s),t}function ca(e,i){i||(i=new Map);for(let t=0,s,a;t<e.length;t++)s=e[t],a=i.get(s[0]),i.set(s[0],Ji(s[1],a));return i}function fa(e){let i=[],t=[];for(let s of e.keys())t.push(s),t.length===25e4&&(i.push(t),t=[]);return t.length&&i.push(t),i}function ha(e,i){i||(i=new Set);for(let t=0;t<e.length;t++)i.add(e[t]);return i}function br(e,i,t,s,a,c,h=0){let m=s&&s.constructor===Array;var v=m?s.shift():s;if(!v)return this.export(e,i,a,c+1);if((v=e((i?i+".":"")+(h+1)+"."+t,JSON.stringify(v)))&&v.then){let b=this;return v.then(function(){return br.call(b,e,i,t,m?s:null,a,c,h+1)})}return br.call(this,e,i,t,m?s:null,a,c,h+1)}function Zs(e,i){let t="";for(let s of e.entries()){e=s[0];let a=s[1],c="";for(let h=0,m;h<a.length;h++){m=a[h]||[""];let v="";for(let b=0;b<m.length;b++)v+=(v?",":"")+(i==="string"?'"'+m[b]+'"':m[b]);v="["+v+"]",c+=(c?",":"")+v}c='["'+e+'",['+c+"]]",t+=(t?",":"")+c}return t}function ea(e,i,t,s){let a=[];for(let c=0,h;c<e.index.length;c++)if(h=e.index[c],i>=h.length)i-=h.length;else{i=h[s?"splice":"slice"](i,t);let m=i.length;if(m&&(a=a.length?a.concat(i):i,t-=m,s&&(e.length-=m),!t))break;i=0}return a}function wt(e){if(!this||this.constructor!==wt)return new wt(e);this.index=e?[e]:[],this.length=e?e.length:0;let i=this;return new Proxy([],{get(t,s){if(s==="length")return i.length;if(s==="push")return function(a){i.index[i.index.length-1].push(a),i.length++};if(s==="pop")return function(){if(i.length)return i.length--,i.index[i.index.length-1].pop()};if(s==="indexOf")return function(a){let c=0;for(let h=0,m,v;h<i.index.length;h++){if(m=i.index[h],v=m.indexOf(a),0<=v)return c+v;c+=m.length}return-1};if(s==="includes")return function(a){for(let c=0;c<i.index.length;c++)if(i.index[c].includes(a))return!0;return!1};if(s==="slice")return function(a,c){return ea(i,a||0,c||i.length,!1)};if(s==="splice")return function(a,c){return ea(i,a||0,c||i.length,!0)};if(s==="constructor")return Array;if(typeof s!="symbol")return(t=i.index[s/2**31|0])&&t[s]},set(t,s,a){return t=s/2**31|0,(i.index[t]||(i.index[t]=[]))[s]=a,i.length++,!0}})}wt.prototype.clear=function(){this.index.length=0};wt.prototype.destroy=function(){this.proxy=this.index=null};wt.prototype.push=function(){};function Ne(e=8){if(!this||this.constructor!==Ne)return new Ne(e);this.index=he(),this.h=[],this.size=0,32<e?(this.B=pa,this.A=BigInt(e)):(this.B=da,this.A=e)}Ne.prototype.get=function(e){let i=this.index[this.B(e)];return i&&i.get(e)};Ne.prototype.set=function(e,i){var t=this.B(e);let s=this.index[t];s?(t=s.size,s.set(e,i),(t-=s.size)&&this.size++):(this.index[t]=s=new Map([[e,i]]),this.h.push(s),this.size++)};function Oe(e=8){if(!this||this.constructor!==Oe)return new Oe(e);this.index=he(),this.h=[],this.size=0,32<e?(this.B=pa,this.A=BigInt(e)):(this.B=da,this.A=e)}Oe.prototype.add=function(e){var i=this.B(e);let t=this.index[i];t?(i=t.size,t.add(e),(i-=t.size)&&this.size++):(this.index[i]=t=new Set([e]),this.h.push(t),this.size++)};z=Ne.prototype;z.has=Oe.prototype.has=function(e){let i=this.index[this.B(e)];return i&&i.has(e)};z.delete=Oe.prototype.delete=function(e){let i=this.index[this.B(e)];i&&i.delete(e)&&this.size--};z.clear=Oe.prototype.clear=function(){this.index=he(),this.h=[],this.size=0};z.values=Oe.prototype.values=function*(){for(let e=0;e<this.h.length;e++)for(let i of this.h[e].values())yield i};z.keys=Oe.prototype.keys=function*(){for(let e=0;e<this.h.length;e++)for(let i of this.h[e].keys())yield i};z.entries=Oe.prototype.entries=function*(){for(let e=0;e<this.h.length;e++)for(let i of this.h[e].entries())yield i};function da(e){let i=2**this.A-1;if(typeof e=="number")return e&i;let t=0,s=this.A+1;for(let a=0;a<e.length;a++)t=(t*s^e.charCodeAt(a))&i;return this.A===32?t+2**31:t}function pa(e){let i=BigInt(2)**this.A-BigInt(1);var t=typeof e;if(t==="bigint")return e&i;if(t==="number")return BigInt(e)&i;t=BigInt(0);let s=this.A+BigInt(1);for(let a=0;a<e.length;a++)t=(t*s^BigInt(e.charCodeAt(a)))&i;return t}Ct.prototype.add=function(e,i,t){if(yn(e)&&(i=e,e=_n(i,this.key)),i&&(e||e===0)){if(!t&&this.reg.has(e))return this.update(e,i);for(let m=0,v;m<this.field.length;m++){v=this.F[m];var s=this.index.get(this.field[m]);if(typeof v=="function"){var a=v(i);a&&s.add(e,a,!1,!0)}else a=v.I,(!a||a(i))&&(v.constructor===String?v=[""+v]:ke(v)&&(v=[v]),Hi(i,v,this.J,0,s,e,v[0],t))}if(this.tag)for(s=0;s<this.D.length;s++){var c=this.D[s];a=this.tag.get(this.R[s]);let m=he();if(typeof c=="function"){if(c=c(i),!c)continue}else{var h=c.I;if(h&&!h(i))continue;c.constructor===String&&(c=""+c),c=_n(i,c)}if(a&&c){ke(c)&&(c=[c]);for(let v=0,b,x;v<c.length;v++)if(b=c[v],!m[b]&&(m[b]=1,(h=a.get(b))?x=h:a.set(b,x=[]),!t||!x.includes(e))){if(x.length===2**31-1){if(h=new wt(x),this.fastupdate)for(let k of this.reg.values())k.includes(x)&&(k[k.indexOf(x)]=h);a.set(b,x=h)}x.push(e),this.fastupdate&&((h=this.reg.get(e))?h.push(x):this.reg.set(e,[x]))}}}if(this.store&&(!t||!this.store.has(e))){let m;if(this.C){m=he();for(let v=0,b;v<this.C.length;v++){if(b=this.C[v],(t=b.I)&&!t(i))continue;let x;if(typeof b=="function"){if(x=b(i),!x)continue;b=[b.V]}else if(ke(b)||b.constructor===String){m[b]=i[b];continue}zi(i,m,b,0,b[0],x)}}this.store.set(e,m||i)}this.worker&&(this.fastupdate||this.reg.add(e))}return this};function zi(e,i,t,s,a,c){if(e=e[a],s===t.length-1)i[a]=c||e;else if(e)if(e.constructor===Array)for(i=i[a]=Array(e.length),a=0;a<e.length;a++)zi(e,i,t,s,a);else i=i[a]||(i[a]=he()),a=t[++s],zi(e,i,t,s,a)}function Hi(e,i,t,s,a,c,h,m){if(e=e[h])if(s===i.length-1){if(e.constructor===Array){if(t[s]){for(i=0;i<e.length;i++)a.add(c,e[i],!0,!0);return}e=e.join(" ")}a.add(c,e,m,!0)}else if(e.constructor===Array)for(h=0;h<e.length;h++)Hi(e,i,t,s,a,c,h,m);else h=i[++s],Hi(e,i,t,s,a,c,h,m);else a.db&&a.remove(c)}function ga(e,i,t,s,a,c,h){let m=e.length,v=[],b,x;b=he();for(let k=0,P,B,T,U;k<i;k++)for(let H=0;H<m;H++)if(T=e[H],k<T.length&&(P=T[k]))for(let X=0;X<P.length;X++){if(B=P[X],(x=b[B])?b[B]++:(x=0,b[B]=1),U=v[x]||(v[x]=[]),!h){let J=k+(H||!a?0:c||0);U=U[J]||(U[J]=[])}if(U.push(B),h&&t&&x===m-1&&U.length-s===t)return s?U.slice(s):U}if(e=v.length)if(a)v=1<v.length?ma(v,t,s,h,c):(v=v[0]).length>t||s?v.slice(s,t+s):v;else{if(e<m)return[];if(v=v[e-1],t||s)if(h)(v.length>t||s)&&(v=v.slice(s,t+s));else{a=[];for(let k=0,P;k<v.length;k++)if(P=v[k],P.length>s)s-=P.length;else if((P.length>t||s)&&(P=P.slice(s,t+s),t-=P.length,s&&(s-=P.length)),a.push(P),!t)break;v=1<a.length?[].concat.apply([],a):a[0]}}return v}function ma(e,i,t,s,a){let c=[],h=he(),m;var v=e.length;let b;if(s){for(a=v-1;0<=a;a--)if(b=(s=e[a])&&s.length){for(v=0;v<b;v++)if(m=s[v],!h[m]){if(h[m]=1,t)t--;else if(c.push(m),c.length===i)return c}}}else for(let x=v-1,k,P=0;0<=x;x--){k=e[x];for(let B=0;B<k.length;B++)if(b=(s=k[B])&&s.length){for(let T=0;T<b;T++)if(m=s[T],!h[m])if(h[m]=1,t)t--;else{let U=(B+(x<v-1&&a||0))/(x+1)|0;if((c[U]||(c[U]=[])).push(m),++P===i)return c}}}return c}function ac(e,i,t){let s=he(),a=[];for(let c=0,h;c<i.length;c++){h=i[c];for(let m=0;m<h.length;m++)s[h[m]]=1}if(t)for(let c=0,h;c<e.length;c++)h=e[c],s[h]&&(a.push(h),s[h]=0);else for(let c=0,h,m;c<e.result.length;c++)for(h=e.result[c],i=0;i<h.length;i++)m=h[i],s[m]&&((a[c]||(a[c]=[])).push(m),s[m]=0);return a}function Xi(e,i,t,s){if(!e.length)return e;if(e.length===1)return e=e[0],e=t||e.length>i?i?e.slice(t,t+i):e.slice(t):e,s?rt.call(this,e):e;let a=[];for(let c=0,h,m;c<e.length;c++)if((h=e[c])&&(m=h.length)){if(t){if(t>=m){t-=m;continue}t<m&&(h=i?h.slice(t,t+i):h.slice(t),m=h.length,t=0)}if(m>i&&(h=h.slice(0,i),m=i),!a.length&&m>=i)return s?rt.call(this,h):h;if(a.push(h),i-=m,!i)break}return a=1<a.length?[].concat.apply([],a):a[0],s?rt.call(this,a):a}function xr(e,i,t){var s=t[0];if(s.then)return Promise.all(t).then(function(x){return e[i].apply(e,x)});if(s[0]&&s[0].index)return e[i].apply(e,s);s=[];let a=[],c=0,h=0,m,v,b;for(let x=0,k;x<t.length;x++)if(k=t[x]){let P;if(k.constructor===le)P=k.result;else if(k.constructor===Array)P=k;else if(c=k.limit||0,h=k.offset||0,b=k.suggest,v=k.resolve,m=k.enrich&&v,k.index)k.resolve=!1,P=k.index.search(k).result,k.resolve=v;else if(k.and)P=e.and(k.and);else if(k.or)P=e.or(k.or);else if(k.xor)P=e.xor(k.xor);else if(k.not)P=e.not(k.not);else continue;if(P.then)a.push(P);else if(P.length)s[x]=P;else if(!b&&(i==="and"||i==="xor")){s=[];break}}return{O:s,P:a,limit:c,offset:h,enrich:m,resolve:v,suggest:b}}le.prototype.or=function(){let{O:e,P:i,limit:t,offset:s,enrich:a,resolve:c}=xr(this,"or",arguments);return va.call(this,e,i,t,s,a,c)};function va(e,i,t,s,a,c){if(i.length){let h=this;return Promise.all(i).then(function(m){e=[];for(let v=0,b;v<m.length;v++)(b=m[v]).length&&(e[v]=b);return va.call(h,e,[],t,s,a,c)})}return e.length&&(this.result.length&&e.push(this.result),2>e.length?this.result=e[0]:(this.result=ma(e,t,s,!1,this.h),s=0)),c?this.resolve(t,s,a):this}le.prototype.and=function(){let e=this.result.length,i,t,s,a;if(!e){let c=arguments[0];c&&(e=!!c.suggest,a=c.resolve,i=c.limit,t=c.offset,s=c.enrich&&a)}if(e){let{O:c,P:h,limit:m,offset:v,enrich:b,resolve:x,suggest:k}=xr(this,"and",arguments);return ya.call(this,c,h,m,v,b,x,k)}return a?this.resolve(i,t,s):this};function ya(e,i,t,s,a,c,h){if(i.length){let m=this;return Promise.all(i).then(function(v){e=[];for(let b=0,x;b<v.length;b++)(x=v[b]).length&&(e[b]=x);return ya.call(m,e,[],t,s,a,c,h)})}if(e.length)if(this.result.length&&e.unshift(this.result),2>e.length)this.result=e[0];else{if(i=Zl(e))return this.result=ga(e,i,t,s,h,this.h,c),c?a?rt.call(this.index,this.result):this.result:this;this.result=[]}else h||(this.result=e);return c?this.resolve(t,s,a):this}le.prototype.xor=function(){let{O:e,P:i,limit:t,offset:s,enrich:a,resolve:c,suggest:h}=xr(this,"xor",arguments);return _a.call(this,e,i,t,s,a,c,h)};function _a(e,i,t,s,a,c,h){if(i.length){let m=this;return Promise.all(i).then(function(v){e=[];for(let b=0,x;b<v.length;b++)(x=v[b]).length&&(e[b]=x);return _a.call(m,e,[],t,s,a,c,h)})}if(e.length)if(this.result.length&&e.unshift(this.result),2>e.length)this.result=e[0];else return this.result=uc.call(this,e,t,s,c,this.h),c?a?rt.call(this.index,this.result):this.result:this;else h||(this.result=e);return c?this.resolve(t,s,a):this}function uc(e,i,t,s,a){let c=[],h=he(),m=0;for(let v=0,b;v<e.length;v++)if(b=e[v]){m<b.length&&(m=b.length);for(let x=0,k;x<b.length;x++)if(k=b[x])for(let P=0,B;P<k.length;P++)B=k[P],h[B]=h[B]?2:1}for(let v=0,b,x=0;v<m;v++)for(let k=0,P;k<e.length;k++)if((P=e[k])&&(b=P[v])){for(let B=0,T;B<b.length;B++)if(T=b[B],h[T]===1)if(t)t--;else if(s){if(c.push(T),c.length===i)return c}else{let U=v+(k?a:0);if(c[U]||(c[U]=[]),c[U].push(T),++x===i)return c}}return c}le.prototype.not=function(){let{O:e,P:i,limit:t,offset:s,enrich:a,resolve:c,suggest:h}=xr(this,"not",arguments);return ba.call(this,e,i,t,s,a,c,h)};function ba(e,i,t,s,a,c,h){if(i.length){let m=this;return Promise.all(i).then(function(v){e=[];for(let b=0,x;b<v.length;b++)(x=v[b]).length&&(e[b]=x);return ba.call(m,e,[],t,s,a,c,h)})}if(e.length&&this.result.length)this.result=lc.call(this,e,t,s,c);else if(c)return this.resolve(t,s,a);return c?a?rt.call(this.index,this.result):this.result:this}function lc(e,i,t,s){let a=[];e=new Set(e.flat().flat());for(let c=0,h,m=0;c<this.result.length;c++)if(h=this.result[c]){for(let v=0,b;v<h.length;v++)if(b=h[v],!e.has(b)){if(t)t--;else if(s){if(a.push(b),a.length===i)return a}else if(a[c]||(a[c]=[]),a[c].push(b),++m===i)return a}}return a}function le(e){if(!this||this.constructor!==le)return new le(e);if(e&&e.index)return e.resolve=!1,this.index=e.index,this.h=e.boost||0,this.result=e.index.search(e).result,this;this.index=null,this.result=e||[],this.h=0}le.prototype.limit=function(e){if(this.result.length){let i=[];for(let t=0,s;t<this.result.length;t++)if(s=this.result[t])if(s.length<=e){if(i[t]=s,e-=s.length,!e)break}else{i[t]=s.slice(0,e);break}this.result=i}return this};le.prototype.offset=function(e){if(this.result.length){let i=[];for(let t=0,s;t<this.result.length;t++)(s=this.result[t])&&(s.length<=e?e-=s.length:(i[t]=s.slice(e),e=0));this.result=i}return this};le.prototype.boost=function(e){return this.h+=e,this};le.prototype.resolve=function(e,i,t){let s=this.result,a=this.index;return this.result=this.index=null,s.length?(typeof e=="object"&&(t=e.enrich,i=e.offset,e=e.limit),Xi.call(a,s,e||100,i,t)):s};he();Ct.prototype.search=function(e,i,t,s){t||(!i&&yn(e)?(t=e,e=""):yn(i)&&(t=i,i=0));let a=[];var c=[];let h;var m;let v,b,x,k=0;var P=!0;let B;if(t){t.constructor===Array&&(t={index:t}),e=t.query||e,h=t.pluck,v=t.merge,b=h||t.field||(b=t.index)&&(b.index?null:b),x=this.tag&&t.tag;var T=t.suggest;P=t.resolve!==!1,P||h||!(b=b||this.field)||(ke(b)?h=b:(b.constructor===Array&&b.length===1&&(b=b[0]),h=b.field||b.index)),B=(m=this.store&&t.enrich&&P)&&t.highlight,i=t.limit||i;var U=t.offset||0;if(i||(i=100),x&&(!this.db||!s)){x.constructor!==Array&&(x=[x]);var H=[];for(let ae=0,q;ae<x.length;ae++)if(q=x[ae],q.field&&q.tag){var X=q.tag;if(X.constructor===Array)for(var J=0;J<X.length;J++)H.push(q.field,X[J]);else H.push(q.field,X)}else{X=Object.keys(q);for(let ce=0,pe,oe;ce<X.length;ce++)if(pe=X[ce],oe=q[pe],oe.constructor===Array)for(J=0;J<oe.length;J++)H.push(pe,oe[J]);else H.push(pe,oe)}if(x=H,!e){if(P=[],H.length)for(c=0;c<H.length;c+=2){if(this.db){if(T=this.index.get(H[c]),!T)continue;P.push(T=T.db.tag(H[c+1],i,U,m))}else T=cc.call(this,H[c],H[c+1],i,U,m);a.push({field:H[c],tag:H[c+1],result:T})}return P.length?Promise.all(P).then(function(ae){for(let q=0;q<ae.length;q++)a[q].result=ae[q];return a}):a}}b&&b.constructor!==Array&&(b=[b])}b||(b=this.field),H=!s&&(this.worker||this.db)&&[];let me;for(let ae=0,q,ce,pe;ae<b.length;ae++){if(ce=b[ae],this.db&&this.tag&&!this.F[ae])continue;let oe;if(ke(ce)||(oe=ce,ce=oe.field,e=oe.query||e,i=oe.limit||i,U=oe.offset||U,T=oe.suggest||T,m=this.store&&(oe.enrich||m)),s)q=s[ae];else if(X=oe||t,J=this.index.get(ce),x&&(this.db&&(X.tag=x,me=J.db.support_tag_search,X.field=b),me||(X.enrich=!1)),H){H[ae]=J.search(e,i,X),X&&m&&(X.enrich=m);continue}else q=J.search(e,i,X),X&&m&&(X.enrich=m);if(pe=q&&(P?q.length:q.result.length),x&&pe){if(X=[],J=0,this.db&&s){if(!me)for(let Pe=b.length;Pe<s.length;Pe++){let Ce=s[Pe];if(Ce&&Ce.length)J++,X.push(Ce);else if(!T)return P?a:new le(a)}}else for(let Pe=0,Ce,Er;Pe<x.length;Pe+=2){if(Ce=this.tag.get(x[Pe]),!Ce){if(T)continue;return P?a:new le(a)}if(Er=(Ce=Ce&&Ce.get(x[Pe+1]))&&Ce.length)J++,X.push(Ce);else if(!T)return P?a:new le(a)}if(J){if(q=ac(q,X,P),pe=q.length,!pe&&!T)return P?q:new le(q);J--}}if(pe)c[k]=ce,a.push(q),k++;else if(b.length===1)return P?a:new le(a)}if(H){if(this.db&&x&&x.length&&!me)for(m=0;m<x.length;m+=2){if(c=this.index.get(x[m]),!c){if(T)continue;return P?a:new le(a)}H.push(c.db.tag(x[m+1],i,U,!1))}let ae=this;return Promise.all(H).then(function(q){return q.length?ae.search(e,i,t,q):q})}if(!k)return P?a:new le(a);if(h&&(!m||!this.store))return a[0];for(H=[],U=0;U<c.length;U++){if(T=a[U],m&&T.length&&typeof T[0].doc>"u"&&(this.db?H.push(T=this.index.get(this.field[0]).db.enrich(T)):T=rt.call(this,T)),h)return P?B?Ki(e,T,this.index,h,B):T:new le(T);a[U]={field:c[U],result:T}}if(m&&this.db&&H.length){let ae=this;return Promise.all(H).then(function(q){for(let ce=0;ce<q.length;ce++)a[ce].result=q[ce];return v?ta(a):B?Ki(e,a,ae.index,h,B):a})}return v?ta(a):B?Ki(e,a,this.index,h,B):a};function Ki(e,i,t,s,a){let c,h;for(let v=0,b,x,k;v<i.length;v++){let P;if(s)P=i,k=s;else{var m=i[v];if(k=m.field,!k)continue;P=m.result}x=t.get(k),b=x.encoder,m=x.tokenize,b!==c&&(c=b,h=c.encode(e));for(let B=0;B<P.length;B++){let T="",U=_n(P[B].doc,k).split(/\s+/);for(let H=0,X,J;H<U.length;H++){X=U[H],J=b.encode(X),J=1<J.length?J.join(" "):J[0];let me;if(J&&X)for(let ae=0,q;ae<h.length;ae++)if(q=h[ae],m==="strict"){if(J===q){T+=(T?" ":"")+a.replace("$1",X),me=!0;break}}else{let ce=J.indexOf(q);if(-1<ce){T+=(T?" ":"")+X.substring(0,ce)+a.replace("$1",X.substring(ce,ce+q.length))+X.substring(ce+q.length),me=!0;break}}me||(T+=(T?" ":"")+U[H])}P[B].highlight=T}if(s)break}return i}function ta(e){let i=[],t=he();for(let s=0,a,c;s<e.length;s++){a=e[s],c=a.result;for(let h=0,m,v,b;h<c.length;h++)v=c[h],typeof v!="object"&&(v={id:v}),m=v.id,(b=t[m])?b.push(a.field):(v.field=t[m]=[a.field],i.push(v))}return i}function cc(e,i,t,s,a){if(e=this.tag.get(e),!e)return[];if((i=(e=e&&e.get(i))&&e.length-s)&&0<i)return(i>t||s)&&(e=e.slice(s,s+t)),a&&(e=rt.call(this,e)),e}function rt(e){if(!this||!this.store)return e;let i=Array(e.length);for(let t=0,s;t<e.length;t++)s=e[t],i[t]={id:s,doc:this.store.get(s)};return i}function Ct(e){if(!this||this.constructor!==Ct)return new Ct(e);let i=e.document||e.doc||e,t,s;if(this.F=[],this.field=[],this.J=[],this.key=(t=i.key||i.id)&&wr(t,this.J)||"id",(s=e.keystore||0)&&(this.keystore=s),this.fastupdate=!!e.fastupdate,this.reg=!this.fastupdate||e.worker||e.db?s?new Oe(s):new Set:s?new Ne(s):new Map,this.C=(t=i.store||null)&&t&&t!==!0&&[],this.store=t&&(s?new Ne(s):new Map),this.cache=(t=e.cache||null)&&new xt(t),e.cache=!1,this.worker=e.worker||!1,this.priority=e.priority||4,this.index=fc.call(this,e,i),this.tag=null,(t=i.tag)&&(typeof t=="string"&&(t=[t]),t.length)){this.tag=new Map,this.D=[],this.R=[];for(let a=0,c,h;a<t.length;a++){if(c=t[a],h=c.field||c,!h)throw Error("The tag field from the document descriptor is undefined.");c.custom?this.D[a]=c.custom:(this.D[a]=wr(h,this.J),c.filter&&(typeof this.D[a]=="string"&&(this.D[a]=new String(this.D[a])),this.D[a].I=c.filter)),this.R[a]=h,this.tag.set(h,new Map)}}if(this.worker){this.fastupdate=!1;let a=[];for(let c of this.index.values())c.then&&a.push(c);if(a.length){let c=this;return Promise.all(a).then(function(h){let m=new Map,v=0;for(let x of c.index.entries()){let k=x[0];var b=x[1];if(b.then){b=a[v].encoder||{};let P=m.get(b);P||(P=b.encode?b:new bn(b),m.set(b,P)),b=h[v],b.encoder=P,c.index.set(k,b),v++}}return c})}}else e.db&&(this.fastupdate=!1,this.mount(e.db))}z=Ct.prototype;z.mount=function(e){let i=this.field;if(this.tag)for(let c=0,h;c<this.R.length;c++){h=this.R[c];var t=void 0;this.index.set(h,t=new je({},this.reg)),i===this.field&&(i=i.slice(0)),i.push(h),t.tag=this.tag.get(h)}t=[];let s={db:e.db,type:e.type,fastupdate:e.fastupdate};for(let c=0,h,m;c<i.length;c++){s.field=m=i[c],h=this.index.get(m);let v=new e.constructor(e.id,s);v.id=e.id,t[c]=v.mount(h),h.document=!0,c?h.bypass=!0:h.store=this.store}let a=this;return this.db=Promise.all(t).then(function(){a.db=!0})};z.commit=function(e,i){return re(this,null,function*(){let t=[];for(let s of this.index.values())t.push(s.commit(e,i));yield Promise.all(t),this.reg.clear()})};z.destroy=function(){let e=[];for(let i of this.index.values())e.push(i.destroy());return Promise.all(e)};function fc(e,i){let t=new Map,s=i.index||i.field||i;ke(s)&&(s=[s]);for(let a=0,c,h;a<s.length;a++){if(c=s[a],ke(c)||(h=c,c=c.field),h=yn(h)?Object.assign({},e,h):e,this.worker){let m=new wn(h);m.encoder=h.encoder,t.set(c,m)}this.worker||t.set(c,new je(h,this.reg)),h.custom?this.F[a]=h.custom:(this.F[a]=wr(c,this.J),h.filter&&(typeof this.F[a]=="string"&&(this.F[a]=new String(this.F[a])),this.F[a].I=h.filter)),this.field[a]=c}if(this.C){e=i.store,ke(e)&&(e=[e]);for(let a=0,c,h;a<e.length;a++)c=e[a],h=c.field||c,c.custom?(this.C[a]=c.custom,c.custom.V=h):(this.C[a]=wr(h,this.J),c.filter&&(typeof this.C[a]=="string"&&(this.C[a]=new String(this.C[a])),this.C[a].I=c.filter))}return t}function wr(e,i){let t=e.split(":"),s=0;for(let a=0;a<t.length;a++)e=t[a],e[e.length-1]==="]"&&(e=e.substring(0,e.length-2))&&(i[s]=!0),e&&(t[s++]=e);return s<t.length&&(t.length=s),1<s?t:t[0]}z.append=function(e,i){return this.add(e,i,!0)};z.update=function(e,i){return this.remove(e).add(e,i)};z.remove=function(e){yn(e)&&(e=_n(e,this.key));for(var i of this.index.values())i.remove(e,!0);if(this.reg.has(e)){if(this.tag&&!this.fastupdate)for(let t of this.tag.values())for(let s of t){i=s[0];let a=s[1],c=a.indexOf(e);-1<c&&(1<a.length?a.splice(c,1):t.delete(i))}this.store&&this.store.delete(e),this.reg.delete(e)}return this.cache&&this.cache.remove(e),this};z.clear=function(){let e=[];for(let i of this.index.values()){let t=i.clear();t.then&&e.push(t)}if(this.tag)for(let i of this.tag.values())i.clear();return this.store&&this.store.clear(),this.cache&&this.cache.clear(),e.length?Promise.all(e):this};z.contain=function(e){return this.db?this.index.get(this.field[0]).db.has(e):this.reg.has(e)};z.cleanup=function(){for(let e of this.index.values())e.cleanup();return this};z.get=function(e){return this.db?this.index.get(this.field[0]).db.enrich(e).then(function(i){return i[0]&&i[0].doc||null}):this.store.get(e)||null};z.set=function(e,i){return typeof e=="object"&&(i=e,e=_n(i,this.key)),this.store.set(e,i),this};z.searchCache=wa;z.export=function(e,i,t=0,s=0){if(t<this.field.length){let h=this.field[t];if((i=this.index.get(h).export(e,h,t,s=1))&&i.then){let m=this;return i.then(function(){return m.export(e,h,t+1)})}return this.export(e,h,t+1)}let a,c;switch(s){case 0:a="reg",c=fa(this.reg),i=null;break;case 1:a="tag",c=this.tag&&la(this.tag,this.reg.size),i=null;break;case 2:a="doc",c=this.store&&Qi(this.store),i=null;break;default:return}return br.call(this,e,i,a,c,t,s)};z.import=function(e,i){var t=e.split(".");t[t.length-1]==="json"&&t.pop();let s=2<t.length?t[0]:"";if(t=2<t.length?t[2]:t[1],this.worker&&s)return this.index.get(s).import(e);if(i){if(typeof i=="string"&&(i=JSON.parse(i)),s)return this.index.get(s).import(t,i);switch(t){case"reg":this.fastupdate=!1,this.reg=ha(i,this.reg);for(let a=0,c;a<this.field.length;a++)c=this.index.get(this.field[a]),c.fastupdate=!1,c.reg=this.reg;if(this.worker){i=[];for(let a of this.index.values())i.push(a.import(e));return Promise.all(i)}break;case"tag":this.tag=ca(i,this.tag);break;case"doc":this.store=Ji(i,this.store)}}};Yi(Ct.prototype);function wa(e,i,t){let s=(typeof e=="object"?""+e.query:e).toLowerCase();this.cache||(this.cache=new xt);let a=this.cache.get(s);if(!a){if(a=this.search(e,i,t),a.then){let c=this;a.then(function(h){return c.cache.set(s,h),h})}this.cache.set(s,a)}return a}function xt(e){this.limit=e&&e!==!0?e:1e3,this.cache=new Map,this.h=""}xt.prototype.set=function(e,i){this.cache.set(this.h=e,i),this.cache.size>this.limit&&this.cache.delete(this.cache.keys().next().value)};xt.prototype.get=function(e){let i=this.cache.get(e);return i&&this.h!==e&&(this.cache.delete(e),this.cache.set(this.h=e,i)),i};xt.prototype.remove=function(e){for(let i of this.cache){let t=i[0];i[1].includes(e)&&this.cache.delete(t)}};xt.prototype.clear=function(){this.cache.clear(),this.h=""};var na={normalize:!1,numeric:!1,dedupe:!1},vr={},Gi=new Map([["b","p"],["v","f"],["w","f"],["z","s"],["x","s"],["d","t"],["n","m"],["c","k"],["g","k"],["j","k"],["q","k"],["i","e"],["y","e"],["u","o"]]),ra=new Map([["ae","a"],["oe","o"],["sh","s"],["kh","k"],["th","t"],["ph","f"],["pf","f"]]),ia=[/([^aeo])h(.)/g,"$1$2",/([aeo])h([^aeo]|$)/g,"$1$2",/(.)\1+/g,"$1"],oa={a:"",e:"",i:"",o:"",u:"",y:"",b:1,f:1,p:1,v:1,c:2,g:2,j:2,k:2,q:2,s:2,x:2,z:2,\u00DF:2,d:3,t:3,l:4,m:5,n:5,r:6},hc={Exact:na,Default:vr,Normalize:vr,LatinBalance:{mapper:Gi},LatinAdvanced:{mapper:Gi,matcher:ra,replacer:ia},LatinExtra:{mapper:Gi,replacer:ia.concat([/(?!^)[aeo]/g,""]),matcher:ra},LatinSoundex:{dedupe:!1,include:{letter:!0},finalize:function(e){for(let t=0;t<e.length;t++){var i=e[t];let s=i.charAt(0),a=oa[s];for(let c=1,h;c<i.length&&(h=i.charAt(c),h==="h"||h==="w"||!(h=oa[h])||h===a||(s+=h,a=h,s.length!==4));c++);e[t]=s}}},CJK:{split:""},LatinExact:na,LatinDefault:vr,LatinSimple:vr};je.prototype.remove=function(e,i){let t=this.reg.size&&(this.fastupdate?this.reg.get(e):this.reg.has(e));if(t){if(this.fastupdate){for(let s=0,a;s<t.length;s++)if(a=t[s])if(2>a.length)a.pop();else{let c=a.indexOf(e);c===t.length-1?a.pop():a.splice(c,1)}}else Cn(this.map,e),this.depth&&Cn(this.ctx,e);i||this.reg.delete(e)}return this.db&&(this.commit_task.push({del:e}),this.T&&Ca(this)),this.cache&&this.cache.remove(e),this};function Cn(e,i){let t=0;var s=typeof i>"u";if(e.constructor===Array){for(let a=0,c,h;a<e.length;a++)if((c=e[a])&&c.length)if(s)t++;else if(h=c.indexOf(i),0<=h){1<c.length?(c.splice(h,1),t++):delete e[a];break}else t++}else for(let a of e.entries()){s=a[0];let c=Cn(a[1],i);c?t+=c:e.delete(s)}return t}var dc={memory:{resolution:1},performance:{resolution:3,fastupdate:!0,context:{depth:1,resolution:1}},match:{tokenize:"forward"},score:{resolution:9,context:{depth:2,resolution:3}}};je.prototype.add=function(e,i,t,s){if(i&&(e||e===0)){if(!s&&!t&&this.reg.has(e))return this.update(e,i);s=this.depth,i=this.encoder.encode(i,!s);let b=i.length;if(b){let x=he(),k=he(),P=this.resolution;for(let B=0;B<b;B++){let T=i[this.rtl?b-1-B:B];var a=T.length;if(a&&(s||!k[T])){var c=this.score?this.score(i,T,B,null,0):yr(P,b,B),h="";switch(this.tokenize){case"full":if(2<a){for(let U=0,H;U<a;U++)for(c=a;c>U;c--){h=T.substring(U,c),H=this.rtl?a-1-U:U;var m=this.score?this.score(i,T,B,h,H):yr(P,b,B,a,H);vn(this,k,h,m,e,t)}break}case"bidirectional":case"reverse":if(1<a){for(m=a-1;0<m;m--){h=T[this.rtl?a-1-m:m]+h;var v=this.score?this.score(i,T,B,h,m):yr(P,b,B,a,m);vn(this,k,h,v,e,t)}h=""}case"forward":if(1<a){for(m=0;m<a;m++)h+=T[this.rtl?a-1-m:m],vn(this,k,h,c,e,t);break}default:if(vn(this,k,T,c,e,t),s&&1<b&&B<b-1){for(a=he(),h=this.U,c=T,m=Math.min(s+1,this.rtl?B+1:b-B),a[c]=1,v=1;v<m;v++)if((T=i[this.rtl?b-1-B-v:B+v])&&!a[T]){a[T]=1;let U=this.score?this.score(i,c,B,T,v-1):yr(h+(b/2>h?0:1),b,B,m-1,v-1),H=this.bidirectional&&T>c;vn(this,x,H?c:T,U,e,t,H?T:c)}}}}}this.fastupdate||this.reg.add(e)}else i=""}return this.db&&(i||this.commit_task.push({del:e}),this.T&&Ca(this)),this};function vn(e,i,t,s,a,c,h){let m=h?e.ctx:e.map,v;if((!i[t]||h&&!(v=i[t])[h])&&(h?(i=v||(i[t]=he()),i[h]=1,(v=m.get(h))?m=v:m.set(h,m=new Map)):i[t]=1,(v=m.get(t))?m=v:m.set(t,m=v=[]),m=m[s]||(m[s]=[]),!c||!m.includes(a))){if(m.length===2**31-1){if(i=new wt(m),e.fastupdate)for(let b of e.reg.values())b.includes(m)&&(b[b.indexOf(m)]=i);v[s]=m=i}m.push(a),e.fastupdate&&((s=e.reg.get(a))?s.push(m):e.reg.set(a,[m]))}}function yr(e,i,t,s,a){return t&&1<e?i+(s||0)<=e?t+(a||0):(e-1)/(i+(s||0))*(t+(a||0))+1|0:0}je.prototype.search=function(e,i,t){t||(i||typeof e!="object"?typeof i=="object"&&(t=i,i=0):(t=e,e=""));let s=[],a,c,h,m=0,v,b,x,k,P;t?(e=t.query||e,i=t.limit||i,m=t.offset||0,c=t.context,h=t.suggest,P=(v=t.resolve!==!1)&&t.enrich,x=t.boost,k=t.resolution,b=this.db&&t.tag):v=this.resolve,c=this.depth&&c!==!1;let B=this.encoder.encode(e,!c);if(a=B.length,i=i||(v?100:0),a===1)return aa.call(this,B[0],"",i,m,v,P,b);if(a===2&&c&&!h)return aa.call(this,B[1],B[0],i,m,v,P,b);let T=he(),U=0,H;if(c&&(H=B[0],U=1),k||k===0||(k=H?this.U:this.resolution),this.db){if(this.db.search&&(e=this.db.search(this,B,i,m,h,v,P,b),e!==!1))return e;let X=this;return function(){return re(this,null,function*(){for(let J,me;U<a;U++){if((me=B[U])&&!T[me]){if(T[me]=1,J=yield $i(X,me,H,0,0,!1,!1),J=ua(J,s,h,k)){s=J;break}H&&(h&&J&&s.length||(H=me))}h&&H&&U===a-1&&!s.length&&(k=X.resolution,H="",U=-1,T=he())}return sa(s,k,i,m,h,x,v)})}()}for(let X,J;U<a;U++){if((J=B[U])&&!T[J]){if(T[J]=1,X=$i(this,J,H,0,0,!1,!1),X=ua(X,s,h,k)){s=X;break}H&&(h&&X&&s.length||(H=J))}h&&H&&U===a-1&&!s.length&&(k=this.resolution,H="",U=-1,T=he())}return sa(s,k,i,m,h,x,v)};function sa(e,i,t,s,a,c,h){let m=e.length,v=e;if(1<m)v=ga(e,i,t,s,a,c,h);else if(m===1)return h?Xi.call(null,e[0],t,s):new le(e[0]);return h?v:new le(v)}function aa(e,i,t,s,a,c,h){return e=$i(this,e,i,t,s,a,c,h),this.db?e.then(function(m){return a?m||[]:new le(m)}):e&&e.length?a?Xi.call(this,e,t,s):new le(e):a?[]:new le}function ua(e,i,t,s){let a=[];if(e&&e.length){if(e.length<=s){i.push(e);return}for(let c=0,h;c<s;c++)(h=e[c])&&(a[c]=h);if(a.length){i.push(a);return}}if(!t)return a}function $i(e,i,t,s,a,c,h,m){let v;return t&&(v=e.bidirectional&&i>t)&&(v=t,t=i,i=v),e.db?e.db.get(i,t,s,a,c,h,m):(e=t?(e=e.ctx.get(t))&&e.get(i):e.map.get(i),e)}function je(e,i){if(!this||this.constructor!==je)return new je(e);if(e){var t=ke(e)?e:e.preset;t&&(e=Object.assign({},dc[t],e))}else e={};t=e.context;let s=t===!0?{depth:1}:t||{},a=ke(e.encoder)?hc[e.encoder]:e.encode||e.encoder||{};this.encoder=a.encode?a:typeof a=="object"?new bn(a):{encode:a},this.resolution=e.resolution||9,this.tokenize=t=(t=e.tokenize)&&t!=="default"&&t!=="exact"&&t||"strict",this.depth=t==="strict"&&s.depth||0,this.bidirectional=s.bidirectional!==!1,this.fastupdate=!!e.fastupdate,this.score=e.score||null,(t=e.keystore||0)&&(this.keystore=t),this.map=t?new Ne(t):new Map,this.ctx=t?new Ne(t):new Map,this.reg=i||(this.fastupdate?t?new Ne(t):new Map:t?new Oe(t):new Set),this.U=s.resolution||3,this.rtl=a.rtl||e.rtl||!1,this.cache=(t=e.cache||null)&&new xt(t),this.resolve=e.resolve!==!1,(t=e.db)&&(this.db=this.mount(t)),this.T=e.commit!==!1,this.commit_task=[],this.commit_timer=null,this.priority=e.priority||4}z=je.prototype;z.mount=function(e){return this.commit_timer&&(clearTimeout(this.commit_timer),this.commit_timer=null),e.mount(this)};z.commit=function(e,i){return this.commit_timer&&(clearTimeout(this.commit_timer),this.commit_timer=null),this.db.commit(this,e,i)};z.destroy=function(){return this.commit_timer&&(clearTimeout(this.commit_timer),this.commit_timer=null),this.db.destroy()};function Ca(e){e.commit_timer||(e.commit_timer=setTimeout(function(){e.commit_timer=null,e.db.commit(e,void 0,void 0)},1))}z.clear=function(){return this.map.clear(),this.ctx.clear(),this.reg.clear(),this.cache&&this.cache.clear(),this.db&&(this.commit_timer&&clearTimeout(this.commit_timer),this.commit_timer=null,this.commit_task=[{clear:!0}]),this};z.append=function(e,i){return this.add(e,i,!0)};z.contain=function(e){return this.db?this.db.has(e):this.reg.has(e)};z.update=function(e,i){let t=this,s=this.remove(e);return s&&s.then?s.then(()=>t.add(e,i)):this.add(e,i)};z.cleanup=function(){return this.fastupdate?(Cn(this.map),this.depth&&Cn(this.ctx),this):this};z.searchCache=wa;z.export=function(e,i,t=0,s=0){let a,c;switch(s){case 0:a="reg",c=fa(this.reg);break;case 1:a="cfg",c=null;break;case 2:a="map",c=Qi(this.map,this.reg.size);break;case 3:a="ctx",c=la(this.ctx,this.reg.size);break;default:return}return br.call(this,e,i,a,c,t,s)};z.import=function(e,i){if(i)switch(typeof i=="string"&&(i=JSON.parse(i)),e=e.split("."),e[e.length-1]==="json"&&e.pop(),e.length===3&&e.shift(),e=1<e.length?e[1]:e[0],e){case"reg":this.fastupdate=!1,this.reg=ha(i,this.reg);break;case"map":this.map=Ji(i,this.map);break;case"ctx":this.ctx=ca(i,this.ctx)}};z.serialize=function(e=!0){let i="",t="",s="";if(this.reg.size){let c;for(var a of this.reg.keys())c||(c=typeof a),i+=(i?",":"")+(c==="string"?'"'+a+'"':a);i="index.reg=new Set(["+i+"]);",t=Zs(this.map,c),t="index.map=new Map(["+t+"]);";for(let h of this.ctx.entries()){a=h[0];let m=Zs(h[1],c);m="new Map(["+m+"])",m='["'+a+'",'+m+"]",s+=(s?",":"")+m}s="index.ctx=new Map(["+s+"]);"}return e?"function inject(index){"+i+t+s+"}":i+t+s};Yi(je.prototype);var xa=typeof window<"u"&&(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB),Cr=["map","ctx","tag","reg","cfg"],_t=he();function Wi(e,i={}){if(!this||this.constructor!==Wi)return new Wi(e,i);typeof e=="object"&&(i=e,e=e.name),e||console.info("Default storage space was used, because a name was not passed."),this.id="flexsearch"+(e?":"+e.toLowerCase().replace(/[^a-z0-9_\-]/g,""):""),this.field=i.field?i.field.toLowerCase().replace(/[^a-z0-9_\-]/g,""):"",this.type=i.type,this.fastupdate=this.support_tag_search=!1,this.db=null,this.h={}}z=Wi.prototype;z.mount=function(e){return e.index?e.mount(this):(e.db=this,this.open())};z.open=function(){if(this.db)return this.db;let e=this;navigator.storage&&navigator.storage.persist(),_t[e.id]||(_t[e.id]=[]),_t[e.id].push(e.field);let i=xa.open(e.id,1);return i.onupgradeneeded=function(){let t=e.db=this.result;for(let s=0,a;s<Cr.length;s++){a=Cr[s];for(let c=0,h;c<_t[e.id].length;c++)h=_t[e.id][c],t.objectStoreNames.contains(a+(a!=="reg"&&h?":"+h:""))||t.createObjectStore(a+(a!=="reg"&&h?":"+h:""))}},e.db=ot(i,function(t){e.db=t,e.db.onversionchange=function(){e.close()}})};z.close=function(){this.db&&this.db.close(),this.db=null};z.destroy=function(){let e=xa.deleteDatabase(this.id);return ot(e)};z.clear=function(){let e=[];for(let t=0,s;t<Cr.length;t++){s=Cr[t];for(let a=0,c;a<_t[this.id].length;a++)c=_t[this.id][a],e.push(s+(s!=="reg"&&c?":"+c:""))}let i=this.db.transaction(e,"readwrite");for(let t=0;t<e.length;t++)i.objectStore(e[t]).clear();return ot(i)};z.get=function(e,i,t=0,s=0,a=!0,c=!1){e=this.db.transaction((i?"ctx":"map")+(this.field?":"+this.field:""),"readonly").objectStore((i?"ctx":"map")+(this.field?":"+this.field:"")).get(i?i+":"+e:e);let h=this;return ot(e).then(function(m){let v=[];if(!m||!m.length)return v;if(a){if(!t&&!s&&m.length===1)return m[0];for(let b=0,x;b<m.length;b++)if((x=m[b])&&x.length){if(s>=x.length){s-=x.length;continue}let k=t?s+Math.min(x.length-s,t):x.length;for(let P=s;P<k;P++)v.push(x[P]);if(s=0,v.length===t)break}return c?h.enrich(v):v}return m})};z.tag=function(e,i=0,t=0,s=!1){e=this.db.transaction("tag"+(this.field?":"+this.field:""),"readonly").objectStore("tag"+(this.field?":"+this.field:"")).get(e);let a=this;return ot(e).then(function(c){return!c||!c.length||t>=c.length?[]:!i&&!t?c:(c=c.slice(t,t+i),s?a.enrich(c):c)})};z.enrich=function(e){typeof e!="object"&&(e=[e]);let i=this.db.transaction("reg","readonly").objectStore("reg"),t=[];for(let s=0;s<e.length;s++)t[s]=ot(i.get(e[s]));return Promise.all(t).then(function(s){for(let a=0;a<s.length;a++)s[a]={id:e[a],doc:s[a]?JSON.parse(s[a]):null};return s})};z.has=function(e){return e=this.db.transaction("reg","readonly").objectStore("reg").getKey(e),ot(e).then(function(i){return!!i})};z.search=null;z.info=function(){};z.transaction=function(e,i,t){e+=e!=="reg"&&this.field?":"+this.field:"";let s=this.h[e+":"+i];if(s)return t.call(this,s);let a=this.db.transaction(e,i);this.h[e+":"+i]=s=a.objectStore(e);let c=t.call(this,s);return this.h[e+":"+i]=null,ot(a).finally(function(){return a=s=null,c})};z.commit=function(e,i,t){return re(this,null,function*(){if(i)yield this.clear(),e.commit_task=[];else{let s=e.commit_task;e.commit_task=[];for(let a=0,c;a<s.length;a++)if(c=s[a],c.clear){yield this.clear(),i=!0;break}else s[a]=c.del;i||(t||(s=s.concat(ql(e.reg))),s.length&&(yield this.remove(s)))}e.reg.size&&(yield this.transaction("map","readwrite",function(s){for(let a of e.map){let c=a[0],h=a[1];h.length&&(i?s.put(h,c):s.get(c).onsuccess=function(){let m=this.result;var v;if(m&&m.length){let b=Math.max(m.length,h.length);for(let x=0,k,P;x<b;x++)if((P=h[x])&&P.length){if((k=m[x])&&k.length)for(v=0;v<P.length;v++)k.push(P[v]);else m[x]=P;v=1}}else m=h,v=1;v&&s.put(m,c)})}}),yield this.transaction("ctx","readwrite",function(s){for(let a of e.ctx){let c=a[0],h=a[1];for(let m of h){let v=m[0],b=m[1];b.length&&(i?s.put(b,c+":"+v):s.get(c+":"+v).onsuccess=function(){let x=this.result;var k;if(x&&x.length){let P=Math.max(x.length,b.length);for(let B=0,T,U;B<P;B++)if((U=b[B])&&U.length){if((T=x[B])&&T.length)for(k=0;k<U.length;k++)T.push(U[k]);else x[B]=U;k=1}}else x=b,k=1;k&&s.put(x,c+":"+v)})}}}),e.store?yield this.transaction("reg","readwrite",function(s){for(let a of e.store){let c=a[0],h=a[1];s.put(typeof h=="object"?JSON.stringify(h):1,c)}}):e.bypass||(yield this.transaction("reg","readwrite",function(s){for(let a of e.reg.keys())s.put(1,a)})),e.tag&&(yield this.transaction("tag","readwrite",function(s){for(let a of e.tag){let c=a[0],h=a[1];h.length&&(s.get(c).onsuccess=function(){let m=this.result;m=m&&m.length?m.concat(h):h,s.put(m,c)})}})),e.map.clear(),e.ctx.clear(),e.tag&&e.tag.clear(),e.store&&e.store.clear(),e.document||e.reg.clear())})};function Ui(e,i,t){let s=e.value,a,c=0;for(let h=0,m;h<s.length;h++){if(m=t?s:s[h]){for(let v=0,b,x;v<i.length;v++)if(x=i[v],b=m.indexOf(x),0<=b)if(a=1,1<m.length)m.splice(b,1);else{s[h]=[];break}c+=m.length}if(t)break}c?a&&e.update(s):e.delete(),e.continue()}z.remove=function(e){return typeof e!="object"&&(e=[e]),Promise.all([this.transaction("map","readwrite",function(i){i.openCursor().onsuccess=function(){let t=this.result;t&&Ui(t,e)}}),this.transaction("ctx","readwrite",function(i){i.openCursor().onsuccess=function(){let t=this.result;t&&Ui(t,e)}}),this.transaction("tag","readwrite",function(i){i.openCursor().onsuccess=function(){let t=this.result;t&&Ui(t,e,!0)}}),this.transaction("reg","readwrite",function(i){for(let t=0;t<e.length;t++)i.delete(e[t])})])};function ot(e,i){return new Promise((t,s)=>{e.onsuccess=e.oncomplete=function(){i&&i(this.result),i=null,t(this.result)},e.onerror=e.onblocked=s,e=null})}var Da=Ct;var Dr=class e{constructor(){}indices={};initIndex(i,t,s){return re(this,null,function*(){this.indices[t]=this.createIndex(s),console.log("Index created:",t,this.indices[t])})}search(i,t){return re(this,null,function*(){let s=this.indices[i];if(s){console.log("Searching in index:",i,s,t);let a=yield s.searchAsync(t,{limit:10,enrich:!0});return console.log("Search results:",a),a}return[]})}getIndex(i){return this.indices[i]}addToIndex(i,t){return re(this,null,function*(){let s=this.indices[i];s&&s.add(t)})}importIndex(i,t){return re(this,null,function*(){try{let s=this.indices[i],a=JSON.parse(t);if(console.log("Parsed index data:",a),s&&a)for(let c of a)console.log("Importing index for table:",i,{chunk:c}),yield s.import(c.key,c.data),console.log("Index imported successfully for table:",s)}catch(s){throw new Error(`Error importing index for table ${i}: ${s}`)}})}exportIndex(i){return re(this,null,function*(){let t=this.indices[i];if(!t)throw new Error(`No index found for table ${i}`);let s=[];return yield t.export((a,c)=>{s.push({key:a.toString(),data:c})}),JSON.stringify(s)})}removeFromIndex(i,t){return re(this,null,function*(){let s=this.indices[i];s&&s.remove(t)})}clearIndex(i){return re(this,null,function*(){this.indices[i]=this.createIndex(["name"])})}createIndex(i){return new Da({tokenize:"forward",cache:!0,document:{id:"uuid",index:i}})}static \u0275fac=function(t){return new(t||e)};static \u0275prov=nn({token:e,factory:e.\u0275fac,providedIn:"root"})};var Ea=class e extends Qs{constructor(t){super("lasagna-db");this.flexsearchIndexService=t;let s=new Set;for(let a of Js){if(s.has(a.version))throw new Error(`Duplicate migration version: ${a.version}`);s.add(a.version);let c=this.version(a.version).stores(a.schema);a.update&&c.upgrade(a.update),console.log(`Migration ${a.version} applied`)}setTimeout(()=>{this.initIndexes()})}productsStore;recipesStore;categoryStore;initIndexes(){return Promise.all([this.initIndex("productsStore"),this.initIndex("recipesStore"),this.initIndex("categoryProductsStore"),this.initIndex("categoryRecipesStore")]).then(()=>{})}initIndex(t){return re(this,null,function*(){yield this.flexsearchIndexService.initIndex(this.getStore(t),t,["name"]);let s=yield this.getOne("indicesStore",t);s?(console.log("Index loaded:",t,s),yield this.flexsearchIndexService.importIndex(t,s.indexData)):(console.log("No index found for table:",t),yield this.getAll(t).then(a=>re(this,null,function*(){for(let c of a)yield this.flexsearchIndexService.addToIndex(t,c);console.log("Index created for table:",t)})),yield this.saveIndex(t))})}saveIndex(t){return re(this,null,function*(){try{if(this.flexsearchIndexService.getIndex(t)){let a=yield this.flexsearchIndexService.exportIndex(t);yield this.replaceData("indicesStore",t,{table:t,indexData:a})}else{console.error("No index data found for table:",t);return}}catch(s){throw console.error("Error saving index:",s),s}})}loadIndex(t){return re(this,null,function*(){let s=yield this.filter("indicesStore","table",t,!0);return console.log("Index data:",s),s?.[0]?s[0].indexData:null})}addData(t,s,a){return re(this,null,function*(){try{let c=a||this.generateUuid(),h=De(be({},s),{uuid:c});return yield this[t].put(h),t==="indicesStore"||(yield this.flexsearchIndexService.addToIndex(t,h),yield this.saveIndex(t)),c}catch(c){throw c}})}replaceData(t,s,a){return re(this,null,function*(){let c=De(be({},a),{uuid:s});yield this[t].put(c),t!=="indicesStore"&&(yield this.flexsearchIndexService.addToIndex(t,c),yield this.saveIndex(t))})}search(t,s,a){return re(this,null,function*(){return this[t].where(s).equals(a).toArray()})}filter(t,s,a,c=!1){return re(this,null,function*(){return this[t].filter(h=>c?h[s]===a:h[s]?.toLowerCase().includes(a.toLowerCase())).toArray()})}getStore(t){return this[t]}getOne(t,s){return re(this,null,function*(){return this[t].get(s)})}getAll(t){return re(this,null,function*(){return this[t].toArray()})}getMany(t,s){return re(this,null,function*(){return this[t].where("uuid").anyOf(s).toArray()})}remove(t,s){return re(this,null,function*(){yield this[t].delete(s),t!=="indicesStore"&&(yield this.flexsearchIndexService.removeFromIndex(t,s),yield this.saveIndex(t))})}clear(t){return re(this,null,function*(){yield this[t].clear(),yield this.flexsearchIndexService.clearIndex(t),yield this.saveIndex(t)})}generateUuid(){return hs()}balkAdd(t,s,a=!0){return re(this,null,function*(){yield this[t].bulkPut(s.map(c=>De(be({},c),{uuid:a?this.generateUuid():c.uuid})))})}uniqueKeys(t,s){return re(this,null,function*(){return this[t].orderBy(s).uniqueKeys()})}static \u0275fac=function(s){return new(s||e)(Ho(Dr))};static \u0275prov=nn({token:e,factory:e.\u0275fac,providedIn:"root"})};export{Ei as a,ef as b,ol as c,sl as d,hs as e,Dr as f,Ea as g,ds as h,dn as i,gl as j,ps as k,He as l,$c as m,Wc as n,ys as o,Gs as p,zl as q,Qc as r,$l as s,Us as t,Ls as u,zs as v,Xl as w,Cs as x,Jc as y,Xc as z};
