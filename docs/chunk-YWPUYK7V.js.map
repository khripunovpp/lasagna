{
  "version": 3,
  "sources": ["src/app/shared/service/tokens/demo-mode.token.ts", "src/app/shared/service/services/demo.service.ts"],
  "sourcesContent": ["import {InjectionToken} from '@angular/core';\n\nexport const DEMO_MODE = new InjectionToken('DEMO_MODE');\n", "import {inject, Injectable} from '@angular/core';\nimport {HttpClient} from '@angular/common/http';\nimport {DexieIndexDbService} from '../db/dexie-index-db.service';\nimport {DEMO_MODE} from '../tokens/demo-mode.token';\nimport {firstValueFrom} from 'rxjs';\nimport {WINDOW} from '../tokens/window.token';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class DemoService {\n  constructor(\n    private _http: HttpClient,\n    private _dbService: DexieIndexDbService,\n  ) {\n  }\n\n  isDemo = inject(DEMO_MODE);\n  private readonly _window = inject(WINDOW);\n\n  async loadDemoData() {\n    try {\n      if (!this.isDemo) {\n        return;\n      }\n      if (this._window?.localStorage.getItem('demo_data_loaded') === 'true') {\n        console.log('Demo data already loaded');\n        return;\n      }\n      const dump = await firstValueFrom(this._http.get<any>('./dump/demo_dump.json'));\n      await this._dbService.restoreAllData(dump);\n      this._window?.localStorage.setItem('demo_data_loaded', 'true');\n      console.log({dump})\n    } catch (error) {\n      console.error('Error loading demo data:', error);\n      throw new Error('Failed to load demo data');\n    }\n  }\n\n  switchOnDemoMode() {\n    try {\n      if (!this._window) {\n        throw new Error('Window is not available');\n      }\n      this._window.localStorage.setItem('demo', 'true');\n      const url = new URL(this._window.location.href);\n      url.searchParams.delete('demo');\n      this._window.history.replaceState({}, '', url.toString());\n      this._window?.location.reload();\n    } catch (e) {\n      console.error('Error switching to demo mode:', e);\n    }\n  }\n\n  switchOffDemoMode() {\n    try {\n      this._window?.localStorage.removeItem('demo');\n      this._window?.location.reload();\n    } catch (e) {\n      console.error('Error switching off demo mode:', e);\n    }\n  }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;AAEO,IAAM,YAAY,IAAI,eAAe,WAAW;;;ACQjD,IAAO,cAAP,MAAO,aAAW;EAEZ;EACA;EAFV,YACU,OACA,YAA+B;AAD/B,SAAA,QAAA;AACA,SAAA,aAAA;EAEV;EAEA,SAAS,OAAO,SAAS;EACR,UAAU,OAAO,MAAM;EAExC,MAAM,eAAY;AAChB,QAAI;AACF,UAAI,CAAC,KAAK,QAAQ;AAChB;MACF;AACA,UAAI,KAAK,SAAS,aAAa,QAAQ,kBAAkB,MAAM,QAAQ;AACrE,gBAAQ,IAAI,0BAA0B;AACtC;MACF;AACA,YAAM,OAAO,MAAM,eAAe,KAAK,MAAM,IAAS,uBAAuB,CAAC;AAC9E,YAAM,KAAK,WAAW,eAAe,IAAI;AACzC,WAAK,SAAS,aAAa,QAAQ,oBAAoB,MAAM;AAC7D,cAAQ,IAAI,EAAC,KAAI,CAAC;IACpB,SAAS,OAAO;AACd,cAAQ,MAAM,4BAA4B,KAAK;AAC/C,YAAM,IAAI,MAAM,0BAA0B;IAC5C;EACF;EAEA,mBAAgB;AACd,QAAI;AACF,UAAI,CAAC,KAAK,SAAS;AACjB,cAAM,IAAI,MAAM,yBAAyB;MAC3C;AACA,WAAK,QAAQ,aAAa,QAAQ,QAAQ,MAAM;AAChD,YAAM,MAAM,IAAI,IAAI,KAAK,QAAQ,SAAS,IAAI;AAC9C,UAAI,aAAa,OAAO,MAAM;AAC9B,WAAK,QAAQ,QAAQ,aAAa,CAAA,GAAI,IAAI,IAAI,SAAQ,CAAE;AACxD,WAAK,SAAS,SAAS,OAAM;IAC/B,SAAS,GAAG;AACV,cAAQ,MAAM,iCAAiC,CAAC;IAClD;EACF;EAEA,oBAAiB;AACf,QAAI;AACF,WAAK,SAAS,aAAa,WAAW,MAAM;AAC5C,WAAK,SAAS,SAAS,OAAM;IAC/B,SAAS,GAAG;AACV,cAAQ,MAAM,kCAAkC,CAAC;IACnD;EACF;;qCAnDW,cAAW,mBAAA,UAAA,GAAA,mBAAA,mBAAA,CAAA;EAAA;4EAAX,cAAW,SAAX,aAAW,WAAA,YAFV,OAAM,CAAA;;;sEAEP,aAAW,CAAA;UAHvB;WAAW;MACV,YAAY;KACb;;;",
  "names": []
}
