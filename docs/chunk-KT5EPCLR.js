import{a as Ce}from"./chunk-RJHHRVZJ.js";import{a as ce,b as O,d as me,e as ge}from"./chunk-KX3GOSXV.js";import{a as ue}from"./chunk-7XWQXZLV.js";import{a as pe,b as de}from"./chunk-O2GJCXTB.js";import{c as fe}from"./chunk-LINTSV2P.js";import{b as I}from"./chunk-CVO47RCB.js";import{a as ae,b as le}from"./chunk-EZ5XDXUH.js";import{a as X,c as P,e as Z,f as ee,g as te,h as v,j as oe,k as ne,n as ie,q as re}from"./chunk-H4D7ZLOP.js";import{a as se}from"./chunk-GQAWBXZL.js";import"./chunk-7BACYQJQ.js";import{a as F,d as R}from"./chunk-4K3JQH4K.js";import{a as K,b as Q}from"./chunk-UW5WEH6W.js";import{$a as c,Ca as b,Da as w,Fa as L,Ga as $,Ha as z,Ia as a,Ja as i,Ka as p,L as G,Oa as C,Pa as u,Qa as d,U as m,V as g,Wb as J,Yb as Y,Z as h,_a as S,ac as H,bb as V,gb as A,ia as r,la as y,na as f,tb as q,va as j,wa as s,wb as U,xb as E,ya as x,za as B}from"./chunk-P3KTPPMX.js";function he(o,e){if(o&1){let t=C();a(0,"div",3)(1,"lg-eggs-widget",4),u("changed",function(l){m(t);let _=d();return g(_.onEggsChanged(l))}),i()()}}var M=class o{constructor(){}eggsChanged=U();selectedWidget=h(null);onWidgetSelect(e){this.selectedWidget.set(e)}onEggsChanged(e){e&&this.eggsChanged.emit(e)}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=f({type:o,selectors:[["lg-amount-widgets"]],outputs:{eggsChanged:"eggsChanged"},decls:5,vars:3,consts:[[1,"amount-widgets"],[1,"amount-widgets__buttons"],[1,"amount-widgets__button",3,"click"],[1,"amount-widgets__wrapper"],[3,"changed"]],template:function(t,n){t&1&&(a(0,"div",0)(1,"div",1)(2,"button",2),u("click",function(){return n.onWidgetSelect("eggs")}),c(3,"Eggs "),i()(),b(4,he,2,0,"div",3),i()),t&2&&(x("selected",n.selectedWidget()!=null),r(4),w(n.selectedWidget()==="eggs"?4:-1))},dependencies:[Ce],styles:[".amount-widgets[_ngcontent-%COMP%]{display:flex;gap:16px;flex-direction:column}.amount-widgets__input[_ngcontent-%COMP%]{flex:1}.amount-widgets__buttons[_ngcontent-%COMP%]{display:flex;gap:16px;flex-wrap:wrap;padding:16px;background-color:#fafafa;border-radius:12px;margin:-16px}.amount-widgets.selected[_ngcontent-%COMP%]   .amount-widgets__buttons[_ngcontent-%COMP%]{margin-bottom:0}.amount-widgets__button[_ngcontent-%COMP%]{display:flex;padding:8px 16px;border-radius:16px;background-color:#e5de38;appearance:none;border:none;font-family:inherit;font-size:inherit}"]})};function ve(o,e){if(o&1){let t=C();a(0,"span",2),u("click",function(){let l=m(t).$implicit,_=d();return g(_.onSelect(l))}),c(1),i()}if(o&2){let t=e.$implicit,n=e.$index,l=e.$count,_=d();x("selected",t.value===_.value),j("data-last",n===l-1?!0:null),r(),V(" ",t.label," ")}}var T=class o{constructor(){}control=E();items=[];onChangeFn;value;selectedItem;onSelect=e=>{this.applyValue(e.value)};registerOnChange(e){this.onChangeFn=e}registerOnTouched(e){}writeValue(e){this.applyValue(e)}applyValue(e){this.value=e,this.onChangeFn?.(e),this.control()?.writeValue(e)}ngOnInit(){}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=f({type:o,selectors:[["lg-chips-list"]],inputs:{control:[1,"control"],items:"items"},features:[A([{provide:X,useExisting:G(()=>o),multi:!0}])],decls:3,vars:0,consts:[[1,"chips-list"],[1,"chip",3,"selected"],[1,"chip",3,"click"]],template:function(t,n){t&1&&(a(0,"div",0),$(1,ve,2,4,"span",1,L),i()),t&2&&(r(),z(n.items))},styles:[".chips-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.chip[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;padding:4px 8px;border-radius:16px;font-size:.875rem;display:inline-block;cursor:pointer}.chip.selected[_ngcontent-%COMP%]{background-color:#0d59ab}"]})};function be(o,e){if(o&1&&p(0,"lg-chips-list",17),o&2){let t=d(),n=S(19);s("control",n)("items",t.topSources())}}function we(o,e){if(o&1&&p(0,"lg-chips-list",17),o&2){let t=d(),n=S(24);s("control",n)("items",t.topCategories())}}function Pe(o,e){if(o&1){let t=C();a(0,"lg-button",20),u("click",function(){m(t);let l=d();return g(l.editProduct(l.value))}),c(1," Edit Product "),i()}}function xe(o,e){if(o&1){let t=C();a(0,"lg-button",20),u("click",function(){m(t);let l=d();return g(l.addProduct(l.value))}),c(1," Add Product "),i()}}var k=class o{constructor(e,t,n){this._productsRepository=e;this._selectResourcesService=t;this._router=n}form=new te({name:new v("",P.required),amount:new v(null,P.required),price:new v(null,P.required),unit:new v("gram"),source:new v(""),category_id:new v(null,P.required)});buttons=[{label:"Grams",value:"gram",style:"secondary",onClick:()=>{console.log("Grams")}},{label:"Pieces",value:"piece",style:"secondary",onClick:()=>{console.log("Piece")}}];uuid=E("");topCategories=h([]);topSources=h([]);uuidEffect=q(()=>{this.uuid()&&this._productsRepository.getOne(this.uuid()).then(e=>{this.form.reset(e)})});get value(){return this.form.value}eggsChanged(e){this.form.patchValue({amount:e})}ngOnInit(){this.form.valueChanges.subscribe(e=>{console.log(e)}),this._productsRepository.getTopCategories().then(e=>{this.topCategories.set(e.map(t=>({label:t.name,value:t.uuid})))}),this._productsRepository.getTopSources().then(e=>{this.topSources.set(e.map(t=>({label:t,value:t})))})}addProduct(e){this._productsRepository.addProduct(O(e)).then(()=>{this._router.navigate(["/products"])})}editProduct(e){this._productsRepository.editProduct(this.uuid(),O(e)).then(()=>{this._router.navigate(["/products"])})}ngAfterViewInit(){this._selectResourcesService.load().then(e=>{})}static \u0275fac=function(t){return new(t||o)(y(fe),y(I),y(Y))};static \u0275cmp=f({type:o,selectors:[["lg-add-product-form"]],inputs:{uuid:[1,"uuid"]},features:[A([{provide:I,useClass:I}])],decls:28,vars:12,consts:[["priceInput",""],["sourceInput",""],["categorySelect",""],[3,"formGroup"],["label","Name"],["formControlName","name",3,"placeholder"],[3,"bottom","mobileMode"],["label","Amount","lgExpand",""],["formControlName","amount","lgParseMath","",3,"onInputChange","placeholder"],["ngProjectAs","after",5,["after"]],["ngProjectAs","content",5,["content"]],[3,"eggsChanged"],["formControlName","unit",3,"items"],["label","Price"],["formControlName","price","lgParseMath","",3,"placeholder"],["label","Source"],["formControlName","source",3,"placeholder"],[3,"control","items"],["label","Category"],["formControlName","category_id",3,"resource"],[3,"click"]],template:function(t,n){if(t&1){let l=C();a(0,"form",3)(1,"lg-gap-column")(2,"lg-control",4),p(3,"lg-input",5),i(),a(4,"lg-gap-row",6)(5,"lg-control",7)(6,"lg-number-input",8),u("onInputChange",function(){m(l);let N=S(15);return g(N.focus())}),a(7,"div",9)(8,"lg-tooltip"),c(9," Widgets "),a(10,"div",10)(11,"lg-amount-widgets",11),u("eggsChanged",function(N){return m(l),g(n.eggsChanged(N))}),i()()()()()(),p(12,"lg-buttons-group",12),i(),a(13,"lg-control",13),p(14,"lg-number-input",14,0),i(),a(16,"lg-gap-column")(17,"lg-control",15),p(18,"lg-input",16,1),i(),b(20,be,1,2,"lg-chips-list",17),i(),a(21,"lg-gap-column")(22,"lg-control",18),p(23,"lg-multiselect",19,2),i(),b(25,we,1,2,"lg-chips-list",17),i(),b(26,Pe,2,0,"lg-button")(27,xe,2,0,"lg-button"),i()()}t&2&&(s("formGroup",n.form),r(3),s("placeholder","Your product name"),r(),s("bottom",!0)("mobileMode",!0),r(2),s("placeholder","In "+n.form.value.unit),r(6),s("items",n.buttons),r(2),s("placeholder","For the entire product in your currency"),r(4),s("placeholder","Where do you buy it?"),r(2),w(n.topSources().length?20:-1),r(3),s("resource","categories"),r(2),w(n.topCategories().length?25:-1),r(),w(n.uuid()?26:27))},dependencies:[re,oe,Z,ee,ne,ie,ae,le,se,F,ce,pe,ge,M,de,R,me,ue,T],styles:[`lg-eggs-widget{min-width:300px}
`],encapsulation:2})};var _e=class o{constructor(e){this._aRoute=e}uuid=h("");ngOnInit(){this._aRoute.params.subscribe(e=>{this.uuid.set(e.uuid)})}static \u0275fac=function(t){return new(t||o)(y(J))};static \u0275cmp=f({type:o,selectors:[["app-add-recipe"]],decls:8,vars:8,consts:[[3,"center"],[3,"flat","link","size"],[3,"uuid"]],template:function(t,n){t&1&&(a(0,"lg-container")(1,"lg-gap-row",0)(2,"lg-title"),c(3),i(),a(4,"lg-button",1),c(5," Back to list "),i()(),a(6,"lg-card"),p(7,"lg-add-product-form",2),i()()),t&2&&(r(),s("center",!0),r(2),V("",n.uuid()?"Edit":"Add"," Product"),r(),B("warning"),s("flat",!0)("link","/products")("size","small"),r(3),s("uuid",n.uuid()))},dependencies:[H,K,Q,k,F,R],encapsulation:2})};export{_e as AddProductComponent};
