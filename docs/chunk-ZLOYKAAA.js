import{a as Oe}from"./chunk-LHZCRIB5.js";import{a as K,c as Re}from"./chunk-QRS76EMV.js";import{a as Ae}from"./chunk-T6K3LUN6.js";import{a as Se}from"./chunk-6QHNBYN5.js";import{a as Ve,b as Ie}from"./chunk-PBY37YKW.js";import{c as ue}from"./chunk-6O2QYWSA.js";import{a as F}from"./chunk-QNQJNRNH.js";import{a as Ee,b as Te}from"./chunk-ZYT64JFR.js";import"./chunk-RYPD5HVN.js";import{a as _e,c as S,e as he,f as ye,g as ve,h as E,j as we,k as be,n as Pe,q as xe}from"./chunk-FMSTASSM.js";import{a as Me}from"./chunk-GKQZ6TBK.js";import{c as k}from"./chunk-TQTLV33A.js";import{a as D}from"./chunk-2NSFWKSX.js";import{a as fe,b as Ce}from"./chunk-HMFW6PL3.js";import{$a as g,Ca as v,Da as w,Fa as oe,Ga as ne,Ha as ie,Ia as l,Ib as ce,Ja as i,Ka as m,L as U,Oa as b,Pa as c,Qa as u,Ra as re,Sa as Y,U as C,V as _,Wb as de,Ya as le,Yb as me,Z as f,Za as se,_a as M,ac as ge,ba as X,bb as I,gb as R,ha as $,ia as r,ka as Z,la as h,na as d,tb as ae,va as ee,wa as a,wb as O,xa as q,xb as P,ya as T,yb as pe,za as te}from"./chunk-EBX4ADAM.js";var N=class n{constructor(e,t){this.renderer=e;this._elementRef=t}targetElement;appendTarget="";wrapClass="";portalContainer;get _appendTarget(){return this.appendTarget?this.appendTarget==="body"?document.body:this.appendTarget:this._elementRef.nativeElement}ngAfterViewInit(){this.portalContainer=this.renderer.createElement("div"),this.renderer.appendChild(this._appendTarget,this.portalContainer),this.targetElement&&(this.wrapClass&&this.wrapClass.split(" ").forEach(t=>this.renderer.addClass(this.portalContainer,t)),this.renderer.appendChild(this.portalContainer,this.targetElement))}ngOnDestroy(){this.targetElement&&this.renderer.removeChild(this.portalContainer,this.targetElement),this.renderer.removeChild(this._appendTarget,this.portalContainer)}static \u0275fac=function(t){return new(t||n)(h(Z),h(X))};static \u0275cmp=d({type:n,selectors:[["lg-portal"]],inputs:{targetElement:"targetElement",appendTarget:"appendTarget",wrapClass:"wrapClass"},decls:0,vars:0,template:function(t,o){},styles:["[_nghost-%COMP%]{display:flex;height:100%;width:100%}"]})};var Fe=["element"],De=["*",[["content"]]],Ne=["*","content"];function We(n,e){if(n&1&&(l(0,"div",4,0),Y(2,1),i(),m(3,"lg-portal",5)),n&2){let t=M(1),o=u();q("left",o.coordinates().x,"px")("top",o.coordinates().y,"px"),r(3),a("appendTarget","body")("targetElement",t)("wrapClass","tooltip")}}var W=class n{constructor(){}gap=P(16);displayed=f(!1);full=P(!1);position=P("top");element=pe("element");onClose=O();coordinates=f({x:0,y:0});toggle(e){if(this.displayed.set(!this.displayed()),this.displayed()||this.onClose.emit(),e){e.stopPropagation();let[t,o]=[e.clientX,e.clientY];setTimeout(()=>{let p=(this.element()?.nativeElement).getBoundingClientRect(),x=p.width,H=p.height,Q=window.innerWidth,J=window.innerHeight,y=16,L=t,z=o;t+x+y>Q&&(L=Q-x-y),o+H+y>J&&(z=J-H-y),t-x-y<0&&(L=y),o-H-y<0&&(z=y),this.coordinates.set({x:L,y:z})})}}close(){this.displayed.set(!1),this.onClose.emit()}onClick(e){e.target instanceof HTMLElement&&(e.target.closest(".tooltip")||(this.displayed.set(!1),this.onClose.emit()))}onKeydown(e){e.key==="Escape"&&(this.displayed.set(!1),this.onClose.emit())}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=d({type:n,selectors:[["lg-tooltip"]],viewQuery:function(t,o){t&1&&le(o.element,Fe,5),t&2&&se()},hostBindings:function(t,o){t&1&&c("click",function(p){return o.onClick(p)},$)("keydown",function(p){return o.onKeydown(p)},$)},inputs:{gap:[1,"gap"],full:[1,"full"],position:[1,"position"]},outputs:{onClose:"onClose"},ngContentSelectors:Ne,decls:5,vars:6,consts:[["element",""],[1,"tooltip",3,"ngClass"],[1,"tooltip__anchor"],[3,"click"],[1,"tooltip__content"],[3,"appendTarget","targetElement","wrapClass"]],template:function(t,o){t&1&&(re(De),l(0,"div",1)(1,"div",2)(2,"div",3),c("click",function(p){return o.toggle(p)}),Y(3),i(),v(4,We,4,7),i()()),t&2&&(q("--gap",o.gap(),"px"),T("fullscreen",o.full()),a("ngClass",o.position()),r(4),w(o.displayed()?4:-1))},dependencies:[ce,N],styles:[".tooltip[_ngcontent-%COMP%]{position:relative;display:inline-block}.tooltip__anchor[_ngcontent-%COMP%]{position:relative}.tooltip__content[_ngcontent-%COMP%]{position:absolute;background-color:#fff;border-radius:16px;padding:16px;box-shadow:0 4px 8px #0000001a;z-index:100}.tooltip.top[_ngcontent-%COMP%]   .tooltip__content[_ngcontent-%COMP%], .tooltip.bottom[_ngcontent-%COMP%]   .tooltip__content[_ngcontent-%COMP%]{bottom:calc(100% + var(--gap));right:50%;transform:translate(50%)}.tooltip.left[_ngcontent-%COMP%]   .tooltip__content[_ngcontent-%COMP%]{bottom:50%;right:calc(100% + var(--gap));transform:translateY(50%)}.tooltip.right[_ngcontent-%COMP%]   .tooltip__content[_ngcontent-%COMP%]{bottom:50%;left:calc(100% + var(--gap));transform:translateY(-50%)}.tooltip.fullscreen[_ngcontent-%COMP%]   .tooltip__content[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#fff;border-radius:0;padding:32px;transform:none;overflow-y:auto}"]})};function Ge(n,e){if(n&1){let t=b();l(0,"div",3)(1,"lg-eggs-widget",4),c("changed",function(s){C(t);let p=u();return _(p.onEggsChanged(s))}),i()()}}var G=class n{constructor(){}eggsChanged=O();selectedWidget=f(null);onWidgetSelect(e){this.selectedWidget.set(e)}onEggsChanged(e){e&&this.eggsChanged.emit(e)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=d({type:n,selectors:[["lg-amount-widgets"]],outputs:{eggsChanged:"eggsChanged"},decls:5,vars:3,consts:[[1,"amount-widgets"],[1,"amount-widgets__buttons"],[1,"amount-widgets__button",3,"click"],[1,"amount-widgets__wrapper"],[3,"changed"]],template:function(t,o){t&1&&(l(0,"div",0)(1,"div",1)(2,"button",2),c("click",function(){return o.onWidgetSelect("eggs")}),g(3,"Eggs "),i()(),v(4,Ge,2,0,"div",3),i()),t&2&&(T("selected",o.selectedWidget()!=null),r(4),w(o.selectedWidget()==="eggs"?4:-1))},dependencies:[Oe],styles:[".amount-widgets[_ngcontent-%COMP%]{display:flex;gap:16px;flex-direction:column}.amount-widgets__input[_ngcontent-%COMP%]{flex:1}.amount-widgets__buttons[_ngcontent-%COMP%]{display:flex;gap:16px;flex-wrap:wrap;padding:16px;background-color:#fafafa;border-radius:12px;margin:-16px}.amount-widgets.selected[_ngcontent-%COMP%]   .amount-widgets__buttons[_ngcontent-%COMP%]{margin-bottom:0}.amount-widgets__button[_ngcontent-%COMP%]{display:flex;padding:8px 16px;border-radius:16px;background-color:#e5de38;appearance:none;border:none;font-family:inherit;font-size:inherit}"]})};function je(n,e){if(n&1){let t=b();l(0,"span",2),c("click",function(){let s=C(t).$implicit,p=u();return _(p.onSelect(s))}),g(1),i()}if(n&2){let t=e.$implicit,o=e.$index,s=e.$count,p=u();T("selected",t.value===p.value),ee("data-last",o===s-1?!0:null),r(),I(" ",t.label," ")}}var j=class n{constructor(){}control=P();items=[];onChangeFn;value;selectedItem;onSelect=e=>{this.applyValue(e.value)};registerOnChange(e){this.onChangeFn=e}registerOnTouched(e){}writeValue(e){this.applyValue(e)}applyValue(e){this.value=e,this.onChangeFn?.(e),this.control()?.writeValue(e)}ngOnInit(){}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=d({type:n,selectors:[["lg-chips-list"]],inputs:{control:[1,"control"],items:"items"},features:[R([{provide:_e,useExisting:U(()=>n),multi:!0}])],decls:3,vars:0,consts:[[1,"chips-list"],[1,"chip",3,"selected"],[1,"chip",3,"click"]],template:function(t,o){t&1&&(l(0,"div",0),ne(1,je,2,4,"span",1,oe),i()),t&2&&(r(),ie(o.items))},styles:[".chips-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.chip[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;padding:4px 8px;border-radius:16px;font-size:.875rem;display:inline-block;cursor:pointer}.chip.selected[_ngcontent-%COMP%]{background-color:#0d59ab}"]})};function He(n,e){if(n&1&&m(0,"lg-chips-list",18),n&2){let t=u(),o=M(19);a("control",o)("items",t.topSources())}}function Le(n,e){if(n&1&&m(0,"lg-chips-list",18),n&2){let t=u(),o=M(24);a("control",o)("items",t.topCategories())}}function ze(n,e){if(n&1){let t=b();l(0,"lg-button",21),c("click",function(){C(t);let s=u();return _(s.editProduct(s.value))}),g(1," Edit Product "),i()}}function $e(n,e){if(n&1){let t=b();l(0,"lg-button",21),c("click",function(){C(t);let s=u();return _(s.addProduct(s.value))}),g(1," Add Product "),i()}}var B=class n{constructor(e,t,o){this._productsRepository=e;this._selectResourcesService=t;this._router=o}form=new ve({name:new E("",S.required),amount:new E(null,S.required),price:new E(null,S.required),unit:new E("gram"),source:new E(""),category_id:new E(null,S.required)});buttons=[{label:"Grams",value:"gram",style:"secondary",onClick:()=>{console.log("Grams")}},{label:"Pieces",value:"piece",style:"secondary",onClick:()=>{console.log("Piece")}}];uuid=P("");topCategories=f([]);topSources=f([]);uuidEffect=ae(()=>{this.uuid()&&this._productsRepository.getOne(this.uuid()).then(e=>{this.form.reset(e)})});get value(){return this.form.value}eggsChanged(e){this.form.patchValue({amount:e})}ngOnInit(){this.form.valueChanges.subscribe(e=>{console.log(e)}),this._productsRepository.getTopCategories().then(e=>{this.topCategories.set(e.map(t=>({label:t.name,value:t.uuid})))}),this._productsRepository.getTopSources().then(e=>{this.topSources.set(e.map(t=>({label:t,value:t})))})}addProduct(e){this._productsRepository.addProduct(K(e)).then(()=>{this._router.navigate(["/products"])})}editProduct(e){this._productsRepository.editProduct(this.uuid(),K(e)).then(()=>{this._router.navigate(["/products"])})}ngAfterViewInit(){this._selectResourcesService.load().then(e=>{})}static \u0275fac=function(t){return new(t||n)(h(ue),h(F),h(me))};static \u0275cmp=d({type:n,selectors:[["lg-add-product-form"]],inputs:{uuid:[1,"uuid"]},features:[R([{provide:F,useClass:F}])],decls:28,vars:13,consts:[["priceInput",""],["sourceInput",""],["categorySelect",""],[3,"formGroup"],["label","Name"],["formControlName","name",3,"placeholder"],[3,"bottom","mobileMode"],["label","Amount","lgExpand",""],["formControlName","amount","lgParseMath","",3,"onInputChange","placeholder"],["ngProjectAs","after",5,["after"]],[3,"position"],["ngProjectAs","content",5,["content"]],[3,"eggsChanged"],["formControlName","unit",3,"items"],["label","Price"],["formControlName","price","lgParseMath","",3,"placeholder"],["label","Source"],["formControlName","source",3,"placeholder"],[3,"control","items"],["label","Category"],["formControlName","category_id",3,"resource"],[3,"click"]],template:function(t,o){if(t&1){let s=b();l(0,"form",3)(1,"lg-gap-column")(2,"lg-control",4),m(3,"lg-input",5),i(),l(4,"lg-gap-row",6)(5,"lg-control",7)(6,"lg-number-input",8),c("onInputChange",function(){C(s);let x=M(15);return _(x.focus())}),l(7,"div",9)(8,"lg-tooltip",10),g(9," Widgets "),l(10,"div",11)(11,"lg-amount-widgets",12),c("eggsChanged",function(x){return C(s),_(o.eggsChanged(x))}),i()()()()()(),m(12,"lg-buttons-group",13),i(),l(13,"lg-control",14),m(14,"lg-number-input",15,0),i(),l(16,"lg-gap-column")(17,"lg-control",16),m(18,"lg-input",17,1),i(),v(20,He,1,2,"lg-chips-list",18),i(),l(21,"lg-gap-column")(22,"lg-control",19),m(23,"lg-multiselect",20,2),i(),v(25,Le,1,2,"lg-chips-list",18),i(),v(26,ze,2,0,"lg-button")(27,$e,2,0,"lg-button"),i()()}t&2&&(a("formGroup",o.form),r(3),a("placeholder","Your product name"),r(),a("bottom",!0)("mobileMode",!0),r(2),a("placeholder","In "+o.form.value.unit),r(2),a("position","left"),r(4),a("items",o.buttons),r(2),a("placeholder","For the entire product in your currency"),r(4),a("placeholder","Where do you buy it?"),r(2),w(o.topSources().length?20:-1),r(3),a("resource","categories"),r(2),w(o.topCategories().length?25:-1),r(),w(o.uuid()?26:27))},dependencies:[xe,we,he,ye,be,Pe,Ee,Te,Me,k,Se,Ve,W,G,Ie,D,Re,Ae,j],styles:[`lg-eggs-widget{min-width:300px}
`],encapsulation:2})};var ke=class n{constructor(e){this._aRoute=e}uuid=f("");ngOnInit(){this._aRoute.params.subscribe(e=>{this.uuid.set(e.uuid)})}static \u0275fac=function(t){return new(t||n)(h(de))};static \u0275cmp=d({type:n,selectors:[["app-add-recipe"]],decls:8,vars:8,consts:[[3,"center"],[3,"flat","link","size"],[3,"uuid"]],template:function(t,o){t&1&&(l(0,"lg-container")(1,"lg-gap-row",0)(2,"lg-title"),g(3),i(),l(4,"lg-button",1),g(5," Back to list "),i()(),l(6,"lg-card"),m(7,"lg-add-product-form",2),i()()),t&2&&(r(),a("center",!0),r(2),I("",o.uuid()?"Edit":"Add"," Product"),r(),te("warning"),a("flat",!0)("link","/products")("size","small"),r(3),a("uuid",o.uuid()))},dependencies:[ge,fe,Ce,B,k,D],encapsulation:2})};export{ke as AddProductComponent};
