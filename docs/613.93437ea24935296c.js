"use strict";(self.webpackChunklasagna=self.webpackChunklasagna||[]).push([[613],{1613:(Xe,w,u)=>{u.r(w),u.d(w,{CalculateRecipeComponent:()=>Oe});var e=u(1007),G=u(1636),N=u(5642),j=u(1086),Y=u(553);const O=["*"];let V=(()=>{class n{constructor(){}static \u0275fac=function(o){return new(o||n)};static \u0275cmp=e.VBU({type:n,selectors:[["lg-table-card"]],ngContentSelectors:O,decls:4,vars:1,consts:[[3,"flat"],[1,"table"],[1,"table__scroll"]],template:function(o,a){1&o&&(e.NAR(),e.j41(0,"lg-card",0)(1,"div",1)(2,"div",2),e.SdG(3),e.k0s()()()),2&o&&e.Y8G("flat",!0)},dependencies:[Y.i],styles:[":host{display:flex;width:100%}.table__scroll{overflow-x:auto}table{width:100%;border-collapse:collapse;--border-color: #efefef}table thead tr{border-bottom:1px solid var(--border-color)}table thead th{text-align:left;padding:16px 24px;opacity:.4;font-size:.8em}table tbody tr{border-bottom:1px solid var(--border-color)}table tbody tr:last-child{border-bottom:none}td{padding:16px 24px}\n"],encapsulation:2})}return n})();var T=u(177),E=u(1119),A=u(7512),I=u(9895),m=u(9417),$=u(7480),S=u(7782),X=u(332),B=u(10),U=u(7504),P=u(3333);const W=["*"];function z(n,l){if(1&n&&e.EFF(0),2&n){const t=e.XpG();e.SpI(" ",t.customMark()," ")}}let L=(()=>{class n{constructor(){}value=!1;customMark=(0,e.hFB)("");onKeydown(t){t.preventDefault(),this.onChangeCheckbox(!this.value)}onCheckboxChanged=(0,e.CGW)();onChange=()=>{};onTouched=()=>{};writeValue(t){this._change(t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}onChangeCheckbox(t){this._change(t)}_change(t){this.value=t,this.onChange(this.value),this.onCheckboxChanged.emit(this.value)}static \u0275fac=function(o){return new(o||n)};static \u0275cmp=e.VBU({type:n,selectors:[["lg-checkbox"]],hostBindings:function(o,a){1&o&&e.bIt("keydown.enter",function(r){return a.onKeydown(r)})("keydown.space",function(r){return a.onKeydown(r)})},inputs:{customMark:[1,"customMark"]},outputs:{onCheckboxChanged:"onCheckboxChanged"},features:[e.Jv_([{provide:m.kq,useExisting:(0,e.Rfq)(()=>n),multi:!0}])],ngContentSelectors:W,decls:5,vars:2,consts:[["tabindex","0",1,"lg-checkbox"],["type","checkbox",1,"checkbox",3,"ngModelChange","ngModel"],[1,"lg-checkbox__mark"]],template:function(o,a){1&o&&(e.NAR(),e.j41(0,"label",0)(1,"input",1),e.bIt("ngModelChange",function(r){return a.onChangeCheckbox(r)}),e.k0s(),e.j41(2,"span",2),e.DNE(3,z,1,1),e.k0s(),e.SdG(4),e.k0s()),2&o&&(e.R7$(),e.Y8G("ngModel",a.value),e.R7$(2),e.vxM(a.customMark()?3:-1))},dependencies:[m.YN,m.Zm,m.BC,m.vS],styles:[".lg-checkbox{display:flex;border-radius:12px}.lg-checkbox:focus-within{outline-color:var(--active-color)}.lg-checkbox__mark{display:flex;align-items:center;justify-content:center;width:51px;height:51px;border-radius:12px;background-color:var(--control-bg);opacity:.2;cursor:pointer;transition:all .2s ease-in-out}.lg-checkbox__mark:hover{opacity:1}.checkbox{display:none}.checkbox:checked+.lg-checkbox__mark{background-color:var(--control-bg-selected);opacity:1;font-weight:700}\n"],encapsulation:2})}return n})();var J=u(1072);let H=(()=>{class n{constructor(){}flex="0 1 auto";static \u0275fac=function(o){return new(o||n)};static \u0275dir=e.FsC({type:n,selectors:[["","lgShrink",""]],hostVars:2,hostBindings:function(o,a){2&o&&e.xc7("flex",a.flex)}})}return n})(),Q=(()=>{class n{constructor(){}selfAlign="center";static \u0275fac=function(o){return new(o||n)};static \u0275dir=e.FsC({type:n,selectors:[["","lgSelfCenter",""]],hostVars:2,hostBindings:function(o,a){2&o&&e.xc7("align-self",a.selfAlign)}})}return n})();var Z=u(1985),K=u(6977);function y(n){n||((0,e.Af3)(y),n=(0,e.WQX)(e.abz));const l=new Z.c(t=>n.onDestroy(t.next.bind(t)));return t=>t.pipe((0,K.Q)(l))}const ae=(n,l)=>l.value.name;function le(n,l){if(1&n){const t=e.RV6();e.j41(0,"section",6)(1,"div",7)(2,"lg-gap-row",8)(3,"small"),e.EFF(4,"Apply for all"),e.k0s(),e.j41(5,"lg-control",9),e.nrm(6,"lg-input",10),e.k0s(),e.j41(7,"lg-control",9),e.nrm(8,"lg-input",11),e.k0s(),e.j41(9,"lg-control",9)(10,"lg-number-input",12),e.bIt("onInputChange",function(){e.eBV(t);const a=e.XpG().$index,i=e.XpG();return e.Njj(i.onTaxValueChange(a))}),e.k0s()(),e.j41(11,"lg-control",9)(12,"lg-checkbox",13),e.bIt("onCheckboxChanged",function(){e.eBV(t);const a=e.XpG().$index,i=e.XpG();return e.Njj(i.onTaxValueChange(a))}),e.k0s()(),e.j41(13,"lg-control",9),e.nrm(14,"lg-number-input",14),e.k0s(),e.j41(15,"lg-button",15),e.bIt("click",function(){e.eBV(t);const a=e.XpG().$index,i=e.XpG();return e.Njj(i.deleteTxRow(a))}),e.nrm(16,"mat-icon",16),e.k0s()()()()}if(2&n){const t=e.XpG().$index;e.Y8G("formGroupName",t),e.R7$(),e.AVh("taxes__row--odd",t%2!=0),e.R7$(),e.Y8G("bottom",!0)("fit",!0),e.R7$(3),e.Y8G("label","Name"),e.R7$(),e.Y8G("placeholder","Name"),e.R7$(),e.Y8G("label","Description"),e.R7$(),e.Y8G("placeholder","Description"),e.R7$(),e.Y8G("label","Value"),e.R7$(),e.Y8G("placeholder","Value"),e.R7$(),e.Y8G("label","Use percentage"),e.R7$(),e.Y8G("customMark","%"),e.R7$(),e.Y8G("label","Amount"),e.R7$(),e.Y8G("disabled",!0)("placeholder","Amount"),e.R7$(),e.Aen("danger"),e.Y8G("size","small")("icon",!0)}}function ie(n,l){1&n&&e.DNE(0,le,17,20,"ng-template",2)}let re=(()=>{class n{constructor(){}totalTaxesChanged=(0,e.CGW)();rows=(0,e.hFB)([{name:"VAT",description:"Value-Added Tax applied to ingredient purchases or product sales",value:.2,amount:0,percentage:!0},{name:"Income Tax",description:"Tax on profit from selling the final product",value:.15,amount:0,percentage:!0},{name:"Import Duty",description:"Customs fee on imported ingredients or packaging",value:50,amount:0,percentage:!1},{name:"Sales Commission",description:"Fee paid to marketplaces or resellers per unit sold",value:.1,amount:0,percentage:!0},{name:"Certification Fee",description:"Cost of food certification, sanitation checks, or licensing",value:100,amount:0,percentage:!1}]);total=(0,e.hFB)(0);taxesForm=new m.gE({rows:new m.Yp([this._getRowGroup()])});rowsEffect=(0,e.QZP)(()=>{this._rowsFormArray.clear(),this.rows().forEach((t,o)=>{this._rowsFormArray.push(this._getRowGroup(t))})});totalTaxes=(0,e.vPA)(0);totalEffect=(0,e.QZP)(()=>{this._recalculateTaxes()});formValues=this.taxesForm.valueChanges.pipe(y());get _rowsFormArray(){return this.taxesForm.get("rows")}ngOnInit(){this.formValues.subscribe(t=>{this.totalTaxes.set(this._getTotalTaxes()),this.totalTaxesChanged.emit(this.totalTaxes())})}onTaxValueChange(t){const o=this._rowsFormArray.at(t),a=this._getAmount(o.value.value,o.value.percentage);o.get("amount")?.patchValue(a.toFixed(2))}deleteTxRow(t){this._rowsFormArray.removeAt(t)}addTxRow(){this._rowsFormArray.push(this._getRowGroup())}_getTotalTaxes(){return this._rowsFormArray.controls.reduce((t,o)=>{const a=parseFloat(o.get("amount")?.value);return t+(isNaN(a)?0:a)},0)}_getAmount(t,o){const a=parseFloat(t.toString());return o?a*this.total():a}_recalculateTaxes(t=!1){this._rowsFormArray.controls.forEach((o,a)=>{const i=this._getAmount(o.get("value")?.value,o.get("percentage")?.value);o.get("amount")?.patchValue(i.toFixed(2),{emitEvent:!t})})}_getRowGroup(t=null){return new m.gE({name:new m.MJ(t?.name||""),description:new m.MJ(t?.description||""),value:new m.MJ(t?.value||0),amount:new m.MJ(0),percentage:new m.MJ(t?.percentage||!1)})}static \u0275fac=function(o){return new(o||n)};static \u0275cmp=e.VBU({type:n,selectors:[["lg-taxes-and-fees-list"]],inputs:{rows:[1,"rows"],total:[1,"total"]},outputs:{totalTaxesChanged:"totalTaxesChanged"},decls:12,vars:6,consts:[[3,"formGroup"],["formArrayName","rows"],["lgCardListItem",""],[3,"level"],[3,"center","mobileMode","relaxed"],["lgSelfCenter","","lgShrink","",3,"click"],[1,"taxes",3,"formGroupName"],[1,"taxes__row"],[3,"bottom","fit"],[3,"label"],["formControlName","name",3,"placeholder"],["formControlName","description",3,"placeholder"],["lgParseMath","","formControlName","value",3,"onInputChange","placeholder"],["formControlName","percentage",3,"onCheckboxChanged","customMark"],["formControlName","amount",3,"disabled","placeholder"],["lgSelfCenter","","lgShrink","",3,"click","size","icon"],["aria-hidden","false","aria-label","Example home icon","fontIcon","close"]],template:function(o,a){1&o&&(e.j41(0,"lg-gap-column")(1,"lg-card-list",0),e.qex(2,1),e.Z7z(3,ie,1,0,null,2,ae),e.bVm(),e.k0s(),e.j41(5,"lg-title",3)(6,"lg-gap-row",4),e.EFF(7," Total taxes and fees "),e.j41(8,"b"),e.EFF(9),e.k0s()()(),e.j41(10,"lg-button",5),e.bIt("click",function(){return a.addTxRow()}),e.EFF(11," Add tax "),e.k0s()()),2&o&&(e.R7$(),e.Y8G("formGroup",a.taxesForm),e.R7$(2),e.Dyx(a.taxesForm.controls.rows.controls),e.R7$(2),e.Y8G("level",4),e.R7$(),e.Y8G("center",!0)("mobileMode",!0)("relaxed",!0),e.R7$(3),e.JRh(a.totalTaxes()))},dependencies:[X.Y,B.p,A.I,m.X1,m.BC,m.cb,m.j4,m.JD,m.$R,m.v8,U.X,P.S,L,I.N,E.Q,J.d,Q,H,S.K,$.t,j.W],styles:[".taxes__row--odd[_ngcontent-%COMP%]{--control-bg: #fff}"]})}return n})();var C=u(467),k=u(4625),ce=u(9512),se=u(7201);let ue=(()=>{class n{_recipeRepository;_productRepository;constructor(t,o){this._recipeRepository=t,this._productRepository=o}calculation;calculateRecipe(t,o=0){var a=this;return new Promise(function(){var i=(0,C.A)(function*(r,c){const s=[];let p=0,x=0;yield a._recipeRepository.getOne(t).then(function(){var R=(0,C.A)(function*(f){const h=(o||f?.outcome_amount||1)/(f?.outcome_amount||1),{table:_,totalAmount:g,totalWeight:d}=yield a._makeIngredientTable(f,h);p+=g||0,x+=d||0,s.push(..._),s.push(a._makeTotal(p,x)),r({recipe:f,result:s,total:p,totalWeight:x})});return function(f){return R.apply(this,arguments)}}())});return function(r,c){return i.apply(this,arguments)}}())}getRecipe(t){var o=this;return(0,C.A)(function*(){if(!t)return;const a=yield o._recipeRepository.getOne(t);if(!a)return;let i=0;return i=a.outcome_unit&&a.outcome_amount?a.outcome_amount:a?.ingredients?.reduce((r,c)=>"gram"!==c.unit?r:r+((0,k.N)(c.amount)||0),0)??0,{totalAmountInGrams:i||0,...a,pricePerUnit:0}})()}_makeRecipeSubTable(t,o=0){var a=this;return(0,C.A)(function*(){return new Promise(function(){var i=(0,C.A)(function*(r,c){const s=[];let p=0,x=0;const R=t.amount;yield a.getRecipe(t.recipe_id).then(function(){var f=(0,C.A)(function*(h){let _=R/(h?.totalAmountInGrams||1);const g=yield a._makeIngredientTable(h,o);g.table=g.table.map((b,D)=>{const Ve=(b.amount||0)*(o||1)*_;return{...b,amount:parseFloat((Ve||0).toFixed(5)),total:parseFloat((b.total?b.total*_:0).toFixed(5)),indent:b.indent+1}});let d=g.totalAmount?g.totalAmount/g.totalWeight:0;const F=(h?.totalAmountInGrams||0)*o*_,v=g.totalAmount*_;s.push(a._makeRecipeCaption({name:h?.name||"Unknown recipe",price_per_gram:d,amount:F,total:v,unit:t.unit,uuid:h?.uuid||""})),s.push(...g.table),x+=v,p+=g.totalWeight*_,r({table:s,totalAmount:x,totalWeight:p})});return function(h){return f.apply(this,arguments)}}())});return function(r,c){return i.apply(this,arguments)}}())})()}_makeIngredientTable(t,o=0){var a=this;const i=[];let r=0,c=0;return Promise.all(t?.ingredients.map(function(){var s=(0,C.A)(function*(p,x){const R=p.recipe_id,f=p.product_id,h=p.name;if(R||f||h)if(R){const _=yield a._makeRecipeSubTable(p,o);i.push(..._.table),c+=_.totalAmount,r+=_.totalWeight}else f?yield a._productRepository.getOne(p.product_id).then(function(){var g=(0,C.A)(function*(d){if(!d)return void i.push(a._makeRow({name:"Unknown product",price_per_gram:void 0,amount:p.amount*(o||1),total:void 0,uuid:d?.uuid||""}));if(!d?.price)return void i.push(a._makeRow({name:d.name,price_per_gram:0,amount:p.amount*(o||1),total:0,uuid:d?.uuid||""}));if(!d?.amount)return void i.push(a._makeRow({name:d.name,price_per_gram:0,amount:p.amount*(o||1),total:0,uuid:d?.uuid||""}));const F=p.amount*(o||1),v=((0,k.N)(d.price)||1)/((0,k.N)(d.amount)||1),b=v*((0,k.N)(F)||1),D="gram"===d.unit||!d.unit;i.push(a._makeRow({name:d.name,price_per_gram:v,amount:F,total:b,unit:d.unit,uuid:d?.uuid||""})),c+=b,D&&(r+=+F)});return function(d){return g.apply(this,arguments)}}()):h&&(i.push(a._makeRow({name:p.name,price_per_gram:void 0,amount:p.amount*(o||1),total:void 0,uuid:""})),r+=+p.amount*(o||1))});return function(p,x){return s.apply(this,arguments)}}())??[]).then(()=>({table:i,totalAmount:c,totalWeight:r}))}_makeRow(t){return{name:t.name,price_per_gram:parseFloat(t.price_per_gram?.toFixed(5)??"0"),amount:t.amount,total:parseFloat(t.total?.toFixed(5)??"0"),unit:t.unit||"gram",indent:t.indent??0,type:"row",uuid:t.uuid}}_makeCaption(t){return{name:t,unit:void 0,price_per_gram:void 0,amount:void 0,total:void 0,indent:0,type:"caption"}}_makeRecipeCaption(t){return{name:t.name,price_per_gram:parseFloat(t.price_per_gram.toFixed(5)),amount:t.amount,total:parseFloat(t.total.toFixed(2)),unit:t.unit||"gram",indent:0,type:"recipe-row",uuid:t.uuid}}_makeTotal(t,o){return{name:"Total (without taxes and fees)",amount:o,unit:"gram",price_per_gram:parseFloat((t/o).toFixed(5)),total:parseFloat(t.toFixed(2)),indent:0,type:"total"}}static \u0275fac=function(o){return new(o||n)(e.KVO(ce.m),e.KVO(se.d))};static \u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const me=(n,l)=>[n,l];function pe(n,l){1&n&&e.eu8(0)}function de(n,l){1&n&&e.eu8(0)}function _e(n,l){1&n&&e.eu8(0)}function ge(n,l){if(1&n){const t=e.RV6();e.j41(0,"lg-gap-row",8)(1,"lg-gap-row",9)(2,"div"),e.EFF(3," Calculation outcome: "),e.k0s(),e.j41(4,"div")(5,"lg-number-input",10),e.mxI("ngModelChange",function(a){e.eBV(t);const i=e.XpG(2);return e.DH7(i.outcome_amount,a)||(i.outcome_amount=a),e.Njj(a)}),e.bIt("onInputChange",function(a){e.eBV(t);const i=e.XpG(2);return e.Njj(i.onOutcomeChange(a))}),e.k0s()(),e.j41(6,"b"),e.EFF(7),e.k0s()(),e.j41(8,"lg-gap-row",11)(9,"div"),e.EFF(10," one "),e.j41(11,"b"),e.EFF(12),e.k0s()(),e.j41(13,"div"),e.EFF(14," costs: "),e.DNE(15,pe,1,0,"ng-container",12),e.EFF(16," ( "),e.DNE(17,de,1,0,"ng-container",12),e.EFF(18," + "),e.DNE(19,_e,1,0,"ng-container",12),e.EFF(20," of taxes and fees) "),e.k0s()()()}if(2&n){let t,o;const a=e.XpG(2),i=e.sdS(11),r=e.sdS(13),c=e.sdS(15);e.Y8G("fit",!0)("center",!0)("mobileMode",!0),e.R7$(),e.Y8G("size","small")("center",!0),e.R7$(4),e.R50("ngModel",a.outcome_amount),e.Y8G("placeholder","Amount"),e.R7$(2),e.SpI(" ",null==(t=a.result())||null==t.recipe?null:t.recipe.outcome_unit," "),e.R7$(),e.Y8G("size","small")("mobileMode",!0),e.R7$(4),e.SpI(" ",null==(o=a.result())||null==o.recipe?null:o.recipe.outcome_unit," "),e.R7$(3),e.Y8G("ngTemplateOutlet",c),e.R7$(2),e.Y8G("ngTemplateOutlet",r),e.R7$(2),e.Y8G("ngTemplateOutlet",i)}}function he(n,l){1&n&&e.eu8(0)}function fe(n,l){1&n&&e.eu8(0)}function Ce(n,l){1&n&&e.eu8(0)}function xe(n,l){1&n&&e.eu8(0)}function be(n,l){if(1&n){const t=e.RV6();e.j41(0,"lg-gap-row",9)(1,"div"),e.EFF(2," Calculation outcome: "),e.k0s(),e.j41(3,"div")(4,"lg-number-input",10),e.mxI("ngModelChange",function(a){e.eBV(t);const i=e.XpG(2);return e.DH7(i.outcome_amount,a)||(i.outcome_amount=a),e.Njj(a)}),e.bIt("onInputChange",function(a){e.eBV(t);const i=e.XpG(2);return e.Njj(i.onOutcomeChange(a))}),e.k0s()(),e.j41(5,"div"),e.EFF(6," costs: "),e.DNE(7,he,1,0,"ng-container",12),e.EFF(8," ( "),e.DNE(9,fe,1,0,"ng-container",12),e.EFF(10," + "),e.DNE(11,Ce,1,0,"ng-container",12),e.EFF(12," of taxes and fees) "),e.k0s(),e.j41(13,"div"),e.EFF(14," per gram: "),e.DNE(15,xe,1,0,"ng-container",12),e.k0s()()}if(2&n){const t=e.XpG(2),o=e.sdS(11),a=e.sdS(13),i=e.sdS(15),r=e.sdS(17);e.Y8G("size","small")("center",!0),e.R7$(4),e.R50("ngModel",t.outcome_amount),e.Y8G("placeholder","Amount"),e.R7$(3),e.Y8G("ngTemplateOutlet",i),e.R7$(2),e.Y8G("ngTemplateOutlet",a),e.R7$(2),e.Y8G("ngTemplateOutlet",o),e.R7$(4),e.Y8G("ngTemplateOutlet",r)}}function Re(n,l){if(1&n&&(e.j41(0,"lg-gap-row",6),e.DNE(1,ge,21,14,"lg-gap-row",8)(2,be,16,8,"lg-gap-row",9),e.k0s()),2&n){const t=e.XpG();e.Y8G("center",!0),e.R7$(),e.vxM(t.notInGrams()?1:2)}}function Fe(n,l){if(1&n&&(e.EFF(0),e.nI1(1,"number")),2&n){const t=e.XpG(2);e.SpI(" ",e.i5U(1,1,t.totalTaxes()/t.showedOutcome(),"1.2-2")," ")}}function ve(n,l){if(1&n&&(e.EFF(0),e.nI1(1,"number")),2&n){const t=e.XpG(2);e.SpI(" ",e.i5U(1,1,t.totalTaxes(),"1.2-2")," ")}}function ke(n,l){if(1&n&&e.DNE(0,Fe,2,4)(1,ve,2,4),2&n){const t=e.XpG();e.vxM(t.notInGrams()?0:1)}}function Te(n,l){if(1&n&&(e.EFF(0),e.nI1(1,"number")),2&n){let t;const o=e.XpG(2);e.SpI(" ",e.i5U(1,1,((null==(t=o.result())?null:t.total)||1)/(o.showedOutcome()||1),"1.2-2")," ")}}function ye(n,l){if(1&n&&(e.EFF(0),e.nI1(1,"number")),2&n){let t;const o=e.XpG(2);e.SpI(" ",e.i5U(1,1,null==(t=o.result())?null:t.total,"1.2-2")," ")}}function we(n,l){if(1&n&&e.DNE(0,Te,2,4)(1,ye,2,4),2&n){const t=e.XpG();e.vxM(t.notInGrams()?0:1)}}function Ge(n,l){if(1&n&&(e.EFF(0),e.nI1(1,"number")),2&n){let t;const o=e.XpG(2);e.SpI(" ",e.i5U(1,1,(((null==(t=o.result())?null:t.total)||1)+o.totalTaxes())/(o.showedOutcome()||1),"1.2-2")," ")}}function je(n,l){if(1&n&&(e.EFF(0),e.nI1(1,"number")),2&n){let t;const o=e.XpG(2);e.SpI(" ",e.i5U(1,1,((null==(t=o.result())?null:t.total)||1)+o.totalTaxes(),"1.2-2")," ")}}function Ee(n,l){if(1&n&&e.DNE(0,Ge,2,4)(1,je,2,4),2&n){const t=e.XpG();e.vxM(t.notInGrams()?0:1)}}function Ae(n,l){}function Ie(n,l){if(1&n&&(e.EFF(0),e.nI1(1,"number")),2&n){let t;const o=e.XpG(2);e.SpI(" ",e.i5U(1,1,(((null==(t=o.result())?null:t.total)||1)+o.totalTaxes())/o.outcome_amount(),"1.2-2")," ")}}function $e(n,l){if(1&n&&e.DNE(0,Ae,0,0)(1,Ie,2,4),2&n){const t=e.XpG();e.vxM(t.notInGrams()?0:1)}}function Se(n,l){if(1&n&&(e.j41(0,"a",19),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.Y8G("routerLink",e.l_i(2,me,"recipe-row"===t.type?"/edit-recipe/":"/edit-product/",t.uuid)),e.R7$(),e.SpI(" ",t.name," ")}}function Me(n,l){if(1&n&&e.EFF(0),2&n){const t=e.XpG().$implicit;e.SpI(" ",t.name," ")}}function De(n,l){if(1&n&&(e.j41(0,"tr",18)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td")(4,"span",18),e.DNE(5,Se,2,5,"a",19)(6,Me,1,1),e.k0s()(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.k0s(),e.j41(11,"td"),e.EFF(12),e.k0s(),e.j41(13,"td"),e.EFF(14),e.k0s()()),2&n){const t=l.$implicit,o=l.$index;e.Y8G("ngClass",t.type),e.R7$(2),e.JRh(o+1),e.R7$(2),e.Y8G("ngClass","indent-"+t.indent),e.R7$(),e.vxM("total"!==t.type?5:6),e.R7$(3),e.JRh(t.amount),e.R7$(2),e.JRh(t.unit),e.R7$(2),e.JRh(t.price_per_gram),e.R7$(2),e.JRh(t.total)}}function Ne(n,l){if(1&n&&(e.j41(0,"table")(1,"colgroup"),e.nrm(2,"col",13)(3,"col",14)(4,"col",15)(5,"col",16)(6,"col",15)(7,"col",17),e.k0s(),e.j41(8,"thead")(9,"tr")(10,"th"),e.EFF(11,"#"),e.k0s(),e.j41(12,"th"),e.EFF(13,"Name"),e.k0s(),e.j41(14,"th"),e.EFF(15,"Amount"),e.k0s(),e.j41(16,"th"),e.EFF(17,"Unit"),e.k0s(),e.j41(18,"th"),e.EFF(19,"Price per unit"),e.k0s(),e.j41(20,"th"),e.EFF(21,"Total"),e.k0s()()(),e.j41(22,"tbody"),e.Z7z(23,De,15,8,"tr",18,e.Vm6),e.k0s()()),2&n){let t;const o=e.XpG();e.R7$(23),e.Dyx(null==(t=o.result())?null:t.result)}}function Ye(n,l){1&n&&(e.j41(0,"div"),e.EFF(1,"Loading..."),e.k0s())}let Oe=(()=>{class n{_aRoute;_calculateRecipeService;constructor(t,o){this._aRoute=t,this._calculateRecipeService=o}uuid=(0,e.vPA)("");result=(0,e.vPA)(null);outcome_amount=(0,e.geq)(0);showedOutcome=(0,e.vPA)(0);totalTaxes=(0,e.vPA)(0);onOutcomeChange=t=>{this._calculateRecipeService.calculateRecipe(this.uuid(),t).then(o=>{this.result.set(o),this.showedOutcome.set(t)})};notInGrams=(0,e.EWP)(()=>this.result()?.recipe?.outcome_unit&&"gram"!==this.result()?.recipe?.outcome_unit);ngOnInit(){this._aRoute.params.subscribe(t=>{this.uuid.set(t.uuid),this._calculateRecipeService.calculateRecipe(t.uuid).then(o=>{this.result.set(o),this.outcome_amount.set(o?.recipe?.outcome_amount||0),this.showedOutcome.set(o?.recipe?.outcome_amount||0)})})}onTotalTaxesChanged=t=>{this.totalTaxes.set(t)};static \u0275fac=function(o){return new(o||n)(e.rXU(G.nX),e.rXU(ue))};static \u0275cmp=e.VBU({type:n,selectors:[["lg-calculate-recipe"]],inputs:{outcome_amount:[1,"outcome_amount"]},outputs:{outcome_amount:"outcome_amountChange"},decls:24,vars:16,consts:[["taxAmount",""],["rawAmount",""],["totalAmount",""],["perGramAmount",""],[3,"center","mobileMode"],[3,"flat","link","size"],[3,"center"],[3,"totalTaxesChanged","total"],[3,"fit","center","mobileMode"],[3,"size","center"],["lgParseMath","",3,"ngModelChange","onInputChange","ngModel","placeholder"],[3,"size","mobileMode"],[4,"ngTemplateOutlet"],["span","1",2,"width","1%"],["span","1",2,"width","20%"],["span","1",2,"width","5%"],["span","1",2,"width","3%"],["span","1",2,"width","7%"],[3,"ngClass"],["target","_blank",3,"routerLink"]],template:function(o,a){if(1&o){const i=e.RV6();e.j41(0,"lg-container")(1,"lg-gap-column")(2,"lg-gap-row",4)(3,"lg-title"),e.EFF(4),e.k0s(),e.j41(5,"lg-button",5),e.EFF(6," Edit "),e.k0s(),e.j41(7,"lg-button",5),e.EFF(8," Back to list "),e.k0s()(),e.DNE(9,Re,3,2,"lg-gap-row",6)(10,ke,2,1,"ng-template",null,0,e.C5r)(12,we,2,1,"ng-template",null,1,e.C5r)(14,Ee,2,1,"ng-template",null,2,e.C5r)(16,$e,2,1,"ng-template",null,3,e.C5r),e.j41(18,"lg-table-card"),e.DNE(19,Ne,25,0,"table")(20,Ye,2,0,"div"),e.k0s(),e.j41(21,"lg-title"),e.EFF(22," Taxes and fees "),e.k0s(),e.j41(23,"lg-taxes-and-fees-list",7),e.bIt("totalTaxesChanged",function(c){return e.eBV(i),e.Njj(a.onTotalTaxesChanged(c))}),e.k0s()()()}if(2&o){let i,r,c,s;e.R7$(2),e.Y8G("center",!0)("mobileMode",!0),e.R7$(2),e.SpI(" ",null==(i=a.result())||null==i.recipe?null:i.recipe.name," cost calculation "),e.R7$(),e.Aen("primary"),e.Y8G("flat",!0)("link","/edit-recipe/"+(null==(r=a.result())||null==r.recipe?null:r.recipe.uuid))("size","small"),e.R7$(2),e.Aen("warning"),e.Y8G("flat",!0)("link","/recipes")("size","small"),e.R7$(2),e.vxM(null!=(c=a.result())&&c.total?9:-1),e.R7$(10),e.vxM(a.result()?19:20),e.R7$(4),e.Y8G("total",null!==(s=null==(s=a.result())?null:s.total)&&void 0!==s?s:0)}},dependencies:[N.H,j.W,V,T.YU,E.Q,A.I,T.QX,I.N,m.YN,m.BC,m.vS,$.t,G.Wk,S.K,re,T.T3],styles:[":host{--control-bg: #fff}lg-number-input .lg-number-input{width:100px}\n"],encapsulation:2})}return n})()}}]);