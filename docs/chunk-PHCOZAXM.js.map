{
  "version": 3,
  "sources": ["src/app/shared/helpers/route.helpers.ts"],
  "sourcesContent": ["import {assertInInjectionContext, inject, Signal} from '@angular/core';\nimport {ActivatedRoute, NavigationEnd, Params, Router} from '@angular/router';\nimport {toSignal} from '@angular/core/rxjs-interop';\nimport {filter, map, pairwise, startWith, take} from 'rxjs';\nimport {tap} from 'rxjs/operators';\n\nexport function injectParams<T = Params | string | null>(\n  keyOrTransform?: string | ((params: Params) => T),\n): Signal<T> {\n  assertInInjectionContext(injectParams);\n  const route = inject(ActivatedRoute);\n\n  if (typeof keyOrTransform === 'function') {\n    return toSignal(route.params.pipe(map(keyOrTransform)), {requireSync: true});\n  }\n\n  const getParam = (params: Params) =>\n    keyOrTransform ? params?.[keyOrTransform] ?? null : params;\n\n  return toSignal(route.params.pipe(map(getParam)), {requireSync: true});\n}\n\nexport function injectQueryParams<T = Params | string | null>(\n  keyOrTransform?: string | ((params: Params) => T),\n): Signal<T> {\n  assertInInjectionContext(injectParams);\n  const route = inject(ActivatedRoute);\n\n  if (typeof keyOrTransform === 'function') {\n    return toSignal(route.queryParams.pipe(map(keyOrTransform)), {requireSync: true});\n  }\n\n  const getParam = (params: Params) =>\n    keyOrTransform ? params?.[keyOrTransform] ?? null : params;\n\n  return toSignal(route.queryParams.pipe(map(getParam)), {requireSync: true});\n}\n\nexport function injectFragment() {\n  assertInInjectionContext(injectFragment);\n  const route = inject(ActivatedRoute);\n\n  return toSignal(route.fragment.pipe(take(1)));\n}\n\n/**\n * Фабрика для создания сигнала, который отслеживает изменения маршрута.\n * @param router\n * @param compareStrictly - если true, сравнивает URL строго с учетом параметров\n */\nexport function routeChangeSignal(\n  router: Router,\n  compareStrictly: boolean = true,\n) {\n  return toSignal(router.events.pipe(\n    filter(event => event instanceof NavigationEnd),\n    startWith({url: ''}),\n    map(event => {\n      const url = (event as NavigationEnd).url;\n\n      return String(compareStrictly\n        ? url\n        : url.split('?')[0].split('#')[0])\n    }),\n    pairwise(),\n    filter((urls) => urls[0] !== urls[1]),\n    tap(event => console.log('Router event:', event)),\n  ))\n}\n\nexport const getURLWithoutParams = (url: string): string => {\n  return url.split('?')[0].split('#')[0];\n}\n\nexport const findRouteData = (route: ActivatedRoute): any => {\n  let currentRoute = route;\n\n  // Идем по всему дереву маршрутов и собираем все данные\n  while (currentRoute) {\n    if (currentRoute.snapshot.data && Object.keys(currentRoute.snapshot.data).length > 0) {\n      return currentRoute.snapshot.data;\n    }\n\n    // Переходим к дочернему маршруту\n    if (currentRoute.firstChild) {\n      currentRoute = currentRoute.firstChild;\n    } else {\n      break;\n    }\n  }\n\n  return {};\n};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;AAMM,SAAU,aACd,gBAAiD;AAEjD,2BAAyB,YAAY;AACrC,QAAM,QAAQ,OAAO,cAAc;AAEnC,MAAI,OAAO,mBAAmB,YAAY;AACxC,WAAO,SAAS,MAAM,OAAO,KAAK,IAAI,cAAc,CAAC,GAAG,EAAC,aAAa,KAAI,CAAC;EAC7E;AAEA,QAAM,WAAW,CAAC,WAChB,iBAAiB,SAAS,cAAc,KAAK,OAAO;AAEtD,SAAO,SAAS,MAAM,OAAO,KAAK,IAAI,QAAQ,CAAC,GAAG,EAAC,aAAa,KAAI,CAAC;AACvE;AAEM,SAAU,kBACd,gBAAiD;AAEjD,2BAAyB,YAAY;AACrC,QAAM,QAAQ,OAAO,cAAc;AAEnC,MAAI,OAAO,mBAAmB,YAAY;AACxC,WAAO,SAAS,MAAM,YAAY,KAAK,IAAI,cAAc,CAAC,GAAG,EAAC,aAAa,KAAI,CAAC;EAClF;AAEA,QAAM,WAAW,CAAC,WAChB,iBAAiB,SAAS,cAAc,KAAK,OAAO;AAEtD,SAAO,SAAS,MAAM,YAAY,KAAK,IAAI,QAAQ,CAAC,GAAG,EAAC,aAAa,KAAI,CAAC;AAC5E;AAEM,SAAU,iBAAc;AAC5B,2BAAyB,cAAc;AACvC,QAAM,QAAQ,OAAO,cAAc;AAEnC,SAAO,SAAS,MAAM,SAAS,KAAK,KAAK,CAAC,CAAC,CAAC;AAC9C;AAOM,SAAU,kBACd,QACA,kBAA2B,MAAI;AAE/B,SAAO,SAAS,OAAO,OAAO,KAC5B,OAAO,WAAS,iBAAiB,aAAa,GAC9C,UAAU,EAAC,KAAK,GAAE,CAAC,GACnB,IAAI,WAAQ;AACV,UAAM,MAAO,MAAwB;AAErC,WAAO,OAAO,kBACV,MACA,IAAI,MAAM,GAAG,EAAE,CAAC,EAAE,MAAM,GAAG,EAAE,CAAC,CAAC;EACrC,CAAC,GACD,SAAQ,GACR,OAAO,CAAC,SAAS,KAAK,CAAC,MAAM,KAAK,CAAC,CAAC,GACpC,IAAI,WAAS,QAAQ,IAAI,iBAAiB,KAAK,CAAC,CAAC,CAClD;AACH;AAEO,IAAM,sBAAsB,CAAC,QAAuB;AACzD,SAAO,IAAI,MAAM,GAAG,EAAE,CAAC,EAAE,MAAM,GAAG,EAAE,CAAC;AACvC;AAEO,IAAM,gBAAgB,CAAC,UAA8B;AAC1D,MAAI,eAAe;AAGnB,SAAO,cAAc;AACnB,QAAI,aAAa,SAAS,QAAQ,OAAO,KAAK,aAAa,SAAS,IAAI,EAAE,SAAS,GAAG;AACpF,aAAO,aAAa,SAAS;IAC/B;AAGA,QAAI,aAAa,YAAY;AAC3B,qBAAe,aAAa;IAC9B,OAAO;AACL;IACF;EACF;AAEA,SAAO,CAAA;AACT;",
  "names": []
}
