"use strict";(self.webpackChunklasagna=self.webpackChunklasagna||[]).push([[892],{416:(_,f,e)=>{e.d(f,{n:()=>r});var t=e(467);const h={products:{name:"products",loaderConfig:{name:"indexDb",storeName:"productsStore"}},categories:{name:"categories",loaderConfig:{name:"indexDb",storeName:"categoryStore"}},recipes:{name:"recipes",loaderConfig:{name:"indexDb",storeName:"recipesStore"}}};var v=e(4412),c=e(1007),i=e(2890);let r=(()=>{class n{_indexDbSelectLoaderService;constructor(o){this._indexDbSelectLoaderService=o}_registry=new Map;_registry$=new v.t(new Map);register(o){if(this._registry.has(o))return;const a=h[o];if(!a)throw new Error(`SelectResource ${o} not found`);this._registry.set(a.name,{name:a.name,list:[],lists:{},loader:{load:()=>this._indexDbSelectLoaderService.load(a.loaderConfig?.storeName)}})}get(o){return this._registry.get(o)}load(o){var a=this;const d=o||Array.from(this._registry.keys());return Promise.all(d.map(function(){var u=(0,t.A)(function*(y){const b=a.get(y),C=yield b.loader.load(b.name);Array.isArray(C)?b.list=C:b.lists=C});return function(y){return u.apply(this,arguments)}}())).then(()=>d.reduce((u,y)=>(u[y]=this.get(y),u),{})).then(()=>{this._registry$.next(this._registry)})}subscribe(o){return this._registry$.subscribe(o)}static \u0275fac=function(a){return new(a||n)(c.KVO(i.L,8))};static \u0275prov=c.jDH({token:n,factory:n.\u0275fac})}return n})()},2890:(_,f,e)=>{e.d(f,{L:()=>v});var t=e(1007),h=e(5559);let v=(()=>{class c{_indexDb;constructor(r){this._indexDb=r}load(r){return new Promise((n,l)=>{this._indexDb.openDb(o=>{const u=o.transaction(r,"readonly").objectStore(r).getAll();u.onsuccess=()=>{n(u.result)}})})}static \u0275fac=function(n){return new(n||c)(t.KVO(h.Q))};static \u0275prov=t.jDH({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})()},2892:(_,f,e)=>{e.r(f),e.d(f,{AddCategoryComponent:()=>D});var t=e(1007),h=e(5642),v=e(553),c=e(1086),i=e(9417),r=e(3333),n=e(7504),l=e(7782),o=e(1119),a=e(416),d=e(2933),u=e(5554);function y(g,x){if(1&g){const s=t.RV6();t.j41(0,"lg-button",3),t.bIt("click",function(){t.eBV(s);const p=t.XpG();return t.Njj(p.editCategory(p.value))}),t.EFF(1," Edit Category "),t.k0s()}}function b(g,x){if(1&g){const s=t.RV6();t.j41(0,"lg-button",3),t.bIt("click",function(){t.eBV(s);const p=t.XpG();return t.Njj(p.addCategory(p.value))}),t.EFF(1," Add Category "),t.k0s()}}let C=(()=>{class g{_categoryRepository;_selectResourcesService;_router;constructor(s,m,p){this._categoryRepository=s,this._selectResourcesService=m,this._router=p}form=new i.gE({name:new i.MJ("",i.k0.required)});uuid=(0,t.hFB)("");uuidEffect=(0,t.QZP)(()=>{this.uuid()&&this._categoryRepository.getOne(this.uuid(),s=>{this.form.reset(s),this.form.updateValueAndValidity()})});get value(){return this.form.value}ngOnInit(){}addCategory(s){this._categoryRepository.addCategory(s).then(()=>{this._router.navigate(["/categories"])})}editCategory(s){this._categoryRepository.editCategory(this.uuid(),s).then(()=>{this._router.navigate(["/categories"])})}static \u0275fac=function(m){return new(m||g)(t.rXU(d.P),t.rXU(a.n),t.rXU(u.Ix))};static \u0275cmp=t.VBU({type:g,selectors:[["lg-add-category-form"]],inputs:{uuid:[1,"uuid"]},features:[t.Jv_([{provide:a.n,useClass:a.n}])],decls:6,vars:3,consts:[[3,"formGroup"],["label","Name"],["formControlName","name",3,"placeholder"],[3,"click"]],template:function(m,p){1&m&&(t.j41(0,"form",0)(1,"lg-gap-column")(2,"lg-control",1),t.nrm(3,"lg-input",2),t.k0s(),t.DNE(4,y,2,0,"lg-button")(5,b,2,0,"lg-button"),t.k0s()()),2&m&&(t.Y8G("formGroup",p.form),t.R7$(3),t.Y8G("placeholder","Your category name"),t.R7$(),t.vxM(p.uuid()?4:5))},dependencies:[i.X1,i.qT,i.BC,i.cb,i.j4,i.JD,r.S,n.X,l.K,o.Q],encapsulation:2})}return g})();var S=e(7512);let D=(()=>{class g{_aRoute;constructor(s){this._aRoute=s}uuid=(0,t.vPA)("");ngOnInit(){this._aRoute.params.subscribe(s=>{this.uuid.set(s.uuid)})}static \u0275fac=function(m){return new(m||g)(t.rXU(u.nX))};static \u0275cmp=t.VBU({type:g,selectors:[["lg-add-category"]],decls:8,vars:8,consts:[[3,"center"],[3,"flat","link","size"],[3,"uuid"]],template:function(m,p){1&m&&(t.j41(0,"lg-container")(1,"lg-gap-row",0)(2,"lg-title"),t.EFF(3),t.k0s(),t.j41(4,"lg-button",1),t.EFF(5," Back to list "),t.k0s()(),t.j41(6,"lg-card"),t.nrm(7,"lg-add-category-form",2),t.k0s()()),2&m&&(t.R7$(),t.Y8G("center",!0),t.R7$(2),t.SpI("",p.uuid()?"Edit":"Add"," Category"),t.R7$(),t.Aen("warning"),t.Y8G("flat",!0)("link","/categories")("size","small"),t.R7$(3),t.Y8G("uuid",p.uuid()))},dependencies:[h.H,v.i,c.W,C,S.I,o.Q],encapsulation:2})}return g})()},5559:(_,f,e)=>{e.d(f,{Q:()=>v});var t=e(467),h=e(1007);let v=(()=>{class c{constructor(){}get _uuid(){return Math.random().toString(36).substring(2)+Date.now().toString(36)}openDb(r){return new Promise(function(){var n=(0,t.A)(function*(l,o){const a=yield window.indexedDB.open("lasagna-db",1);a.onerror=d=>{o(d)},a.onsuccess=d=>{r(d.target?.result)},a.onupgradeneeded=d=>{const u=d.target?.result;u.createObjectStore("productsStore",{keyPath:"uuid",autoIncrement:!0}).createIndex("name","name",{unique:!1}),u.createObjectStore("recipesStore",{keyPath:"uuid",autoIncrement:!0}).createIndex("name","name",{unique:!1}),u.createObjectStore("categoryStore",{keyPath:"uuid",autoIncrement:!0}).createIndex("name","name",{unique:!1})},l()});return function(l,o){return n.apply(this,arguments)}}())}addData(r,n){this.openDb(l=>{l.transaction(r,"readwrite").objectStore(r).add({...n,uuid:this._uuid})})}replaceData(r,n,l){this.openDb(o=>{o.transaction(r,"readwrite").objectStore(r).put({...l,uuid:n})})}getOne(r,n,l){this.openDb(o=>{o.transaction(r,"readonly").objectStore(r).get(n).onsuccess=y=>{l(y.target.result)}})}static \u0275fac=function(n){return new(n||c)};static \u0275prov=h.jDH({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})()},7504:(_,f,e)=>{e.d(f,{X:()=>c});var t=e(1007);const h=[[["beforeLabelTpl"]],[["labelTpl"]],[["afterLabelTpl"]],[["endLabelTpl"]],"*"],v=["beforeLabelTpl","labelTpl","afterLabelTpl","endLabelTpl","*"];let c=(()=>{class i{constructor(){}label=(0,t.hFB)("");static \u0275fac=function(l){return new(l||i)};static \u0275cmp=t.VBU({type:i,selectors:[["lg-control"]],inputs:{label:[1,"label"]},ngContentSelectors:v,decls:11,vars:1,consts:[[1,"control"],[1,"control__label"],[1,"control__label-string"],[1,"control__label-end"],[1,"control__content"]],template:function(l,o){1&l&&(t.NAR(h),t.j41(0,"div",0)(1,"label",1),t.SdG(2),t.j41(3,"span",2),t.SdG(4,1),t.EFF(5),t.k0s(),t.SdG(6,2),t.j41(7,"div",3),t.SdG(8,3),t.k0s()(),t.j41(9,"div",4),t.SdG(10,4),t.k0s()()),2&l&&(t.R7$(5),t.SpI(" ",o.label()," "))},styles:[".control{display:flex;flex-direction:column;gap:8px}.control__label{font-size:.9rem;display:flex;align-items:flex-end;gap:8px}.control__label-end{display:flex;align-items:flex-end;gap:8px;margin-left:auto}.control__content{display:flex}\n"],encapsulation:2})}return i})()}}]);