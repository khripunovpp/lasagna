import{a as W,b as X,c as Y,d as tt}from"./chunk-4TGB4FSH.js";import{a as H,b as J}from"./chunk-PVSGR3WZ.js";import{a as q}from"./chunk-TG44ZCI4.js";import{a as Q}from"./chunk-X6AQQZRC.js";import{a as Z}from"./chunk-QC6HSGGS.js";import"./chunk-HLUOBQIS.js";import{a as I,b as A,c as B}from"./chunk-2H6ZB4B2.js";import"./chunk-K3OSNH4A.js";import"./chunk-3EENQPAB.js";import"./chunk-2XBDGHLZ.js";import"./chunk-BZLRTCBN.js";import{a as O,d as K}from"./chunk-T5OOR2YZ.js";import"./chunk-ZDTDYXDD.js";import{a as G}from"./chunk-TTH7B7VT.js";import{a as U,c as V}from"./chunk-XRFFTXPM.js";import{Ca as s,Da as u,Ea as b,Ga as g,Ha as P,Ia as r,Ja as o,Ka as h,Oa as k,Pa as v,Pb as $,Qa as p,Qb as z,U as w,V as E,Z as R,Zb as M,ab as a,ac as j,bb as C,cb as m,db as S,f as L,ia as n,la as d,na as D,nb as y,ob as F,pb as N,ra as x,wa as l,za as f}from"./chunk-FL5UAJ26.js";var nt=(e,i)=>i.value==null?null:i.value.category;function ot(e,i){if(e&1&&(r(0,"span"),a(1),o()),e&2){let t=p(2).$implicit;n(),m("from ",t.source)}}function rt(e,i){if(e&1&&(r(0,"span"),a(1),o(),r(2,"span"),a(3),o(),s(4,ot,2,1,"span")),e&2){let t=p().$implicit;n(),C(t.name),n(2),S("",t.amount,"gr for ",t.price),n(),u(t.source?4:-1)}}function at(e,i){if(e&1&&(r(0,"span"),a(1),o()),e&2){let t=p(2).$implicit;n(),m("from ",t==null?null:t.source)}}function lt(e,i){if(e&1&&(r(0,"span"),a(1),o(),r(2,"span"),a(3),o(),s(4,at,2,1,"span")),e&2){let t=p().$implicit;n(),C(t==null?null:t.name),n(2),S("",t==null?null:t.amount," gr for ",t==null?null:t.price),n(),u(t!=null&&t.source?4:-1)}}function ct(e,i){if(e&1&&s(0,rt,5,4)(1,lt,5,4),e&2){let t=i.flow;u(t==="new"?0:1)}}function pt(e,i){e&1&&a(0," per gram ")}function mt(e,i){if(e&1&&a(0),e&2){let t=p(2).$implicit;m(" per ",t.unit," ")}}function dt(e,i){if(e&1){let t=k();r(0,"lg-gap-row",0)(1,"div",7)(2,"lg-gap-row",0)(3,"div",8)(4,"a",9),a(5),o()(),r(6,"div",10),a(7),o(),r(8,"div",11),a(9),y(10,"number"),s(11,pt,1,0)(12,mt,1,1),o()()(),r(13,"lg-button",12),v("click",function(){w(t);let _=p().$implicit,T=p(3);return E(T.deleteProduct(_))}),h(14,"mat-icon",13),o()()}if(e&2){let t=p().$implicit,c=p(3);l("center",!0),n(2),l("center",!0),n(2),l("routerLink","/products/edit/"+t.uuid),n(),C(t.name),n(2),m(" ",t.source??""),n(2),m(" ",N(10,11,c.getPricePerGram(t),"1.2-5")," "),n(2),u(!t.unit||t.unit==="gram"?11:12),n(2),f("danger"),l("size","small")("icon",!0)}}function st(e,i){e&1&&x(0,dt,15,14,"ng-template",6)}function ut(e,i){if(e&1&&(r(0,"lg-title",5),a(1),o(),r(2,"lg-card-list"),g(3,st,1,0,null,6,b),o()),e&2){let t=i;l("level",3),n(),m(" ",t.category||"Uncategorized"," "),n(2),P(t.products)}}function _t(e,i){if(e&1&&s(0,ut,5,2),e&2){let t,c=i.$implicit;u((t=c.value)?0:-1,t)}}function ft(e,i){e&1&&(r(0,"lg-gap-row",0)(1,"lg-title",5),a(2," No products found "),o()()),e&2&&(l("center",!0),n(),l("level",5))}var et=class e{constructor(i,t,c,_,T){this._productsRepository=i;this._csvReaderService=t;this._transferDataService=c;this._activatedRoute=_;this._notificationsService=T;this._activatedRoute.data.pipe(Q()).subscribe(it=>{this.products.set(it.list)})}products=R([]);ProductDbInputScheme=A;Stores=O;getPricePerGram(i){return(I(i.price)||1)/(I(i.amount)||1)}exportProducts(){this._transferDataService.exportTable("productsStore","json")}deleteProduct(i){i.uuid&&this._productsRepository.deleteProduct(i.uuid).then(()=>{this._notificationsService.success("Product deleted"),this.loadProducts()})}ngOnInit(){return L(this,null,function*(){yield this.loadProducts()})}loadProducts(){}static \u0275fac=function(t){return new(t||e)(d(B),d(X),d(tt),d(M),d(Z))};static \u0275cmp=D({type:e,selectors:[["lg-product-list"]],decls:14,vars:15,consts:[[3,"center"],[3,"flat","link","size"],[3,"click","flat","size"],[3,"onDone","schema","storeName"],["lgImportRowTpl",""],[3,"level"],["lgCardListItem",""],[1,"expand"],[2,"flex","20%"],[3,"routerLink"],[2,"flex","10%"],[2,"flex","70%"],[3,"click","size","icon"],["aria-hidden","false","aria-label","Example home icon","fontIcon","close"]],template:function(t,c){t&1&&(r(0,"lg-container")(1,"lg-title"),a(2," Products "),o(),r(3,"lg-gap-row",0)(4,"lg-button",1),a(5," Add "),o(),r(6,"lg-button",2),v("click",function(){return c.exportProducts()}),a(7," Export "),o(),r(8,"lg-import",3),v("onDone",function(){return c.loadProducts()}),x(9,ct,2,1,"ng-template",4),o()(),g(10,_t,1,1,null,null,nt,!1,ft,3,2,"lg-gap-row",0),y(13,"keyvalue"),o()),t&2&&(n(3),l("center",!0),n(),f("primary"),l("flat",!0)("link","/products/add")("size","small"),n(2),f("info"),l("flat",!0)("size","small"),n(2),l("schema",c.ProductDbInputScheme)("storeName",c.Stores.PRODUCTS),n(2),P(F(13,13,c.products())))},dependencies:[G,K,q,U,V,z,J,H,Y,j,$,W],styles:["[_nghost-%COMP%]{display:block}"]})};export{et as ProductListComponent};
