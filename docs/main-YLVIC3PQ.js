import{a as ke,b as Re}from"./chunk-IZB2NYUU.js";import{a as M}from"./chunk-MILTATWE.js";import{a as we}from"./chunk-DJF77PYH.js";import{a as Ee}from"./chunk-DA2HX24K.js";import{b as Se}from"./chunk-FXU5CNHZ.js";import"./chunk-B3EIBHPV.js";import{a as ye}from"./chunk-42PC7HUI.js";import"./chunk-C2HXCXZW.js";import"./chunk-ZUL4ERHZ.js";import{d as V}from"./chunk-O7XKGAI7.js";import{$ as U,$a as ie,$b as ge,D as g,Db as le,Ea as J,Fa as X,Gb as de,I as k,Ia as ee,Ja as te,Ka as p,La as c,Ma as u,N as j,P as Z,Q as W,Qa as ne,R as a,Ra as oe,S as Q,Sa as re,Ub as ue,V as $,W as q,Wb as me,Y as G,Yb as fe,Zb as he,a as K,ab as se,bc as ve,cb as O,cc as Ce,dc as be,eb as ae,f as d,ga as Y,i as A,j as P,jb as pe,ka as v,kb as l,pa as C,r as y,ub as ce,va as _,wa as B,x as h,y as N,ya as R}from"./chunk-2LMMMB25.js";var H=(e,n)=>d(void 0,null,function*(){let t=e.paramMap.get("uuid");return a(M)?.getOne(t)});var xe=(e,n)=>d(void 0,null,function*(){let t=e.paramMap.get("uuid");return a(ke)?.calculateRecipe(t)});var Ae=(e,n)=>d(void 0,null,function*(){let t=e.paramMap.get("uuid"),r=a(M),o=a(Re),i=(yield r.getOne(t))?.taxTemplateName;return i?o.getTemplateByName("tax",i):null});var Pe=[{path:"",children:[{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",loadComponent:()=>import("./chunk-BBMMOO4H.js").then(e=>e.ApplicationComponent)},{path:"recipes",children:[{path:"",loadComponent:()=>import("./chunk-KS4T6A5G.js").then(e=>e.RecipesListComponent)},{path:"add",loadComponent:()=>import("./chunk-RNKFLRYH.js").then(e=>e.AddRecipeComponent)},{path:"edit/:uuid",loadComponent:()=>import("./chunk-RNKFLRYH.js").then(e=>e.AddRecipeComponent),resolve:{recipe:H}},{path:"calculate/:uuid",loadComponent:()=>import("./chunk-VXNY25WG.js").then(e=>e.CalculateRecipeComponent),resolve:{result:xe,template:Ae}}]},{path:"products",children:[{path:"",loadComponent:()=>import("./chunk-LG5R3D2H.js").then(e=>e.ProductListComponent)},{path:"add",loadComponent:()=>import("./chunk-GZUV7XJ5.js").then(e=>e.AddProductComponent)},{path:"edit/:uuid",loadComponent:()=>import("./chunk-GZUV7XJ5.js").then(e=>e.AddProductComponent),resolve:{product:H}}]},{path:"settings",children:[{path:"",loadComponent:()=>import("./chunk-3TY3S5QS.js").then(e=>e.SettingsComponent)},{path:"categories",children:[{path:"products",children:[{path:"",loadComponent:()=>import("./chunk-G2B3BGIR.js").then(e=>e.CategoryListComponent)},{path:"add",loadComponent:()=>import("./chunk-55BI7DP2.js").then(e=>e.AddCategoryComponent)},{path:"edit/:uuid",loadComponent:()=>import("./chunk-55BI7DP2.js").then(e=>e.AddCategoryComponent)}]},{path:"recipes",children:[{path:"",loadComponent:()=>import("./chunk-4XVYSU3N.js").then(e=>e.CategoryRecipeListComponent)},{path:"add",loadComponent:()=>import("./chunk-C6IVFDAJ.js").then(e=>e.AddCategoryRecipeComponent)},{path:"edit/:uuid",loadComponent:()=>import("./chunk-C6IVFDAJ.js").then(e=>e.AddCategoryRecipeComponent)}]}]}]},{path:"widgets",loadComponent:()=>import("./chunk-MKWIQLFZ.js").then(e=>e.WidgetsPageComponent)}]}];var E="Service workers are disabled or not supported by this browser",b=class{serviceWorker;worker;registration;events;constructor(n,t){if(this.serviceWorker=n,!n)this.worker=this.events=this.registration=new A(r=>r.error(new Error(E)));else{let r=null,o=new P;this.worker=new A(f=>(r!==null&&f.next(r),o.subscribe(x=>f.next(x))));let s=()=>{let{controller:f}=n;f!==null&&(r=f,o.next(r))};n.addEventListener("controllerchange",s),s(),this.registration=this.worker.pipe(k(()=>n.getRegistration()));let i=new P;this.events=i.asObservable();let m=f=>{let{data:x}=f;x?.type&&i.next(x)};n.addEventListener("message",m),t?.get(B,null,{optional:!0})?.onDestroy(()=>{n.removeEventListener("controllerchange",s),n.removeEventListener("message",m)})}}postMessage(n,t){return new Promise(r=>{this.worker.pipe(g(1)).subscribe(o=>{o.postMessage(K({action:n},t)),r()})})}postMessageWithOperation(n,t,r){let o=this.waitForOperationCompleted(r),s=this.postMessage(n,t);return Promise.all([s,o]).then(([,i])=>i)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(n){let t;return typeof n=="string"?t=r=>r.type===n:t=r=>n.includes(r.type),this.events.pipe(N(t))}nextEventOfType(n){return this.eventsOfType(n).pipe(g(1))}waitForOperationCompleted(n){return new Promise((t,r)=>{this.eventsOfType("OPERATION_COMPLETED").pipe(N(o=>o.nonce===n),g(1),y(o=>{if(o.result!==void 0)return o.result;throw new Error(o.error)})).subscribe({next:t,error:r})})}get isEnabled(){return!!this.serviceWorker}},Le=(()=>{class e{sw;messages;notificationClicks;subscription;get isEnabled(){return this.sw.isEnabled}pushManager=null;subscriptionChanges=new P;constructor(t){if(this.sw=t,!t.isEnabled){this.messages=h,this.notificationClicks=h,this.subscription=h;return}this.messages=this.sw.eventsOfType("PUSH").pipe(y(o=>o.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(y(o=>o.data)),this.pushManager=this.sw.registration.pipe(y(o=>o.pushManager));let r=this.pushManager.pipe(k(o=>o.getSubscription()));this.subscription=new A(o=>{let s=r.subscribe(o),i=this.subscriptionChanges.subscribe(o);return()=>{s.unsubscribe(),i.unsubscribe()}})}requestSubscription(t){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(E));let r={userVisibleOnly:!0},o=this.decodeBase64(t.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),s=new Uint8Array(new ArrayBuffer(o.length));for(let i=0;i<o.length;i++)s[i]=o.charCodeAt(i);return r.applicationServerKey=s,new Promise((i,m)=>{this.pushManager.pipe(k(w=>w.subscribe(r)),g(1)).subscribe({next:w=>{this.subscriptionChanges.next(w),i(w)},error:m})})}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(E));let t=r=>{if(r===null)throw new Error("Not subscribed to push notifications.");return r.unsubscribe().then(o=>{if(!o)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})};return new Promise((r,o)=>{this.subscription.pipe(g(1),k(t)).subscribe({next:r,error:o})})}decodeBase64(t){return atob(t)}static \u0275fac=function(r){return new(r||e)(W(b))};static \u0275prov=j({token:e,factory:e.\u0275fac})}return e})(),De=(()=>{class e{sw;versionUpdates;unrecoverable;get isEnabled(){return this.sw.isEnabled}constructor(t){if(this.sw=t,!t.isEnabled){this.versionUpdates=h,this.unrecoverable=h;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(E));let t=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:t},t)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(E));let t=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:t},t)}static \u0275fac=function(r){return new(r||e)(W(b))};static \u0275prov=j({token:e,factory:e.\u0275fac})}return e})();var Oe=new Z("");function Fe(){let e=a(S);if(!("serviceWorker"in navigator&&e.enabled!==!1))return;let n=a(Oe),t=a(Y),r=a(B);t.runOutsideAngular(()=>{let o=navigator.serviceWorker,s=()=>o.controller?.postMessage({action:"INITIALIZE"});o.addEventListener("controllerchange",s),r.onDestroy(()=>{o.removeEventListener("controllerchange",s)})}),t.runOutsideAngular(()=>{let o,{registrationStrategy:s}=e;if(typeof s=="function")o=new Promise(i=>s().subscribe(()=>i()));else{let[i,...m]=(s||"registerWhenStable:30000").split(":");switch(i){case"registerImmediately":o=Promise.resolve();break;case"registerWithDelay":o=_e(+m[0]||0);break;case"registerWhenStable":o=Promise.race([r.whenStable(),_e(+m[0])]);break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${e.registrationStrategy}`)}}o.then(()=>navigator.serviceWorker.register(n,{scope:e.scope}).catch(i=>console.error("Service worker registration failed with:",i)))})}function _e(e){return new Promise(n=>setTimeout(n,e))}function Ne(e,n){return new b(e.enabled!==!1?navigator.serviceWorker:void 0,n)}var S=class{enabled;scope;registrationStrategy};function Me(e,n={}){return Q([Le,De,{provide:Oe,useValue:e},{provide:S,useValue:n},{provide:b,useFactory:Ne,deps:[S,G]},_(Fe)])}var Ie={providers:[ce({eventCoalescing:!0}),be(Pe),he(fe()),Se(),me(),_(()=>{let e=a(ye),n=a(we);return Promise.all([e.preloadCategories(),n.preloadCategories()])}),Me("ngsw-worker.js",{enabled:!de(),registrationStrategy:"registerWhenStable:30000"})]};function je(e,n){if(e&1){let t=ne();p(0,"button",0),oe("click",function(){$(t);let o=re();return q(o.installPWA())}),O(1,"\u0423\u0441\u0442\u0430\u043D\u043E\u0432\u0438\u0442\u044C PWA"),c()}}var I=class e{deferredPrompt=null;showButton=!1;ngOnInit(){window.addEventListener("beforeinstallprompt",n=>{n.preventDefault(),this.deferredPrompt=n,this.showButton=!0})}installPWA(){return d(this,null,function*(){if(!this.deferredPrompt)return;this.deferredPrompt.prompt();let{outcome:n}=yield this.deferredPrompt.userChoice;n==="accepted"?(this.showButton=!1,console.log("PWA \u0443\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D\u0430!")):console.log("\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C \u043E\u0442\u043A\u0430\u0437\u0430\u043B\u0441\u044F \u043E\u0442 \u0443\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0438"),this.deferredPrompt=null,this.showButton=!1})}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=C({type:e,selectors:[["lg-pwa-install"]],decls:1,vars:1,consts:[[3,"click"]],template:function(t,r){t&1&&J(0,je,2,0,"button"),t&2&&X(r.showButton?0:-1)},styles:["lg-pwa-install[_ngcontent-%COMP%]{display:flex}button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;padding:10px 20px;cursor:pointer;width:100%}button[_ngcontent-%COMP%]:hover{background-color:#0056b3}"]})};var T=()=>({exact:!1}),L=()=>["route-active"],We=(e,n)=>n.label;function Ue(e,n){if(e&1&&(p(0,"a",4),O(1),c()),e&2){let t=n.$implicit;R("routerLink",t.link)("routerLinkActive",l(4,L))("routerLinkActiveOptions",l(5,T)),v(),ae(" ",t.label," ")}}var D=class e{constructor(){}items=U([{label:"Recipes",link:"/recipes"},{label:"Products",link:"/products"}]);activeIndex=U(0);links=le(V);setActive(n){this.activeIndex.set(n)}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=C({type:e,selectors:[["lg-header"]],viewQuery:function(t,r){t&1&&ie(r.links,V,5),t&2&&se()},decls:10,vars:15,consts:[[1,"lg-header"],[1,"lg-header__icon",3,"routerLinkActiveOptions","routerLinkActive","routerLink"],["aria-hidden","false","fontIcon","home"],[1,"lg-header__inner"],[1,"lg-header__link",3,"routerLink","routerLinkActive","routerLinkActiveOptions"],["aria-hidden","false","fontIcon","settings"],["aria-hidden","false","fontIcon","widgets"]],template:function(t,r){t&1&&(p(0,"header",0)(1,"a",1),u(2,"mat-icon",2),c(),p(3,"div",3),ee(4,Ue,2,6,"a",4,We),c(),p(6,"a",1),u(7,"mat-icon",5),c(),p(8,"a",1),u(9,"mat-icon",6),c()()),t&2&&(v(),R("routerLinkActiveOptions",l(9,T))("routerLinkActive",l(10,L))("routerLink","/home"),v(3),te(r.items()),v(2),R("routerLinkActiveOptions",l(11,T))("routerLinkActive",l(12,L))("routerLink","/settings"),v(2),R("routerLinkActiveOptions",l(13,T))("routerLinkActive",l(14,L))("routerLink","/widgets"))},dependencies:[ve,Ce,Ee],styles:[".lg-header[_ngcontent-%COMP%]{position:fixed;z-index:3;height:var(--header-height);left:0;right:0;top:12px;display:flex;align-items:center;justify-content:center;gap:16px;overflow-x:auto;white-space:nowrap;padding:0 16px}@media (max-width: 768px){.lg-header[_ngcontent-%COMP%]{justify-content:normal;scroll-snap-type:both mandatory;overscroll-behavior-x:contain;scrollbar-width:none}}.lg-header__inner[_ngcontent-%COMP%]{display:flex;border-radius:35px;padding:8px;-webkit-backdrop-filter:blur(3px);backdrop-filter:blur(3px);background-color:#ffffffb3}.lg-header__link[_ngcontent-%COMP%]{font-size:1rem;font-family:inherit;text-decoration:none;padding:8px 24px;border-radius:32px;cursor:pointer;display:flex;align-items:center;justify-content:center;scroll-snap-align:center}.lg-header__link.route-active[_ngcontent-%COMP%]{background-color:#a26dc7;color:#fff}.lg-header__icon[_ngcontent-%COMP%]{border-radius:50%;display:flex;align-items:center;justify-content:center;padding:8px;cursor:pointer;scroll-snap-align:center;-webkit-backdrop-filter:blur(3px);backdrop-filter:blur(3px);background-color:#ffffffb3}.lg-header__icon.route-active[_ngcontent-%COMP%]{background-color:#a26dc7;color:#fff}"]})};var F=class e{title="lasagna";static \u0275fac=function(t){return new(t||e)};static \u0275cmp=C({type:e,selectors:[["app-root"]],features:[pe([])],decls:5,vars:0,consts:[[1,"app"],[1,"app-content"]],template:function(t,r){t&1&&(u(0,"lg-pwa-install"),p(1,"main",0),u(2,"lg-header"),p(3,"div",1),u(4,"router-outlet"),c()())},dependencies:[ge,I,D],styles:[".app-content[_ngcontent-%COMP%]{padding-top:calc(var(--header-height) + 44px);padding-bottom:32px}"]})};ue(F,Ie).catch(e=>console.error(e));
