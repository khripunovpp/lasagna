import{a as ae}from"./chunk-6FM27WYZ.js";import{a as ie}from"./chunk-GSKV4P7T.js";import{a as ne}from"./chunk-NVH3CQSE.js";import{a as v}from"./chunk-3DMBXY5D.js";import{a as Z}from"./chunk-DVR7LJI2.js";import{a as ee}from"./chunk-HJDHJOR3.js";import{a as re}from"./chunk-KLASXVLN.js";import{a as te,c as oe}from"./chunk-BR5PE5ST.js";import{v as Y}from"./chunk-4JACCPQC.js";import{a as L}from"./chunk-TKRM7P4A.js";import{a as Q}from"./chunk-H7PEEFRQ.js";import{C as B,D as H,E as y,G as m,L as O,M as W,N as j,O as z,Q as U,R as q,S as J,U as K,W as X,g as E,o as $,s as P}from"./chunk-3EK7W3Q2.js";import{$a as r,Db as S,Fb as k,Ib as b,Jb as A,Kb as n,Lb as a,Mb as c,Mc as M,Nb as w,Nc as I,Ob as N,Pb as R,Rb as D,Vb as l,Wb as u,eb as C,fc as V,gc as G,hc as f,jc as _,la as x,lb as F,ma as d,nb as T,va as h}from"./chunk-TMZLFVGH.js";var g=class o{constructor(){}selfAlign="center";static \u0275fac=function(t){return new(t||o)};static \u0275dir=T({type:o,selectors:[["","lgSelfCenter",""]],hostVars:2,hostBindings:function(t,i){t&2&&V("align-self",i.selfAlign)}})};var ce=(o,e)=>e.name+e.uuid;function le(o,e){if(o&1){let t=D();a(0,"section",2)(1,"div",5)(2,"lg-flex-row",6),w(3,"lg-input",7)(4,"lg-textarea",8),a(5,"lg-checkbox",9),l("onCheckboxChanged",function(){let s=x(t).$index,p=u();return d(p.onTaxValueChange(s))}),c(),a(6,"lg-number-input",10),l("onInputChange",function(){let s=x(t).$index,p=u();return d(p.onTaxValueChange(s))}),c(),a(7,"lg-button",11),l("click",function(){let s=x(t).$index,p=u();return d(p.deleteTxRow(s))}),w(8,"mat-icon",12),c()()()()}if(o&2){let t=e.$index;u().taxesForm.controls.rows.controls[t],n("formGroupName",t),r(),G("taxes__row--odd",t%2!==0),r(),n("top",!0)("fit",!0),r(),n("placeholder","Name"),r(),n("rows",3)("placeholder","Description"),r(),n("customMark","%"),r(),n("placeholder","Value"),r(),f("danger"),n("size","tiny")("icon",!0)}}function pe(o,e){o&1&&_(0," Save changes ")}function ue(o,e){o&1&&_(0," No changes ")}var se=class o{constructor(e,t){this._taxesRepository=e;this._notificationService=t}taxes=h([]);rows=M(()=>this.taxes().map(e=>v.fromRaw(e)));taxesForm=new y({rows:new U([this._getRowGroup()])});rowsEffect=I(()=>{this._rowsFormArray.clear(),this.rows().forEach((e,t)=>{this._rowsFormArray.push(this._getRowGroup(e))}),this.taxesForm.updateValueAndValidity(),this.taxesForm.markAsPristine()});totalTaxes=h(0);formValues=this.taxesForm.valueChanges.pipe($());get _rowsFormArray(){return this.taxesForm.get("rows")}ngOnInit(){this._taxesRepository.getAll().then(e=>{this.taxes.set(e)})}onTaxValueChange(e){}deleteTxRow(e){let t=this.taxesForm.value.rows?.[e]?.uuid;this._rowsFormArray.removeAt(e),this.taxesForm.markAsDirty(),t&&this._taxesRepository.deleteOne(t)}addTaxRow(){this._rowsFormArray.push(this._getRowGroup()),this.taxesForm.markAsDirty()}async saveTaxes(){try{let e=this.taxesForm.value.rows?.map(t=>v.fromRaw(P(t)))??[];await this._taxesRepository.addMany(e),this._notificationService.success("Taxes saved successfully"),this.taxesForm.markAsPristine()}catch(e){this._notificationService.error(E(e))}}_getRowGroup(e){return new y({name:new m(e?.name||""),description:new m(e?.description||""),value:new m(e?.amount||0),amount:new m(0),percentage:new m(e?.percentage||!1),uuid:new m(e?.uuid||"")})}static \u0275fac=function(t){return new(t||o)(C(ae),C(K))};static \u0275cmp=F({type:o,selectors:[["lg-taxes-settings"]],decls:11,vars:7,consts:[[3,"formGroup"],["formArrayName","rows"],[1,"taxes",3,"formGroupName"],["lgSelfCenter","","lgShrink","",3,"click","disabled"],["lgSelfCenter","","lgShrink","",3,"click"],[1,"taxes__row"],[3,"top","fit"],["formControlName","name","lgWidth","35%",3,"placeholder"],["lgWidth","35%","formControlName","description",3,"rows","placeholder"],["lgShrink","","formControlName","percentage",3,"onCheckboxChanged","customMark"],["lgParseMath","","formControlName","value",3,"onInputChange","placeholder"],["lgShrink","",3,"click","size","icon"],["aria-hidden","false","aria-label","Example home icon","fontIcon","close"]],template:function(t,i){t&1&&(a(0,"lg-flex-column"),N(1,0)(2,1),b(3,le,9,14,"section",2,ce),R()(),a(5,"lg-flex-row")(6,"lg-button",3),l("click",function(){return i.saveTaxes()}),S(7,pe,1,0)(8,ue,1,0),c(),a(9,"lg-button",4),l("click",function(){return i.addTaxRow()}),_(10," Add tax "),c()()()),t&2&&(r(),n("formGroup",i.taxesForm),r(2),A(i.taxes()),r(3),f("success"),n("disabled",!i.taxesForm.dirty),r(),k(i.taxesForm.dirty?7:8),r(2),f("warning"))},dependencies:[Q,Z,q,B,H,X,ne,Y,te,oe,J,O,z,W,j,g,re,ee,ie,L],encapsulation:2})};export{g as a,se as b};
