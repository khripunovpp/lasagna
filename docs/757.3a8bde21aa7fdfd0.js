"use strict";(self.webpackChunklasagna=self.webpackChunklasagna||[]).push([[757],{8757:(J,p,s)=>{s.r(p),s.d(p,{AddProductComponent:()=>Y});var t=s(1007),C=s(5642),_=s(553),v=s(1086),r=s(9417),b=s(3333),y=s(7504),P=s(7782),g=s(1119),a=s(416),k=s(8456),m=s(8536),x=s(9895);const R=["*",[["content"]]],F=["*","content"];function A(n,c){1&n&&(t.j41(0,"div",3),t.SdG(1,1),t.k0s())}let j=(()=>{class n{constructor(){}displayed=(0,t.vPA)(!1);onClick(e){e.target instanceof HTMLElement&&(e.target.closest(".tooltip")||this.displayed.set(!1))}static \u0275fac=function(o){return new(o||n)};static \u0275cmp=t.VBU({type:n,selectors:[["lg-tooltip"]],hostBindings:function(o,i){1&o&&t.bIt("click",function(u){return i.onClick(u)},!1,t.EBC)},ngContentSelectors:F,decls:5,vars:1,consts:[[1,"tooltip"],[1,"tooltip__anchor"],[3,"click"],[1,"tooltip__content"]],template:function(o,i){1&o&&(t.NAR(R),t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.bIt("click",function(){return i.displayed.set(!i.displayed())}),t.SdG(3),t.k0s(),t.DNE(4,A,2,0,"div",3),t.k0s()()),2&o&&(t.R7$(4),t.vxM(i.displayed()?4:-1))},styles:[".tooltip[_ngcontent-%COMP%]{position:relative;display:inline-block}.tooltip__anchor[_ngcontent-%COMP%]{position:relative}.tooltip__content[_ngcontent-%COMP%]{position:absolute;bottom:50%;right:calc(100% + 16px);transform:translateY(50%);background-color:#fff;border-radius:16px;padding:16px;box-shadow:0 4px 8px #0000001a;z-index:100}"]})}return n})();var T=s(8710);function M(n,c){if(1&n){const e=t.RV6();t.j41(0,"div",3)(1,"lg-eggs-widget",4),t.bIt("changed",function(i){t.eBV(e);const l=t.XpG();return t.Njj(l.onEggsChanged(i))}),t.k0s()()}}let G=(()=>{class n{constructor(){}eggsChanged=(0,t.CGW)();selectedWidget=(0,t.vPA)(null);onWidgetSelect(e){this.selectedWidget.set(e)}onEggsChanged(e){e&&this.eggsChanged.emit(e)}static \u0275fac=function(o){return new(o||n)};static \u0275cmp=t.VBU({type:n,selectors:[["lg-amount-widgets"]],outputs:{eggsChanged:"eggsChanged"},decls:5,vars:3,consts:[[1,"amount-widgets"],[1,"amount-widgets__buttons"],[1,"amount-widgets__button",3,"click"],[1,"amount-widgets__wrapper"],[3,"changed"]],template:function(o,i){1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"button",2),t.bIt("click",function(){return i.onWidgetSelect("eggs")}),t.EFF(3,"Eggs "),t.k0s()(),t.DNE(4,M,2,0,"div",3),t.k0s()),2&o&&(t.AVh("selected",null!=i.selectedWidget()),t.R7$(4),t.vxM("eggs"===i.selectedWidget()?4:-1))},dependencies:[T.e],styles:[".amount-widgets[_ngcontent-%COMP%]{display:flex;gap:16px;flex-direction:column}.amount-widgets__input[_ngcontent-%COMP%]{flex:1}.amount-widgets__buttons[_ngcontent-%COMP%]{display:flex;gap:16px;flex-wrap:wrap;padding:16px;background-color:#fafafa;border-radius:12px;margin:-16px}.amount-widgets.selected[_ngcontent-%COMP%]   .amount-widgets__buttons[_ngcontent-%COMP%]{margin-bottom:0}.amount-widgets__button[_ngcontent-%COMP%]{display:flex;padding:8px 16px;border-radius:16px;background-color:#e5de38;appearance:none;border:none;font-family:inherit;font-size:inherit}"]})}return n})();var I=s(7480),f=s(7512),V=s(5130),$=s(9170);function w(n,c){if(1&n){const e=t.RV6();t.j41(0,"span",2),t.bIt("click",function(){const i=t.eBV(e).$implicit,l=t.XpG();return t.Njj(l.onSelect(i))}),t.EFF(1),t.k0s()}if(2&n){const e=c.$implicit,o=c.$index,i=c.$count,l=t.XpG();t.AVh("selected",e.value===l.value),t.BMQ("data-last",o===i-1||null),t.R7$(),t.SpI(" ",e.label," ")}}let S=(()=>{class n{constructor(){}control=(0,t.hFB)();items=[];onChangeFn;value;selectedItem;onSelect=e=>{this.applyValue(e.value)};registerOnChange(e){this.onChangeFn=e}registerOnTouched(e){}writeValue(e){this.applyValue(e)}applyValue(e){this.value=e,this.onChangeFn?.(e),this.control()?.writeValue(e)}ngOnInit(){}static \u0275fac=function(o){return new(o||n)};static \u0275cmp=t.VBU({type:n,selectors:[["lg-chips-list"]],inputs:{control:[1,"control"],items:"items"},features:[t.Jv_([{provide:r.kq,useExisting:(0,t.Rfq)(()=>n),multi:!0}])],decls:3,vars:0,consts:[[1,"chips-list"],[1,"chip",3,"selected"],[1,"chip",3,"click"]],template:function(o,i){1&o&&(t.j41(0,"div",0),t.Z7z(1,w,2,4,"span",1,t.fX1),t.k0s()),2&o&&(t.R7$(),t.Dyx(i.items))},styles:[".chips-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.chip[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;padding:4px 8px;border-radius:16px;font-size:.875rem;display:inline-block;cursor:pointer}.chip.selected[_ngcontent-%COMP%]{background-color:#0d59ab}"]})}return n})();var E=s(7201),h=s(1636);function B(n,c){if(1&n&&t.nrm(0,"lg-chips-list",17),2&n){const e=t.XpG(),o=t.sdS(19);t.Y8G("control",o)("items",e.topSources())}}function N(n,c){if(1&n&&t.nrm(0,"lg-chips-list",17),2&n){const e=t.XpG(),o=t.sdS(24);t.Y8G("control",o)("items",e.topCategories())}}function O(n,c){if(1&n){const e=t.RV6();t.j41(0,"lg-button",20),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.editProduct(i.value))}),t.EFF(1," Edit Product "),t.k0s()}}function W(n,c){if(1&n){const e=t.RV6();t.j41(0,"lg-button",20),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.addProduct(i.value))}),t.EFF(1," Add Product "),t.k0s()}}let X=(()=>{class n{_productsRepository;_selectResourcesService;_router;constructor(e,o,i){this._productsRepository=e,this._selectResourcesService=o,this._router=i}form=new r.gE({name:new r.MJ("",r.k0.required),amount:new r.MJ(null,r.k0.required),price:new r.MJ(null,r.k0.required),unit:new r.MJ("gram"),source:new r.MJ(""),category_id:new r.MJ(null,r.k0.required)});buttons=[{label:"Grams",value:"gram",style:"secondary",onClick:()=>{console.log("Grams")}},{label:"Pieces",value:"piece",style:"secondary",onClick:()=>{console.log("Piece")}}];uuid=(0,t.hFB)("");topCategories=(0,t.vPA)([]);topSources=(0,t.vPA)([]);uuidEffect=(0,t.QZP)(()=>{this.uuid()&&this._productsRepository.getOne(this.uuid()).then(e=>{this.form.reset(e)})});get value(){return this.form.value}eggsChanged(e){this.form.patchValue({amount:e})}ngOnInit(){this.form.valueChanges.subscribe(e=>{console.log(e)}),this._productsRepository.getTopCategories().then(e=>{this.topCategories.set(e.map(o=>({label:o.name,value:o.uuid})))}),this._productsRepository.getTopSources().then(e=>{this.topSources.set(e.map(o=>({label:o,value:o})))})}addProduct(e){this._productsRepository.addProduct((0,m.rh)(e)).then(()=>{this._router.navigate(["/products"])})}editProduct(e){this._productsRepository.editProduct(this.uuid(),(0,m.rh)(e)).then(()=>{this._router.navigate(["/products"])})}ngAfterViewInit(){this._selectResourcesService.load().then(e=>{})}static \u0275fac=function(o){return new(o||n)(t.rXU(E.d),t.rXU(a.n),t.rXU(h.Ix))};static \u0275cmp=t.VBU({type:n,selectors:[["lg-add-product-form"]],inputs:{uuid:[1,"uuid"]},features:[t.Jv_([{provide:a.n,useClass:a.n}])],decls:28,vars:12,consts:[["priceInput",""],["sourceInput",""],["categorySelect",""],[3,"formGroup"],["label","Name"],["formControlName","name",3,"placeholder"],[3,"bottom","mobileMode"],["label","Amount","lgExpand",""],["formControlName","amount","lgParseMath","",3,"onInputChange","placeholder"],["ngProjectAs","after",5,["after"]],["ngProjectAs","content",5,["content"]],[3,"eggsChanged"],["formControlName","unit",3,"items"],["label","Price"],["formControlName","price","lgParseMath","",3,"placeholder"],["label","Source"],["formControlName","source",3,"placeholder"],[3,"control","items"],["label","Category"],["formControlName","category_id",3,"resource"],[3,"click"]],template:function(o,i){if(1&o){const l=t.RV6();t.j41(0,"form",3)(1,"lg-gap-column")(2,"lg-control",4),t.nrm(3,"lg-input",5),t.k0s(),t.j41(4,"lg-gap-row",6)(5,"lg-control",7)(6,"lg-number-input",8),t.bIt("onInputChange",function(){t.eBV(l);const d=t.sdS(15);return t.Njj(d.focus())}),t.j41(7,"div",9)(8,"lg-tooltip"),t.EFF(9," Widgets "),t.j41(10,"div",10)(11,"lg-amount-widgets",11),t.bIt("eggsChanged",function(d){return t.eBV(l),t.Njj(i.eggsChanged(d))}),t.k0s()()()()()(),t.nrm(12,"lg-buttons-group",12),t.k0s(),t.j41(13,"lg-control",13),t.nrm(14,"lg-number-input",14,0),t.k0s(),t.j41(16,"lg-gap-column")(17,"lg-control",15),t.nrm(18,"lg-input",16,1),t.k0s(),t.DNE(20,B,1,2,"lg-chips-list",17),t.k0s(),t.j41(21,"lg-gap-column")(22,"lg-control",18),t.nrm(23,"lg-multiselect",19,2),t.k0s(),t.DNE(25,N,1,2,"lg-chips-list",17),t.k0s(),t.DNE(26,O,2,0,"lg-button")(27,W,2,0,"lg-button"),t.k0s()()}2&o&&(t.Y8G("formGroup",i.form),t.R7$(3),t.Y8G("placeholder","Your product name"),t.R7$(),t.Y8G("bottom",!0)("mobileMode",!0),t.R7$(2),t.Y8G("placeholder","In "+i.form.value.unit),t.R7$(6),t.Y8G("items",i.buttons),t.R7$(2),t.Y8G("placeholder","For the entire product in your currency"),t.R7$(4),t.Y8G("placeholder","Where do you buy it?"),t.R7$(2),t.vxM(i.topSources().length?20:-1),t.R7$(3),t.Y8G("resource","categories"),t.R7$(2),t.vxM(i.topCategories().length?25:-1),t.R7$(),t.vxM(i.uuid()?26:27))},dependencies:[r.X1,r.qT,r.BC,r.cb,r.j4,r.JD,b.S,y.X,P.K,g.Q,k.$,x.N,j,G,I.t,f.I,V.i,$.A,S],styles:["lg-eggs-widget{min-width:300px}\n"],encapsulation:2})}return n})(),Y=(()=>{class n{_aRoute;constructor(e){this._aRoute=e}uuid=(0,t.vPA)("");ngOnInit(){this._aRoute.params.subscribe(e=>{this.uuid.set(e.uuid)})}static \u0275fac=function(o){return new(o||n)(t.rXU(h.nX))};static \u0275cmp=t.VBU({type:n,selectors:[["app-add-recipe"]],decls:8,vars:8,consts:[[3,"center"],[3,"flat","link","size"],[3,"uuid"]],template:function(o,i){1&o&&(t.j41(0,"lg-container")(1,"lg-gap-row",0)(2,"lg-title"),t.EFF(3),t.k0s(),t.j41(4,"lg-button",1),t.EFF(5," Back to list "),t.k0s()(),t.j41(6,"lg-card"),t.nrm(7,"lg-add-product-form",2),t.k0s()()),2&o&&(t.R7$(),t.Y8G("center",!0),t.R7$(2),t.SpI("",i.uuid()?"Edit":"Add"," Product"),t.R7$(),t.Aen("warning"),t.Y8G("flat",!0)("link","/products")("size","small"),t.R7$(3),t.Y8G("uuid",i.uuid()))},dependencies:[C.H,_.i,v.W,X,g.Q,f.I],encapsulation:2})}return n})()}}]);