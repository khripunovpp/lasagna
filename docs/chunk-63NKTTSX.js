import{a as I}from"./chunk-EAJNJSEE.js";import{a as P}from"./chunk-XHO626AJ.js";import{a as W,c as X,d as Y,e as ee,f as te,g as oe}from"./chunk-3CXEBPFR.js";import{a as J,c as K}from"./chunk-OPWIYIGK.js";import{a as H}from"./chunk-65PCG7KQ.js";import{b as Q}from"./chunk-UKAU3626.js";import{a as ie}from"./chunk-ZBULITSO.js";import"./chunk-7JNSNANE.js";import{a as i}from"./chunk-RFEBMF6P.js";import"./chunk-Q24HNGKZ.js";import"./chunk-FG5PJ7WR.js";import{a as Z,d as q}from"./chunk-6CXN2K45.js";import"./chunk-E64ZE4KI.js";import{a as U}from"./chunk-5PVAHMKX.js";import{a as $,c as B}from"./chunk-PXM5XOY4.js";import{t as O,w as G}from"./chunk-JUGNCNLY.js";import{$b as x,Cb as A,Eb as w,Fb as h,Gb as c,Hb as l,Ib as N,Mb as v,Pb as R,Qb as d,W as F,Za as r,ac as m,bc as L,ca as M,cb as S,cc as j,ea as u,f as D,hb as V,la as f,ma as _,mb as T,r as k,ub as p,x as b,xb as g,z}from"./chunk-46OIECST.js";var ne=i.object({uuid:i.string().optional(),name:i.string().min(1).optional(),description:i.string().optional(),ingredients:i.array(i.object({name:i.string().min(1).optional(),uuid:i.string().optional(),amount:i.union([i.string(),i.number()]).optional(),product_id:i.string().optional(),recipe_id:i.string().optional(),unit:i.string().optional()})),outcome_amount:i.union([i.string(),i.number()]).optional(),outcome_unit:i.string().optional(),taxTemplateName:i.string().optional(),category_id:i.string().optional()});var re=new M("CategorizedRecipesList",{factory:()=>{let t=u(I),o=u(P);return k(t.loadRecipes()).pipe(F(()=>t.recipes$)).pipe(b(n=>n.toSorted((a,s)=>a.name.localeCompare(s.name))),b(n=>Y(n,"category_id")),z(n=>D(void 0,null,function*(){let a=[];for(let C in n){let E=n[C],ce=yield o.getOne(C);a.push({category:ce?.name,recipes:E})}if(!a.length)return[];let[s,...y]=a.toSorted((C,E)=>C.category>E.category?1:-1);return s?.category?[s].concat(y):y.concat([s])})))}});var le=(t,o)=>o==null?null:o.category;function ae(t,o){if(t&1&&(c(0,"span"),m(1),l()),t&2){let e=o.$implicit;r(),L(e==null?null:e.name)}}function se(t,o){if(t&1){let e=v();c(0,"lg-gap-row",5)(1,"div",9)(2,"a",10),m(3),l()(),c(4,"lg-button",11),m(5," Calculate "),l(),c(6,"lg-button",12),R("click",function(){f(e);let a=d().$implicit,s=d(2);return _(s.deleteRecipe(a))}),N(7,"mat-icon",13),l()()}if(t&2){let e=d().$implicit;p("center",!0),r(2),p("routerLink","/recipes/edit/"+e.uuid),r(),L(e.name),r(),g("primary"),p("size","small")("link","/recipes/calculate/"+e.uuid)("flat",!0),r(2),g("danger"),p("size","small")("icon",!0)}}function me(t,o){if(t&1&&T(0,se,8,12,"ng-template",8),t&2){let e=o.$implicit;p("uuid",e.uuid)}}function de(t,o){if(t&1){let e=v();c(0,"lg-title",6),m(1),l(),c(2,"lg-card-list",7),R("onSelected",function(a){f(e),d();let s=x(13);return _(s.putSelected(a))}),w(3,me,1,1,null,8,A),l()}if(t&2){let e=o.$implicit;d();let n=x(13);p("level",3),r(),j(" ",(e==null?null:e.category)||"Uncategorized"," "),r(),p("mode",n.selectionMode())("selectAll",n.selectAll())("deselectAll",n.deselectAll()),r(),h(e.recipes)}}function ue(t,o){t&1&&(c(0,"lg-gap-row",5)(1,"lg-title",6),m(2," No recipes found "),l()()),t&2&&(p("center",!0),r(),p("level",5))}var pe=class t{constructor(o,e,n){this._recipesRepository=o;this._notificationsService=e;this._transferDataService=n}recipes=Q(u(re));Stores=Z;RecipeDbInputScheme=ne;ngOnInit(){this.loadRecipes()}deleteRecipe(o){this._recipesRepository.deleteRecipe(o.uuid).then(()=>{this.loadRecipes(),this._notificationsService.success("Recipe deleted")})}loadRecipes(){this._recipesRepository.loadRecipes()}exportRecipes(o){this._transferDataService.exportTable("recipesStore","json",{selected:Array.from(o)})}static \u0275fac=function(e){return new(e||t)(S(I),S(ie),S(oe))};static \u0275cmp=V({type:t,selectors:[["lg-recipes-list"]],decls:17,vars:13,consts:[["selectionZone",""],[3,"flat","link","size"],[3,"click","flat","size"],[3,"onDone","schema","storeName"],["lgImportRowTpl",""],[3,"center"],[3,"level"],[3,"onSelected","mode","selectAll","deselectAll"],["lgCardListItem","",3,"uuid"],[1,"expand"],[3,"routerLink"],[3,"size","link","flat"],[3,"click","size","icon"],["aria-hidden","false","aria-label","Example home icon","fontIcon","close"]],template:function(e,n){if(e&1){let a=v();c(0,"lg-controls-bar")(1,"lg-button",1),m(2," Add "),l(),c(3,"lg-button",2),R("click",function(){f(a);let y=x(13);return _(n.exportRecipes(y.selected()))}),m(4," Export "),l(),c(5,"lg-import",3),R("onDone",function(){return f(a),_(n.loadRecipes())}),T(6,ae,2,1,"ng-template",4),l()(),c(7,"lg-fade-in")(8,"lg-container")(9,"lg-gap-row",5)(10,"lg-title"),m(11," Recipes "),l()(),c(12,"lg-selection-zone",null,0),w(14,de,5,5,null,null,le,!1,ue,3,2,"lg-gap-row",5),l()()()}e&2&&(r(),g("primary"),p("flat",!0)("link","/recipes/add")("size","small"),r(2),g("info"),p("flat",!0)("size","small"),r(2),p("schema",n.RecipeDbInputScheme)("storeName",n.Stores.RECIPES),r(4),p("center",!0),r(5),h(n.recipes()))},dependencies:[U,q,O,H,$,B,K,J,X,W,ee,G,te],styles:["[_nghost-%COMP%]{display:block}"]})};export{pe as RecipesListComponent};
