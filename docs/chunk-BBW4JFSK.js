import{a as I}from"./chunk-SODVWLEX.js";import{a as P}from"./chunk-R6LAS6PV.js";import{a as W,c as X,d as Y,e as ee,f as ie}from"./chunk-KFT4H3KY.js";import{a as J,c as K}from"./chunk-LT55FNNA.js";import{a as H}from"./chunk-7FCO3ACG.js";import{b as Q}from"./chunk-NVVJOV7R.js";import{a as te}from"./chunk-B4GE2TBC.js";import"./chunk-CEEQQY3I.js";import{a as i}from"./chunk-RKFCCI7E.js";import"./chunk-MQ26JLPX.js";import"./chunk-KPGIGGUF.js";import{a as Z,d as q}from"./chunk-OIUOAUKL.js";import"./chunk-FTNH4PRO.js";import{a as U}from"./chunk-PFLOR5BA.js";import{a as $,c as B}from"./chunk-42ANHTC5.js";import{s as O,v as G}from"./chunk-2WRE22FH.js";import{$b as L,Ab as A,Cb as w,Db as h,Eb as c,Fb as l,Gb as N,Kb as v,Nb as R,Ob as d,W as F,Xa as r,Zb as x,_b as m,ab as S,ac as j,ca as M,ea as u,f as D,fb as V,ka as f,kb as b,la as _,r as k,sb as p,vb as g,x as T,z}from"./chunk-7IKCFNVS.js";var oe=i.object({uuid:i.string().optional(),name:i.string().min(1).optional(),description:i.string().optional(),ingredients:i.array(i.object({name:i.string().min(1).optional(),uuid:i.string().optional(),amount:i.union([i.string(),i.number()]).optional(),product_id:i.string().optional(),recipe_id:i.string().optional(),unit:i.string().optional()})),outcome_amount:i.union([i.string(),i.number()]).optional(),outcome_unit:i.string().optional(),taxTemplateName:i.string().optional(),category_id:i.string().optional()});var ne=new M("CategorizedRecipesList",{factory:()=>{let t=u(I),o=u(P);return k(t.loadRecipes()).pipe(F(()=>t.recipes$)).pipe(T(n=>n.toSorted((a,s)=>a.name.localeCompare(s.name))),T(n=>Y(n,"category_id")),z(n=>D(void 0,null,function*(){let a=[];for(let C in n){let E=n[C],pe=yield o.getOne(C);a.push({category:pe?.name,recipes:E})}if(!a.length)return[];let[s,...y]=a.toSorted((C,E)=>C.category>E.category?1:-1);return s?.category?[s].concat(y):y.concat([s])})))}});var ce=(t,o)=>o==null?null:o.category;function le(t,o){if(t&1&&(c(0,"span"),m(1),l()),t&2){let e=o.$implicit;r(),L(e==null?null:e.name)}}function ae(t,o){if(t&1){let e=v();c(0,"lg-gap-row",1)(1,"div",9)(2,"a",10),m(3),l()(),c(4,"lg-button",11),m(5," Calculate "),l(),c(6,"lg-button",12),R("click",function(){f(e);let a=d().$implicit,s=d(2);return _(s.deleteRecipe(a))}),N(7,"mat-icon",13),l()()}if(t&2){let e=d().$implicit;p("center",!0),r(2),p("routerLink","/recipes/edit/"+e.uuid),r(),L(e.name),r(),g("primary"),p("size","small")("link","/recipes/calculate/"+e.uuid)("flat",!0),r(2),g("danger"),p("size","small")("icon",!0)}}function se(t,o){if(t&1&&b(0,ae,8,12,"ng-template",8),t&2){let e=o.$implicit;p("uuid",e.uuid)}}function me(t,o){if(t&1){let e=v();c(0,"lg-title",6),m(1),l(),c(2,"lg-card-list",7),R("onSelected",function(a){f(e),d();let s=x(12);return _(s.putSelected(a))}),w(3,se,1,1,null,8,A),l()}if(t&2){let e=o.$implicit;d();let n=x(12);p("level",3),r(),j(" ",(e==null?null:e.category)||"Uncategorized"," "),r(),p("mode",n.selectionMode())("selectAll",n.selectAll())("deselectAll",n.deselectAll()),r(),h(e.recipes)}}function de(t,o){t&1&&(c(0,"lg-gap-row",1)(1,"lg-title",6),m(2," No recipes found "),l()()),t&2&&(p("center",!0),r(),p("level",5))}var re=class t{constructor(o,e,n){this._recipesRepository=o;this._notificationsService=e;this._transferDataService=n}recipes=Q(u(ne));Stores=Z;RecipeDbInputScheme=oe;ngOnInit(){this.loadRecipes()}deleteRecipe(o){this._recipesRepository.deleteRecipe(o.uuid).then(()=>{this.loadRecipes(),this._notificationsService.success("Recipe deleted")})}loadRecipes(){this._recipesRepository.loadRecipes()}exportRecipes(o){this._transferDataService.exportTable("recipesStore","json",{selected:Array.from(o)})}static \u0275fac=function(e){return new(e||t)(S(I),S(te),S(ie))};static \u0275cmp=V({type:t,selectors:[["lg-recipes-list"]],decls:16,vars:13,consts:[["selectionZone",""],[3,"center"],[3,"flat","link","size"],[3,"click","flat","size"],[3,"onDone","schema","storeName"],["lgImportRowTpl",""],[3,"level"],[3,"onSelected","mode","selectAll","deselectAll"],["lgCardListItem","",3,"uuid"],[1,"expand"],[3,"routerLink"],[3,"size","link","flat"],[3,"click","size","icon"],["aria-hidden","false","aria-label","Example home icon","fontIcon","close"]],template:function(e,n){if(e&1){let a=v();c(0,"lg-fade-in")(1,"lg-container")(2,"lg-gap-row",1)(3,"lg-title"),m(4," Recipes "),l(),c(5,"lg-button",2),m(6," Add "),l(),c(7,"lg-button",3),R("click",function(){f(a);let y=x(12);return _(n.exportRecipes(y.selected()))}),m(8," Export "),l(),c(9,"lg-import",4),R("onDone",function(){return f(a),_(n.loadRecipes())}),b(10,le,2,1,"ng-template",5),l()(),c(11,"lg-selection-zone",null,0),w(13,me,5,5,null,null,ce,!1,de,3,2,"lg-gap-row",1),l()()()}e&2&&(r(2),p("center",!0),r(3),g("primary"),p("flat",!0)("link","/recipes/add")("size","small"),r(2),g("info"),p("flat",!0)("size","small"),r(2),p("schema",n.RecipeDbInputScheme)("storeName",n.Stores.RECIPES),r(4),h(n.recipes()))},dependencies:[U,q,O,H,$,B,K,J,X,W,ee,G],styles:["[_nghost-%COMP%]{display:block}"]})};export{re as RecipesListComponent};
