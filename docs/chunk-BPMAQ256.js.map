{
  "version": 3,
  "sources": ["src/app/features/documentation/service/docs.service.ts"],
  "sourcesContent": ["import {DocFile, SharedDocLoaderService, TreeNode} from \"./docs-loader.service\";\nimport {Stores} from '../../../shared/service/db/const/stores';\nimport {BehaviorSubject} from 'rxjs';\nimport {inject, Injectable} from \"@angular/core\";\nimport {USER_LANGUAGE} from '../../settings/service/providers/user-language.token';\n\n@Injectable({providedIn: 'root'})\nexport class DocsService {\n  constructor() {\n  }\n\n  orderTitles: Record<string, number> = {\n    'getting-started': 1,\n    'invoices': 4,\n    'settings': 5,\n    'recipes': 3,\n    'storage': 2,\n  };\n  private docs$ = new BehaviorSubject<DocFile[]>([]);\n  private tree$ = new BehaviorSubject<TreeNode[]>([]);\n  private _userLang = inject(USER_LANGUAGE);\n  private _sharedLoader = inject(SharedDocLoaderService);\n\n  getDocsView() {\n    return this.docs$.getValue();\n  }\n\n  async init() {\n    try {\n      const {docs, tree} = await this._sharedLoader.load('./docs', Stores.DOCUMENTATION);\n      const filteredTree = this._filterLanguage(tree, this._userLang());\n      this.tree$.next(this._sortTree(filteredTree));\n      this.docs$.next(docs);\n    } catch (e) {\n      console.error('DocsService init failed', e);\n    }\n  }\n\n  getDocs() {\n    return this.docs$.asObservable();\n  }\n\n  getTree() {\n    return this.tree$.asObservable();\n  }\n\n  private _filterLanguage(nodes: TreeNode[], lang: string): TreeNode[] {\n    return nodes\n      .map(node => this._sharedLoader.filterLanguage(node, lang))\n      .filter((n): n is TreeNode => !!n);\n  }\n\n  private _sortTree(nodes: TreeNode[]): TreeNode[] {\n    return nodes.toSorted((a, b) => (this.orderTitles[a.name || ''] || 0) - (this.orderTitles[b.name || ''] || 0));\n  }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAOM,IAAO,cAAP,MAAO,aAAW;EACtB,cAAA;EACA;EAEA,cAAsC;IACpC,mBAAmB;IACnB,YAAY;IACZ,YAAY;IACZ,WAAW;IACX,WAAW;;EAEL,QAAQ,IAAI,gBAA2B,CAAA,CAAE;EACzC,QAAQ,IAAI,gBAA4B,CAAA,CAAE;EAC1C,YAAY,OAAO,aAAa;EAChC,gBAAgB,OAAO,sBAAsB;EAErD,cAAW;AACT,WAAO,KAAK,MAAM,SAAQ;EAC5B;EAEA,MAAM,OAAI;AACR,QAAI;AACF,YAAM,EAAC,MAAM,KAAI,IAAI,MAAM,KAAK,cAAc,KAAK,UAAU,OAAO,aAAa;AACjF,YAAM,eAAe,KAAK,gBAAgB,MAAM,KAAK,UAAS,CAAE;AAChE,WAAK,MAAM,KAAK,KAAK,UAAU,YAAY,CAAC;AAC5C,WAAK,MAAM,KAAK,IAAI;IACtB,SAAS,GAAG;AACV,cAAQ,MAAM,2BAA2B,CAAC;IAC5C;EACF;EAEA,UAAO;AACL,WAAO,KAAK,MAAM,aAAY;EAChC;EAEA,UAAO;AACL,WAAO,KAAK,MAAM,aAAY;EAChC;EAEQ,gBAAgB,OAAmB,MAAY;AACrD,WAAO,MACJ,IAAI,UAAQ,KAAK,cAAc,eAAe,MAAM,IAAI,CAAC,EACzD,OAAO,CAAC,MAAqB,CAAC,CAAC,CAAC;EACrC;EAEQ,UAAU,OAAiB;AACjC,WAAO,MAAM,SAAS,CAAC,GAAG,OAAO,KAAK,YAAY,EAAE,QAAQ,EAAE,KAAK,MAAM,KAAK,YAAY,EAAE,QAAQ,EAAE,KAAK,EAAE;EAC/G;;qCA/CW,cAAW;EAAA;4EAAX,cAAW,SAAX,aAAW,WAAA,YADC,OAAM,CAAA;;;sEAClB,aAAW,CAAA;UADvB;WAAW,EAAC,YAAY,OAAM,CAAC;;;",
  "names": []
}
