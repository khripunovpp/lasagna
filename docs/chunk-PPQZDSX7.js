import{c as f}from"./chunk-NECHCYOO.js";import{b as h}from"./chunk-P7L2C53Q.js";import{g as y}from"./chunk-5ZHT4QO7.js";import{b as d}from"./chunk-Z2KUFMIF.js";import{y as R}from"./chunk-K7R7MOA3.js";import{V as u,Z as i,ma as a}from"./chunk-PNZYYIKS.js";import{f as o}from"./chunk-2WH2EVR6.js";var C=class c{constructor(t,s,e,r,n){this._flexsearchIndexService=t;this._productsRepository=s;this._recipesRepository=e;this._categoryProductsRepository=r;this._categoryRecipesRepository=n}displayBar=a(!1);results=a([]);resultsPayload=a([]);showBar(){this.displayBar.set(!0)}hideBar(){this.displayBar.set(!1)}search(t){return o(this,null,function*(){let e=(yield Promise.all([this._searchInProducts(t),this._searchInRecipes(t),this._searchInProductsCategories(t),this._searchInRecipesCategories(t)])).flat(),r=[];for(let n of e){let p=yield this.getResource(n);if(p&&p.length!==0)for(let l of p)r.push({context:n.context,uuid:encodeURIComponent(l?.uuid??""),data:l})}return this.resultsPayload.set(r),r})}getResource(t){return o(this,null,function*(){let s=[];for(let e of t.result)switch(t.context){case"product":{let r=yield this._productsRepository.getOne(e);s.push(r);break}case"recipe":{let r=yield this._recipesRepository.getOne(e);s.push(r);break}case"category_product":{let r=yield this._categoryProductsRepository.getOne(e);s.push(r);break}case"category_recipe":{let r=yield this._categoryRecipesRepository.getOne(e);s.push(r);break}}return s})}_searchInProducts(t){return o(this,null,function*(){return(yield this._flexsearchIndexService.search("productsStore",t)).flatMap(e=>({context:"product",field:e.field,result:e.result}))})}_searchInRecipes(t){return o(this,null,function*(){return(yield this._flexsearchIndexService.search("recipesStore",t)).flatMap(e=>({context:"recipe",field:e.field,result:e.result}))})}_searchInProductsCategories(t){return o(this,null,function*(){return(yield this._flexsearchIndexService.search("categoryProductsStore",t)).flatMap(e=>({context:"category_product",field:e.field,result:e.result}))})}_searchInRecipesCategories(t){return o(this,null,function*(){return(yield this._flexsearchIndexService.search("categoryRecipesStore",t)).flatMap(e=>({context:"category_recipe",field:e.field,result:e.result}))})}static \u0275fac=function(s){return new(s||c)(i(R),i(y),i(f),i(d),i(h))};static \u0275prov=u({token:c,factory:c.\u0275fac,providedIn:"root"})};export{C as a};
