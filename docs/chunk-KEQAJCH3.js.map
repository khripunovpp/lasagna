{
  "version": 3,
  "sources": ["src/app/features/documentation/view/docs-three.component.ts"],
  "sourcesContent": ["import {AfterViewInit, Component, ElementRef, Renderer2, signal, viewChild} from '@angular/core';\nimport {AsyncPipe, NgTemplateOutlet} from '@angular/common';\nimport {NavigationEnd, Router, RouterLink} from '@angular/router';\nimport {MatIcon} from '@angular/material/icon';\nimport {combineLatestWith, defer, filter, of, startWith, switchMap} from 'rxjs';\nimport {TranslatePipe} from '@ngx-translate/core';\nimport {ButtonComponent} from '../../../shared/view/ui/button/button.component';\nimport {DropdownComponent} from '../../controls/dropdown/dropdown.component';\nimport {DocsService} from '../service/docs.service';\n\n\n@Component({\n  selector: 'lg-docs-three',\n  template: `\n    @if (placeholderHeight()) {\n      <div [style.height.px]=\"placeholderHeight()\"></div>\n    }\n    <lg-dropdown [style.left.px]=\"position()?.left\"\n                 [style.position]=\"position()?.position\"\n                 [style.top.px]=\"position()?.top\">\n      <lg-button [size]=\"'small'\"\n                 [style]=\"'transcluent'\"\n                 lgDropdownAnchor>\n        <mat-icon aria-hidden=\"false\" fontIcon=\"auto_stories\"></mat-icon>\n      </lg-button>\n\n\n      <div class=\"lg-documentation-container\">\n        @for (item of tree | async; track item) {\n          <ng-container [ngTemplateOutlet]=\"itemTpl\"\n                        [ngTemplateOutletContext]=\"{ $implicit: item,level:0 }\"></ng-container>\n        }\n      </div>\n\n    </lg-dropdown>\n\n\n    <ng-template #itemTpl let-item let-level=\"level\">\n      <div\n        (click)=\"toggle(item)\"\n        [style.padding-left.px]=\"level * 16\"\n        class=\"doc-tree-item\">\n        @if (item.type === 'folder') {\n          <div class=\"doc-tree-toggle\">\n            {{ item._expanded ? '▼' : '▶' }}\n          </div>\n        } @else {\n          <div class=\"doc-tree-empty-icon\"></div>\n        }\n\n        @if (item.path) {\n          <a [routerLink]=\"getPath(item.path)\" class=\"doc-tree-link\">\n            {{ (nameToTitleMap[item.name] ?? item.title ?? item.name) | translate }}\n          </a>\n        } @else {\n          <div class=\"doc-tree-folder-name\">\n            {{ (nameToTitleMap[item.name] ?? item.title ?? item.name) | translate }}\n          </div>\n        }\n      </div>\n\n      @if (item.children && item._expanded) {\n        @for (child of item.children; track child) {\n          <ng-container\n            [ngTemplateOutlet]=\"itemTpl\"\n            [ngTemplateOutletContext]=\"{ $implicit: child, level: level + 1 }\"/>\n        }\n      }\n    </ng-template>\n  `,\n  imports: [\n    AsyncPipe,\n    NgTemplateOutlet,\n    RouterLink,\n    ButtonComponent,\n    DropdownComponent,\n    MatIcon,\n    TranslatePipe,\n  ],\n  styles: [`\n    .lg-documentation-container {\n      font-size: 14px;\n      line-height: 1.5;\n    }\n\n    .doc-tree-item {\n      display: flex;\n      align-items: center;\n      gap: 4px;\n      cursor: pointer;\n      user-select: none;\n      padding: 2px 0;\n      white-space: nowrap;\n    }\n\n    .doc-tree-toggle {\n      width: 16px;\n      display: inline-block;\n      cursor: pointer;\n      font-size: 12px;\n    }\n\n    .doc-tree-empty-icon {\n      width: 16px;\n      display: inline-block;\n    }\n\n    .doc-tree-link {\n      color: #2a2a2a;\n      text-decoration: none;\n      transition: color 0.2s;\n    }\n\n    .doc-tree-link:hover {\n      text-decoration: underline;\n      color: #000;\n    }\n\n    .doc-tree-folder-name {\n      font-weight: 600;\n    }\n  `]\n})\nexport class DocsThreeComponent\n  implements AfterViewInit {\n  constructor(\n    public docsService: DocsService,\n    private _router: Router,\n    private _renderer2: Renderer2,\n  ) {\n  }\n\n  dropdownComponent = viewChild(DropdownComponent);\n  dropdownElementRef = viewChild(DropdownComponent, {read: ElementRef});\n  nameToTitleMap: Record<string, string> = {\n    'getting-started': 'docs.getting-started',\n    'invoices': 'docs.invoices',\n    'settings': 'docs.settings',\n    'recipes': 'docs.recipes',\n    'storage': 'docs.storage',\n  };\n\n  onNavigationEnd = defer(() => this._router.events.pipe(\n    filter(event => event instanceof NavigationEnd),\n    startWith(null) // Ensure initial value\n  ));\n\n  tree = defer(() => this.docsService.getTree())\n    .pipe(\n      combineLatestWith(this.onNavigationEnd),\n      switchMap(([tree]) => {\n        // Ensure all items are expanded if the current route matches\n        const currentPath = this._router.url.split('?')[0];\n        const expandAll = (items: any[], path: string) => {\n          items.forEach(item => {\n            item._expanded = item.path ? currentPath.startsWith(this.getPath(item.path)) : false;\n            if (item.children) {\n              expandAll(item.children, path);\n            }\n          });\n        };\n        expandAll(tree, currentPath);\n        this.dropdownComponent()?.closeDropdown();\n        return of(tree);\n      }),\n    );\n  placeholderHeight = signal(0);\n  position = signal<{\n    top: number\n    left: number\n    position: string\n  } | null>(null);\n\n  getPath(item: string) {\n    const segments = item.split('/');\n    const mapped = segments.map(segment => segment.replace('.md', ''));\n    return ['/docs'].concat(mapped.filter(Boolean)).join('/');\n  }\n\n  toggle(item: any) {\n    if (item.type !== 'folder') return;\n    item._expanded = !item._expanded;\n  }\n\n  ngAfterViewInit() {\n    setTimeout(() => {\n      const dropdown = this.dropdownElementRef();\n      if (dropdown) {\n        const rect = dropdown.nativeElement.getBoundingClientRect();\n        const height = rect.height;\n        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n        const scrollLeft = window.pageXOffset || document.documentElement.scrollLeft;\n        this.placeholderHeight.set(height + 32);\n        this.position.set({\n          top: rect.top + scrollTop,\n          left: rect.left + scrollLeft,\n          position: 'fixed',\n        });\n      }\n      this.dropdownComponent()?.closeDropdown();\n    });\n  }\n}\n"],
  "mappings": "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",
  "names": []
}
